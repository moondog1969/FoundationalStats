<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 6 Base Graphics | An Amalgam of R</title>
<meta name="author" content="Ken Aho">
<meta name="description" content='"Mankind invented a system to cope with the fact that we are so intrinsically lousy at manipulating numbers. It’s called the graph."  - Charlie Munger, businessman and philanthropist  6.1...'>
<meta name="generator" content="bookdown 0.39 with bs4_book()">
<meta property="og:title" content="Chapter 6 Base Graphics | An Amalgam of R">
<meta property="og:type" content="book">
<meta property="og:description" content='"Mankind invented a system to cope with the fact that we are so intrinsically lousy at manipulating numbers. It’s called the graph."  - Charlie Munger, businessman and philanthropist  6.1...'>
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 6 Base Graphics | An Amalgam of R">
<meta name="twitter:description" content='"Mankind invented a system to cope with the fact that we are so intrinsically lousy at manipulating numbers. It’s called the graph."  - Charlie Munger, businessman and philanthropist  6.1...'>
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.8.0/transition.js"></script><script src="libs/bs3compat-0.8.0/tabs.js"></script><script src="libs/bs3compat-0.8.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/core-js-2.5.3/shim.min.js"></script><script src="libs/react-18.2.0/react.min.js"></script><script src="libs/react-18.2.0/react-dom.min.js"></script><script src="libs/reactwidget-2.0.0/react-tools.js"></script><script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="libs/reactable-0.4.4/reactable.css" rel="stylesheet">
<script src="libs/reactable-binding-0.4.4/reactable.js"></script><script src="libs/rglWebGL-binding-1.3.1/rglWebGL.js"></script><link href="libs/rglwidgetClass-1.3.1/rgl.css" rel="stylesheet">
<script src="libs/rglwidgetClass-1.3.1/rglClass.src.js"></script><script src="libs/rglwidgetClass-1.3.1/utils.src.js"></script><script src="libs/rglwidgetClass-1.3.1/buffer.src.js"></script><script src="libs/rglwidgetClass-1.3.1/subscenes.src.js"></script><script src="libs/rglwidgetClass-1.3.1/shaders.src.js"></script><script src="libs/rglwidgetClass-1.3.1/shadersrc.src.js"></script><script src="libs/rglwidgetClass-1.3.1/textures.src.js"></script><script src="libs/rglwidgetClass-1.3.1/projection.src.js"></script><script src="libs/rglwidgetClass-1.3.1/mouse.src.js"></script><script src="libs/rglwidgetClass-1.3.1/init.src.js"></script><script src="libs/rglwidgetClass-1.3.1/pieces.src.js"></script><script src="libs/rglwidgetClass-1.3.1/draw.src.js"></script><script src="libs/rglwidgetClass-1.3.1/controls.src.js"></script><script src="libs/rglwidgetClass-1.3.1/selection.src.js"></script><script src="libs/rglwidgetClass-1.3.1/rglTimer.src.js"></script><script src="libs/rglwidgetClass-1.3.1/pretty.src.js"></script><script src="libs/rglwidgetClass-1.3.1/axes.src.js"></script><script src="libs/rglwidgetClass-1.3.1/animation.src.js"></script><script src="libs/CanvasMatrix4-1.3.1/CanvasMatrix.src.js"></script><link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="libs/plotly-binding-4.10.4/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
          margin-bottom: 0em;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="A Primer and Reference for Biologists">An Amalgam of R</a>:
        <small class="text-muted">A Primer and Reference for Biologists</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li><a class="" href="ch1.html"><span class="header-section-number">1</span> Welcome to R</a></li>
<li><a class="" href="ch2.html"><span class="header-section-number">2</span> Some Basics</a></li>
<li><a class="" href="ch3.html"><span class="header-section-number">3</span> Data Objects, Packages, and Datasets</a></li>
<li><a class="" href="ch4.html"><span class="header-section-number">4</span> Basic Data Management</a></li>
<li><a class="" href="ch5.html"><span class="header-section-number">5</span> Welcome to the Tidyverse</a></li>
<li><a class="active" href="ch6.html"><span class="header-section-number">6</span> Base Graphics</a></li>
<li><a class="" href="ch7.html"><span class="header-section-number">7</span> Grid Graphics, Including ggplot2</a></li>
<li><a class="" href="ch8.html"><span class="header-section-number">8</span> Functions</a></li>
<li><a class="" href="ch9.html"><span class="header-section-number">9</span> R Interfaces</a></li>
<li><a class="" href="ch10.html"><span class="header-section-number">10</span> Building R Packages</a></li>
<li><a class="" href="ch11.html"><span class="header-section-number">11</span> Interactive and Web Applications</a></li>
<li><a class="" href="ch12.html"><span class="header-section-number">12</span> R and Your Computer</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="ch6" class="section level1" number="6">
<h1>
<span class="header-section-number">6</span> Base Graphics<a class="anchor" aria-label="anchor" href="#ch6"><i class="fas fa-link"></i></a>
</h1>
<blockquote>
<p><em>"Mankind invented a system to cope with the fact that we are so intrinsically lousy at manipulating numbers. It’s called the graph."</em></p>
</blockquote>
<div class="flushright">
<p>- <strong>Charlie Munger</strong>, <em>businessman and philanthropist</em></p>
</div>
<div id="introduction" class="section level2" number="6.1">
<h2>
<span class="header-section-number">6.1</span> Introduction<a class="anchor" aria-label="anchor" href="#introduction"><i class="fas fa-link"></i></a>
</h2>
<p>
An important feature of <strong>R</strong> is its capacity to create publication-quality graphics with tremendous user flexibility. Generally speaking, <strong>R</strong> graphics are non-interactive and changes to plots require the creation of entirely new static plots. This may feel like a major departure for those used to point-and-click graphics, characteristic of software like Excel<span class="math inline">\(^{\circledR}\)</span> and SigmaPlot<span class="math inline">\(^{\circledR}\)</span>.
</p>
<p>There are two general graphics approaches in <strong>R</strong>: <em>base</em> graphics and <em>grid</em> graphics <span class="citation">(<a href="references.html#ref-murrell2019">Murrell 2019</a>)</span>. Base graphics are applied using the <strong>R</strong> distribution package <em>graphics</em>, whereas the grid graphics system relies on low level facilities in the <strong>R</strong> distributed <em>grid</em> package, which are generally implemented via high level functions in other packages. The base and grid graphics systems generally do not interact well, although both rely on the distributed <em>grDevices</em> package which provides the fundamental infrastructure for <strong>R</strong> graphics, including graphical devices. Both base and grid systems follow the <em>painters model</em> in which later output obscures earlier overlapping output.</p>
<p>The base graphics system is the focus of this chapter. The grid system, and its most popular adherent, the package <em>ggplot2</em>, is described in Chapter <a href="ch7.html#ch7">7</a>.
</p>
</div>
<div id="simple-base-graphics-examples" class="section level2" number="6.2">
<h2>
<span class="header-section-number">6.2</span> Simple Base Graphics Examples<a class="anchor" aria-label="anchor" href="#simple-base-graphics-examples"><i class="fas fa-link"></i></a>
</h2>
<p>The base graphics system allows creation of a wide variety of plots for single variables and multiple variables (see Figs <a href="ch6.html#fig:d1">6.1</a> and <a href="ch6.html#fig:d2">6.2</a>, respectively). Approaches for making many of these example plots are elaborated later in this chapter.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:d1"></span>
<img src="figure/minimal-d1-1.png" alt="Base graphics approaches for single variables.  Figure follows @murrell2019. Classes of plotted objects are distinguished by name and color in main headings: &lt;span style='color: lightblue;'&gt;num&lt;/span&gt; = numeric, &lt;span style='color: brown;'&gt;tab&lt;/span&gt; = table, &lt;span style='color: lightgreen;'&gt;fac&lt;/span&gt; = factor. By row, from left to right, graphics are: 1) a *scatterplot* created by applying the function `plot()` to a vector of class numeric, 2) the `plot()` function applied to a one-dimensional object of class table, resulting in a distributional plot, 3) a *barplot*, useful for comparing categorical outcomes, 4) a *pie chart*, 5) a *dotchart*, which provides a dot variant of a bar plot), 6) a *boxplot*, i.e., the interquartile range (hinges) and whiskers delimiting outliers, 7) a *histogram* (the most common graphical distributional summary), 8) a *stripchart*, i.e., a one dimensional scatter plot that provides a horizontal view of distributional outcomes, and 9) a *stem chart*." width="672"><p class="caption">
Figure 6.1: Base graphics approaches for single variables. Figure follows <span class="citation">Murrell (<a href="references.html#ref-murrell2019">2019</a>)</span>. Classes of plotted objects are distinguished by name and color in main headings: <span style="color: lightblue;">num</span> = numeric, <span style="color: brown;">tab</span> = table, <span style="color: lightgreen;">fac</span> = factor. By row, from left to right, graphics are: 1) a <em>scatterplot</em> created by applying the function <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> to a vector of class numeric, 2) the <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> function applied to a one-dimensional object of class table, resulting in a distributional plot, 3) a <em>barplot</em>, useful for comparing categorical outcomes, 4) a <em>pie chart</em>, 5) a <em>dotchart</em>, which provides a dot variant of a bar plot), 6) a <em>boxplot</em>, i.e., the interquartile range (hinges) and whiskers delimiting outliers, 7) a <em>histogram</em> (the most common graphical distributional summary), 8) a <em>stripchart</em>, i.e., a one dimensional scatter plot that provides a horizontal view of distributional outcomes, and 9) a <em>stem chart</em>.
</p>
</div>
<p>
</p>
<p>
</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:d2"></span>
<img src="figure/minimal-d2-1.png" alt="Base graphics approaches for considering multiple variables.  Figure follows @murrell2019. Classes of plotted objects are distinguished by name and color in main headings: &lt;span style='color: lightblue;'&gt;num&lt;/span&gt; = numeric, &lt;span style='color: brown;'&gt;tab&lt;/span&gt; = table, &lt;span style='color: lightgreen;'&gt;fac&lt;/span&gt; = factor. By row, from left to right, graphics are: 1) a *scatterplot* based on two quantitative variables, 2) a scatterplot with smoothed densities, 3) a *sunflower plot*, which uses special symbols to indicate overplotting of points, 4) a *boxplot* based on a factor (with two levels) and a numeric variable, 5) and 6) *stacked and beside barplots* of matrices, 7) a *dotchart*, 8) a *stripchart*, based on two numeric variables, and 9) a *spineplot*, a special cases of a mosaic plot (obtained using `mosaicplot()`), representing a generalization of a stacked (or highlighted) bar plot." width="672"><p class="caption">
Figure 6.2: Base graphics approaches for considering multiple variables. Figure follows <span class="citation">Murrell (<a href="references.html#ref-murrell2019">2019</a>)</span>. Classes of plotted objects are distinguished by name and color in main headings: <span style="color: lightblue;">num</span> = numeric, <span style="color: brown;">tab</span> = table, <span style="color: lightgreen;">fac</span> = factor. By row, from left to right, graphics are: 1) a <em>scatterplot</em> based on two quantitative variables, 2) a scatterplot with smoothed densities, 3) a <em>sunflower plot</em>, which uses special symbols to indicate overplotting of points, 4) a <em>boxplot</em> based on a factor (with two levels) and a numeric variable, 5) and 6) <em>stacked and beside barplots</em> of matrices, 7) a <em>dotchart</em>, 8) a <em>stripchart</em>, based on two numeric variables, and 9) a <em>spineplot</em>, a special cases of a mosaic plot (obtained using <code><a href="https://rdrr.io/r/graphics/mosaicplot.html">mosaicplot()</a></code>), representing a generalization of a stacked (or highlighted) bar plot.
</p>
</div>
<p>
</p>
<p>
</p>
<div id="plot" class="section level3" number="6.2.1">
<h3>
<span class="header-section-number">6.2.1</span> <code>plot()</code><a class="anchor" aria-label="anchor" href="#plot"><i class="fas fa-link"></i></a>
</h3>
<p>
The workhorse of base graphics is the function <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code>. From Figs <a href="ch6.html#fig:d1">6.1</a> and <a href="ch6.html#fig:d2">6.2</a> it is evident that <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> can be used in a number of different ways, depending on the characteristics of data being plotted. For example, if data are two numeric vectors, then a conventional scatterplot is created. However, if the first two arguments in <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> call a numerical vector and a factor vector (in that order), then a boxplot is created, and if the first two arguments in <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> call a factor vector and a numeric vector (in that order), then a stripchart is created. Further, plotting methods for particular classes of objects can be designed that can be implemented by calling <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code>. For instance, the dendrogram in Fig <a href="ch6.html#fig:den">6.3</a> was created using a plotting method called <code>plot.agnes()</code>, designed for objects of class <code>agnes</code><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;An object class resulting from hierarchical agglomerative cluster analyses produced by the function &lt;code&gt;cluster::agnes&lt;/code&gt;.&lt;/p&gt;"><sup>56</sup></a>. However, the function can be run using a generic call to <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code>. See Ch <a href="ch8.html#ch8">8</a> for additional details on plotting methods for <strong>R</strong> classes.
</p>
<div class="sourceCode" id="cb688"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://svn.r-project.org/R-packages/trunk/cluster/">cluster</a></span><span class="op">)</span></span>
<span><span class="va">aa.ga</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/cluster/man/agnes.html">agnes</a></span><span class="op">(</span><span class="va">animals</span>, method <span class="op">=</span> <span class="st">"average"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">aa.ga</span>, sub <span class="op">=</span> <span class="st">""</span>, main <span class="op">=</span> <span class="st">""</span>, which.plots <span class="op">=</span> <span class="fl">2</span>, xlab <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:den"></span>
<img src="figure/minimal-den-1.png" alt="Dendrogram of an average linkage classification of animals based on six variables: warm vs. cold blooded, ability to fly, vertebrate or invertebrate, whether or not the animal is endangered, whether or not the animal lives in groups, and whether or not the animal has hair. The plotting function used, `plot.agnes()`, is called using the generic name `plot()`." width="672"><p class="caption">
Figure 6.3: Dendrogram of an average linkage classification of animals based on six variables: warm vs. cold blooded, ability to fly, vertebrate or invertebrate, whether or not the animal is endangered, whether or not the animal lives in groups, and whether or not the animal has hair. The plotting function used, <code>plot.agnes()</code>, is called using the generic name <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code>.
</p>
</div>
<p>By default, the function <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> creates a projection at user defined Cartesian coordinates. Under this usage <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> has only
two required arguments.</p>
<ul>
<li>
<code>x</code> defines the x-coordinate values.</li>
<li>
<code>y</code> defines the y-coordinate values.</li>
</ul>
<p>If coordinates for only one dimension, <code>x</code> are supplied, then <code>x</code> is plotted on the vertical axis against the series <span class="math inline">\(1:n\)</span>, where <span class="math inline">\(n\)</span> is the number of points in <code>x</code>. A coordinate system can also be supplied to the argument <code>x</code> in the form of a formula, list, matrix, or dataframe.</p>
<p>Important optional arguments include the following:</p>
<ul>
<li>
<code>pch</code> specifies the symbol type(s), i.e., the plotting character(s) to be used.</li>
<li>
<code>col</code> defines the color(s) to be used with the symbols.</li>
<li>
<code>cex</code> defines the size (character expansion) of the plot symbols and text.</li>
<li>
<code>xlab</code> and <code>ylab</code> allow the user to specify the x and y-axis labels.</li>
<li>
<code>type</code> allows the user to define the type of graph to be drawn. Possible types are <code>"p"</code> for scatterplot points (the default), <code>"l"</code> for a line plot, <code>"b"</code> for both, <code>"c"</code> for the line component of <code>"b"</code>, <code>"o"</code> for overplotted, <code>"h"</code> for ‘histogram’ like vertical lines (see middle plot in top row of Fig <a href="ch6.html#fig:d1">6.1</a>), <code>"s"</code> for stair steps, and <code>n"</code> for no plotting.</li>
</ul>
<div class="example">
<p><span id="exm:exm-plotf1" class="example"><strong>Example 6.1  </strong></span><span class="math inline">\(\text{}\)</span><br>
We can see some symbol and color alternatives by calling them in <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> (Fig <a href="ch6.html#fig:sp1">6.4</a>).</p>
<style type="text/css">
pre.numberSource code > span > a:first-child::before {
  left: -.4em;
}
</style>
<div class="sourceCode" id="cb689"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb689-1"><a href="ch6.html#cb689-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>, <span class="at">pch =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>, <span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,</span>
<span id="cb689-2"><a href="ch6.html#cb689-2"></a>     <span class="at">ylab =</span><span class="st">"Symbol number"</span>,</span>
<span id="cb689-3"><a href="ch6.html#cb689-3"></a>     <span class="at">xlab =</span> <span class="st">"Color number"</span>,</span>
<span id="cb689-4"><a href="ch6.html#cb689-4"></a>     <span class="at">cex =</span> <span class="fl">1.6</span>, <span class="at">cex.lab =</span> <span class="fl">1.1</span>, <span class="at">cex.axis =</span> <span class="fl">1.1</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:sp1"></span>
<img src="figure/minimal-sp1-1.png" alt="Some symbol and color plotting possibilities in `plot()`." width="576"><p class="caption">
Figure 6.4: Some symbol and color plotting possibilities in <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code>.
</p>
</div>
<p>In line one from the code above, the <em>x</em> and <em>y</em> coordinates are both sequences of numbers from 1 to 20 obtained from the command <code>1:20</code>. I varied symbol colors and plotting characters (<code>col</code> and <code>pch</code>, respectively) using <code>1:20</code> as well. Thus, the combination <code>col = 1</code> and <code>pch = 1</code> results in a black open circle, whereas the combination <code>col = 20</code>, <code>pch = 20</code> results in a blue filled circle. Note that we need to enclose the axis names in quotations for <code>R</code> to recognize
them as text. Symbol numbers <code>21-26</code> allow background color specification using the argument <code>bg</code>. Many other symbol types are also possible.</p>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
</div>
</div>
<div id="graphical-devices" class="section level2" number="6.3">
<h2>
<span class="header-section-number">6.3</span> Graphical Devices<a class="anchor" aria-label="anchor" href="#graphical-devices"><i class="fas fa-link"></i></a>
</h2>
<p>Graphics in <strong>R</strong> are created within <em>graphics devices</em>, encoded in the package <em>grDevices</em>. These vary with respect to storage modes, display modes, available typefaces, and other characteristics. In a basic <strong>R</strong> download, six graphics devices will be available:</p>
<ul>
<li>
<code><a href="https://rdrr.io/r/grDevices/windows.html">windows()</a></code> is available for Windows releases of <strong>R</strong>. Provides on-screen rendering of graphics (outside of RStudio)<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;RStudio has its own native on-screen graphics device. A non RStudio graphics device can be opened (within RStudio) using &lt;code&gt;dev.new(RStudioGD = FALSE)&lt;/code&gt;.&lt;/p&gt;"><sup>57</sup></a>, and creates Windows metafile graphics files.</li>
<li>
<code><a href="https://rdrr.io/r/grDevices/pdf.html">pdf()</a></code> renders graphics into .pdf files.</li>
<li>
<code><a href="https://rdrr.io/r/grDevices/postscript.html">postscript()</a></code> renders graphics into PostScript, .ps, graphics files.</li>
<li>
<code><a href="https://rdrr.io/r/grDevices/xfig.html">xfig()</a></code> renders graphics files using the Xfig graphics file format.</li>
<li>
<code><a href="https://rdrr.io/r/grDevices/dev2bitmap.html">bitmap()</a></code> renders graphics into bitmap graphics files It requires the open source software <a href="https://www.ghostscript.com/">ghostscript</a>.</li>
<li>
<code>piktex()</code> Writes TeX/PicTeX graphics commands to a file and is of historical interest only.</li>
</ul>
<p>
</p>
<p>A number of other graphics devices also exist, although they may return a warning if <strong>R</strong> was not compiled to use them upon installation.</p>
<ul>
<li><p><code><a href="https://rdrr.io/r/grDevices/cairo.html">cairo_pdf()</a></code>, <code><a href="https://rdrr.io/r/grDevices/cairo.html">cairo_ps()</a></code> and <code><a href="https://rdrr.io/r/grDevices/cairo.html">svg()</a></code> are PDF, PostScript SVG (Scalar Vector Graphics) devices based on the open source <a href="https://www.cairographics.org/">Cairo</a> graphics.</p></li>
<li><p><code><a href="https://rdrr.io/r/grDevices/png.html">bmp()</a></code>, <code><a href="https://rdrr.io/r/grDevices/png.html">jpeg()</a></code>, <code><a href="https://rdrr.io/r/grDevices/png.html">png()</a></code>, and <code><a href="https://rdrr.io/r/grDevices/png.html">tiff()</a></code> render graphics as .bmp, .jpg, .png, and .tif bitmap files, respectively.</p></li>
<li><p><code><a href="https://rdrr.io/r/grDevices/x11.html">X11()</a></code> is the graphics device for the X11 windowing system, and is commonly used in Unix-alike operating systems, including MacOS.</p></li>
<li><p><code>quartz()</code> is only functional on MacOS and supports plotting to the screen (default) and to various graphics file formats. The device requires the open source software <a href="https://www.xquartz.org/">XQuartz</a> for rendering some <strong>R</strong> graphical user interfaces (see Ch <a href="ch11.html#ch11">11</a>).</p></li>
</ul>
<p>
</p>
<p>Multiple devices (currently up to 63) may exist simultaneously in an <strong>R</strong> work session, although there will only be one <em>active</em> device. To find the current (active) graphics device can type <code><a href="https://rdrr.io/r/grDevices/dev.html">dev.cur()</a></code>. I get:</p>
<div class="sourceCode" id="cb690"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.cur</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>png 
  2 </code></pre>
<p><strong>R</strong> tells me there are two devices open. The current device is a Windows device. The second device is the so-called “null device.” The null device is always open but only serves as a placeholder. Any attempt to use it will open a new device in <strong>R</strong>. Occasionally, on purpose or by accident, all graphics devices (except the null device) may become turned off. A new active graphics device can be created at any time by typing:</p>
<div class="sourceCode" id="cb692"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.new</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>One can close the current (active) device using:</p>
<div class="sourceCode" id="cb693"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>The active device can be changed using the function <code><a href="https://rdrr.io/r/grDevices/dev.html">dev.set()</a></code>. For instance, if there were three or more accessible devices, and one wished to define device three as the active device, one could type:</p>
<div class="sourceCode" id="cb694"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.set</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p>It is possible to scroll through graphics devices using keyboard shortcuts. Specifically, let <span class="math inline">\(n\)</span> be the current device number, then the combination <kbd>Ctrl</kbd> + <kbd>Alt</kbd> + <kbd>F11</kbd> (Windows or Linux) or <kbd>Cmd</kbd> + <kbd>Alt</kbd> + <kbd>F11</kbd> (Mac) shows device <span class="math inline">\(n-1\)</span>, whereas <kbd>Ctrl</kbd> + <kbd>Alt</kbd> + <kbd>F12</kbd> (Windows or Linux) or <kbd>Cmd</kbd> + <kbd>Alt</kbd> + <kbd>F12</kbd> (Mac) shows device <span class="math inline">\(n+1\)</span>.</p>
<p>
</p>
</div>
<div id="par" class="section level2" number="6.4">
<h2>
<span class="header-section-number">6.4</span> <code>par()</code><a class="anchor" aria-label="anchor" href="#par"><i class="fas fa-link"></i></a>
</h2>
<p>Parameters for a graphics device (which may contain several plots) can be accessed and modified using the function <code><a href="https://rdrr.io/r/graphics/par.html">par()</a></code>. Below are important arguments for <code><a href="https://rdrr.io/r/graphics/par.html">par()</a></code>. Some of these can also be specified as arguments in <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code>, with different results.</p>
<ul>
<li>
<code>bg</code> gives the background color for the graphical device. When used in <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> it gives the background color of plotting symbols.</li>
<li>
<code>bty</code> is the box-type to be drawn around the plots. If <code>bty</code> is one of <code>"o"</code> (the default), <code>"l"</code>, <code>"7"</code>, <code>"c", "u"</code>, or <code>"]"</code> the resulting box resembles the corresponding upper case letter. The value <code>"n"</code> suppresses the box.</li>
<li>
<code>fg</code> gives the foreground color.</li>
<li>
<code>font</code> is an integer that specifies the font typeface. <code>1</code> corresponds to regular text (the default), <code>2</code> to bold face,
<code>3</code> to italic and <code>4</code> to bold italic.</li>
<li>
<code>las</code> is the style of axis labels: <code>0</code> always parallel to the axis (default), <code>1</code> always horizontal, <code>2</code> always
perpendicular to the axis, <code>3</code> always vertical.</li>
<li>
<code>mar</code> will have the form <code>c(bottom, left, top, right)</code> and gives the number of lines of margin to be specified on the four sides of the plot. The default is <code>c(5, 4, 4, 2) + 0.1</code>.</li>
<li>
<code>mfrow</code> will have the form <code>c(number of rows, number of columns)</code> and the number and position of plots in a graphical layout. Multiple graphs can also be placed into a graphical device with additional control over plot designation to multiple elements in a row and column configuration, using the function <code><a href="https://rdrr.io/r/graphics/layout.html">layout()</a></code>.</li>
<li>
<code>oma</code> specifies the outer margins of a graphical device, given multiple plots, using a vector using a matrix of
the form: <code>c(bottom, left, top, right)</code>.</li>
<li>
<code>usr</code> will have the form <code>c(x1, x2, y1, y2)</code> giving the extremes of the user coordinates of the plotting
region.</li>
</ul>
<p>When setting graphical parameters, it is good practice to revert back to the original parameter values. Assume that I want to background of the graphics device to be black. To set this I would type:</p>
<div class="sourceCode" id="cb695"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">old.par</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>no.readonly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># save default, for resetting...</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>bg <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="co"># change background parameter</span></span></code></pre></div>
<p>To return to the default settings for background I would type:</p>
<div class="sourceCode" id="cb696"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">old.par</span><span class="op">)</span></span></code></pre></div>
<p>Defaults will also be reset by closing the current graphics device, or by opening a new device. For instance, using <code><a href="https://rdrr.io/r/grDevices/dev.html">dev.new()</a></code>.</p>
<p>Other fundamental properties of the default graphics device, such as device height, width and pointsize, can be adjusted using the <code><a href="https://rdrr.io/r/grDevices/dev.html">dev.new()</a></code> function. For instance, to create a graphical device 9 inches wide, and 4 inches high, I would type:</p>
<div class="sourceCode" id="cb697"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.new</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">9</span>, height <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<div class="example">
<p><span id="exm:exm-par1" class="example"><strong>Example 6.2  </strong></span><span class="math inline">\(\text{}\)</span><br>
Fig <a href="ch6.html#fig:par1">6.5</a> shows an example of applying background and foreground colors using the <code>bg</code> and <code>fg</code> arguments in <code><a href="https://rdrr.io/r/graphics/par.html">par()</a></code>, respectively. Note also the specification of a bold font using the <code><a href="https://rdrr.io/r/graphics/par.html">par()</a></code> argument <code>font = 3</code>, and expansion of all graphics parameters to slightly larger than their original size, using <code>cex = 1.1</code>.</p>
<div class="sourceCode" id="cb698"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb698-1"><a href="ch6.html#cb698-1"></a>old.par <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">no.readonly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb698-2"><a href="ch6.html#cb698-2"></a><span class="fu">par</span>(<span class="at">bg =</span> <span class="st">"black"</span>, <span class="at">fg =</span> <span class="st">"white"</span>, <span class="at">font =</span> <span class="dv">3</span>, <span class="at">cex =</span> <span class="fl">1.1</span>)</span>
<span id="cb698-3"><a href="ch6.html#cb698-3"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">xlab =</span> <span class="st">"x"</span>, <span class="at">ylab =</span> <span class="st">"y"</span>,</span>
<span id="cb698-4"><a href="ch6.html#cb698-4"></a>     <span class="at">col.lab =</span> <span class="st">"white"</span>)</span>
<span id="cb698-5"><a href="ch6.html#cb698-5"></a><span class="fu">par</span>(old.par)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:par1"></span>
<img src="figure/minimal-par1-1.png" alt="Use of `par()` to change background and foreground graphical parameters." width="480"><p class="caption">
Figure 6.5: Use of <code><a href="https://rdrr.io/r/graphics/par.html">par()</a></code> to change background and foreground graphical parameters.
</p>
</div>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
<div class="example">
<p><span id="exm:exm-par2" class="example"><strong>Example 6.3  </strong></span><span class="math inline">\(\text{}\)</span><br>
Fig <a href="ch6.html#fig:par2">6.6</a> shows how one can place multiple graphs into a single graphical device using the <code>mfrow</code> argument in <code><a href="https://rdrr.io/r/graphics/par.html">par()</a></code>, and control figure margins using the <code><a href="https://rdrr.io/r/graphics/par.html">par()</a></code> argument <code>mar</code> (line two). It also shows some basic plot types resulting from the <code>type</code> argument in <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> (lines 4-7).
</p>
<div class="sourceCode" id="cb699"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb699-1"><a href="ch6.html#cb699-1"></a>old.par <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">no.readonly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb699-2"><a href="ch6.html#cb699-2"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">cex =</span> <span class="fl">1.1</span>, <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb699-3"><a href="ch6.html#cb699-3"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>; y <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">rnorm</span>(<span class="dv">10</span>))</span>
<span id="cb699-4"><a href="ch6.html#cb699-4"></a><span class="fu">plot</span>(x, y)</span>
<span id="cb699-5"><a href="ch6.html#cb699-5"></a><span class="fu">plot</span>(x, y, <span class="at">type =</span> <span class="st">"l"</span>)</span>
<span id="cb699-6"><a href="ch6.html#cb699-6"></a><span class="fu">plot</span>(x, y, <span class="at">type =</span> <span class="st">"o"</span>)</span>
<span id="cb699-7"><a href="ch6.html#cb699-7"></a><span class="fu">plot</span>(x, y, <span class="at">type =</span> <span class="st">"h"</span>)</span>
<span id="cb699-8"><a href="ch6.html#cb699-8"></a><span class="fu">par</span>(old.par)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:par2"></span>
<img src="figure/minimal-par2-1.png" alt="Use of `par()` to place multiple graphs into a single graphical device. The figure also demonstrates basic plot types, specified using the `plot()` argument `type`. Clockwise from the top-left these are: 1) a point plot (scatterplot), 2) a line plot, 3) a histogram-like (high density line) plot, and 4) a plot with a both points and lines." width="672"><p class="caption">
Figure 6.6: Use of <code><a href="https://rdrr.io/r/graphics/par.html">par()</a></code> to place multiple graphs into a single graphical device. The figure also demonstrates basic plot types, specified using the <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> argument <code>type</code>. Clockwise from the top-left these are: 1) a point plot (scatterplot), 2) a line plot, 3) a histogram-like (high density line) plot, and 4) a plot with a both points and lines.
</p>
</div>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
</div>
<div id="exporting-graphics" class="section level2" number="6.5">
<h2>
<span class="header-section-number">6.5</span> Exporting Graphics<a class="anchor" aria-label="anchor" href="#exporting-graphics"><i class="fas fa-link"></i></a>
</h2>
<p>To export <strong>R</strong> graphics, one can generally copy snapshots to a clipboard using pull down menus on graphical device. These can then be pasted into programs (e.g., word processors) as bitmaps (a spatially mapped array of bits) or metafiles, a generic term for a file format that can store multiple types of
(generally graphical) data.</p>
<p>To create the best possible graphs, however, one should save device output using graphical device functions.</p>
<p>For instance, to save a graphics device image as a pdf under the file name <code>example.pdf</code> in the working directory I would type:</p>
<div class="sourceCode" id="cb700"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html">pdf</a></span><span class="op">(</span>file <span class="op">=</span><span class="st">"example.pdf"</span><span class="op">)</span></span></code></pre></div>
<p>I would then make the plot, for instance</p>
<div class="sourceCode" id="cb701"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p>The plot will not be shown because the <code><a href="https://rdrr.io/r/grDevices/png.html">png()</a></code> graphical device is engaged. As a final step I close the device.</p>
<div class="sourceCode" id="cb702"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>The graphics file will now be contained in the working directory. If the file argument is unspecified, <code><a href="https://rdrr.io/r/grDevices/pdf.html">pdf()</a></code> will save a file called <code>Rplot.pdf</code>.</p>
<p>By default, the <em>bitmap graphics formats</em>: BMP, JPEG, PNG, and TIFF, have a width and height of 480 pixels, and a “large” point size (1/72 inch) in <strong>R</strong>. This results in a rather coarse 72 ppi (72 points per inch) image resolution.
However, changing the <code>res</code> (resolution) argument in a graphical device function without changing the pointsize, or height and width arguments will generally result in unusable figures.</p>
<p>Because <span class="math inline">\(500 \approx 72 \cdot 6\)</span>, one can generate a TIFF with greater than <span class="math inline">\(400\)</span> ppi TIFF called <code>fig1.tiff</code> by typing:</p>
<div class="sourceCode" id="cb703"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/png.html">tiff</a></span><span class="op">(</span><span class="st">"fig1.tiff"</span>, res <span class="op">=</span> <span class="fl">72</span> <span class="op">*</span> <span class="fl">6</span>, height <span class="op">=</span> <span class="fl">480</span> <span class="op">*</span> <span class="fl">6</span>, width <span class="op">=</span> <span class="fl">480</span> <span class="op">*</span> <span class="fl">6</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>With respect to graphical formats, documentation in the <em>grDevices</em> package states:</p>
<blockquote>
<p>“The PNG format is lossless<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Lossless entails data compression without loss of information.&lt;/p&gt;"><sup>58</sup></a> and is best for line diagrams and blocks of color. The JPEG format is lossy<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Lossy refers to data compression in which unnecessary information is discarded.&lt;/p&gt;"><sup>59</sup></a>,
but may be useful for image plots, for example. The BMP format is standard on Windows, and supported by most viewers elsewhere. TIFF is a meta-format: the default format written by the default format <code>tiff(compression = none)</code> is lossless and stores RGB values uncompressed. Such files are widely accepted, which is their main virtue over PNG.”</p>
</blockquote>
<p>
</p>
<p>The <code><a href="https://rdrr.io/r/grDevices/cairo.html">svg()</a></code>, and graphical devices apply cairographics and will recognize a large number of symbols and fonts not available for document and image generation in the default setting of the Windows PostScript and PDF devices.</p>
</div>
<div id="text-points-and-lines" class="section level2" number="6.6">
<h2>
<span class="header-section-number">6.6</span> <code>text()</code>, <code>points()</code>, and <code>lines()</code><a class="anchor" aria-label="anchor" href="#text-points-and-lines"><i class="fas fa-link"></i></a>
</h2>
<p>
The functions <code><a href="https://rdrr.io/r/graphics/text.html">text()</a></code>, <code><a href="https://rdrr.io/r/graphics/points.html">points()</a></code> and <code><a href="https://rdrr.io/r/graphics/lines.html">lines()</a></code> can be used to overlay text, points and lines in a plot, respectively. As with <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> the first two arguments of these functions are the <em>x</em> and <em>y</em> coordinates for the plotted entities. Other arguments concern characteristics of the plotted items. For instance, to plot the text <code>"example"</code> with in an existing plot, at plot coordinates <code>x = 0</code>, <code>y = 0</code>, with a large character expansion, I could type:</p>
<div class="sourceCode" id="cb704"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">1</span>, type <span class="op">=</span> <span class="st">"n"</span>, axes <span class="op">=</span> <span class="cn">F</span>, xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="co"># empty plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">0</span>, <span class="st">"example"</span>, cex <span class="op">=</span> <span class="fl">9</span><span class="op">)</span></span></code></pre></div>
<p>The result is shown in Fig <a href="ch6.html#fig:text1">6.7</a>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:text1"></span>
<img src="figure/minimal-text1-1.png" alt="Empty plot (even axes are suppressed) with text overlain." width="288"><p class="caption">
Figure 6.7: Empty plot (even axes are suppressed) with text overlain.
</p>
</div>
<p>The function <code><a href="https://rdrr.io/r/base/paste.html">paste()</a></code> can be used to concatenate elements from text strings in plots or output. For instance, try:
</p>
<div class="sourceCode" id="cb705"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span><span class="op">)</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"d"</span>, <span class="st">"e"</span>, <span class="st">"f"</span><span class="op">)</span></span>
<span><span class="va">c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span><span class="op">)</span></span>
<span><span class="va">c</span></span></code></pre></div>
<pre><code>[1] "a d" "b e" "c f"</code></pre>
<p>Which can be placed in a plot (Fig <a href="ch6.html#fig:text2">6.8</a>) using <code><a href="https://rdrr.io/r/graphics/text.html">text()</a></code>.</p>
<div class="sourceCode" id="cb707"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">1</span>, type <span class="op">=</span> <span class="st">"n"</span>, axes <span class="op">=</span> <span class="cn">F</span>, xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">c</span>, collapse <span class="op">=</span> <span class="st">' '</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:text2"></span>
<img src="figure/minimal-text2-1.png" alt="An empty plot with text overlain.  Note the use `paste(c, collapse = ' ')` to collapse the string vector `c` into a single entity." width="288"><p class="caption">
Figure 6.8: An empty plot with text overlain. Note the use <code>paste(c, collapse = ' ')</code> to collapse the string vector <code>c</code> into a single entity.
</p>
</div>
<p>To plot a dashed line between the points <span class="math inline">\((0, 0)\)</span> and <span class="math inline">\((3, 2)\)</span>, I would type:</p>
<div class="sourceCode" id="cb708"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>or</p>
<div class="sourceCode" id="cb709"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span>, type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></span></code></pre></div>
<p>The result is shown in Fig <a href="ch6.html#fig:text3">6.9</a>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:text3"></span>
<img src="figure/minimal-text3-1.png" alt="Plot with dashed line overlain." width="480"><p class="caption">
Figure 6.9: Plot with dashed line overlain.
</p>
</div>
<p>To place a large, blue, triangle with red outline at the point (1, 1), of an existing plot I would type:</p>
<div class="sourceCode" id="cb710"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">1</span>, pch <span class="op">=</span> <span class="fl">24</span>, col <span class="op">=</span> <span class="fl">2</span>, bg <span class="op">=</span> <span class="fl">4</span>, cex <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code></pre></div>
<p>The resulting plot is shown in Fig <a href="ch6.html#fig:text4">6.10</a>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:text4"></span>
<img src="figure/minimal-text4-1.png" alt="Plot with point overlain." width="480"><p class="caption">
Figure 6.10: Plot with point overlain.
</p>
</div>
<div id="plotting-mathematical-text" class="section level3" number="6.6.1">
<h3>
<span class="header-section-number">6.6.1</span> Plotting Mathematical Text<a class="anchor" aria-label="anchor" href="#plotting-mathematical-text"><i class="fas fa-link"></i></a>
</h3>
<p><strong>R</strong> has useful functions for the plotting of mathematical expressions. These include the Greek letters, mathematical operators, italicization, and sub- and super-scripts. mathematical text is generally called as an expression in the text argument in the functions <code><a href="https://rdrr.io/r/graphics/text.html">text()</a></code> or <code><a href="https://rdrr.io/r/graphics/mtext.html">mtext()</a></code>. For example, the formula for the sample variance is overlain in Fig <a href="ch6.html#fig:text4a">6.11</a>.</p>
<div class="sourceCode" id="cb711"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">1</span>, type <span class="op">=</span> <span class="st">"n"</span>, axes <span class="op">=</span> <span class="cn">F</span>, xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="va">varexp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu">over</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"("</span>,<span class="fu">italic</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">-</span> <span class="fu">bar</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>,<span class="st">")"</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                              <span class="fu">italic</span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">==</span><span class="fl">1</span>, <span class="fu">italic</span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span>,<span class="op">(</span><span class="fu">italic</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">0</span>, <span class="va">varexp</span>, cex <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:text4a"></span>
<img src="figure/minimal-text4a-1.png" alt="Empty plot with formula for the sample variance overlain.  Type `?plotmath` for more information." width="384"><p class="caption">
Figure 6.11: Empty plot with formula for the sample variance overlain. Type <code><a href="https://rdrr.io/r/grDevices/plotmath.html">?plotmath</a></code> for more information.
</p>
</div>
<p></p>
</div>
<div id="mtext" class="section level3" number="6.6.2">
<h3>
<span class="header-section-number">6.6.2</span> <code>mtext()</code><a class="anchor" aria-label="anchor" href="#mtext"><i class="fas fa-link"></i></a>
</h3>
<p>To place text in the margin of a plot we can use the function <code><a href="https://rdrr.io/r/graphics/mtext.html">mtext()</a></code>. As its first argument the <code><a href="https://rdrr.io/r/graphics/mtext.html">mtext()</a></code> function requires a character string to be written into the plot. The 2nd argument, <code>side</code> defines the plot margin to be written on: <code>1</code> = bottom, <code>2</code> =left, <code>3</code> = top, <code>4</code> = right.
For instance, to place the text <code>"Axis 2"</code> on the right hand axis of an existing plot, I would type:</p>
<div class="sourceCode" id="cb712"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span><span class="op">(</span><span class="st">"Axis 2"</span>, <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div id="geometric-shapes" class="section level2" number="6.7">
<h2>
<span class="header-section-number">6.7</span> Geometric Shapes<a class="anchor" aria-label="anchor" href="#geometric-shapes"><i class="fas fa-link"></i></a>
</h2>
<p>Geometric shapes can be drawn using a number of functions including <code><a href="https://rdrr.io/r/graphics/rect.html">rect()</a></code> (which draws rectangles) and <code><a href="https://rdrr.io/r/graphics/polygon.html">polygon()</a></code> (which draws other polygons) based on user-supplied vertices. For instance, to place a purple rectangle with vertices at <span class="math inline">\((1,1)\)</span>, <span class="math inline">\((1,2)\)</span>, <span class="math inline">\((2,2)\)</span>, and <span class="math inline">\((2,1)\)</span>, in an existing plot, I would type:</p>
<div class="sourceCode" id="cb713"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/rect.html">rect</a></span><span class="op">(</span>xleft <span class="op">=</span> <span class="fl">0</span>, ybottom <span class="op">=</span> <span class="fl">1</span>, xright <span class="op">=</span> <span class="fl">2</span>, ytop <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span></code></pre></div>
<p>See Fig <a href="ch6.html#fig:text5">6.12</a>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:text5"></span>
<img src="figure/minimal-text5-1.png" alt="Plot with rectangle overlain." width="480"><p class="caption">
Figure 6.12: Plot with rectangle overlain.
</p>
</div>
<p>
</p>
</div>
<div id="axis" class="section level2" number="6.8">
<h2>
<span class="header-section-number">6.8</span> <code>axis()</code><a class="anchor" aria-label="anchor" href="#axis"><i class="fas fa-link"></i></a>
</h2>
<p>The function <code><a href="https://rdrr.io/r/graphics/axis.html">axis()</a></code> can be used to create new axes on a plot or to customize axis characteristics. Its first argument (<code>side</code>) specifies the side of the plot that the new axis will occupy <code>1</code> = bottom, <code>2</code> =left, <code>3</code> = top, <code>4</code> = right.</p>
<p>For instance, to create a right hand axis I would type:</p>
<div class="sourceCode" id="cb714"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<p>Other important <code><a href="https://rdrr.io/r/graphics/axis.html">axis()</a></code> arguments include a vector of axis labels (argument <code>labels</code>), and the locations of labels (argument <code>at</code>).
</p>
<div class="example">
<p><span id="exm:exm-axis1" class="example"><strong>Example 6.4  </strong></span><span class="math inline">\(\text{}\)</span><br>
Here I create customized axes with rotated, <span class="math inline">\(x\)</span>-axis labels, using <code><a href="https://rdrr.io/r/graphics/axis.html">axis()</a></code> and <code><a href="https://rdrr.io/r/graphics/text.html">text()</a></code> (Fig <a href="ch6.html#fig:figaxis">6.13</a>).</p>
<style type="text/css">
pre.numberSource code > span > a:first-child::before {
  left: -.05em;
}
</style>
<div class="sourceCode" id="cb715"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb715-1"><a href="ch6.html#cb715-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">type =</span> <span class="st">"n"</span>, <span class="at">axes =</span> F, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">""</span>)</span>
<span id="cb715-2"><a href="ch6.html#cb715-2"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">2</span>, <span class="at">at =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb715-3"><a href="ch6.html#cb715-3"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">at =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">labels =</span> <span class="cn">FALSE</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb715-4"><a href="ch6.html#cb715-4"></a><span class="fu">text</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="fu">rep</span>(.<span class="dv">65</span>, <span class="dv">3</span>), <span class="fu">c</span>(<span class="st">"Label 1"</span>, <span class="st">"Label 2"</span>, <span class="st">"Label 3"</span>), </span>
<span id="cb715-5"><a href="ch6.html#cb715-5"></a>     <span class="at">srt =</span> <span class="dv">50</span>, <span class="at">xpd =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:figaxis"></span>
<img src="figure/minimal-figaxis-1.png" alt="Modifying axes with `axis()`." width="576"><p class="caption">
Figure 6.13: Modifying axes with <code><a href="https://rdrr.io/r/graphics/axis.html">axis()</a></code>.
</p>
</div>
<p>The argument <code>srt = 50</code> (Line 5) rotates the text 50 degrees (<code>srt</code> cannot be specified in <code><a href="https://rdrr.io/r/graphics/mtext.html">mtext()</a></code> or <code><a href="https://rdrr.io/r/graphics/axis.html">axis()</a></code>, hence the use of <code><a href="https://rdrr.io/r/graphics/text.html">text()</a></code> here). The specification <code>xpd = TRUE</code> in <code><a href="https://rdrr.io/r/graphics/text.html">text()</a></code> (Line 5) allows text printing to extend to the plot axis margins.</p>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
</div>
<div id="font-typefaces" class="section level2" number="6.9">
<h2>
<span class="header-section-number">6.9</span> Font Typefaces<a class="anchor" aria-label="anchor" href="#font-typefaces"><i class="fas fa-link"></i></a>
</h2>
<p>Font <em>typefaces</em> can be changed using a number of graphical functions, including <code><a href="https://rdrr.io/r/graphics/par.html">par()</a></code>, via the argument <code>family</code>. The general typeface families: <code>"serif"</code>, <code>"mono"</code>, and <code>"sans"</code>, and the <a href="http://en.wikipedia.org/wiki/Hershey_font">Hershey</a> family of fonts (type <code><a href="https://rdrr.io/r/grDevices/Hershey.html">?Hershey</a></code> for more information) are transferable across all graphics devices employed in <code>R</code>. To change the font in a graphical device from the default sans serif (similar to Arial) to serif (similar to Times New Roman) one
could type:</p>
<div class="sourceCode" id="cb716"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"serif"</span><span class="op">)</span></span></code></pre></div>
<p>To use a Courier-type monospace font one would use.</p>
<div class="sourceCode" id="cb717"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"mono"</span><span class="op">)</span></span></code></pre></div>
<p>Many other typeface families are possible, although they may not be transportable to all graphical devices and graphical storage formats.</p>
<div class="example">
<p><span id="exm:exm-ff1" class="example"><strong>Example 6.5  </strong></span><span class="math inline">\(\text{}\)</span><br>
In the code below I bring in a large number of conventional font families using a function from the Foundational and Applied Statistics for R <a href="http://http//www2.cose.isu.edu/~ahoken/book/">website</a>. These typefaces (and many others) will typically be available on Windows platform machines, although not all will be supported by non-Windows graphics devices. The result can be seen in Figure <a href="ch6.html#fig:typef">6.14</a> which displays text from ninety-nine Windows typefaces.</p>
<style type="text/css">
pre.numberSource code > span > a:first-child::before {
  left: -.05em;
}
</style>
<div class="sourceCode" id="cb718"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb718-1"><a href="ch6.html#cb718-1"></a><span class="fu">source</span>(<span class="fu">url</span>(<span class="st">"http://www2.cose.isu.edu/~ahoken/book/win_fonts.R"</span>))</span>
<span id="cb718-2"><a href="ch6.html#cb718-2"></a><span class="fu">png</span>(<span class="st">"fonts.png"</span>, <span class="at">res =</span> <span class="dv">72</span> <span class="sc">*</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">480</span> <span class="sc">*</span> <span class="dv">6</span>, <span class="at">width =</span> <span class="dv">480</span> <span class="sc">*</span> <span class="dv">6</span>)</span>
<span id="cb718-3"><a href="ch6.html#cb718-3"></a>  x <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="fl">2.8</span>, <span class="fl">6.4</span>, <span class="fl">9.6</span>), <span class="at">each =</span> <span class="dv">33</span>)</span>
<span id="cb718-4"><a href="ch6.html#cb718-4"></a>  y <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="dv">10</span>, <span class="fl">0.25</span>, <span class="at">by =</span> <span class="sc">-</span>.<span class="dv">2965</span>), <span class="dv">3</span>)</span>
<span id="cb718-5"><a href="ch6.html#cb718-5"></a>  font.type <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">rep</span>(<span class="st">"f"</span>, <span class="fu">length</span>(fonts)), <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(fonts), <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb718-6"><a href="ch6.html#cb718-6"></a>  <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>), <span class="at">cex =</span> <span class="fl">1.05</span>)</span>
<span id="cb718-7"><a href="ch6.html#cb718-7"></a>  <span class="fu">plot</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">type =</span> <span class="st">"n"</span>, <span class="at">xaxt=</span> <span class="st">"n"</span>, <span class="at">yaxt =</span> <span class="st">"n"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">""</span>, </span>
<span id="cb718-8"><a href="ch6.html#cb718-8"></a>       <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb718-9"><a href="ch6.html#cb718-9"></a></span>
<span id="cb718-10"><a href="ch6.html#cb718-10"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(fonts)){</span>
<span id="cb718-11"><a href="ch6.html#cb718-11"></a>    <span class="fu">text</span>(x[i],y[i], <span class="at">labels=</span>fonts[i] , <span class="at">family =</span> font.type[i])</span>
<span id="cb718-12"><a href="ch6.html#cb718-12"></a>  }</span>
<span id="cb718-13"><a href="ch6.html#cb718-13"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:typef"></span>
<img src="fonts.png" alt="Examples of font families that can be used in **R** graphics." width="80%"><p class="caption">
Figure 6.14: Examples of font families that can be used in <strong>R</strong> graphics.
</p>
</div>
<p>Note that on line 2 in the code above, I use the function <code><a href="https://rdrr.io/r/grDevices/png.html">png()</a></code> to generate a high resolution .png graphical file. Thus, running the entirety of the preceding code chunk will create the image file <code>fonts.tiff</code> in your working directory. To save myself from typing an inordinate amount of code, I use a for loop (see Ch <a href="ch8.html#ch8">8</a>) to place the fonts one at a time in the graphics device (lines 9-11). Output from closing the graphical device is shown on line 14-15.</p>
<p>Importantly, the typefaces imported from the first line of code in the chunk above will now be available for graphics functions using the Windows graphical device. To see the first six available Windows fonts one can type:</p>
<div class="sourceCode" id="cb719"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/windowsFonts.html">windowsFonts</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>$serif
[1] "TT Times New Roman"

$sans
[1] "TT Arial"

$mono
[1] "TT Courier New"

$f1
[1] "Agency FB"

$f2
[1] "Albany AMT"

$f3
[1] "ALGERIAN"</code></pre>
<p>Similarly, one can see the available fonts for PostScript and PDF graphics devices using:</p>
<div class="sourceCode" id="cb721"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/postscriptFonts.html">pdfFonts</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] "serif"      "sans"       "mono"       "AvantGarde" "Bookman"   
[6] "Courier"   </code></pre>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
<p>
</p>
</div>
<div id="colors" class="section level2" number="6.10">
<h2>
<span class="header-section-number">6.10</span> Colors<a class="anchor" aria-label="anchor" href="#colors"><i class="fas fa-link"></i></a>
</h2>
<p>An enormous number of color choices for <strong>R</strong> graphics are possible and these can be specified in at least six different ways.</p>
<ul>
<li>First, we can specify colors with integers as I did in Figure <a href="ch6.html#fig:sp1">6.4</a>. Additional varieties can be obtained by drawing color elements from the function <code><a href="https://rdrr.io/r/grDevices/colors.html">colors()</a></code> using <code>colors()[number]</code> (Fig <a href="ch6.html#fig:col1">6.15</a>).
</li>
</ul>
<div class="sourceCode" id="cb723"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">32</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">e</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">e</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, bg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colors.html">colors</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">640</span><span class="op">]</span>, pch <span class="op">=</span> <span class="fl">22</span>, cex <span class="op">=</span> <span class="fl">2.5</span>, xaxt <span class="op">=</span> <span class="st">"n"</span>, </span>
<span>     yaxt <span class="op">=</span> <span class="st">"n"</span>, xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="va">e</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">e</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">640</span>, cex <span class="op">=</span> <span class="fl">.4</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:col1"></span>
<img src="figure/minimal-col1-1.png" alt="Color choices from `colors()`" width="672"><p class="caption">
Figure 6.15: Color choices from <code><a href="https://rdrr.io/r/grDevices/colors.html">colors()</a></code>
</p>
</div>
<p>The function <code><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid()</a></code> creates a dataframe from all combinations of user-supplied supplied vectors. Note that these combinations are used as coordinates in <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code>.
</p>
<ul>
<li><p>Second, we can specify colors using actual color names, e.g., <code>"white"</code>, <code>"red"</code>, <code>"yellow"</code>. For a visual display of essentially all the available named colors in <strong>R</strong> type: <code>example(colors)</code>.</p></li>
<li><p>Third, we can define colors by requesting red green and blue (RGB) color intensities, along with transparency, using the function <code><a href="https://rdrr.io/r/grDevices/rgb.html">rgb()</a></code> (Fig <a href="ch6.html#fig:rgb">6.16</a>). Usable light intensities can be made to vary individually from 0 to 255 (i.e., within an 8 bit format). Thus, there are <span class="math inline">\(255^4 = 4,228,250,625\)</span> possible <code><a href="https://rdrr.io/r/grDevices/rgb.html">rgb()</a></code> color combinations. By default, <code>red</code> <code>green</code>, <code>blue</code>, and <code>alpha</code> (transparency) arguments in <code><a href="https://rdrr.io/r/grDevices/rgb.html">rgb()</a></code> are defined to be in (0, 1).
</p></li>
</ul>
<div class="sourceCode" id="cb724"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb724-1"><a href="ch6.html#cb724-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">cex =</span> <span class="dv">15</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">""</span>,</span>
<span id="cb724-2"><a href="ch6.html#cb724-2"></a>     <span class="at">col =</span> <span class="fu">rgb</span>(<span class="at">red =</span> <span class="fu">rep</span>(<span class="fl">0.2</span>,<span class="dv">10</span>), <span class="at">green =</span> <span class="fu">rep</span>(<span class="fl">0.5</span>,<span class="dv">10</span>),</span>
<span id="cb724-3"><a href="ch6.html#cb724-3"></a>               <span class="at">blue =</span> <span class="fu">rep</span>(<span class="fl">0.8</span>,<span class="dv">10</span>),</span>
<span id="cb724-4"><a href="ch6.html#cb724-4"></a>               <span class="at">alpha =</span> <span class="fu">seq</span>(<span class="fl">0.05</span>,<span class="dv">1</span>, <span class="at">length =</span> <span class="dv">10</span>)), <span class="at">axes =</span> F)</span>
<span id="cb724-5"><a href="ch6.html#cb724-5"></a><span class="fu">box</span>()</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:rgb"></span>
<img src="figure/minimal-rgb-1.png" alt="Demonstration of `rgb()`, emphasizing changes in transparency.  " width="384"><p class="caption">
Figure 6.16: Demonstration of <code><a href="https://rdrr.io/r/grDevices/rgb.html">rgb()</a></code>, emphasizing changes in transparency.
</p>
</div>
<p>Note the use of <code><a href="https://rdrr.io/r/graphics/box.html">box()</a></code> on line 5, which places a box around the plot.</p>
<p></p>
<ul>
<li><p>Fourth, similar to <code><a href="https://rdrr.io/r/grDevices/rgb.html">rgb()</a></code>, we can specify colors using the function <code><a href="https://rdrr.io/r/grDevices/hcl.html">hcl()</a></code> which controls hues, chroma, and luminescence and transparency (see Fig <a href="ch6.html#fig:col2">6.17</a>).</p></li>
<li><p>Fifth, we can define colors using <em>hexadecimal codes</em><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;A data coding system that uses 16 symbols: the numbers 1-9, and the letters A-F. Hexadecimals are primarily used to provide a more intuitive representation of binary-coded values (see Ch &lt;a href="ch12.html#ch12"&gt;12&lt;/a&gt;).&lt;/p&gt;'><sup>60</sup></a>, e.g., blue = <code>"#0000FF"</code>.
</p></li>
<li><p>Sixth, we can specify colors using <em>palettes</em>. Figure <a href="ch6.html#fig:col2">6.17</a> shows six pie plots. Each pie plot uses a different pre-defined color palette. Each pie slice from each pie represents a distinct segment of a distinct palette.
</p></li>
</ul>
<div class="sourceCode" id="cb725"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb725-1"><a href="ch6.html#cb725-1"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">6</span>),<span class="dv">3</span>,<span class="dv">2</span>))</span>
<span id="cb725-2"><a href="ch6.html#cb725-2"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb725-3"><a href="ch6.html#cb725-3"></a><span class="fu">pie</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">12</span>), <span class="at">col =</span> <span class="fu">rainbow</span>(<span class="dv">12</span>), <span class="at">main =</span> <span class="st">"Rainbow colors"</span>)</span>
<span id="cb725-4"><a href="ch6.html#cb725-4"></a><span class="fu">pie</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">12</span>), <span class="at">col =</span> <span class="fu">heat.colors</span>(<span class="dv">12</span>), <span class="at">main =</span> <span class="st">"Heat colors"</span>)</span>
<span id="cb725-5"><a href="ch6.html#cb725-5"></a><span class="fu">pie</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">12</span>), <span class="at">col =</span> <span class="fu">topo.colors</span>(<span class="dv">12</span>), <span class="at">main =</span> <span class="st">"Topographic colors"</span>)</span>
<span id="cb725-6"><a href="ch6.html#cb725-6"></a><span class="fu">pie</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">12</span>), <span class="at">col =</span> <span class="fu">gray</span>(<span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>)), <span class="at">main =</span> <span class="st">"Gray colors"</span>)</span>
<span id="cb725-7"><a href="ch6.html#cb725-7"></a><span class="fu">pie</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">12</span>), <span class="at">col =</span> <span class="fu">hcl</span>(<span class="at">h=</span><span class="fu">seq</span>(<span class="dv">180</span>,<span class="dv">0</span>, <span class="at">length=</span><span class="dv">12</span>)), </span>
<span id="cb725-8"><a href="ch6.html#cb725-8"></a>    <span class="at">main =</span> <span class="st">"Cols from hcl hue"</span>)</span>
<span id="cb725-9"><a href="ch6.html#cb725-9"></a><span class="fu">pie</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">12</span>), <span class="at">col =</span> <span class="fu">hcl</span>(<span class="at">h=</span><span class="fu">seq</span>(<span class="dv">360</span>,<span class="dv">180</span>,<span class="at">length=</span><span class="dv">12</span>)), </span>
<span id="cb725-10"><a href="ch6.html#cb725-10"></a>    <span class="at">main =</span> <span class="st">"Cols from chroma"</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:col2"></span>
<img src="figure/minimal-col2-1.png" alt="Examples of color palettes in **R**. Numbers do not correspond to actual color type designations." width="672"><p class="caption">
Figure 6.17: Examples of color palettes in <strong>R</strong>. Numbers do not correspond to actual color type designations.
</p>
</div>
<p>Note that the functions <code><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow()</a></code>, <code><a href="https://rdrr.io/r/grDevices/palettes.html">heat.colors()</a></code>, <code><a href="https://rdrr.io/r/grDevices/palettes.html">topo.colors()</a></code> (Lines 3-6) only require an integer specification requesting the number of colors within a particular palette. For instance</p>
<div class="sourceCode" id="cb726"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] "#FF0000" "#CCFF00" "#00FF66" "#0066FF" "#CC00FF"</code></pre>
<p>Note that the colors in <code><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow()</a></code> are given in a hexidecimal format.</p>
<p>The function <code><a href="https://rdrr.io/r/grDevices/palette.html">palette()</a></code> can be used to check and define a number of useful palettes. Colors in the <em>current</em> palette can be obtained by typing:</p>
<div class="sourceCode" id="cb728"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/palette.html">palette</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] "black"   "#DF536B" "#61D04F" "#2297E6" "#28E2E5" "#CD0BBC" "#F5C710"
[8] "gray62" </code></pre>
<p>A list of predefined palettes in <code><a href="https://rdrr.io/r/grDevices/palette.html">palette()</a></code> can be obtained by typing:</p>
<div class="sourceCode" id="cb730"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/palette.html">palette.pals</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code> [1] "R3"              "R4"              "ggplot2"        
 [4] "Okabe-Ito"       "Accent"          "Dark 2"         
 [7] "Paired"          "Pastel 1"        "Pastel 2"       
[10] "Set 1"           "Set 2"           "Set 3"          
[13] "Tableau 10"      "Classic Tableau" "Polychrome 36"  
[16] "Alphabet"       </code></pre>
<p>To define the current palette to be the one used by the <em>ggplot2</em> package (Ch <a href="ch7.html#ch7">7</a>), I could type: <code>palette("ggplot2")</code>.</p>
<p>
A large number of useful pre-defined palettes (including color-blind-safe palettes) can be obtained using the package <em>RColorBrewer</em> (Fig <a href="ch6.html#fig:col3">6.18</a>).</p>
<div class="sourceCode" id="cb732"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">RColorBrewer</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">display.brewer.all</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">7</span>, colorblindFriendly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:col3"></span>
<img src="figure/minimal-col3-1.png" alt="*RColorBrewer* color-blind-safe, seven category palettes. Top palettes are so-called 'sequential' palettes, middle palettes are 'qualitative', and bottom palettes are 'divergent'." width="576"><p class="caption">
Figure 6.18: <em>RColorBrewer</em> color-blind-safe, seven category palettes. Top palettes are so-called ‘sequential’ palettes, middle palettes are ‘qualitative’, and bottom palettes are ‘divergent’.
</p>
</div>
<p>Here are the hexadecimal names for the “Set2” palette chunks in Figure <a href="ch6.html#fig:col3">6.18</a>.</p>
<div class="sourceCode" id="cb733"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op">(</span><span class="fl">7</span>, <span class="st">"Set2"</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] "#66C2A5" "#FC8D62" "#8DA0CB" "#E78AC3" "#A6D854" "#FFD92F" "#E5C494"</code></pre>
<p>Customized palettes can be generated using the <code><a href="https://rdrr.io/r/grDevices/colorRamp.html">colorRamp()</a></code> function which returns functions that “interpolate a set of given colors to create new color palettes.” Important <code>colorRampPaltette()</code> arguments include:
two required arguments.</p>
<ul>
<li>
<code>colors</code> defines colors to interpolate.</li>
<li>
<code>bias</code> a positive number that controls distinctions among interpolated colors. Larger values indicated greater differences.</li>
<li>
<code>space</code> one of <code>"RGB"</code> or <code>"Lab"</code>, indicating whether RGB or CIELAB<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;The CIELAB color space is defined by three values: &lt;code&gt;L*&lt;/code&gt; for perceptual lightness and &lt;code&gt;a*&lt;/code&gt; and &lt;code&gt;b*&lt;/code&gt; for the four unique colors of human vision: red, green, blue and yellow. &lt;span class="citation"&gt;(&lt;a href="references.html#ref-cie"&gt;Schanda 2007&lt;/a&gt;)&lt;/span&gt;. The CIELAB space is intended to be &lt;em&gt;perceptually uniform&lt;/em&gt;. CIELAB and several other colors spaces are included in the encompassing CIECAM02 color space &lt;span class="citation"&gt;(&lt;a href="references.html#ref-wikicielab"&gt;Wikipedia 2024b&lt;/a&gt;)&lt;/span&gt;.&lt;/p&gt;'><sup>61</sup></a> color spaces are to be used in interpolations.</li>
</ul>
<p>Here I generate and plot a 15 color palette interpolated from the colors red and blue (Fig <a href="ch6.html#fig:crp">6.19</a>).</p>
<div class="sourceCode" id="cb735"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb735-1"><a href="ch6.html#cb735-1"></a>crp <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="at">colors =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>))(<span class="dv">15</span>)</span>
<span id="cb735-2"><a href="ch6.html#cb735-2"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="dv">5</span>, <span class="at">col =</span> crp, <span class="at">axes =</span> F, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">""</span>)</span>
<span id="cb735-3"><a href="ch6.html#cb735-3"></a><span class="fu">box</span>()</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:crp"></span>
<img src="figure/minimal-crp-1.png" alt="Color palette generated by the function `colorRampPalette()`." width="480"><p class="caption">
Figure 6.19: Color palette generated by the function <code><a href="https://rdrr.io/r/grDevices/colorRamp.html">colorRampPalette()</a></code>.
</p>
</div>
<p>The function <code><a href="https://rdrr.io/r/graphics/box.html">box()</a></code> (Line 3) places a box around the figure whose axes and axis labels I have intentionally omitted.
There are a number of packages for the generation of customized palettes. My current favorite is <em>colorspace</em> and its interactive function <code>hclwizard()</code>, which generates the <em>shiny</em> GUI (Ch <a href="ch11.html#ch11">11</a>) shown in Fig <a href="ch6.html#fig:colspace">6.20</a>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:colspace"></span>
<img src="figs6/colGUI.png" alt="A GUI for constructed customized palettes generating by the function `colorspace::hclwizard()`." width="75%"><p class="caption">
Figure 6.20: A GUI for constructed customized palettes generating by the function <code><a href="https://colorspace.R-Forge.R-project.org/reference/choose_palette.html">colorspace::hclwizard()</a></code>.
</p>
</div>
</div>
<div id="scatterplots" class="section level2" number="6.11">
<h2>
<span class="header-section-number">6.11</span> Scatterplots<a class="anchor" aria-label="anchor" href="#scatterplots"><i class="fas fa-link"></i></a>
</h2>
<p>
<em>Scatterplots</em> project points at the intersection of paired observations describing two quantitative variables. Thus, scatterplots are often presented in conjunction with simple regression analyses <span class="citation">(<a href="references.html#ref-aho2014">Aho 2014</a>)</span>.</p>
<div class="example">
<p><span id="exm:exm-sp1" class="example"><strong>Example 6.6  </strong></span><span class="math inline">\(\text{}\)</span><br>
As an example of scatterplot usage we will use the <code>Loblolly</code> dataset in the package <em>datasets</em>. Figure <a href="ch6.html#fig:scat1">6.21</a> allows visualization of the relationship of loblolly pine tree age and tree height.</p>
<div class="sourceCode" id="cb736"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">Loblolly</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">height</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:scat1"></span>
<img src="figure/minimal-scat1-1.png" alt="Scatterplot of `height` and `age` from the `Loblolly` pine tree dataset." width="576"><p class="caption">
Figure 6.21: Scatterplot of <code>height</code> and <code>age</code> from the <code>Loblolly</code> pine tree dataset.
</p>
</div>
<p>Now let’s fit a simple linear regression for loblolly pine height as a function of age. A regression line will show the best possible linear fit for a response variable as a function of an quantitative explanatory variable <span class="citation">(<a href="references.html#ref-aho2014">Aho 2014</a>)</span>. The <strong>R</strong> function for a linear model is <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>. It encompasses and allows a huge number of statistical procedures, including regression (see Chs. 9-11 in <span class="citation">(<a href="references.html#ref-aho2014">Aho 2014</a>)</span>). We have:</p>
<div class="sourceCode" id="cb737"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ha.lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">height</span> <span class="op">~</span> <span class="va">age</span>, data <span class="op">=</span> <span class="va">Loblolly</span><span class="op">)</span></span></code></pre></div>
<p>Note that in the first argument of <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> we define <code>height</code> to be a function of <code>age</code> using the tilde operator. Objects of class <code>lm</code> have their own<code>summary</code> function. This can be called by simply typing:</p>
<div class="sourceCode" id="cb738"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">ha.lm</span><span class="op">)</span></span></code></pre></div>
<pre><code>
Call:
lm(formula = height ~ age, data = Loblolly)

Residuals:
   Min     1Q Median     3Q    Max 
-7.021 -2.167 -0.439  2.054  6.855 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -1.3124     0.6218   -2.11    0.038 *  
age           2.5905     0.0409   63.27   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.95 on 82 degrees of freedom
Multiple R-squared:  0.98,  Adjusted R-squared:  0.98 
F-statistic: 4e+03 on 1 and 82 DF,  p-value: &lt;2e-16</code></pre>
<p>The output shows us the <em>Y</em>-intercept, -1.31240, and slope, 2.59052, of the fitted regression line, and results from null hypothesis tests, along with a lot of other information.</p>
<p>The <code><a href="https://rdrr.io/r/graphics/abline.html">abline()</a></code> function allows the plotting of a line over an existing plot. The first two arguments for <code><a href="https://rdrr.io/r/graphics/abline.html">abline()</a></code> are the <em>Y</em>-intercept and slope (Fig <a href="ch6.html#fig:scat2">6.22</a>).</p>
<div class="sourceCode" id="cb740"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">Loblolly</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">age</span>,<span class="va">height</span>, pch<span class="op">=</span><span class="fl">2</span>, col<span class="op">=</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.312396</span>, <span class="fl">2.590523</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:scat2"></span>
<img src="figure/minimal-scat2-1.png" alt="Scatterplot with fit overlain." width="576"><p class="caption">
Figure 6.22: Scatterplot with fit overlain.
</p>
</div>
<p>Note that we could have gotten the same result using <code>abline(ha.lm)</code>.</p>
<p>Finally, we can overlay a 95% confidence interval for the true regression fitted value (see <span class="citation">Aho (<a href="references.html#ref-aho2014">2014</a>)</span>, Ch 9) using the function <code><a href="https://rdrr.io/r/stats/predict.lm.html">predict.lm()</a></code> (Fig <a href="ch6.html#fig:scat3">6.23</a>)</p>
<div class="sourceCode" id="cb741"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb741-1"><a href="ch6.html#cb741-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">predict</span>(ha.lm, <span class="at">interval =</span> <span class="st">"confidence"</span>)</span>
<span id="cb741-2"><a href="ch6.html#cb741-2"></a></span>
<span id="cb741-3"><a href="ch6.html#cb741-3"></a>o <span class="ot">&lt;-</span> <span class="fu">order</span>(Loblolly<span class="sc">$</span>age)</span>
<span id="cb741-4"><a href="ch6.html#cb741-4"></a>ageo <span class="ot">&lt;-</span> Loblolly<span class="sc">$</span>age[o]</span>
<span id="cb741-5"><a href="ch6.html#cb741-5"></a>cio <span class="ot">&lt;-</span> ci[o,]</span>
<span id="cb741-6"><a href="ch6.html#cb741-6"></a></span>
<span id="cb741-7"><a href="ch6.html#cb741-7"></a><span class="fu">with</span>(Loblolly, <span class="fu">plot</span>(age, height, <span class="at">pch=</span><span class="dv">19</span>, <span class="at">col=</span><span class="dv">1</span>))</span>
<span id="cb741-8"><a href="ch6.html#cb741-8"></a><span class="fu">abline</span>(<span class="sc">-</span><span class="fl">1.312396</span>, <span class="fl">2.590523</span>)</span>
<span id="cb741-9"><a href="ch6.html#cb741-9"></a><span class="fu">points</span>(ageo, cio[,<span class="dv">2</span>], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"gray"</span>) <span class="co"># lower CI bound</span></span>
<span id="cb741-10"><a href="ch6.html#cb741-10"></a><span class="fu">points</span>(ageo, cio[,<span class="dv">3</span>], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"gray"</span>) <span class="co"># upper CI bound</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:scat3"></span>
<img src="figure/minimal-scat3-1.png" alt="Scatterplot with confidence interval for the true mean of $y$ given $x$, overlain." width="576"><p class="caption">
Figure 6.23: Scatterplot with confidence interval for the true mean of <span class="math inline">\(y\)</span> given <span class="math inline">\(x\)</span>, overlain.
</p>
</div>
<p>The object <code>ci</code>, created on Line 1, is a dataframe containing fits, and corresponding lower and upper confidence interval bounds. The ordering of <span class="math inline">\(x\)</span>-axis values is established on Line 3 to allow creation of lines that look like functions of <span class="math inline">\(x\)</span>. This ordering is applied to Cartesian coordinates on Lines 4-5.</p>
</div>
<p><span class="math inline">\(\blacksquare\)</span>
</p>
</div>
<div id="transformations" class="section level2" number="6.12">
<h2>
<span class="header-section-number">6.12</span> Transformations<a class="anchor" aria-label="anchor" href="#transformations"><i class="fas fa-link"></i></a>
</h2>
<p>
Importantly, <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> allows straightforward application of log transformations to axes. For instance, to apply a <span class="math inline">\(\log_e\)</span> transformation to the <span class="math inline">\(x\)</span>-axis or <span class="math inline">\(y\)</span>-axis I could use <code>log = "x"</code> or <code>log = "y"</code>, respectively (Fig <a href="ch6.html#fig:logt">6.24</a>).</p>
<div class="sourceCode" id="cb742"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">Loblolly</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">height</span>, log <span class="op">=</span> <span class="st">"y"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:logt"></span>
<img src="figure/minimal-logt-1.png" alt="Graphical $\log_e$ transformation of the `height` axis from a scatterplot of the `Loblolly` pine tree dataset." width="576"><p class="caption">
Figure 6.24: Graphical <span class="math inline">\(\log_e\)</span> transformation of the <code>height</code> axis from a scatterplot of the <code>Loblolly</code> pine tree dataset.
</p>
</div>
</div>
<div id="multiple-plots" class="section level2" number="6.13">
<h2>
<span class="header-section-number">6.13</span> Multiple Plots<a class="anchor" aria-label="anchor" href="#multiple-plots"><i class="fas fa-link"></i></a>
</h2>
<p>As shown earlier, multiple graphs can be placed in a graphics device using the <code>mfrow</code> or <code>mfcol</code> argument in <code><a href="https://rdrr.io/r/graphics/par.html">par()</a></code>. In this section I will try to incorporate a number of the functions discussed so far, including <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code>, <code><a href="https://rdrr.io/r/graphics/par.html">par()</a></code>, mathematical formulae with <code><a href="https://rdrr.io/r/graphics/text.html">text()</a></code>, <code><a href="https://rdrr.io/r/graphics/points.html">points()</a></code>, shapes rending with <code><a href="https://rdrr.io/r/graphics/rect.html">rect()</a></code>, <code><a href="https://rdrr.io/r/grDevices/colors.html">colors()</a></code> <code><a href="https://rdrr.io/r/graphics/axis.html">axis()</a></code>, and <code><a href="https://rdrr.io/r/graphics/mtext.html">mtext()</a></code>.</p>
<div class="example">
<p><span id="exm:exm-multi" class="example"><strong>Example 6.7  </strong></span><span class="math inline">\(\text{}\)</span><br>
The dataframe <code>C.isotope</code> in package <em>asbio</em> describes variations in <span class="math inline">\(\delta ^{14}\)</span>C over time in La Jolla California. The term <span class="math inline">\(\delta ^{14}C\)</span> describes the ratio of carbon 14 to carbon 12 (<span class="math inline">\(^{14}\)</span>C is unstable, while <span class="math inline">\(^{12}\)</span>C is a stable isotope of carbon) compared to a standard ratio. We will create a figure with four subplots, with the following characteristics:</p>
<ul>
<li>It will have dimensions 8” x 7”.</li>
<li>The outer margins (in number of lines) will be bottom = 0.1, left = 0.1, top = 0, right = 0.</li>
<li>The inner margins (for each plot) will be bottom = 4, left = 4.4, top = 2, right = 2. The plot margins will be light gray. We can specify gray gradations with the function.</li>
<li>The first plot will show <span class="math inline">\(\delta ^{14}\)</span>C as a function of date. The plotting area will be dark gray, i.e., <code>colors()[181]</code>. Points will be white circles with a black border.</li>
<li>The second plot will be a line plot of atmospheric carbon as a function of date. It will have a light green plotting area: <code>colors()[363]</code>.</li>
<li>The third plot will be a scatterplot of <span class="math inline">\(\delta ^{14}\)</span>C as a function of atmospheric C. Points will be yellow circles with a black border. The plotting area will be light red: <code>colors()[580]</code>.</li>
<li>The fourth plot will show the sample variance for atmospheric carbon in the time series. It will have a custom (albeit meaningless) axis, created with <code><a href="https://rdrr.io/r/graphics/axis.html">axis()</a></code>, with the labels: <code>a</code>, <code>b</code>, <code>c</code>, and <code>d</code>. It will also have a horizontal axis label inserted with <code><a href="https://rdrr.io/r/graphics/mtext.html">mtext()</a></code>.</li>
</ul>
<p>The result is shown in Fig <a href="ch6.html#fig:multi1">6.25</a>.</p>
<div class="sourceCode" id="cb743"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb743-1"><a href="ch6.html#cb743-1"></a><span class="fu">library</span>(asbio)</span>
<span id="cb743-2"><a href="ch6.html#cb743-2"></a><span class="fu">data</span>(C.isotope)</span>
<span id="cb743-3"><a href="ch6.html#cb743-3"></a><span class="fu">dev.new</span>(<span class="at">height =</span> <span class="dv">8</span>, <span class="at">width =</span> <span class="dv">7</span>)</span>
<span id="cb743-4"><a href="ch6.html#cb743-4"></a>op <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="at">oma =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="fl">4.4</span>, <span class="dv">2</span>, <span class="dv">2</span>),</span>
<span id="cb743-5"><a href="ch6.html#cb743-5"></a>          <span class="at">bg =</span> <span class="fu">gray</span>(.<span class="dv">97</span>))</span>
<span id="cb743-6"><a href="ch6.html#cb743-6"></a><span class="co">#-------------------------------- plot 1 -------------------------------#</span></span>
<span id="cb743-7"><a href="ch6.html#cb743-7"></a><span class="fu">with</span>(C.isotope, <span class="fu">plot</span>(Decimal.date, D14C, <span class="at">xlab =</span> <span class="st">"Date"</span>, <span class="at">ylab =</span> </span>
<span id="cb743-8"><a href="ch6.html#cb743-8"></a>                       <span class="fu">expression</span>(<span class="fu">paste</span>(delta<span class="sc">^</span><span class="dv">14</span>,<span class="st">"C (per mille)"</span>)), </span>
<span id="cb743-9"><a href="ch6.html#cb743-9"></a>                     <span class="at">type =</span> <span class="st">"n"</span>))</span>
<span id="cb743-10"><a href="ch6.html#cb743-10"></a></span>
<span id="cb743-11"><a href="ch6.html#cb743-11"></a><span class="fu">rect</span>(<span class="fu">par</span>(<span class="st">"usr"</span>)[<span class="dv">1</span>], <span class="fu">par</span>(<span class="st">"usr"</span>)[<span class="dv">3</span>], <span class="fu">par</span>(<span class="st">"usr"</span>)[<span class="dv">2</span>], <span class="fu">par</span>(<span class="st">"usr"</span>)[<span class="dv">4</span>],</span>
<span id="cb743-12"><a href="ch6.html#cb743-12"></a>     <span class="at">col =</span> <span class="fu">colors</span>()[<span class="dv">181</span>])</span>
<span id="cb743-13"><a href="ch6.html#cb743-13"></a></span>
<span id="cb743-14"><a href="ch6.html#cb743-14"></a><span class="fu">with</span>(C.isotope, <span class="fu">points</span>(Decimal.date, D14C, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">bg =</span> <span class="st">"white"</span>))</span>
<span id="cb743-15"><a href="ch6.html#cb743-15"></a></span>
<span id="cb743-16"><a href="ch6.html#cb743-16"></a><span class="co">#-------------------------------- plot 2 -------------------------------#</span></span>
<span id="cb743-17"><a href="ch6.html#cb743-17"></a><span class="fu">with</span>(C.isotope, <span class="fu">plot</span>(Decimal.date, CO2, <span class="at">xlab =</span> <span class="st">"Date"</span>, <span class="at">ylab =</span></span>
<span id="cb743-18"><a href="ch6.html#cb743-18"></a>                       <span class="fu">expression</span>(<span class="fu">paste</span>(CO[<span class="dv">2</span>],<span class="st">" (ppm)"</span>)), </span>
<span id="cb743-19"><a href="ch6.html#cb743-19"></a>                     <span class="at">type =</span> <span class="st">"n"</span>))</span>
<span id="cb743-20"><a href="ch6.html#cb743-20"></a></span>
<span id="cb743-21"><a href="ch6.html#cb743-21"></a><span class="fu">rect</span>(<span class="fu">par</span>(<span class="st">"usr"</span>)[<span class="dv">1</span>], <span class="fu">par</span>(<span class="st">"usr"</span>)[<span class="dv">3</span>], <span class="fu">par</span>(<span class="st">"usr"</span>)[<span class="dv">2</span>], <span class="fu">par</span>(<span class="st">"usr"</span>)[<span class="dv">4</span>],</span>
<span id="cb743-22"><a href="ch6.html#cb743-22"></a>     <span class="at">col =</span> <span class="fu">colors</span>()[<span class="dv">363</span>])</span>
<span id="cb743-23"><a href="ch6.html#cb743-23"></a></span>
<span id="cb743-24"><a href="ch6.html#cb743-24"></a><span class="fu">with</span>(C.isotope, <span class="fu">points</span>(Decimal.date, CO2, <span class="at">type =</span> <span class="st">"l"</span>))</span>
<span id="cb743-25"><a href="ch6.html#cb743-25"></a></span>
<span id="cb743-26"><a href="ch6.html#cb743-26"></a><span class="co">#-------------------------------- plot 3 -------------------------------#</span></span>
<span id="cb743-27"><a href="ch6.html#cb743-27"></a><span class="fu">with</span>(C.isotope, <span class="fu">plot</span>(CO2, D14C, <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(CO[<span class="dv">2</span>], <span class="st">" (ppm)"</span>)), </span>
<span id="cb743-28"><a href="ch6.html#cb743-28"></a>                     <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(delta<span class="sc">^</span><span class="dv">14</span>,<span class="st">"C (per mille)"</span>)), </span>
<span id="cb743-29"><a href="ch6.html#cb743-29"></a>                     <span class="at">type =</span> <span class="st">"n"</span>))</span>
<span id="cb743-30"><a href="ch6.html#cb743-30"></a></span>
<span id="cb743-31"><a href="ch6.html#cb743-31"></a><span class="fu">rect</span>(<span class="fu">par</span>(<span class="st">"usr"</span>)[<span class="dv">1</span>], <span class="fu">par</span>(<span class="st">"usr"</span>)[<span class="dv">3</span>], <span class="fu">par</span>(<span class="st">"usr"</span>)[<span class="dv">2</span>], <span class="fu">par</span>(<span class="st">"usr"</span>)[<span class="dv">4</span>],</span>
<span id="cb743-32"><a href="ch6.html#cb743-32"></a>     <span class="at">col =</span> <span class="fu">colors</span>()[<span class="dv">580</span>])</span>
<span id="cb743-33"><a href="ch6.html#cb743-33"></a></span>
<span id="cb743-34"><a href="ch6.html#cb743-34"></a><span class="fu">with</span>(C.isotope, <span class="fu">points</span>(CO2, D14C, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">bg =</span> <span class="st">"yellow"</span>))</span>
<span id="cb743-35"><a href="ch6.html#cb743-35"></a></span>
<span id="cb743-36"><a href="ch6.html#cb743-36"></a><span class="co">#-------------------------------- plot 4 -------------------------------#</span></span>
<span id="cb743-37"><a href="ch6.html#cb743-37"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">xaxt =</span> <span class="st">"n"</span>, <span class="at">yaxt =</span> <span class="st">"n"</span>, </span>
<span id="cb743-38"><a href="ch6.html#cb743-38"></a>     <span class="at">type =</span> <span class="st">"n"</span>)</span>
<span id="cb743-39"><a href="ch6.html#cb743-39"></a></span>
<span id="cb743-40"><a href="ch6.html#cb743-40"></a><span class="fu">rect</span>(<span class="fu">par</span>(<span class="st">"usr"</span>)[<span class="dv">1</span>], <span class="fu">par</span>(<span class="st">"usr"</span>)[<span class="dv">3</span>], <span class="fu">par</span>(<span class="st">"usr"</span>)[<span class="dv">2</span>], <span class="fu">par</span>(<span class="st">"usr"</span>)[<span class="dv">4</span>], </span>
<span id="cb743-41"><a href="ch6.html#cb743-41"></a>     <span class="at">col =</span> <span class="st">"white"</span>)</span>
<span id="cb743-42"><a href="ch6.html#cb743-42"></a><span class="fu">text</span>(<span class="fl">5.5</span>, <span class="fl">5.5</span>, <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">over</span>(</span>
<span id="cb743-43"><a href="ch6.html#cb743-43"></a>  <span class="fu">sum</span>(<span class="fu">paste</span>(<span class="st">"("</span>,<span class="fu">italic</span>(x[i] <span class="sc">-</span> <span class="fu">bar</span>(x)),<span class="st">")"</span><span class="sc">^</span><span class="dv">2</span>), </span>
<span id="cb743-44"><a href="ch6.html#cb743-44"></a>      <span class="fu">italic</span>(i)<span class="sc">==</span><span class="dv">1</span>, <span class="fu">italic</span>(n)),(<span class="fu">italic</span>(n) <span class="sc">-</span> <span class="dv">1</span>)),<span class="st">" = 78.4"</span>)), </span>
<span id="cb743-45"><a href="ch6.html#cb743-45"></a>  <span class="at">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb743-46"><a href="ch6.html#cb743-46"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>, <span class="st">"d"</span>))</span>
<span id="cb743-47"><a href="ch6.html#cb743-47"></a><span class="fu">mtext</span>(<span class="at">side =</span> <span class="dv">1</span>, </span>
<span id="cb743-48"><a href="ch6.html#cb743-48"></a>      <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Variance of "</span>, CO[<span class="dv">2</span>], <span class="st">" concentration"</span>)),</span>
<span id="cb743-49"><a href="ch6.html#cb743-49"></a>      <span class="at">line =</span> <span class="dv">3</span>)</span>
<span id="cb743-50"><a href="ch6.html#cb743-50"></a><span class="fu">par</span>(op)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:multi1"></span>
<img src="figure/minimal-multi1-1.png" alt="Figure resulting from summative example code." width="672"><p class="caption">
Figure 6.25: Figure resulting from summative example code.
</p>
</div>
</div>
<p><span class="math inline">\(\blacksquare\)</span>
</p>
</div>
<div id="histograms" class="section level2" number="6.14">
<h2>
<span class="header-section-number">6.14</span> Histograms<a class="anchor" aria-label="anchor" href="#histograms"><i class="fas fa-link"></i></a>
</h2>
<p>
<em>Histograms</em> are vital for considering the distributional characteristics of quantitative data. They consist of rectangles whose height is proportional or equivalent to the frequency of particular numeric intervals (<em>bins</em>) describing that variable.</p>
<div class="example">
<p><span id="exm:exm-bryce" class="example"><strong>Example 6.8  </strong></span><span class="math inline">\(\text{}\)</span><br>
The <code>brycesite</code> dataset from package <em>labdsv</em> consists of environmental variables recorded at, or calculated for, each of 160 plots in Bryce Canyon National Park in Southern Utah.</p>
<div class="sourceCode" id="cb744"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">labdsv</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">brycesite</span><span class="op">)</span></span></code></pre></div>
<p>The histogram in Fig <a href="ch6.html#fig:hist1">6.26</a> shows the distribution of the aspect (in degrees) of sites in the dataset.</p>
<div class="sourceCode" id="cb745"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">brycesite</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">asp</span>, xlab <span class="op">=</span> <span class="st">"Aspect (Degrees)"</span>, main <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:hist1"></span>
<img src="figure/minimal-hist1-1.png" alt="Histogram of raw aspect measures from the `brycesite` dataset." width="576"><p class="caption">
Figure 6.26: Histogram of raw aspect measures from the <code>brycesite</code> dataset.
</p>
</div>
<p>
The distribution appears remarkably uniform.</p>
<p>Consideration of raw aspect values in analyses is problematic because the measurements are circular. As a result the values 1 and 360 are numerically 359 units apart, although they in fact only differ by one degree. One solution is to use the transformation <span class="math inline">\([1 - \cos(\text{aspect}^{\text{o}} - 45)]/2\)</span>. This index will have highest values on southwest slopes (at 225 degrees), and lowest values on northeast facing slopes (at 45 degrees). This acknowledges the fact that highest temperatures in the Northern Hemisphere occur on Southwest facing slopes because they receive ambient warming during the morning, coupled with late afternoon direct radiation. We have:</p>
<div class="sourceCode" id="cb746"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">asp.val</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="op">(</span><span class="op">(</span><span class="va">brycesite</span><span class="op">$</span><span class="va">asp</span> <span class="op">-</span> <span class="fl">45</span><span class="op">)</span> <span class="op">*</span> <span class="va">pi</span><span class="op">)</span><span class="op">/</span><span class="fl">180</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span></span></code></pre></div>
<p>Fig <a href="ch6.html#fig:hist2">6.27</a> shows the distribution of the transformed aspects which now appears bimodal.</p>
<div class="sourceCode" id="cb747"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">asp.val</span>, xlab <span class="op">=</span> <span class="st">"Aspect idex"</span>, main <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:hist2"></span>
<img src="figure/minimal-hist2-1.png" alt="Histogram of transformed aspect measures from the `brycesite` dataset." width="576"><p class="caption">
Figure 6.27: Histogram of transformed aspect measures from the <code>brycesite</code> dataset.
</p>
</div>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
<p></p>
</div>
<div id="controlling-graphical-features-using-vectors" class="section level2" number="6.15">
<h2>
<span class="header-section-number">6.15</span> Controlling Graphical Features using Vectors<a class="anchor" aria-label="anchor" href="#controlling-graphical-features-using-vectors"><i class="fas fa-link"></i></a>
</h2>
<p>It is often useful to add information to graphical elements using a variable.</p>
<div class="example">
<p><span id="exm:exm-bryce2" class="example"><strong>Example 6.9  </strong></span><span class="math inline">\(\text{}\)</span><br>
The <code>brycesite</code> contains information on incident radiation received by sites, measured in Langleys. A Langley (Ly) is a measure of energy per unit area, per unit time. To be precise, one Ly = 1 calorie m<span class="math inline">\(^{-2}\)</span> min<span class="math inline">\(^{-1}\)</span>. In SI units 1Ly = 41840.00 J m<span class="math inline">\(^{-2}\)</span>. Fig <a href="ch6.html#fig:scatbryce">6.28</a> is a scatterplot of Langleys as a function of aspect index values. In addition five topographic positions from are distinguished using both point color and shape. For clarity I also create a legend. Note that ridge top sites have mostly northeastern aspect, and hence have lower radiation inputs.</p>
<!-- {\internallinenumbers \resetlinenumber[1] -->
<div class="sourceCode" id="cb748"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb748-1"><a href="ch6.html#cb748-1"></a><span class="fu">with</span>(brycesite, <span class="fu">plot</span>(asp.val, annrad, <span class="at">xlab =</span> <span class="st">"Aspect value"</span>,</span>
<span id="cb748-2"><a href="ch6.html#cb748-2"></a>                     <span class="at">ylab =</span> <span class="st">"Annual radiation (Langleys)"</span>,</span>
<span id="cb748-3"><a href="ch6.html#cb748-3"></a>                     <span class="at">col =</span> <span class="fu">as.numeric</span>(pos), <span class="at">pch =</span> <span class="fu">as.numeric</span>(pos)))</span>
<span id="cb748-4"><a href="ch6.html#cb748-4"></a></span>
<span id="cb748-5"><a href="ch6.html#cb748-5"></a><span class="fu">legend</span>(<span class="st">"bottomright"</span>, <span class="at">legend =</span> <span class="fu">levels</span>(brycesite<span class="sc">$</span>pos), <span class="at">pch =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:scatbryce"></span>
<img src="figure/minimal-scatbryce-1.png" alt="Scatterplot of aspect index value versus annual radiation with topographic positions indicated from the `brycesite` dataset." width="672"><p class="caption">
Figure 6.28: Scatterplot of aspect index value versus annual radiation with topographic positions indicated from the <code>brycesite</code> dataset.
</p>
</div>
<p>Note that to assign colors and plotting characters appropriately, I coerce the categorical topographic position vector, <code>brycesite$pos</code>, to be numeric with <code><a href="https://rdrr.io/r/base/numeric.html">as.numeric()</a></code> (Line 3). The result is:</p>
<div class="sourceCode" id="cb749"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">brycesite</span><span class="op">$</span><span class="va">pos</span><span class="op">)</span></span></code></pre></div>
<pre><code>  [1] 4 3 3 4 5 3 3 5 3 3 2 2 3 4 3 3 3 1 2 2 2 5 4 4 3 5 4 3 5 3 5 3 2 5 5
 [36] 4 1 1 2 4 4 3 3 3 3 4 3 5 3 3 3 2 5 3 5 3 3 5 5 4 3 3 5 2 3 3 5 2 2 5
 [71] 2 2 3 3 3 2 2 3 3 2 4 3 4 2 5 3 3 2 2 3 5 5 3 5 5 3 3 3 3 5 5 3 3 3 3
[106] 5 1 2 4 1 2 1 2 3 5 1 5 3 3 3 3 1 3 2 2 5 2 1 2 2 1 2 1 1 1 1 1 1 2 1
[141] 1 4 5 5 5 4 5 2 2 4 1 5 5 5 3 2 2 1 5 4</code></pre>
<p>Ones correspond to the first alphanumeric level in <code>pos</code>, <code>bottom</code>, whereas fives correspond to the last alphanumeric level, <code>up_slope</code>. The color and symbols assignments are made within the plot on Line three. Base graphics legends can be created using the function <code><a href="https://rdrr.io/r/graphics/legend.html">legend()</a></code> (Line 5). The first argument(s) will be a specific <em>x</em>, <em>y</em> position in the plot for the legend, or one of: <code>"bottomright"</code>, <code>"bottom"</code>, <code>"bottomleft"</code>, <code>"left"</code>, <code>"topleft"</code>, <code>"top"</code>, <code>"topright"</code>, <code>"right"</code>, or <code>"center"</code>. The <code>legend</code> argument names the categories to be depicted. The function <code><a href="https://rdrr.io/r/base/levels.html">levels()</a></code> used in the <code>legend</code> argument lists the categories in a vector of class factor, alphanumerically.</p>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
<p>
</p>
</div>
<div id="secondary-axes" class="section level2" number="6.16">
<h2>
<span class="header-section-number">6.16</span> Secondary Axes<a class="anchor" aria-label="anchor" href="#secondary-axes"><i class="fas fa-link"></i></a>
</h2>
<p>For many graphical summaries it may be necessary to add additional axes. For base graphics this will involve laying one plot on top of another, by specifying <code>par(new = TRUE)</code>, and defining <code>axes = FALSE</code>, and depending on whether we want extra vertical or horizontal axes, <code>xlab = FALSE</code> or <code>ylab = FALSE</code>, and <code>ylab = ""</code> or <code>xlab = ""</code> in the arguments of the second plot.</p>
<div class="example">
<p><span id="exm:exm-axis2" class="example"><strong>Example 6.10  </strong></span><span class="math inline">\(\text{}\)</span><br>
In this example I make a scatterplot that considers both <code>brycesite</code> annual radiation and annual growing season radiation as a function of aspect value (Fig <a href="ch6.html#fig:secaxis">6.29</a>).</p>
<div class="sourceCode" id="cb751"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb751-1"><a href="ch6.html#cb751-1"></a>op <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="fl">4.5</span>,<span class="dv">1</span>,<span class="fl">4.5</span>), <span class="at">cex =</span> <span class="fl">1.2</span>)</span>
<span id="cb751-2"><a href="ch6.html#cb751-2"></a><span class="fu">with</span>(brycesite, <span class="fu">plot</span>(asp.val, annrad, <span class="at">xlab =</span> <span class="st">"Aspect value"</span>,</span>
<span id="cb751-3"><a href="ch6.html#cb751-3"></a>                     <span class="at">ylab =</span> <span class="st">"Annual radiation (Langleys)"</span>))</span>
<span id="cb751-4"><a href="ch6.html#cb751-4"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb751-5"><a href="ch6.html#cb751-5"></a><span class="fu">with</span>(brycesite, <span class="fu">plot</span>(asp.val, grorad, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>, <span class="at">xlab =</span> <span class="st">""</span>,</span>
<span id="cb751-6"><a href="ch6.html#cb751-6"></a>                     <span class="at">ylab =</span> <span class="st">""</span>))</span>
<span id="cb751-7"><a href="ch6.html#cb751-7"></a><span class="fu">axis</span>(<span class="dv">4</span>)</span>
<span id="cb751-8"><a href="ch6.html#cb751-8"></a><span class="fu">mtext</span>(<span class="at">side =</span> <span class="dv">4</span>,<span class="st">"Growing season radiation (Langleys)"</span>, <span class="at">line =</span> <span class="dv">3</span>, <span class="at">cex =</span> <span class="fl">1.2</span>)</span>
<span id="cb751-9"><a href="ch6.html#cb751-9"></a><span class="fu">legend</span>(<span class="st">"bottomright"</span>, <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">19</span>), <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Annual radiation"</span>,</span>
<span id="cb751-10"><a href="ch6.html#cb751-10"></a>                                            <span class="st">"Growing season radiation"</span>))</span>
<span id="cb751-11"><a href="ch6.html#cb751-11"></a><span class="fu">par</span>(op)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:secaxis"></span>
<img src="figure/minimal-secaxis-1.png" alt="Scatterplot of annual radiation and growing season radiation as function of the aspect value index for the `brycesite` dataset." width="672"><p class="caption">
Figure 6.29: Scatterplot of annual radiation and growing season radiation as function of the aspect value index for the <code>brycesite</code> dataset.
</p>
</div>
<p>Note the extra room given to the right hand margin (Line 1) to contain a labeling for a secondary vertical axis. The code <code>par(new = TRUE)</code> (Line 4) tells <strong>R</strong> not to <em>clean</em> the graphical device before drawing a new plot. The code <code>axis(4)</code> (Line 7) creates labeling for the right hand axis. The argument <code>axes = FALSE</code> in the second plot, suppresses default plot plotting of axis units on the left and bottom axes.</p>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
</div>
<div id="barplots" class="section level2" number="6.17">
<h2>
<span class="header-section-number">6.17</span> Barplots<a class="anchor" aria-label="anchor" href="#barplots"><i class="fas fa-link"></i></a>
</h2>
<p>
<em>Barplots</em> are frequently used to compare single number summaries (e.g., sum, median, mean, etc.) of categorical levels.</p>
<div class="example">
<p><span id="exm:exm-bp" class="example"><strong>Example 6.11  </strong></span><span class="math inline">\(\text{}\)</span><br>
Of great concern to both citizens and scientists are rising global levels of atmospheric greenhouse gasses. Atmospheric CO<span class="math inline">\(_2\)</span> concentrations have increased more than 40% since the start of the industrial revolution while the more potent greenhouse gasses CH<span class="math inline">\(_4\)</span> and NO<span class="math inline">\(_2\)</span> have increased approximately 150% and 23%, respectively <span class="citation">(<a href="references.html#ref-brink">Brinkmann 2009</a>)</span>. We will take a detailed look at recent global patterns of CO<span class="math inline">\(_2\)</span> emissions and human population numbers in this example, while creating different sorts of barplots, and applying some of the data management techniques introduced in Chapter <a href="ch4.html#ch4">4</a>. Tidyverse data management approaches will be used for creating <em>ggplot2</em> graphics in Chapter <a href="ch4.html#ch4">4</a>. We will use the <code>world.emissions</code> dataframe from <em>asbio</em> as our data source.</p>
<div class="sourceCode" id="cb752"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb752-1"><a href="ch6.html#cb752-1"></a><span class="fu">library</span>(asbio)</span>
<span id="cb752-2"><a href="ch6.html#cb752-2"></a><span class="fu">data</span>(world.emissions)</span>
<span id="cb752-3"><a href="ch6.html#cb752-3"></a></span>
<span id="cb752-4"><a href="ch6.html#cb752-4"></a>nred <span class="ot">&lt;-</span> world.emissions[world.emissions<span class="sc">$</span>continent <span class="sc">!=</span> <span class="st">"Redundant"</span>,]</span>
<span id="cb752-5"><a href="ch6.html#cb752-5"></a>co2 <span class="ot">&lt;-</span> <span class="fu">with</span>(nred, <span class="fu">tapply</span>(co2, country, <span class="cf">function</span>(x){<span class="fu">mean</span>(x, <span class="at">na.rm =</span> T)}))</span>
<span id="cb752-6"><a href="ch6.html#cb752-6"></a>n <span class="ot">&lt;-</span> <span class="fu">with</span>(nred, <span class="fu">tapply</span>(co2, country, <span class="cf">function</span>(x){<span class="fu">length</span>(x)}))</span>
<span id="cb752-7"><a href="ch6.html#cb752-7"></a></span>
<span id="cb752-8"><a href="ch6.html#cb752-8"></a>co2n <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(co2, n))</span>
<span id="cb752-9"><a href="ch6.html#cb752-9"></a>co2n.sub <span class="ot">&lt;-</span> co2n[<span class="fu">which</span>(<span class="fu">row.names</span>(co2) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Canada"</span>, <span class="st">"China"</span>, <span class="st">"Finland"</span>,</span>
<span id="cb752-10"><a href="ch6.html#cb752-10"></a><span class="st">"Japan"</span>, <span class="st">"Kenya"</span>, <span class="st">"United States"</span>)),]</span>
<span id="cb752-11"><a href="ch6.html#cb752-11"></a></span>
<span id="cb752-12"><a href="ch6.html#cb752-12"></a>labels <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">rownames</span>(co2n.sub), <span class="st">" ("</span>, co2n.sub<span class="sc">$</span>n, <span class="st">")"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span></code></pre></div>
<p>In the code above, CO<span class="math inline">\(_2\)</span> annual means and sample sizes for each country are computed on Lines 4-5. A subset dataset of six countries is created on Lines 7-8. Country names for this subset and the number of years of data collection are combined in an object called <code>labels</code> on Line 10. Here is the barplot code.</p>
<div class="sourceCode" id="cb753"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb753-1"><a href="ch6.html#cb753-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#5D3003"</span>,<span class="st">"#347C62"</span>,<span class="st">"#A79DBE"</span>,<span class="st">"#DFCCC2"</span>,<span class="st">"#994E58"</span>, <span class="st">"#F1F1F1"</span>)</span>
<span id="cb753-2"><a href="ch6.html#cb753-2"></a><span class="fu">barplot</span>(co2n.sub<span class="sc">$</span>co2, <span class="at">las =</span> <span class="dv">2</span>, <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">yaxt =</span> <span class="st">"n"</span>, <span class="at">names =</span> labels,</span>
<span id="cb753-3"><a href="ch6.html#cb753-3"></a>        <span class="at">log =</span> <span class="st">"y"</span>, <span class="at">col =</span> cols)</span>
<span id="cb753-4"><a href="ch6.html#cb753-4"></a><span class="fu">axis</span>(<span class="dv">2</span>)</span>
<span id="cb753-5"><a href="ch6.html#cb753-5"></a><span class="fu">mtext</span>(<span class="at">side =</span> <span class="dv">2</span>, </span>
<span id="cb753-6"><a href="ch6.html#cb753-6"></a>      <span class="fu">expression</span>(<span class="fu">paste</span>(CO[<span class="dv">2</span>], <span class="st">" Emissions (metric tons x "</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>, <span class="st">")"</span>)),</span>
<span id="cb753-7"><a href="ch6.html#cb753-7"></a>      <span class="at">line =</span> <span class="fl">2.5</span>)</span></code></pre></div>
<p>The color palette on Line 1 in the code above was generated using <code><a href="https://colorspace.R-Forge.R-project.org/reference/choose_palette.html">colorspace::hclwizard()</a></code>. Note that rotated <em>x</em>-axis labels (<code>las = 2</code>) and log-scale <em>y</em>-axis are are specified on the call to <code><a href="https://rdrr.io/r/graphics/barplot.html">barplot()</a></code> on Lines 2-3. A customized <em>y</em>-axis is constructed on Lines 4-7. This is done largely to force the axis tick labels to be have a default vertical format. They would be vertical otherwise because of the use of <code>las = 2</code> in <code><a href="https://rdrr.io/r/graphics/barplot.html">barplot()</a></code>. Figure <a href="ch6.html#fig:bp1">6.30</a> shows the shows the final result.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:bp1"></span>
<img src="figure/minimal-bp1-1.png" alt="Barplot of mean annual CO$_2$ emmission levels for six countries. Number of years used in computing means indicated in parentheses." width="576"><p class="caption">
Figure 6.30: Barplot of mean annual CO<span class="math inline">\(_2\)</span> emmission levels for six countries. Number of years used in computing means indicated in parentheses.
</p>
</div>
<p>To depict trends since the year 2000, we can use a stacked barplot (Fig <a href="ch6.html#fig:bp1stb">6.31</a>), or a side by side barplot (Fig <a href="ch6.html#fig:bp1ssb">6.32</a>) by applying <code><a href="https://rdrr.io/r/graphics/barplot.html">barplot()</a></code> to a matrix with columns representing categories.</p>
<p>In the code below we subset the data by country (Lines 1-4) and year (Line 6), and create a dataframe containing CO<span class="math inline">\(_2\)</span> and country data (line 8), which is converted to a wide format matrix using <code><a href="https://rdrr.io/r/utils/stack.html">unstack()</a></code> (Line 9).</p>
<div class="sourceCode" id="cb754"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb754-1"><a href="ch6.html#cb754-1"></a>csub <span class="ot">&lt;-</span> world.emissions[</span>
<span id="cb754-2"><a href="ch6.html#cb754-2"></a>  <span class="fu">which</span>(world.emissions<span class="sc">$</span>country <span class="sc">%in%</span> </span>
<span id="cb754-3"><a href="ch6.html#cb754-3"></a>          <span class="fu">c</span>(<span class="st">"Canada"</span>, <span class="st">"China"</span>, <span class="st">"Finland"</span>, </span>
<span id="cb754-4"><a href="ch6.html#cb754-4"></a>            <span class="st">"Japan"</span>, <span class="st">"Kenya"</span>, <span class="st">"United States"</span>)),]</span>
<span id="cb754-5"><a href="ch6.html#cb754-5"></a></span>
<span id="cb754-6"><a href="ch6.html#cb754-6"></a>ysub <span class="ot">&lt;-</span> csub[<span class="fu">which</span>(csub<span class="sc">$</span>year <span class="sc">&gt;=</span> <span class="dv">2000</span>),]</span>
<span id="cb754-7"><a href="ch6.html#cb754-7"></a></span>
<span id="cb754-8"><a href="ch6.html#cb754-8"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">co2 =</span> ysub<span class="sc">$</span>co2, <span class="at">country =</span> ysub<span class="sc">$</span>country)</span>
<span id="cb754-9"><a href="ch6.html#cb754-9"></a>dat1 <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">unstack</span>(dat))</span></code></pre></div>
<p>In the code below, hexadecimal colors generated by <code><a href="https://colorspace.R-Forge.R-project.org/reference/choose_palette.html">colorspace::hclwizard()</a></code> are brought in (Line 1) and modified, i.e., unlisted, coerced to be a character vector and reversed (Line 2), preceding creation of the barplot (Lines 4-8).</p>
<div class="sourceCode" id="cb755"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb755-1"><a href="ch6.html#cb755-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"colormap_hex.txt"</span>) <span class="co"># file from hclwizard()</span></span>
<span id="cb755-2"><a href="ch6.html#cb755-2"></a>cols <span class="ot">&lt;-</span> <span class="fu">rev</span>(<span class="fu">as.character</span>(<span class="fu">unlist</span>(cols)))</span>
<span id="cb755-3"><a href="ch6.html#cb755-3"></a></span>
<span id="cb755-4"><a href="ch6.html#cb755-4"></a><span class="fu">barplot</span>(dat1, <span class="at">log =</span> <span class="st">"y"</span>, <span class="at">col =</span> cols, <span class="at">yaxt =</span> <span class="st">"n"</span>, <span class="at">las =</span> <span class="dv">2</span>, <span class="at">names =</span> labels)</span>
<span id="cb755-5"><a href="ch6.html#cb755-5"></a><span class="fu">axis</span>(<span class="dv">2</span>)</span>
<span id="cb755-6"><a href="ch6.html#cb755-6"></a><span class="fu">mtext</span>(<span class="at">side =</span> <span class="dv">2</span>, </span>
<span id="cb755-7"><a href="ch6.html#cb755-7"></a>      <span class="fu">expression</span>(<span class="fu">paste</span>(CO[<span class="dv">2</span>], <span class="st">" Emissions (metric tons x "</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>, <span class="st">")"</span>)),</span>
<span id="cb755-8"><a href="ch6.html#cb755-8"></a>      <span class="at">line =</span> <span class="fl">2.5</span>, <span class="at">cex =</span> <span class="fl">1.2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:bp1stb"></span>
<img src="figure/minimal-bp1stb-1.png" alt="Stacked barplot of mean annual CO$_2$ emmission levels for six countries from 2000-2019." width="576"><p class="caption">
Figure 6.31: Stacked barplot of mean annual CO<span class="math inline">\(_2\)</span> emmission levels for six countries from 2000-2019.
</p>
</div>
<p>Side by side barplots are generated by specifying <code>beside = TRUE</code> in <code><a href="https://rdrr.io/r/graphics/barplot.html">barplot()</a></code> (Line 2 in code below).</p>
<div class="sourceCode" id="cb756"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb756-1"><a href="ch6.html#cb756-1"></a><span class="fu">barplot</span>(dat1, <span class="at">log =</span> <span class="st">"y"</span>, <span class="at">beside =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> cols, <span class="at">yaxt =</span> <span class="st">"n"</span>, <span class="at">las =</span> <span class="dv">2</span>)</span>
<span id="cb756-2"><a href="ch6.html#cb756-2"></a></span>
<span id="cb756-3"><a href="ch6.html#cb756-3"></a><span class="fu">axis</span>(<span class="dv">2</span>)</span>
<span id="cb756-4"><a href="ch6.html#cb756-4"></a><span class="fu">mtext</span>(<span class="at">side =</span> <span class="dv">2</span>, </span>
<span id="cb756-5"><a href="ch6.html#cb756-5"></a>      <span class="fu">expression</span>(<span class="fu">paste</span>(CO[<span class="dv">2</span>], <span class="st">" Emissions (metric tons x "</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>, <span class="st">")"</span>)),</span>
<span id="cb756-6"><a href="ch6.html#cb756-6"></a>      <span class="at">line =</span> <span class="fl">2.5</span>, <span class="at">cex =</span> <span class="fl">1.2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:bp1ssb"></span>
<img src="figure/minimal-bp1ssb-1.png" alt="Side by side barplot of mean annual CO$_2$ emmission levels for six countries from 2000-2019." width="576"><p class="caption">
Figure 6.32: Side by side barplot of mean annual CO<span class="math inline">\(_2\)</span> emmission levels for six countries from 2000-2019.
</p>
</div>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
<p>
</p>
</div>
<div id="boxplots" class="section level2" number="6.18">
<h2>
<span class="header-section-number">6.18</span> Boxplots<a class="anchor" aria-label="anchor" href="#boxplots"><i class="fas fa-link"></i></a>
</h2>
<p>
<em>Boxplots</em> or <em>box and whisker plots</em> and their variants are an excellent way to quickly summarize and compare the distributions of levels in a categorical variable with respect to a quantitative variable. The function <code><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot()</a></code> does this by graphically providing a five number summary for factor levels (Fig <a href="ch6.html#fig:box">6.33</a>). Specifically, the upper and lower hinges of boxes from boxplot show the 1st and 3rd quartiles (thus the box contains the central 50% of the data). The black stripe in the middle of each box shows the median. The whiskers extend to the most extreme data point which is no more than <code>coef</code> times the length of the box away from a hinge, where <code>coef</code> is defined in the arguments for <code><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot()</a></code> (by default <code>coef = 1.5</code>). Circle symbols outside of whiskers can be considered outliers <span class="citation">(<em>cf</em>., <a href="references.html#ref-tukey1977">Tukey et al. 1977</a>)</span>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:box"></span>
<img src="figs6/box.png" alt="A summary of boxplot characteristics." width="80%"><p class="caption">
Figure 6.33: A summary of boxplot characteristics.
</p>
</div>
<p></p>
<div class="example">
<p><span id="exm:exm-bxp1" class="example"><strong>Example 6.12  </strong></span><span class="math inline">\(\text{}\)</span><br>
Here we reconsider the <code>world.emissions</code> data using boxplots. Recall our approach from the previous exercise:</p>
<div class="sourceCode" id="cb757"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb757-1"><a href="ch6.html#cb757-1"></a>csub <span class="ot">&lt;-</span> world.emissions[</span>
<span id="cb757-2"><a href="ch6.html#cb757-2"></a>  <span class="fu">which</span>(world.emissions<span class="sc">$</span>country <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Canada"</span>, <span class="st">"China"</span>, <span class="st">"Finland"</span>,</span>
<span id="cb757-3"><a href="ch6.html#cb757-3"></a>                                     <span class="st">"Japan"</span>, <span class="st">"Kenya"</span>, <span class="st">"United States"</span>)),]</span>
<span id="cb757-4"><a href="ch6.html#cb757-4"></a>ysub <span class="ot">&lt;-</span> csub[<span class="fu">which</span>(csub<span class="sc">$</span>year <span class="sc">&gt;=</span> <span class="dv">2000</span>),]</span>
<span id="cb757-5"><a href="ch6.html#cb757-5"></a></span>
<span id="cb757-6"><a href="ch6.html#cb757-6"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">co2 =</span> ysub<span class="sc">$</span>co2, <span class="at">country =</span> ysub<span class="sc">$</span>country)</span></code></pre></div>
<p>We can use <code>plot(q ~ c)</code> (Fig <a href="ch6.html#fig:d2">6.2</a>) or <code>boxplot(q ~ c)</code> to make boxplots, where <code>q</code> is a vector of quantitative data and <code>c</code> is a corresponding vector of categorical data.</p>
<div class="sourceCode" id="cb758"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb758-1"><a href="ch6.html#cb758-1"></a>cols1 <span class="ot">&lt;-</span> <span class="fu">rev</span>(<span class="fu">c</span>(<span class="st">"#5D3003"</span>,<span class="st">"#347C62"</span>,<span class="st">"#A79DBE"</span>,</span>
<span id="cb758-2"><a href="ch6.html#cb758-2"></a>               <span class="st">"#DFCCC2"</span>,<span class="st">"#994E58"</span>, <span class="st">"#F1F1F1"</span>))</span>
<span id="cb758-3"><a href="ch6.html#cb758-3"></a><span class="fu">with</span>(dat, </span>
<span id="cb758-4"><a href="ch6.html#cb758-4"></a>     <span class="fu">boxplot</span>(co2 <span class="sc">~</span> country, <span class="at">col =</span> cols1, <span class="at">las =</span> <span class="dv">2</span>, <span class="at">xlab =</span> <span class="st">""</span>, </span>
<span id="cb758-5"><a href="ch6.html#cb758-5"></a>             <span class="at">ylab =</span> </span>
<span id="cb758-6"><a href="ch6.html#cb758-6"></a>               <span class="fu">expression</span>(</span>
<span id="cb758-7"><a href="ch6.html#cb758-7"></a>                 <span class="fu">paste</span>(CO[<span class="dv">2</span>], <span class="st">" Emissions (metric tons x "</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>, <span class="st">")"</span>))))</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:bxp"></span>
<img src="figure/minimal-bxp-1.png" alt="Boxplots of annual CO$_2$ emmission levels for six countries from 2000-2019." width="576"><p class="caption">
Figure 6.34: Boxplots of annual CO<span class="math inline">\(_2\)</span> emmission levels for six countries from 2000-2019.
</p>
</div>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
<div id="violin-plots" class="section level3" number="6.18.1">
<h3>
<span class="header-section-number">6.18.1</span> Violin Plots<a class="anchor" aria-label="anchor" href="#violin-plots"><i class="fas fa-link"></i></a>
</h3>
<p>
Another graphical tool for comparing probability distributions is a <em>violin plot</em>. It contains contains similar components to a boxplots, including designation of boxes and whiskers, along with a rotated kernel density plot on each side. Thus, it allows additional consideration of the skew, kurtosis and potential multimodality of distributions. The function <code>vioplot</code> from the package <em>vioplot</em> allows base graphics generation of violin plots.
</p>
<div class="example">
<p><span id="exm:exm-vio1" class="example"><strong>Example 6.13  </strong></span><span class="math inline">\(\text{}\)</span><br>
As an example we will compare violin plots based on random sampling of a bimodal, uniform and normal distribution (see <code>?vioplot</code>). Note the kernel density generator fits a oblique sphere, although the uniform PDF is a rectangle (Fig <a href="ch6.html#fig:vio">6.35</a>).</p>
<div class="sourceCode" id="cb759"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb759-1"><a href="ch6.html#cb759-1"></a><span class="fu">library</span>(vioplot)</span>
<span id="cb759-2"><a href="ch6.html#cb759-2"></a></span>
<span id="cb759-3"><a href="ch6.html#cb759-3"></a>mu <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb759-4"><a href="ch6.html#cb759-4"></a>sig <span class="ot">&lt;-</span> <span class="fl">0.6</span></span>
<span id="cb759-5"><a href="ch6.html#cb759-5"></a>bimodal <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">1000</span>,<span class="sc">-</span>mu, sig), <span class="fu">rnorm</span>(<span class="dv">1000</span>, mu, sig))</span>
<span id="cb759-6"><a href="ch6.html#cb759-6"></a>uniform <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">2000</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>)</span>
<span id="cb759-7"><a href="ch6.html#cb759-7"></a>normal <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">2000</span>, <span class="dv">0</span>, <span class="dv">3</span>)</span>
<span id="cb759-8"><a href="ch6.html#cb759-8"></a><span class="fu">vioplot</span>(bimodal, uniform, normal, <span class="at">col =</span> cols1[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>],</span>
<span id="cb759-9"><a href="ch6.html#cb759-9"></a>        <span class="at">names =</span> <span class="st">"Bimodal"</span>, <span class="st">"Uniform"</span>, <span class="st">"Normal"</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:vio"></span>
<img src="figure/minimal-vio-1.png" alt="Violin plots based on random sampling from a bimodal, uniform, and normal distribution." width="576"><p class="caption">
Figure 6.35: Violin plots based on random sampling from a bimodal, uniform, and normal distribution.
</p>
</div>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
</div>
</div>
<div id="interval-plots" class="section level2" number="6.19">
<h2>
<span class="header-section-number">6.19</span> Interval Plots<a class="anchor" aria-label="anchor" href="#interval-plots"><i class="fas fa-link"></i></a>
</h2>
<p>
<em>Interval plots</em> display location measures (e.g. means, medians, etc.), typically as bars, along with error bars representing measures of data dispersion (e.g., standard errors, standard deviations, confidence intervals, interquartile ranges, etc.). Thus, barplots and boxplots can be considered special types of interval plots.</p>
<div class="example">
<p><span id="exm:exm-iplot1" class="example"><strong>Example 6.14  </strong></span><span class="math inline">\(\text{}\)</span><br>
As an example, we will create an interval plot by hand using a classic dataset from R.A. Fisher that records the yield of different varieties of potatoes. The data are in the dataframe <code><a href="https://rdrr.io/pkg/asbio/man/potato.html">asbio::potato</a></code>. Here are the means and the standard errors of the mean.
</p>
<div class="sourceCode" id="cb760"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">potato</span><span class="op">)</span></span>
<span><span class="va">means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">potato</span>, <span class="fu"><a href="https://rdrr.io/r/base/tapply.html">tapply</a></span><span class="op">(</span><span class="va">Yield</span>, <span class="va">Variety</span>, <span class="va">mean</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">means</span><span class="op">)</span></span></code></pre></div>
<pre><code>         Ajax Arran comrade British queen  Duke of York       Epicure 
       3.3400        2.2622        3.1367        1.7778        2.1600 
   Great Scot 
       3.4033 </code></pre>
<div class="sourceCode" id="cb762"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">potato</span>, </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/tapply.html">tapply</a></span><span class="op">(</span><span class="va">Yield</span>, <span class="va">Variety</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">ses</span><span class="op">)</span></span></code></pre></div>
<pre><code>         Ajax Arran comrade British queen  Duke of York       Epicure 
     0.305941      0.070902      0.181184      0.148313      0.146771 
   Great Scot 
     0.140929 </code></pre>
<p>We will plot the means using a barplot and save the horizontal locations of bars as a object <code>bloc</code>.</p>
<div class="sourceCode" id="cb764"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bloc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="va">means</span>, las <span class="op">=</span> <span class="fl">2</span>, ylab <span class="op">=</span> <span class="st">"Yield (lbs per plant)"</span>, col <span class="op">=</span> <span class="va">cols</span><span class="op">)</span></span></code></pre></div>
<p>We will then overlay error bars using the function <code><a href="https://rdrr.io/r/graphics/segments.html">segments()</a></code> or <code><a href="https://rdrr.io/r/graphics/arrows.html">arrows()</a></code>.</p>
<div class="sourceCode" id="cb765"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/segments.html">segments</a></span><span class="op">(</span>x0 <span class="op">=</span> <span class="va">bloc</span>, y0 <span class="op">=</span> <span class="va">means</span> <span class="op">-</span> <span class="va">ses</span>, y1 <span class="op">=</span> <span class="va">means</span> <span class="op">+</span> <span class="va">ses</span>, x1 <span class="op">=</span> <span class="va">bloc</span><span class="op">)</span></span></code></pre></div>
<p>The result is shown in Fig <a href="ch6.html#fig:iplot">6.36</a>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:iplot"></span>
<img src="figure/minimal-iplot-1.png" alt="Interval plot of the Fisher potato dataset.  Bar heights are means, error bars represent $\bar{x} \pm \hat{\sigma}_{\bar{x}}$." width="576"><p class="caption">
Figure 6.36: Interval plot of the Fisher potato dataset. Bar heights are means, error bars represent <span class="math inline">\(\bar{x} \pm \hat{\sigma}_{\bar{x}}\)</span>.
</p>
</div>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
<p> </p>
<p>The function <code><a href="https://rdrr.io/pkg/asbio/man/bplot.html">asbio::bplot</a></code> allows straightforward creation of interval plots from specified explanatory and response variables. A large number of location and dispersion measures can be specified in the function arguments. To recreate Fig <a href="ch6.html#fig:iplot">6.36</a> one could simply type:
</p>
<div class="sourceCode" id="cb766"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">potato</span>, <span class="fu"><a href="https://rdrr.io/pkg/asbio/man/bplot.html">bplot</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Yield</span>, x <span class="op">=</span> <span class="va">Variety</span>, bar.col <span class="op">=</span> <span class="va">cols</span>, border <span class="op">=</span> <span class="va">cols</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div id="pairwise-comparisons" class="section level3" number="6.19.1">
<h3>
<span class="header-section-number">6.19.1</span> Pairwise Comparisons<a class="anchor" aria-label="anchor" href="#pairwise-comparisons"><i class="fas fa-link"></i></a>
</h3>
<p>An important component of many biological analyses are multiple pairwise comparisons of means (or other location measures). These tests will often require control of Family-Wise type I Error Rate (FWER), that is, the probability of incorrectly rejecting at least one true null hypothesis in a family of related tests. The most powerful method for controlling FWER in a <em>post hoc</em> family of pairwise tests, following an omnibus ANalysis Of VAriance (ANOVA), is Tukey’s honest significant difference (see <span class="citation">Aho (<a href="references.html#ref-aho2014">2014</a>)</span>).</p>
<div class="example">
<p><span id="exm:exm-iplotb" class="example"><strong>Example 6.15  </strong></span><span class="math inline">\(\text{}\)</span><br><span class="citation">Zelazo, Zelazo, and Kolb (<a href="references.html#ref-zelazo1972">1972</a>)</span> performed a series of experiments to determine whether certain exercises could allow infants to learn to walk at a younger age. The experimental treatments were: Active Exercise (AE), Passive Exercise (PE), Test-Only (TO), and Control (C). The data are in the dataframe <code><a href="https://rdrr.io/pkg/asbio/man/baby.walk.html">asbio::baby.walk</a></code>. For more information type <code><a href="https://rdrr.io/pkg/asbio/man/baby.walk.html">?baby.walk</a></code>.</p>
<p>Rejection of the omnibus ANOVA null hypothesis of no mean treatment differences, allowed pairwise comparison of treatment means using Tukey’s procedure. We will use the function <code><a href="https://rdrr.io/pkg/asbio/man/pairw.anova.html">asbio::pairw.anova()</a></code> to run this analysis.</p>
<div class="sourceCode" id="cb767"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">baby.walk</span><span class="op">)</span></span>
<span><span class="va">tukey</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">baby.walk</span>, <span class="fu"><a href="https://rdrr.io/pkg/asbio/man/pairw.anova.html">pairw.anova</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">date</span>, x <span class="op">=</span> <span class="va">treatment</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tukey</span></span></code></pre></div>
<pre><code>
95% Tukey-Kramer confidence intervals 

              Diff    Lower    Upper  Decision Adj. p-value
muAE-muC    -2.225 -4.35648 -0.09352 Reject H0     0.038997
muAE-muPE   -0.525 -2.65648  1.60648    FTR H0     0.897224
muC-muPE       1.7 -0.52625  3.92625    FTR H0     0.172932
muAE-muTO -1.58333 -3.61562  0.44895    FTR H0     0.160457
muC-muTO   0.64167 -1.48981  2.77314    FTR H0     0.829542
muPE-muTO -1.05833 -3.18981  1.07314    FTR H0     0.513366</code></pre>
<p>Interval plots can be used to summarize these comparisons. The <code>plot</code> method for objects of class <code>pairw</code> calls <code><a href="https://rdrr.io/pkg/asbio/man/bplot.html">bplot()</a></code> for this purpose. In particular, we have:</p>
<div class="sourceCode" id="cb769"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">tukey</span>, ylab <span class="op">=</span> <span class="st">"Months until walking"</span>, cex.lett <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></span></code></pre></div>
<pre><code>
Bars are means.  Errors are SEs.

The population means of factor levels with the same letter are not
significantly different at alpha = 0.05 using the Tukey HSD method.</code></pre>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:iplotb"></span>
<img src="figure/minimal-iplotb-1.png" alt="An interval plot summarizing the results of pairwise comparisons for the `baby.walk` example." width="576"><p class="caption">
Figure 6.37: An interval plot summarizing the results of pairwise comparisons for the <code>baby.walk</code> example.
</p>
</div>
<p>As stated in the <code><a href="https://rdrr.io/pkg/asbio/man/plot.pairw.html">plot.pairw()</a></code> function output (Fig <a href="ch6.html#fig:iplotb">6.37</a>), letters above bars summarize the result of pairwise comparisons. In particular, factor levels means with the same letter are not significantly different using the conventional FWER <span class="math inline">\(\alpha = 0.05\)</span>.</p>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
<p>
</p>
<p>We will look at more sophisticated graphical methods for pairwise comparisons in Ch <a href="ch7.html#ch7">7</a>.</p>
</div>
</div>
<div id="matplot" class="section level2" number="6.20">
<h2>
<span class="header-section-number">6.20</span> <code>matplot()</code><a class="anchor" aria-label="anchor" href="#matplot"><i class="fas fa-link"></i></a>
</h2>
<p>The function <code><a href="https://rdrr.io/r/graphics/matplot.html">matplot()</a></code> allows one to plot the columns of one matrix against the columns of another. There is no clear <em>ggplot2</em> alternative to <code><a href="https://rdrr.io/r/graphics/matplot.html">matplot()</a></code> because <em>tidyverse</em> functions require data to be a long table format, whereas <code><a href="https://rdrr.io/r/graphics/matplot.html">matplot()</a></code> works best with data in a wide table format.
</p>
<div class="example">
<p><span id="exm:exm-mplot" class="example"><strong>Example 6.16  </strong></span><span class="math inline">\(\text{}\)</span><br>
To demonstrate <code><a href="https://rdrr.io/r/graphics/matplot.html">matplot()</a></code> we will use the <code>dat1</code> dataset, used to create Fig <a href="ch6.html#fig:bp1stb">6.31</a>, which contains annual CO<span class="math inline">\(_2\)</span> levels from 2000-2019 for six countries.</p>
<div class="sourceCode" id="cb771"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb771-1"><a href="ch6.html#cb771-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="fl">4.5</span>,<span class="dv">5</span>,<span class="dv">2</span>), <span class="at">cex =</span> <span class="fl">1.1</span>)</span>
<span id="cb771-2"><a href="ch6.html#cb771-2"></a><span class="fu">matplot</span>(<span class="at">x =</span> <span class="dv">2000</span><span class="sc">:</span><span class="dv">2019</span>, <span class="at">y =</span> dat1, <span class="at">col =</span> cols1, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>,</span>
<span id="cb771-3"><a href="ch6.html#cb771-3"></a>        <span class="at">log =</span> <span class="st">"y"</span>, </span>
<span id="cb771-4"><a href="ch6.html#cb771-4"></a>        <span class="at">ylab =</span> <span class="fu">expression</span>(</span>
<span id="cb771-5"><a href="ch6.html#cb771-5"></a>          <span class="fu">paste</span>(CO[<span class="dv">2</span>], <span class="st">" Emissions (metric tons x "</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>, <span class="st">")"</span>)))</span>
<span id="cb771-6"><a href="ch6.html#cb771-6"></a></span>
<span id="cb771-7"><a href="ch6.html#cb771-7"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="dv">2001</span>, <span class="at">y =</span> <span class="dv">80000</span>, <span class="at">xpd =</span> <span class="cn">TRUE</span>,</span>
<span id="cb771-8"><a href="ch6.html#cb771-8"></a>       <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>, <span class="at">bty =</span> <span class="st">"n"</span>,</span>
<span id="cb771-9"><a href="ch6.html#cb771-9"></a>       <span class="at">col =</span> cols, <span class="at">legend =</span></span>
<span id="cb771-10"><a href="ch6.html#cb771-10"></a>         <span class="fu">c</span>(<span class="st">"Canada"</span>, <span class="st">"China"</span>, <span class="st">"Finland"</span>,</span>
<span id="cb771-11"><a href="ch6.html#cb771-11"></a>           <span class="st">"Japan"</span>, <span class="st">"Kenya"</span>, <span class="st">"United States"</span>))</span></code></pre></div>
<p>In the code above, note that I allocate additional room in the top of the graph for a legend (Line 1). Note that the response variable is a matrix of CO<span class="math inline">\(_2\)</span> values whose columns delimit countries (Line 2). The <code>xpd</code> argument in <code><a href="https://rdrr.io/r/graphics/legend.html">legend()</a></code> allows plotting to be clipped to the device region which will generally exceed the plot region (Line 6). The result is shown in Fig <a href="ch6.html#fig:mp">6.38</a>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:mp"></span>
<img src="figure/minimal-mp-1.png" alt="A matrix line plot." width="576"><p class="caption">
Figure 6.38: A matrix line plot.
</p>
</div>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
</div>
<div id="interactivity" class="section level2" number="6.21">
<h2>
<span class="header-section-number">6.21</span> Interactivity<a class="anchor" aria-label="anchor" href="#interactivity"><i class="fas fa-link"></i></a>
</h2>
<p>As noted earlier, <strong>R</strong> graphics are generally non-interactive. Some <em>graphical interactivity</em> is allowed via the function <code><a href="https://rdrr.io/r/graphics/locator.html">locator()</a></code>, which returns graphical coordinates where a mouse click occurred in plot, and <code><a href="https://rdrr.io/r/graphics/identify.html">identify()</a></code>, which can be used to add labels and symbols to mouse click locations. For instance, try:</p>
<div class="sourceCode" id="cb772"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.new</a></span><span class="op">(</span>RStudioGD <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># If one is using RStudio</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/identify.html">identify</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, labels <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p></p>
<p>For Windows, X Window, and Cairo graphics devices, more sophisticated methods exist for interactivity. In these settings, the function <code><a href="https://rdrr.io/r/grDevices/getGraphicsEvent.html">setGraphicsEventHandlers()</a></code> can be used to call functions when events such as mouse clicks or keystrokes occur. For instance, open an appropriate graphics device and try:</p>
<div class="sourceCode" id="cb773"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/example.html">example</a></span><span class="op">(</span><span class="st">"getGraphicsEvent"</span><span class="op">)</span></span></code></pre></div>
<p>Still other interactive options are possible using animations and hand rotatable graphics. These approaches, which are often transferable to Markdown HTMLs, are considered briefly in the next two sections of this chapter. Animations using the package <em>ggplot2</em> are considered in Ch <a href="ch7.html#ch7">7</a>. GUI driven graphics interactivity is also possible, and is described in Ch <a href="ch11.html#ch11">11</a>.
</p>
</div>
<div id="three-dimensional-graphics" class="section level2" number="6.22">
<h2>
<span class="header-section-number">6.22</span> Three Dimensional Graphics<a class="anchor" aria-label="anchor" href="#three-dimensional-graphics"><i class="fas fa-link"></i></a>
</h2>
<p>
It is often necessary to consider more than two variables in biological graphics. This can be done in a number of different ways, including the use of additional axes (e.g., Fig <a href="ch6.html#fig:secaxis">6.29</a>) (including 3D plots), additional colors, multiple line or symbol types (Fig <a href="ch6.html#fig:scatbryce">6.28</a>), or even multiple symbol sizes.</p>
<div class="example">
<p><span id="exm:exm-thd" class="example"><strong>Example 6.17  </strong></span><span class="math inline">\(\text{}\)</span><br>
To consider three dimensional plotting we will use two datasets from the package <em>vegan</em> which describe taiga/tundra ecosystems at particular Scandinavian sites. Vegetation data are contained in the dataset <code>varespec</code> while soil chemistry data for the same sites are contained in the dataset <code>varechem</code>.</p>
<div class="sourceCode" id="cb774"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/vegandevs/vegan">vegan</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">varespec</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">varechem</span><span class="op">)</span></span></code></pre></div>
<p>In Fig <a href="ch6.html#fig:sym">6.39</a> we examine the distribution of the heath plant <em>Vaccinium vitis-idaea</em> (a common species in boreal forest understories) with respect to both pH and soil percent nitrogen. This is done by making symbol sizes change with the abundance of <em>V. vitis-idaea</em>.</p>
<div class="sourceCode" id="cb775"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">varechem</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">N</span>, <span class="va">pH</span>, xlab <span class="op">=</span> <span class="st">"% soil N"</span>, pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>                    cex <span class="op">=</span> <span class="va">varespec</span><span class="op">$</span><span class="va">Vaccviti</span><span class="op">/</span><span class="fl">100</span> <span class="op">*</span> <span class="fl">15</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:sym"></span>
<img src="figure/minimal-sym-1.png" alt="Cover of *Vaccinium vitis-idaea* with respect to pH and % soil
nitrogen. Larger symbols indicate higher percent plant cover." width="576"><p class="caption">
Figure 6.39: Cover of <em>Vaccinium vitis-idaea</em> with respect to pH and % soil
nitrogen. Larger symbols indicate higher percent plant cover.
</p>
</div>
<p><em>Vaccinium vitis-idaea</em> appears to prefer intermediate to low levels of soil N, and acidic soils. The somewhat negative association between soil N and pH is probably due to soil leaching, because H<span class="math inline">\(^+\)</span> (and Al<span class="math inline">\(^{3+}\)</span>) cations are more strongly adsorbed by soil colloids than bases in poorly drained soils.</p>
<p>A 3D plot of the same associations can be created using the <code>scatterplot3d()</code> function from the package <em>scatterplot3d</em> .</p>
<div class="sourceCode" id="cb776"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb776-1"><a href="ch6.html#cb776-1"></a><span class="fu">library</span>(scatterplot3d)</span>
<span id="cb776-2"><a href="ch6.html#cb776-2"></a>Fig <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">angle =</span> <span class="dv">55</span>){</span>
<span id="cb776-3"><a href="ch6.html#cb776-3"></a>s3d <span class="ot">&lt;-</span> <span class="fu">scatterplot3d</span>(<span class="fu">cbind</span>(varechem<span class="sc">$</span>N, varechem<span class="sc">$</span>pH, varespec<span class="sc">$</span>Vaccviti),</span>
<span id="cb776-4"><a href="ch6.html#cb776-4"></a><span class="at">type =</span> <span class="st">"h"</span>, <span class="at">highlight.3d =</span> <span class="cn">TRUE</span>, <span class="at">angle =</span> angle, <span class="at">scale =</span> .<span class="dv">7</span>, <span class="at">pch =</span> <span class="dv">16</span>,</span>
<span id="cb776-5"><a href="ch6.html#cb776-5"></a><span class="at">xlab =</span> <span class="st">"N"</span>, <span class="at">ylab =</span> <span class="st">"pH"</span>, <span class="at">zlab =</span></span>
<span id="cb776-6"><a href="ch6.html#cb776-6"></a>  <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(Vaccinium), <span class="st">" "</span>, <span class="fu">italic</span>(vitis<span class="sc">-</span>idaea), </span>
<span id="cb776-7"><a href="ch6.html#cb776-7"></a>                   <span class="st">" % cover"</span>)))</span>
<span id="cb776-8"><a href="ch6.html#cb776-8"></a></span>
<span id="cb776-9"><a href="ch6.html#cb776-9"></a>lm1 <span class="ot">&lt;-</span><span class="fu">lm</span>(varespec<span class="sc">$</span>Vaccviti <span class="sc">~</span> varechem<span class="sc">$</span>N <span class="sc">+</span> varechem<span class="sc">$</span>pH)</span>
<span id="cb776-10"><a href="ch6.html#cb776-10"></a>s3d<span class="sc">$</span><span class="fu">plane3d</span>(lm1)</span>
<span id="cb776-11"><a href="ch6.html#cb776-11"></a>}</span>
<span id="cb776-12"><a href="ch6.html#cb776-12"></a><span class="fu">Fig</span>()</span></code></pre></div>
<p>In the code above, I define the figure to be a function (named <code>Fig</code>) to allow the angle of rotation in the 3D scatterplot to be easily changed using the <code>angle</code> argument in <code>Fig</code> (Line 2). Functions will be addressed in detail in Ch 8. By stipulating <code>highlight.3d = TRUE</code> (Line 4), objects that are closer to the viewer with respect to the <code>x</code> plane are given warmer colors. A regression “plane” is also overlaid on the graph (Lines 9-10). The fitted plane is produced from a multiple regression model created by the function <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>.
</p>
<p>The result is shown in Fig <a href="ch6.html#fig:tds">6.40</a>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:tds"></span>
<img src="figure/minimal-tds-1.png" alt="Cover of *Vaccinium vitis-idaea* with respect to pH and % soil
nitrogen, depicted in a 3D scatterplot." width="576"><p class="caption">
Figure 6.40: Cover of <em>Vaccinium vitis-idaea</em> with respect to pH and % soil
nitrogen, depicted in a 3D scatterplot.
</p>
</div>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
<p>
</p>
</div>
<div id="animation" class="section level2" number="6.23">
<h2>
<span class="header-section-number">6.23</span> Animation<a class="anchor" aria-label="anchor" href="#animation"><i class="fas fa-link"></i></a>
</h2>
<p>
<em>Animations</em> can be created in <strong>R</strong> to illustrate a wide range of processes <span class="citation">(<a href="references.html#ref-xie2013">Xie 2013</a>; <a href="references.html#ref-xie2018">Xie et al. 2018</a>)</span>. Functions with animation are generally based on loops (Section <a href="ch8.html#loops">8.4</a>) with some method of slowing the loop; usually the function <code><a href="https://rdrr.io/r/base/Sys.sleep.html">Sys.sleep()</a></code>.
</p>
<div class="example">
<p><span id="exm:exm-anm" class="example"><strong>Example 6.18  </strong></span><span class="math inline">\(\text{}\)</span><br>
Here we add animation to the 3D scatterplot shown in Fig <a href="ch6.html#fig:tds">6.40</a>. This will be facilitated by the fact that the plot is a function with an argument whose alteration results in modification of the graph.</p>
<div class="sourceCode" id="cb777"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb777-1"><a href="ch6.html#cb777-1"></a>fig.rot <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb777-2"><a href="ch6.html#cb777-2"></a><span class="fu">lapply</span>(<span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">360</span>), <span class="cf">function</span>(i){</span>
<span id="cb777-3"><a href="ch6.html#cb777-3"></a>  <span class="fu">Fig</span>(i)</span>
<span id="cb777-4"><a href="ch6.html#cb777-4"></a>  <span class="fu">Sys.sleep</span>(.<span class="dv">1</span>)</span>
<span id="cb777-5"><a href="ch6.html#cb777-5"></a>  })</span>
<span id="cb777-6"><a href="ch6.html#cb777-6"></a>}</span>
<span id="cb777-7"><a href="ch6.html#cb777-7"></a></span>
<span id="cb777-8"><a href="ch6.html#cb777-8"></a><span class="fu">fig.rot</span>()</span>
<span id="cb777-9"><a href="ch6.html#cb777-9"></a><span class="co"># save frames into one GIF:</span></span>
<span id="cb777-10"><a href="ch6.html#cb777-10"></a><span class="fu">library</span>(animation)</span>
<span id="cb777-11"><a href="ch6.html#cb777-11"></a><span class="fu">saveGIF</span>(<span class="fu">fig.rot</span>(), <span class="at">interval =</span> <span class="dv">1</span>, <span class="at">movie.name =</span> <span class="st">"vaccinium.gif"</span>)</span></code></pre></div>
<p>Recall that <code><a href="https://rdrr.io/r/base/lapply.html">lapply()</a></code> returns a list of the same length as its first argument <code>X</code>, whose elements result from applying a function, given in the second argument, to corresponding elements of <code>X</code>. In the code above, an argument-less function is created containing a loop run by <code><a href="https://rdrr.io/r/base/lapply.html">lapply()</a></code> (Lines 2 - 5). As the loop index <code>i</code> changes from <code>i = 1</code> to <code>i = 360</code> (Line 2) this changes the <code>angle</code> argument in the function <code>fig()</code>, used in creating Fig <a href="ch6.html#fig:tds">6.40</a>. At the end of each step in the loop, the system is paused for a tenth of second (Line 4) with the function <code><a href="https://rdrr.io/r/base/Sys.sleep.html">Sys.sleep()</a></code> to allow each “frame” of the animation to be viewed separately. In the (optional) last two lines of code, the <strong>R</strong> package <em>animation</em> is loaded, and the function <code><a href="https://rdrr.io/pkg/animation/man/saveGIF.html">animation::saveGIF()</a></code> is used to save the animation in a GIF file format<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Use of &lt;code&gt;saveGIF&lt;/code&gt; requires installation of open source software &lt;a href="http://www.imagemagick.org/script/convert.php"&gt;ImageMagick&lt;/a&gt; or &lt;a href="http://www.graphicsmagick.org"&gt;GraphicsMagick&lt;/a&gt; (see &lt;code&gt;?saveGIF&lt;/code&gt;).&lt;/p&gt;'><sup>62</sup></a>.</p>
<p>The animation result is shown in <a href="ch6.html#fig:tdsa">6.41</a>.
<!-- Animation controls are provided by the \LaTeX package *animation*. --></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:tdsa"></span>
<img src="figure/minimal-tdsa-.gif" alt="Animated version of the 3D scatterplot from Fig \@ref(fig:tds)." width="672"><p class="caption">
Figure 6.41: Animated version of the 3D scatterplot from Fig <a href="ch6.html#fig:tds">6.40</a>.
</p>
</div>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
<p>Working animations generated in <strong>R</strong> can be placed into HTML documents created under <strong>R</strong> Markdown, or PDF documents created using Sweave-alike approaches (Section <a href="ch2.html#workflow">2.9.2</a>). The former approach currently requires installation of the <em>gifski</em> <strong>R</strong> package and the specification: <code>animation.hook = "gifski"</code> among the chunk options for the animation. The latter approach requires loading of the <em>animate</em> LaTeX package and using the chunk option <code>fig.show = "animate"</code>. PDF animations can viewed using a number of PDF viewers including the Foxit<span class="math inline">\(^{\circledR}\)</span> and Adobe<span class="math inline">\(^{\circledR}\)</span> Acrobat Readers.</p>
<div class="example">
<p><span id="exm:exm-rgl" class="example"><strong>Example 6.19  </strong></span><span class="math inline">\(\text{}\)</span><br>
We can also create hand-rotatable 3D figures under the <em>rgl</em> real-time rendering system.</p>
<div class="sourceCode" id="cb778"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb778-1"><a href="ch6.html#cb778-1"></a>expg <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(varechem<span class="sc">$</span>pH, varechem<span class="sc">$</span>N)</span>
<span id="cb778-2"><a href="ch6.html#cb778-2"></a>subs <span class="ot">&lt;-</span> <span class="fu">cbind</span>(varechem<span class="sc">$</span>pH, varechem<span class="sc">$</span>N)</span>
<span id="cb778-3"><a href="ch6.html#cb778-3"></a>tf <span class="ot">&lt;-</span> (expg[,<span class="dv">1</span>] <span class="sc">==</span> subs[,<span class="dv">1</span>]) <span class="sc">&amp;</span> (expg[,<span class="dv">2</span>] <span class="sc">==</span> subs[,<span class="dv">2</span>])</span>
<span id="cb778-4"><a href="ch6.html#cb778-4"></a>y <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(tf <span class="sc">==</span> <span class="cn">TRUE</span>, varespec<span class="sc">$</span>Vaccviti, <span class="cn">NA</span>)</span>
<span id="cb778-5"><a href="ch6.html#cb778-5"></a>surface <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">N =</span> expg[,<span class="dv">1</span>], <span class="at">pH =</span> expg[,<span class="dv">2</span>], <span class="at">vac.vit =</span> y)</span>
<span id="cb778-6"><a href="ch6.html#cb778-6"></a></span>
<span id="cb778-7"><a href="ch6.html#cb778-7"></a><span class="fu">library</span>(car)</span>
<span id="cb778-8"><a href="ch6.html#cb778-8"></a><span class="fu">scatter3d</span>(vac.vit <span class="sc">~</span> N <span class="sc">+</span> pH, <span class="at">data =</span> surface, <span class="at">surface =</span> <span class="cn">TRUE</span>, <span class="at">fit =</span> <span class="st">"linear"</span>,</span>
<span id="cb778-9"><a href="ch6.html#cb778-9"></a><span class="at">zlab =</span> <span class="st">"N"</span>, <span class="at">xlab =</span> <span class="st">"pH"</span>, <span class="at">ylab =</span> <span class="st">"Vaccinium vitilus (% cover)"</span>)</span></code></pre></div>
<div id="rgl21560" style="width:672px;height:480px;" class="rglWebGL html-widget" role="img" aria-labelledby="rgl21560-aria"></div>
<script type="application/json" data-for="rgl21560">{"x":{"material":{"color":"#000000","alpha":1,"lit":true,"ambient":"#000000","specular":"#FFFFFF","emission":"#000000","shininess":50,"smooth":true,"front":"filled","back":"filled","size":3,"lwd":1,"fog":true,"point_antialias":false,"line_antialias":false,"texture":null,"textype":"rgb","texmode":"modulate","texmipmap":false,"texminfilter":"linear","texmagfilter":"linear","texenvmap":false,"depth_mask":true,"depth_test":"less","isTransparent":false,"polygon_offset":[0,0],"margin":"","floating":false,"tag":"","blend":["src_alpha","one_minus_src_alpha"]},"rootSubscene":7,"objects":{"16":{"id":16,"type":"text","material":{"lit":false},"vertices":"0","colors":"1","texts":[["3"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"2","family":[["sans"]],"font":[[1]],"ignoreExtent":false,"flags":33808},"17":{"id":17,"type":"text","material":{"lit":false},"vertices":"3","colors":"4","texts":[["4"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"5","family":[["sans"]],"font":[[1]],"ignoreExtent":false,"flags":33808},"18":{"id":18,"type":"text","material":{"lit":false},"vertices":"6","colors":"7","texts":[["10"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"8","family":[["sans"]],"font":[[1]],"ignoreExtent":false,"flags":33808},"19":{"id":19,"type":"text","material":{"lit":false},"vertices":"9","colors":"10","texts":[["30"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"11","family":[["sans"]],"font":[[1]],"ignoreExtent":false,"flags":33808},"20":{"id":20,"type":"text","material":{"lit":false},"vertices":"12","colors":"13","texts":[["2"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"14","family":[["sans"]],"font":[[1]],"ignoreExtent":false,"flags":33808},"21":{"id":21,"type":"text","material":{"lit":false},"vertices":"15","colors":"16","texts":[["20"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"17","family":[["sans"]],"font":[[1]],"ignoreExtent":false,"flags":33808},"22":{"id":22,"type":"spheres","material":{},"vertices":"18","colors":"19","radii":[[0.02350174635648727]],"centers":"20","ignoreExtent":false,"fastTransparency":true,"flags":32771},"23":{"id":23,"type":"lines","material":{"lit":false},"vertices":"21","colors":"22","centers":"23","ignoreExtent":false,"flags":32832},"24":{"id":24,"type":"lines","material":{"lit":false},"vertices":"24","colors":"25","centers":"26","ignoreExtent":false,"flags":32832},"25":{"id":25,"type":"lines","material":{"lit":false},"vertices":"27","colors":"28","centers":"29","ignoreExtent":false,"flags":32832},"26":{"id":26,"type":"text","material":{"lit":false},"vertices":"30","colors":"31","texts":[["pH"]],"cex":[[1]],"adj":[[1,0.5,0.5]],"centers":"32","family":[["sans"]],"font":[[1]],"ignoreExtent":false,"flags":33808},"27":{"id":27,"type":"text","material":{"lit":false},"vertices":"33","colors":"34","texts":[["Vaccinium vitilus (% cover)"]],"cex":[[1]],"adj":[[1,0.5,0.5]],"centers":"35","family":[["sans"]],"font":[[1]],"ignoreExtent":false,"flags":33808},"28":{"id":28,"type":"text","material":{"lit":false},"vertices":"36","colors":"37","texts":[["N"]],"cex":[[1]],"adj":[[1,0.5,0.5]],"centers":"38","family":[["sans"]],"font":[[1]],"ignoreExtent":false,"flags":33808},"29":{"id":29,"type":"surface","material":{"alpha":0.4980392158031464,"lit":false,"isTransparent":true},"vertices":"39","colors":"40","dim":[[26,26]],"centers":"41","ignoreExtent":false,"flipped":false,"flags":32810},"30":{"id":30,"type":"surface","material":{"alpha":0.4980392158031464,"lit":false,"front":"lines","back":"lines","isTransparent":true},"vertices":"42","colors":"43","dim":[[26,26]],"centers":"44","ignoreExtent":false,"flipped":false,"flags":32810},"31":{"id":31,"type":"lines","material":{"lit":false},"vertices":"45","colors":"46","centers":"47","ignoreExtent":false,"flags":32832},"11":{"id":11,"type":"light","vertices":[[0,0,1]],"colors":[[1,1,1,1],[1,1,1,1],[1,1,1,1]],"viewpoint":true,"finite":false},"10":{"id":10,"type":"background","material":{},"colors":"48","centers":"49","sphere":false,"fogtype":"none","fogscale":1,"flags":32768},"12":{"id":12,"type":"background","material":{"lit":false,"back":"lines"},"colors":"50","centers":"51","sphere":false,"fogtype":"none","fogscale":1,"flags":32768},"15":{"id":15,"type":"background","material":{"lit":false,"back":"lines"},"colors":"52","centers":"53","sphere":false,"fogtype":"exp2","fogscale":1,"flags":32768},"7":{"id":7,"type":"subscene","par3d":{"antialias":8,"FOV":60,"ignoreExtent":false,"listeners":7,"mouseMode":{"none":"none","left":"polar","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,1.891403079032898],"modelMatrix":[[1,0,0,-0.4749999940395355],[0,0.9659258127212524,-0.258819043636322,-0.3328343629837036],[0,0.258819043636322,0.9659258127212524,-2.484507322311401],[0,0,0,1]],"projMatrix":[[1.732050895690918,0,0,0],[0,1.732050895690918,0,0],[0,0,-2.000000238418579,-2.837104797363281],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[1,0,0,0],[0,0.9659258127212524,-0.258819043636322,0],[0,0.258819043636322,0.9659258127212524,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[1,1,1],"viewport":{"x":0,"y":0,"width":1,"height":1},"zoom":1,"bbox":[-0.05000000074505806,1,-0.1000000014901161,1.049999952316284,-0.05000000074505806,1.023501753807068],"windowRect":[112,135,368,391],"family":"sans","font":1,"cex":1,"useFreeType":false,"fontname":"TT Arial","maxClipPlanes":8,"glVersion":4.6,"activeSubscene":0},"embeddings":{"viewport":"replace","projection":"replace","model":"replace","mouse":"replace"},"objects":[15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,11],"subscenes":[],"flags":34171}},"crosstalk":{"key":[],"group":[],"id":[],"options":[]},"width":672,"height":480,"buffer":{"accessors":[{"bufferView":0,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":1,"componentType":5126,"count":1,"type":"VEC4"},{"bufferView":2,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":3,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":4,"componentType":5126,"count":1,"type":"VEC4"},{"bufferView":5,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":6,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":7,"componentType":5126,"count":1,"type":"VEC4"},{"bufferView":8,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":9,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":10,"componentType":5126,"count":1,"type":"VEC4"},{"bufferView":11,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":12,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":13,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":14,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":15,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":16,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":17,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":18,"componentType":5126,"count":26,"type":"VEC3"},{"bufferView":19,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":20,"componentType":5126,"count":26,"type":"VEC3"},{"bufferView":21,"componentType":5121,"count":2,"type":"VEC3"},{"bufferView":22,"componentType":5126,"count":1,"type":"VEC4"},{"bufferView":23,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":24,"componentType":5121,"count":2,"type":"VEC3"},{"bufferView":25,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":26,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":27,"componentType":5121,"count":2,"type":"VEC3"},{"bufferView":28,"componentType":5126,"count":1,"type":"VEC4"},{"bufferView":29,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":30,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":31,"componentType":5126,"count":1,"type":"VEC4"},{"bufferView":32,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":33,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":34,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":35,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":36,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":37,"componentType":5126,"count":1,"type":"VEC4"},{"bufferView":38,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":39,"componentType":5126,"count":676,"type":"VEC3"},{"bufferView":40,"componentType":5126,"count":1,"type":"VEC4"},{"bufferView":41,"componentType":5126,"count":625,"type":"VEC3"},{"bufferView":42,"componentType":5126,"count":676,"type":"VEC3"},{"bufferView":43,"componentType":5126,"count":1,"type":"VEC4"},{"bufferView":44,"componentType":5126,"count":625,"type":"VEC3"},{"bufferView":45,"componentType":5126,"count":52,"type":"VEC3"},{"bufferView":46,"componentType":5121,"count":52,"type":"VEC4","normalized":true},{"bufferView":47,"componentType":5126,"count":26,"type":"VEC3"},{"bufferView":48,"componentType":5126,"count":1,"type":"VEC4"},{"bufferView":49,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":50,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":51,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":52,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":53,"componentType":5121,"count":1,"type":"VEC3"}],"bufferViews":[{"buffer":0,"byteLength":12,"byteOffset":0},{"buffer":0,"byteLength":16,"byteOffset":12},{"buffer":0,"byteLength":12,"byteOffset":28},{"buffer":0,"byteLength":12,"byteOffset":40},{"buffer":0,"byteLength":16,"byteOffset":52},{"buffer":0,"byteLength":12,"byteOffset":68},{"buffer":0,"byteLength":12,"byteOffset":80},{"buffer":0,"byteLength":16,"byteOffset":92},{"buffer":0,"byteLength":12,"byteOffset":108},{"buffer":0,"byteLength":12,"byteOffset":120},{"buffer":0,"byteLength":16,"byteOffset":132},{"buffer":0,"byteLength":12,"byteOffset":148},{"buffer":0,"byteLength":12,"byteOffset":160},{"buffer":0,"byteLength":4,"byteOffset":172},{"buffer":0,"byteLength":12,"byteOffset":176},{"buffer":0,"byteLength":12,"byteOffset":188},{"buffer":0,"byteLength":4,"byteOffset":200},{"buffer":0,"byteLength":12,"byteOffset":204},{"buffer":0,"byteLength":312,"byteOffset":216},{"buffer":0,"byteLength":4,"byteOffset":528},{"buffer":0,"byteLength":312,"byteOffset":532},{"buffer":0,"byteLength":6,"byteOffset":844},{"buffer":0,"byteLength":16,"byteOffset":852},{"buffer":0,"byteLength":12,"byteOffset":868},{"buffer":0,"byteLength":6,"byteOffset":880},{"buffer":0,"byteLength":4,"byteOffset":886},{"buffer":0,"byteLength":12,"byteOffset":892},{"buffer":0,"byteLength":6,"byteOffset":904},{"buffer":0,"byteLength":16,"byteOffset":912},{"buffer":0,"byteLength":12,"byteOffset":928},{"buffer":0,"byteLength":3,"byteOffset":940},{"buffer":0,"byteLength":16,"byteOffset":944},{"buffer":0,"byteLength":3,"byteOffset":960},{"buffer":0,"byteLength":12,"byteOffset":964},{"buffer":0,"byteLength":4,"byteOffset":976},{"buffer":0,"byteLength":12,"byteOffset":980},{"buffer":0,"byteLength":3,"byteOffset":992},{"buffer":0,"byteLength":16,"byteOffset":996},{"buffer":0,"byteLength":3,"byteOffset":1012},{"buffer":0,"byteLength":8112,"byteOffset":1016},{"buffer":0,"byteLength":16,"byteOffset":9128},{"buffer":0,"byteLength":7500,"byteOffset":9144},{"buffer":0,"byteLength":8112,"byteOffset":16644},{"buffer":0,"byteLength":16,"byteOffset":24756},{"buffer":0,"byteLength":7500,"byteOffset":24772},{"buffer":0,"byteLength":624,"byteOffset":32272},{"buffer":0,"byteLength":208,"byteOffset":32896},{"buffer":0,"byteLength":312,"byteOffset":33104},{"buffer":0,"byteLength":16,"byteOffset":33416},{"buffer":0,"byteLength":3,"byteOffset":33432},{"buffer":0,"byteLength":4,"byteOffset":33435},{"buffer":0,"byteLength":3,"byteOffset":33439},{"buffer":0,"byteLength":4,"byteOffset":33442},{"buffer":0,"byteLength":3,"byteOffset":33446}],"buffers":[{"byteLength":33449,"bytes":"xU5sPs3MTL0AAAAAjIsLPwAAAACMiws/AACAP8VObD7NzEy9AAAAAAAAgD/NzEy9AAAAAIyL\nCz8AAAAAjIsLPwAAgD8AAIA/zcxMvQAAAAAAAAAAzczMvQAAAAAAAAAAjIsLP4yLCz8AAIA/\nAAAAAM3MzL0AAAAAAAAAAM3MzL0gpV0/AAAAAIyLCz+Miws/AACAPwAAAADNzMy9IKVdP83M\nTL3WwGM6zcxMvQAAAAHNzEy91sBjOs3MTL3NzEy9bGVIP83MTL0AAAABzcxMvWxlSD/NzEy9\nAAAAADXuLz9ONtk+2YmdPWTA4T73txY+xU5sPiCO/z7zE+I+2YmdPVqUGz+Y8eo+AAAAAGvg\ncT9g7xg/AAAAAM2auD5S2g0/2YkdPtS4vz5S2g0/2YmdPbnB5z4i9zc/2YmdPQQS0T0zXh0/\n2YmdPXcWZT63bVs/2YmdPQqvEz64lkg/AAAAAAqvEz5ExQI/2YkdPgceBz9QiDM/AAAAAM2a\nuD5S2g0/2YkdPtS4vz5S2g0/2YmdPqJXij6nL2M/2YmdPgACCT0AAIA/xU5sPnJ/vT5tssk+\nxU7sPoz32T3j1Wk/2YkdPgAAAADnULE+2YkdPsgDkT7LTwg/xU5sPuH0TT8gpV0+2YkdPmCw\nGT+t/IQ+T+zEPs+i3D5enT4+FDsxP6Tg8j6OgJQ+xU5sPgAAgD89z/M+AQEAAQAAAAA17i8/\nTjbZPtmJnT1kwOE+97cWPsVObD4gjv8+8xPiPtmJnT1alBs/mPHqPgAAAABr4HE/YO8YPwAA\nAADNmrg+UtoNP9mJHT7UuL8+UtoNP9mJnT25wec+Ivc3P9mJnT0EEtE9M14dP9mJnT13FmU+\nt21bP9mJnT0KrxM+uJZIPwAAAAAKrxM+RMUCP9mJHT4HHgc/UIgzPwAAAADNmrg+UtoNP9mJ\nHT7UuL8+UtoNP9mJnT6iV4o+py9jP9mJnT4AAgk9AACAP8VObD5yf70+bbLJPsVO7D6M99k9\n49VpP9mJHT4AAAAA51CxPtmJHT7IA5E+y08IP8VObD7h9E0/IKVdPtmJHT5gsBk/rfyEPk/s\nxD7Potw+Xp0+PhQ7MT+k4PI+joCUPsVObD4AAIA/Pc/zPgAAAAEAAAAAjIsLPwAAAACMiws/\nAACAPwAAAD8AAAAAAAAAAAAAAAABAAAAAAEAAAAAAAAAAAA/AAAAAAAAAAAAAQAAAAAAAIyL\n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\n7YTrPgrXoz4pXA8/yzzoPgrXoz6amRk/qvTkPgrXoz4K1yM/iKzhPgrXoz57FC4/Z2TePgrX\noz7sUTg/RhzbPgrXoz5cj0I/JNTXPgrXoz7NzEw/A4zUPgrXoz49Clc/4UPRPgrXoz6uR2E/\nwPvNPgrXoz4fhWs/n7PKPgrXoz6PwnU/fWvHPgrXoz4AAIA/XCPEPgrXoz4AAAAAMwgGP+xR\nuD4K1yM9ImQEP+xRuD4K16M9EcACP+xRuD6PwvU9ARwBP+xRuD4K1yM+4O/+PuxRuD7NzEw+\nvqf7PuxRuD6PwnU+nV/4PuxRuD4pXI8+exf1PuxRuD4K16M+Ws/xPuxRuD7sUbg+OYfuPuxR\nuD7NzMw+Fz/rPuxRuD6uR+E+9vbnPuxRuD6PwvU+1K7kPuxRuD64HgU/s2bhPuxRuD4pXA8/\nkh7ePuxRuD6amRk/cNbaPuxRuD4K1yM/T47XPuxRuD57FC4/LUbUPuxRuD7sUTg/DP7QPuxR\nuD5cj0I/6rXNPuxRuD7NzEw/yW3KPuxRuD49Clc/qCXHPuxRuD6uR2E/ht3DPuxRuD4fhWs/\nZZXAPuxRuD6PwnU/Q029PuxRuD4AAIA/IgW6PuxRuD4AAAAAFvkAP83MzD4K1yM9Cqr+Ps3M\nzD4K16M96WH7Ps3MzD6PwvU9xxn4Ps3MzD4K1yM+ptH0Ps3MzD7NzEw+hInxPs3MzD6PwnU+\nY0HuPs3MzD4pXI8+QvnqPs3MzD4K16M+ILHnPs3MzD7sUbg+/2jkPs3MzD7NzMw+3SDhPs3M\nzD6uR+E+vNjdPs3MzD6PwvU+m5DaPs3MzD64HgU/eUjXPs3MzD4pXA8/WADUPs3MzD6amRk/\nNrjQPs3MzD4K1yM/FXDNPs3MzD57FC4/9CfKPs3MzD7sUTg/0t/GPs3MzD5cj0I/sZfDPs3M\nzD7NzEw/j0/APs3MzD49Clc/bge9Ps3MzD6uR2E/Tb+5Ps3MzD4fhWs/K3e2Ps3MzD6PwnU/\nCi+zPs3MzD4AAIA/6OavPs3MzD4AAAAA8tP3Pq5H4T4K1yM90Iv0Pq5H4T4K16M9r0PxPq5H\n4T6PwvU9jvvtPq5H4T4K1yM+bLPqPq5H4T7NzEw+S2vnPq5H4T6PwnU+KSPkPq5H4T4pXI8+\nCNvgPq5H4T4K16M+55LdPq5H4T7sUbg+xUraPq5H4T7NzMw+pALXPq5H4T6uR+E+grrTPq5H\n4T6PwvU+YXLQPq5H4T64HgU/PyrNPq5H4T4pXA8/HuLJPq5H4T6amRk//ZnGPq5H4T4K1yM/\n21HDPq5H4T57FC4/ugnAPq5H4T7sUTg/mMG8Pq5H4T5cj0I/d3m5Pq5H4T7NzEw/VjG2Pq5H\n4T49Clc/NOmyPq5H4T6uR2E/E6GvPq5H4T4fhWs/8VisPq5H4T6PwnU/0BCpPq5H4T4AAIA/\nr8ilPq5H4T4AAAAAuLXtPo/C9T4K1yM9l23qPo/C9T4K16M9dSXnPo/C9T6PwvU9VN3jPo/C\n9T4K1yM+MpXgPo/C9T7NzEw+EU3dPo/C9T6PwnU+8ATaPo/C9T4pXI8+zrzWPo/C9T4K16M+\nrXTTPo/C9T7sUbg+iyzQPo/C9T7NzMw+auTMPo/C9T6uR+E+SZzJPo/C9T6PwvU+J1TGPo/C\n9T64HgU/BgzDPo/C9T4pXA8/5MO/Po/C9T6amRk/w3u8Po/C9T4K1yM/oTO5Po/C9T57FC4/\ngOu1Po/C9T7sUTg/X6OyPo/C9T5cj0I/PVuvPo/C9T7NzEw/HBOsPo/C9T49Clc/+sqoPo/C\n9T6uR2E/2YKlPo/C9T4fhWs/uDqiPo/C9T6PwnU/lvKePo/C9T4AAIA/daqbPo/C9T4AAAAA\nfpfjPrgeBT8K1yM9XU/gPrgeBT8K16M9OwfdPrgeBT+PwvU9Gr/ZPrgeBT8K1yM++XbWPrge\nBT/NzEw+1y7TPrgeBT+PwnU+tubPPrgeBT8pXI8+lJ7MPrgeBT8K16M+c1bJPrgeBT/sUbg+\nUg7GPrgeBT/NzMw+MMbCPrgeBT+uR+E+D36/PrgeBT+PwvU+7TW8PrgeBT+4HgU/zO24Prge\nBT8pXA8/q6W1PrgeBT+amRk/iV2yPrgeBT8K1yM/aBWvPrgeBT97FC4/Rs2rPrgeBT/sUTg/\nJYWoPrgeBT9cj0I/BD2lPrgeBT/NzEw/4vShPrgeBT89Clc/wayePrgeBT+uR2E/n2SbPrge\nBT8fhWs/fhyYPrgeBT+PwnU/XNSUPrgeBT8AAIA/O4yRPrgeBT8AAAAARXnZPilcDz8K1yM9\nIzHWPilcDz8K16M9AunSPilcDz+PwvU94KDPPilcDz8K1yM+v1jMPilcDz/NzEw+nhDJPilc\nDz+PwnU+fMjFPilcDz8pXI8+W4DCPilcDz8K16M+OTi/PilcDz/sUbg+GPC7PilcDz/NzMw+\n9qe4PilcDz+uR+E+1V+1PilcDz+PwvU+tBeyPilcDz+4HgU/ks+uPilcDz8pXA8/cYerPilc\nDz+amRk/Tz+oPilcDz8K1yM/LvekPilcDz97FC4/Da+hPilcDz/sUTg/62aePilcDz9cj0I/\nyh6bPilcDz/NzEw/qNaXPilcDz89Clc/h46UPilcDz+uR2E/ZkaRPilcDz8fhWs/RP6NPilc\nDz+PwnU/I7aKPilcDz8AAIA/AW6HPilcDz8AAAAAC1vPPpqZGT8K1yM96RLMPpqZGT8K16M9\nyMrIPpqZGT+PwvU9p4LFPpqZGT8K1yM+hTrCPpqZGT/NzEw+ZPK+PpqZGT+PwnU+Qqq7PpqZ\nGT8pXI8+IWK4PpqZGT8K16M+ABq1PpqZGT/sUbg+3tGxPpqZGT/NzMw+vYmuPpqZGT+uR+E+\nm0GrPpqZGT+PwvU+evmnPpqZGT+4HgU/WLGkPpqZGT8pXA8/N2mhPpqZGT+amRk/FiGePpqZ\nGT8K1yM/9NiaPpqZGT97FC4/05CXPpqZGT/sUTg/sUiUPpqZGT9cj0I/kACRPpqZGT/NzEw/\nb7iNPpqZGT89Clc/TXCKPpqZGT+uR2E/LCiHPpqZGT8fhWs/CuCDPpqZGT+PwnU/6ZeAPpqZ\nGT8AAIA/j596PpqZGT8AAAAA0TzFPgrXIz8K1yM9sPTBPgrXIz8K16M9jqy+PgrXIz+PwvU9\nbWS7PgrXIz8K1yM+Sxy4PgrXIz/NzEw+KtS0PgrXIz+PwnU+CYyxPgrXIz8pXI8+50OuPgrX\nIz8K16M+xvuqPgrXIz/sUbg+pLOnPgrXIz/NzMw+g2ukPgrXIz+uR+E+YiOhPgrXIz+PwvU+\nQNudPgrXIz+4HgU/H5OaPgrXIz8pXA8//UqXPgrXIz+amRk/3AKUPgrXIz8K1yM/u7qQPgrX\nIz97FC4/mXKNPgrXIz/sUTg/eCqKPgrXIz9cj0I/VuKGPgrXIz/NzEw/NZqDPgrXIz89Clc/\nE1KAPgrXIz+uR2E/5BN6PgrXIz8fhWs/oYNzPgrXIz+PwnU/XvNsPgrXIz8AAIA/HGNmPgrX\nIz8AAAAAlx67PnsULj8K1yM9dta3PnsULj8K16M9VY60PnsULj+PwvU9M0axPnsULj8K1yM+\nEv6tPnsULj/NzEw+8LWqPnsULj+PwnU+z22nPnsULj8pXI8+rSWkPnsULj8K16M+jN2gPnsU\nLj/sUbg+a5WdPnsULj/NzMw+SU2aPnsULj+uR+E+KAWXPnsULj+PwvU+Br2TPnsULj+4HgU/\n5XSQPnsULj8pXA8/xCyNPnsULj+amRk/ouSJPnsULj8K1yM/gZyGPnsULj97FC4/X1SDPnsU\nLj/sUTg/PgyAPnsULj9cj0I/OYh5PnsULj/NzEw/9vdyPnsULj89Clc/s2dsPnsULj+uR2E/\ncddlPnsULj8fhWs/LkdfPnsULj+PwnU/67ZYPnsULj8AAIA/qCZSPnsULj8AAAAAXgCxPuxR\nOD8K1yM9PLitPuxROD8K16M9G3CqPuxROD+PwvU9+SenPuxROD8K1yM+2N+jPuxROD/NzEw+\nt5egPuxROD+PwnU+lU+dPuxROD8pXI8+dAeaPuxROD8K16M+Ur+WPuxROD/sUbg+MXeTPuxR\nOD/NzMw+Dy+QPuxROD+uR+E+7uaMPuxROD+PwvU+zZ6JPuxROD+4HgU/q1aGPuxROD8pXA8/\nig6DPuxROD+amRk/0Yx/PuxROD8K1yM/jvx4PuxROD97FC4/S2xyPuxROD/sUTg/CNxrPuxR\nOD9cj0I/xktlPuxROD/NzEw/g7tePuxROD89Clc/QCtYPuxROD+uR2E//ZpRPuxROD8fhWs/\nugpLPuxROD+PwnU/d3pEPuxROD8AAIA/Neo9PuxROD8AAAAAJOKmPlyPQj8K1yM9ApqjPlyP\nQj8K16M94VGgPlyPQj+PwvU9wAmdPlyPQj8K1yM+nsGZPlyPQj/NzEw+fXmWPlyPQj+PwnU+\nWzGTPlyPQj8pXI8+OumPPlyPQj8K16M+GaGMPlyPQj/sUbg+91iJPlyPQj/NzMw+1hCGPlyP\nQj+uR+E+tMiCPlyPQj+PwvU+JgF/PlyPQj+4HgU/43B4PlyPQj8pXA8/oOBxPlyPQj+amRk/\nXVBrPlyPQj8K1yM/G8BkPlyPQj97FC4/2C9ePlyPQj/sUTg/lZ9XPlyPQj9cj0I/Ug9RPlyP\nQj/NzEw/D39KPlyPQj89Clc/zO5DPlyPQj+uR2E/il49PlyPQj8fhWs/R842PlyPQj+PwnU/\nBD4wPlyPQj8AAIA/wa0pPlyPQj8AAAAA6sOcPs3MTD8K1yM9yXuZPs3MTD8K16M9pzOWPs3M\nTD+PwvU9huuSPs3MTD8K1yM+ZKOPPs3MTD/NzEw+Q1uMPs3MTD+PwnU+IhOJPs3MTD8pXI8+\nAMuFPs3MTD8K16M+34KCPs3MTD/sUbg+e3V+Ps3MTD/NzMw+OOV3Ps3MTD+uR+E+9VRxPs3M\nTD+PwvU+ssRqPs3MTD+4HgU/cDRkPs3MTD8pXA8/LaRdPs3MTD+amRk/6hNXPs3MTD8K1yM/\np4NQPs3MTD97FC4/ZPNJPs3MTD/sUTg/IWNDPs3MTD9cj0I/39I8Ps3MTD/NzEw/nEI2Ps3M\nTD89Clc/WbIvPs3MTD+uR2E/FiIpPs3MTD8fhWs/05EiPs3MTD+PwnU/kQEcPs3MTD8AAIA/\nTnEVPs3MTD8AAAAAsKWSPj0KVz8K1yM9j12PPj0KVz8K16M9bhWMPj0KVz+PwvU9TM2IPj0K\nVz8K1yM+K4WFPj0KVz/NzEw+CT2CPj0KVz+PwnU+0Ol9Pj0KVz8pXI8+jVl3Pj0KVz8K16M+\nSslwPj0KVz/sUbg+BzlqPj0KVz/NzMw+xahjPj0KVz+uR+E+ghhdPj0KVz+PwvU+P4hWPj0K\nVz+4HgU//PdPPj0KVz8pXA8/uWdJPj0KVz+amRk/dtdCPj0KVz8K1yM/NEc8Pj0KVz97FC4/\n8bY1Pj0KVz/sUTg/riYvPj0KVz9cj0I/a5YoPj0KVz/NzEw/KAYiPj0KVz89Clc/5XUbPj0K\nVz+uR2E/o+UUPj0KVz8fhWs/YFUOPj0KVz+PwnU/HcUHPj0KVz8AAIA/2jQBPj0KVz8AAAAA\nd4eIPq5HYT8K1yM9VT+FPq5HYT8K16M9NPeBPq5HYT+PwvU9JV59Pq5HYT8K1yM+4s12Pq5H\nYT/NzEw+nz1wPq5HYT+PwnU+XK1pPq5HYT8pXI8+GR1jPq5HYT8K16M+14xcPq5HYT/sUbg+\nlPxVPq5HYT/NzMw+UWxPPq5HYT+uR+E+DtxIPq5HYT+PwvU+y0tCPq5HYT+4HgU/ibs7Pq5H\nYT8pXA8/Ris1Pq5HYT+amRk/A5suPq5HYT8K1yM/wAooPq5HYT97FC4/fXohPq5HYT/sUTg/\nOuoaPq5HYT9cj0I/+FkUPq5HYT/NzEw/tckNPq5HYT89Clc/cjkHPq5HYT+uR2E/L6kAPq5H\nYT8fhWs/2TH0Pa5HYT+PwnU/UxHnPa5HYT8AAIA/zfDZPa5HYT8AAAAAetJ8Ph+Faz8K1yM9\nN0J2Ph+Faz8K16M99LFvPh+Faz+PwvU9sSFpPh+Faz8K1yM+bpFiPh+Faz/NzEw+LAFcPh+F\n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\nGj8oXA8+rkdhPvbUGD8oXA8+uB6FPuYwFz8oXA8+mpmZPtSMFT8oXA8+exSuPsPoEz8oXA8+\nXI/CPrNEEj8oXA8+PgrXPqKgED8oXA8+HoXrPpL8Dj8oXA8+AAAAP4BYDT8oXA8+cD0KP3C0\nCz8oXA8+4noUP18QCj8oXA8+UrgeP05sCD8oXA8+wvUoPz7IBj8oXA8+NDMzPy4kBT8oXA8+\npHA9PxyAAz8oXA8+FK5HPwzcAT8oXA8+hetRP/s3AD8oXA8+9ihcP9Qn/T4oXA8+ZmZmP7Tf\n+T4oXA8+16NwP5GX9j4oXA8+SOF6P3FP8z4oXA8+CtejPCz6Gz/rUTg+j8J1PRtWGj/rUTg+\nzMzMPQuyGD/rUTg+KVwPPvoNFz/rUTg+61E4PuppFT/rUTg+rkdhPtjFEz/rUTg+uB6FPsgh\nEj/rUTg+mpmZPrd9ED/rUTg+exSuPqbZDj/rUTg+XI/CPpY1DT/rUTg+PgrXPoaRCz/rUTg+\nHoXrPnTtCT/rUTg+AAAAP2RJCD/rUTg+cD0KP1OlBj/rUTg+4noUP0IBBT/rUTg+UrgePzJd\nAz/rUTg+wvUoPyK5AT/rUTg+NDMzPxAVAD/rUTg+pHA9P//h/D7rUTg+FK5HP96Z+T7rUTg+\nhetRP7xR9j7rUTg+9ihcP5sJ8z7rUTg+ZmZmP3nB7z7rUTg+16NwP1h57D7rUTg+SOF6PzYx\n6T7rUTg+CtejPA/rFj+uR2E+j8J1Pf9GFT+uR2E+zMzMPe6iEz+uR2E+KVwPPt7+ET+uR2E+\n61E4PsxaED+uR2E+rkdhPry2Dj+uR2E+uB6FPqsSDT+uR2E+mpmZPppuCz+uR2E+exSuPorK\nCT+uR2E+XI/CPnomCD+uR2E+PgrXPmiCBj+uR2E+HoXrPlfeBD+uR2E+AAAAP0c6Az+uR2E+\ncD0KPzaWAT+uR2E+4noUP0vk/z6uR2E+UrgePyqc/D6uR2E+wvUoPwlU+T6uR2E+NDMzP+cL\n9j6uR2E+pHA9P8XD8j6uR2E+FK5HP6R77z6uR2E+hetRP4Mz7D6uR2E+9ihcP2Hr6D6uR2E+\nZmZmP0Cj5T6uR2E+16NwPx5b4j6uR2E+SOF6P/0S3z6uR2E+CtejPPLbET+4HoU+j8J1PeI3\nED+4HoU+zMzMPdKTDj+4HoU+KVwPPsDvDD+4HoU+61E4PrBLCz+4HoU+rkdhPp+nCT+4HoU+\n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\nUrgeP4F38T1I4Xo/wvUoP/xW5D1I4Xo/NDMzP3Y21z1I4Xo/pHA9P/AVyj1I4Xo/FK5HP2v1\nvD1I4Xo/hetRP+bUrz1I4Xo/9ihcP1+0oj1I4Xo/ZmZmP9qTlT1I4Xo/16NwP1RziD1I4Xo/\nSOF6P52ldj1I4Xo/AAAAADaQMz8AAAAACtcjPSbsMT8AAAAACtejPRVIMD8AAAAAj8L1PQSk\nLj8AAAAACtcjPvT/LD8AAAAAzcxMPuNbKz8AAAAAj8J1PtK3KT8AAAAAKVyPPsITKD8AAAAA\nCtejPrFvJj8AAAAA7FG4PqDLJD8AAAAAzczMPo8nIz8AAAAArkfhPn+DIT8AAAAAj8L1Pm7f\nHz8AAAAAuB4FP107Hj8AAAAAKVwPP02XHD8AAAAAmpkZPzzzGj8AAAAACtcjPytPGT8AAAAA\nexQuPxqrFz8AAAAA7FE4PwoHFj8AAAAAXI9CP/liFD8AAAAAzcxMP+i+Ej8AAAAAPQpXP9ga\nET8AAAAArkdhP8d2Dz8AAAAAH4VrP7bSDT8AAAAAj8J1P6YuDD8AAAAAAACAP5WKCj8AAAAA\nAAAAABqBLj8K1yM9CtcjPQndLD8K1yM9CtejPfg4Kz8K1yM9j8L1PeeUKT8K1yM9CtcjPtfw\nJz8K1yM9zcxMPsZMJj8K1yM9j8J1PrWoJD8K1yM9KVyPPqUEIz8K1yM9CtejPpRgIT8K1yM9\n7FG4PoO8Hz8K1yM9zczMPnMYHj8K1yM9rkfhPmJ0HD8K1yM9j8L1PlHQGj8K1yM9uB4FP0As\nGT8K1yM9KVwPPzCIFz8K1yM9mpkZPx/kFT8K1yM9CtcjPw5AFD8K1yM9exQuP/6bEj8K1yM9\n7FE4P+33ED8K1yM9XI9CP9xTDz8K1yM9zcxMP8yvDT8K1yM9PQpXP7sLDD8K1yM9rkdhP6pn\nCj8K1yM9H4VrP5nDCD8K1yM9j8J1P4kfBz8K1yM9AACAP3h7BT8K1yM9AAAAAP1xKT8K16M9\nCtcjPezNJz8K16M9CtejPdspJj8K16M9j8L1PcuFJD8K16M9CtcjPrrhIj8K16M9zcxMPqk9\nIT8K16M9j8J1PpmZHz8K16M9KVyPPoj1HT8K16M9CtejPndRHD8K16M97FG4PmatGj8K16M9\nzczMPlYJGT8K16M9rkfhPkVlFz8K16M9j8L1PjTBFT8K16M9uB4FPyQdFD8K16M9KVwPPxN5\nEj8K16M9mpkZPwLVED8K16M9CtcjP/EwDz8K16M9exQuP+GMDT8K16M97FE4P9DoCz8K16M9\nXI9CP79ECj8K16M9zcxMP6+gCD8K16M9PQpXP578Bj8K16M9rkdhP41YBT8K16M9H4VrP320\nAz8K16M9j8J1P2wQAj8K16M9AACAP1tsAD8K16M9AAAAAOBiJD+PwvU9CtcjPc++Ij+PwvU9\nCtejPb4aIT+PwvU9j8L1Pa52Hz+PwvU9CtcjPp3SHT+PwvU9zcxMPowuHD+PwvU9j8J1PnyK\nGj+PwvU9KVyPPmvmGD+PwvU9CtejPlpCFz+PwvU97FG4PkqeFT+PwvU9zczMPjn6Ez+PwvU9\nrkfhPihWEj+PwvU9j8L1PheyED+PwvU9uB4FPwcODz+PwvU9KVwPP/ZpDT+PwvU9mpkZP+XF\nCz+PwvU9CtcjP9UhCj+PwvU9exQuP8R9CD+PwvU97FE4P7PZBj+PwvU9XI9CP6I1BT+PwvU9\nzcxMP5KRAz+PwvU9PQpXP4HtAT+PwvU9rkdhP3BJAD+PwvU9H4VrP79K/T6PwvU9j8J1P54C\n+j6PwvU9AACAP3y69j6PwvU9AAAAAMNTHz8K1yM+CtcjPbKvHT8K1yM+CtejPaILHD8K1yM+\nj8L1PZFnGj8K1yM+CtcjPoDDGD8K1yM+zcxMPm8fFz8K1yM+j8J1Pl97FT8K1yM+KVyPPk7X\nEz8K1yM+CtejPj0zEj8K1yM+7FG4Pi2PED8K1yM+zczMPhzrDj8K1yM+rkfhPgtHDT8K1yM+\nj8L1PvuiCz8K1yM+uB4FP+r+CT8K1yM+KVwPP9laCD8K1yM+mpkZP8i2Bj8K1yM+CtcjP7gS\nBT8K1yM+exQuP6duAz8K1yM+7FE4P5bKAT8K1yM+XI9CP4YmAD8K1yM+zcxMP+oE/T4K1yM+\nPQpXP8i8+T4K1yM+rkdhP6d09j4K1yM+H4VrP4Ys8z4K1yM+j8J1P2Tk7z4K1yM+AACAP0Oc\n7D4K1yM+AAAAAKZEGj/NzEw+CtcjPZWgGD/NzEw+CtejPYX8Fj/NzEw+j8L1PXRYFT/NzEw+\nCtcjPmO0Ez/NzEw+zcxMPlMQEj/NzEw+j8J1PkJsED/NzEw+KVyPPjHIDj/NzEw+CtejPiAk\nDT/NzEw+7FG4PhCACz/NzEw+zczMPv/bCT/NzEw+rkfhPu43CD/NzEw+j8L1Pt6TBj/NzEw+\nuB4FP83vBD/NzEw+KVwPP7xLAz/NzEw+mpkZP6ynAT/NzEw+CtcjP5sDAD/NzEw+exQuPxS/\n/D7NzEw+7FE4P/N2+T7NzEw+XI9CP9Eu9j7NzEw+zcxMP7Dm8j7NzEw+PQpXP4+e7z7NzEw+\nrkdhP21W7D7NzEw+H4VrP0wO6T7NzEw+j8J1PyrG5T7NzEw+AACAPwl+4j7NzEw+AAAAAIk1\nFT+PwnU+CtcjPXmREz+PwnU+CtejPWjtET+PwnU+j8L1PVdJED+PwnU+CtcjPkalDj+PwnU+\nzcxMPjYBDT+PwnU+j8J1PiVdCz+PwnU+KVyPPhS5CT+PwnU+CtejPgQVCD+PwnU+7FG4PvNw\nBj+PwnU+zczMPuLMBD+PwnU+rkfhPtEoAz+PwnU+j8L1PsGEAT+PwnU+uB4FP2DB/z6PwnU+\nKVwPPz95/D6PwnU+mpkZPx0x+T6PwnU+CtcjP/zo9T6PwnU+exQuP9ug8j6PwnU+7FE4P7lY\n7z6PwnU+XI9CP5gQ7D6PwnU+zcxMP3bI6D6PwnU+PQpXP1WA5T6PwnU+rkdhPzM44j6PwnU+\nH4VrPxLw3j6PwnU+j8J1P/Gn2z6PwnU+AACAP89f2D6PwnU+AAAAAGwmED8pXI8+CtcjPVyC\nDj8pXI8+CtejPUveDD8pXI8+j8L1PTo6Cz8pXI8+CtcjPiqWCT8pXI8+zcxMPhnyBz8pXI8+\nj8J1PghOBj8pXI8+KVyPPvepBD8pXI8+CtejPucFAz8pXI8+7FG4PtZhAT8pXI8+zczMPot7\n/z4pXI8+rkfhPmkz/D4pXI8+j8L1Pkjr+D4pXI8+uB4FPyaj9T4pXI8+KVwPPwVb8j4pXI8+\nmpkZP+QS7z4pXI8+CtcjP8LK6z4pXI8+exQuP6GC6D4pXI8+7FE4P3865T4pXI8+XI9CP17y\n4T4pXI8+zcxMPz2q3j4pXI8+PQpXPxti2z4pXI8+rkdhP/oZ2D4pXI8+H4VrP9jR1D4pXI8+\nj8J1P7eJ0T4pXI8+AACAP5ZBzj4pXI8+AAAAAFAXCz8K16M+CtcjPT9zCT8K16M+CtejPS7P\nBz8K16M+j8L1PR0rBj8K16M+CtcjPg2HBD8K16M+zcxMPvziAj8K16M+j8J1Pus+AT8K16M+\nKVyPPrU1/z4K16M+CtejPpTt+z4K16M+7FG4PnKl+D4K16M+zczMPlFd9T4K16M+rkfhPjAV\n8j4K16M+j8L1Pg7N7j4K16M+uB4FP+2E6z4K16M+KVwPP8s86D4K16M+mpkZP6r05D4K16M+\nCtcjP4is4T4K16M+exQuP2dk3j4K16M+7FE4P0Yc2z4K16M+XI9CPyTU1z4K16M+zcxMPwOM\n1D4K16M+PQpXP+FD0T4K16M+rkdhP8D7zT4K16M+H4VrP5+zyj4K16M+j8J1P31rxz4K16M+\nAACAP1wjxD4K16M+AAAAADMIBj/sUbg+CtcjPSJkBD/sUbg+CtejPRHAAj/sUbg+j8L1PQEc\nAT/sUbg+CtcjPuDv/j7sUbg+zcxMPr6n+z7sUbg+j8J1Pp1f+D7sUbg+KVyPPnsX9T7sUbg+\nCtejPlrP8T7sUbg+7FG4PjmH7j7sUbg+zczMPhc/6z7sUbg+rkfhPvb25z7sUbg+j8L1PtSu\n5D7sUbg+uB4FP7Nm4T7sUbg+KVwPP5Ie3j7sUbg+mpkZP3DW2j7sUbg+CtcjP0+O1z7sUbg+\nexQuPy1G1D7sUbg+7FE4Pwz+0D7sUbg+XI9CP+q1zT7sUbg+zcxMP8ltyj7sUbg+PQpXP6gl\nxz7sUbg+rkdhP4bdwz7sUbg+H4VrP2WVwD7sUbg+j8J1P0NNvT7sUbg+AACAPyIFuj7sUbg+\nAAAAABb5AD/NzMw+CtcjPQqq/j7NzMw+CtejPelh+z7NzMw+j8L1PccZ+D7NzMw+CtcjPqbR\n9D7NzMw+zcxMPoSJ8T7NzMw+j8J1PmNB7j7NzMw+KVyPPkL56j7NzMw+CtejPiCx5z7NzMw+\n7FG4Pv9o5D7NzMw+zczMPt0g4T7NzMw+rkfhPrzY3T7NzMw+j8L1PpuQ2j7NzMw+uB4FP3lI\n1z7NzMw+KVwPP1gA1D7NzMw+mpkZPza40D7NzMw+CtcjPxVwzT7NzMw+exQuP/Qnyj7NzMw+\n7FE4P9Lfxj7NzMw+XI9CP7GXwz7NzMw+zcxMP49PwD7NzMw+PQpXP24HvT7NzMw+rkdhP02/\nuT7NzMw+H4VrPyt3tj7NzMw+j8J1Pwovsz7NzMw+AACAP+jmrz7NzMw+AAAAAPLT9z6uR+E+\nCtcjPdCL9D6uR+E+CtejPa9D8T6uR+E+j8L1PY777T6uR+E+CtcjPmyz6j6uR+E+zcxMPktr\n5z6uR+E+j8J1Pikj5D6uR+E+KVyPPgjb4D6uR+E+CtejPueS3T6uR+E+7FG4PsVK2j6uR+E+\nzczMPqQC1z6uR+E+rkfhPoK60z6uR+E+j8L1PmFy0D6uR+E+uB4FPz8qzT6uR+E+KVwPPx7i\nyT6uR+E+mpkZP/2Zxj6uR+E+CtcjP9tRwz6uR+E+exQuP7oJwD6uR+E+7FE4P5jBvD6uR+E+\nXI9CP3d5uT6uR+E+zcxMP1Yxtj6uR+E+PQpXPzTpsj6uR+E+rkdhPxOhrz6uR+E+H4VrP/FY\nrD6uR+E+j8J1P9AQqT6uR+E+AACAP6/IpT6uR+E+AAAAALi17T6PwvU+CtcjPZdt6j6PwvU+\nCtejPXUl5z6PwvU+j8L1PVTd4z6PwvU+CtcjPjKV4D6PwvU+zcxMPhFN3T6PwvU+j8J1PvAE\n2j6PwvU+KVyPPs681j6PwvU+CtejPq100z6PwvU+7FG4Poss0D6PwvU+zczMPmrkzD6PwvU+\nrkfhPkmcyT6PwvU+j8L1PidUxj6PwvU+uB4FPwYMwz6PwvU+KVwPP+TDvz6PwvU+mpkZP8N7\nvD6PwvU+CtcjP6EzuT6PwvU+exQuP4DrtT6PwvU+7FE4P1+jsj6PwvU+XI9CPz1brz6PwvU+\nzcxMPxwTrD6PwvU+PQpXP/rKqD6PwvU+rkdhP9mCpT6PwvU+H4VrP7g6oj6PwvU+j8J1P5by\nnj6PwvU+AACAP3Wqmz6PwvU+AAAAAH6X4z64HgU/CtcjPV1P4D64HgU/CtejPTsH3T64HgU/\nj8L1PRq/2T64HgU/CtcjPvl21j64HgU/zcxMPtcu0z64HgU/j8J1Prbmzz64HgU/KVyPPpSe\nzD64HgU/CtejPnNWyT64HgU/7FG4PlIOxj64HgU/zczMPjDGwj64HgU/rkfhPg9+vz64HgU/\nj8L1Pu01vD64HgU/uB4FP8ztuD64HgU/KVwPP6ultT64HgU/mpkZP4ldsj64HgU/CtcjP2gV\nrz64HgU/exQuP0bNqz64HgU/7FE4PyWFqD64HgU/XI9CPwQ9pT64HgU/zcxMP+L0oT64HgU/\nPQpXP8Gsnj64HgU/rkdhP59kmz64HgU/H4VrP34cmD64HgU/j8J1P1zUlD64HgU/AACAPzuM\nkT64HgU/AAAAAEV52T4pXA8/CtcjPSMx1j4pXA8/CtejPQLp0j4pXA8/j8L1PeCgzz4pXA8/\nCtcjPr9YzD4pXA8/zcxMPp4QyT4pXA8/j8J1PnzIxT4pXA8/KVyPPluAwj4pXA8/CtejPjk4\nvz4pXA8/7FG4Phjwuz4pXA8/zczMPvanuD4pXA8/rkfhPtVftT4pXA8/j8L1PrQXsj4pXA8/\nuB4FP5LPrj4pXA8/KVwPP3GHqz4pXA8/mpkZP08/qD4pXA8/CtcjPy73pD4pXA8/exQuPw2v\noT4pXA8/7FE4P+tmnj4pXA8/XI9CP8oemz4pXA8/zcxMP6jWlz4pXA8/PQpXP4eOlD4pXA8/\nrkdhP2ZGkT4pXA8/H4VrP0T+jT4pXA8/j8J1PyO2ij4pXA8/AACAPwFuhz4pXA8/AAAAAAtb\nzz6amRk/CtcjPekSzD6amRk/CtejPcjKyD6amRk/j8L1PaeCxT6amRk/CtcjPoU6wj6amRk/\nzcxMPmTyvj6amRk/j8J1PkKquz6amRk/KVyPPiFiuD6amRk/CtejPgAatT6amRk/7FG4Pt7R\nsT6amRk/zczMPr2Jrj6amRk/rkfhPptBqz6amRk/j8L1Pnr5pz6amRk/uB4FP1ixpD6amRk/\nKVwPPzdpoT6amRk/mpkZPxYhnj6amRk/CtcjP/TYmj6amRk/exQuP9OQlz6amRk/7FE4P7FI\nlD6amRk/XI9CP5AAkT6amRk/zcxMP2+4jT6amRk/PQpXP01wij6amRk/rkdhPywohz6amRk/\nH4VrPwrggz6amRk/j8J1P+mXgD6amRk/AACAP4+fej6amRk/AAAAANE8xT4K1yM/CtcjPbD0\nwT4K1yM/CtejPY6svj4K1yM/j8L1PW1kuz4K1yM/CtcjPkscuD4K1yM/zcxMPirUtD4K1yM/\nj8J1PgmMsT4K1yM/KVyPPudDrj4K1yM/CtejPsb7qj4K1yM/7FG4PqSzpz4K1yM/zczMPoNr\npD4K1yM/rkfhPmIjoT4K1yM/j8L1PkDbnT4K1yM/uB4FPx+Tmj4K1yM/KVwPP/1Klz4K1yM/\nmpkZP9wClD4K1yM/CtcjP7u6kD4K1yM/exQuP5lyjT4K1yM/7FE4P3gqij4K1yM/XI9CP1bi\nhj4K1yM/zcxMPzWagz4K1yM/PQpXPxNSgD4K1yM/rkdhP+QTej4K1yM/H4VrP6GDcz4K1yM/\nj8J1P17zbD4K1yM/AACAPxxjZj4K1yM/AAAAAJceuz57FC4/CtcjPXbWtz57FC4/CtejPVWO\ntD57FC4/j8L1PTNGsT57FC4/CtcjPhL+rT57FC4/zcxMPvC1qj57FC4/j8J1Ps9tpz57FC4/\n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\nKFwPPilcDz4XHRw/KFwPPutROD4GeRo/KFwPPq5HYT721Bg/KFwPPrgehT7mMBc/KFwPPpqZ\nmT7UjBU/KFwPPnsUrj7D6BM/KFwPPlyPwj6zRBI/KFwPPj4K1z6ioBA/KFwPPh6F6z6S/A4/\nKFwPPgAAAD+AWA0/KFwPPnA9Cj9wtAs/KFwPPuJ6FD9fEAo/KFwPPlK4Hj9ObAg/KFwPPsL1\nKD8+yAY/KFwPPjQzMz8uJAU/KFwPPqRwPT8cgAM/KFwPPhSuRz8M3AE/KFwPPoXrUT/7NwA/\nKFwPPvYoXD/UJ/0+KFwPPmZmZj+03/k+KFwPPtejcD+Rl/Y+KFwPPkjhej9xT/M+KFwPPgrX\nozws+hs/61E4Po/CdT0bVho/61E4PszMzD0Lshg/61E4PilcDz76DRc/61E4PutROD7qaRU/\n61E4Pq5HYT7YxRM/61E4PrgehT7IIRI/61E4PpqZmT63fRA/61E4PnsUrj6m2Q4/61E4PlyP\nwj6WNQ0/61E4Pj4K1z6GkQs/61E4Ph6F6z507Qk/61E4PgAAAD9kSQg/61E4PnA9Cj9TpQY/\n61E4PuJ6FD9CAQU/61E4PlK4Hj8yXQM/61E4PsL1KD8iuQE/61E4PjQzMz8QFQA/61E4PqRw\nPT//4fw+61E4PhSuRz/emfk+61E4PoXrUT+8UfY+61E4PvYoXD+bCfM+61E4PmZmZj95we8+\n61E4PtejcD9Yeew+61E4Pkjhej82Mek+61E4PgrXozwP6xY/rkdhPo/CdT3/RhU/rkdhPszM\nzD3uohM/rkdhPilcDz7e/hE/rkdhPutROD7MWhA/rkdhPq5HYT68tg4/rkdhPrgehT6rEg0/\nrkdhPpqZmT6abgs/rkdhPnsUrj6Kygk/rkdhPlyPwj56Jgg/rkdhPj4K1z5oggY/rkdhPh6F\n6z5X3gQ/rkdhPgAAAD9HOgM/rkdhPnA9Cj82lgE/rkdhPuJ6FD9L5P8+rkdhPlK4Hj8qnPw+\nrkdhPsL1KD8JVPk+rkdhPjQzMz/nC/Y+rkdhPqRwPT/Fw/I+rkdhPhSuRz+ke+8+rkdhPoXr\nUT+DM+w+rkdhPvYoXD9h6+g+rkdhPmZmZj9Ao+U+rkdhPtejcD8eW+I+rkdhPkjhej/9Et8+\nrkdhPgrXozzy2xE/uB6FPo/CdT3iNxA/uB6FPszMzD3Skw4/uB6FPilcDz7A7ww/uB6FPutR\nOD6wSws/uB6FPq5HYT6fpwk/uB6FPrgehT6OAwg/uB6FPpqZmT5+XwY/uB6FPnsUrj5uuwQ/\nuB6FPlyPwj5cFwM/uB6FPj4K1z5McwE/uB6FPh6F6z51nv8+uB6FPgAAAD9UVvw+uB6FPnA9\nCj8zDvk+uB6FPuJ6FD8RxvU+uB6FPlK4Hj/wffI+uB6FPsL1KD/ONe8+uB6FPjQzMz+t7es+\nuB6FPqRwPT+Mpeg+uB6FPhSuRz9qXeU+uB6FPoXrUT9JFeI+uB6FPvYoXD8ozd4+uB6FPmZm\nZj8Ghds+uB6FPtejcD/lPNg+uB6FPkjhej/E9NQ+uB6FPgrXozzWzAw/mpmZPo/CdT3GKAs/\nmpmZPszMzD20hAk/mpmZPilcDz6j4Ac/mpmZPutROD6TPAY/mpmZPq5HYT6CmAQ/mpmZPrge\nhT5y9AI/mpmZPpqZmT5gUAE/mpmZPnsUrj6gWP8+mpmZPlyPwj5+EPw+mpmZPj4K1z5dyPg+\nmpmZPh6F6z48gPU+mpmZPgAAAD8aOPI+mpmZPnA9Cj/57+4+mpmZPuJ6FD/Yp+s+mpmZPlK4\nHj+2X+g+mpmZPsL1KD+VF+U+mpmZPjQzMz90z+E+mpmZPqRwPT9Rh94+mpmZPhSuRz8xP9s+\nmpmZPoXrUT8P99c+mpmZPvYoXD/trtQ+mpmZPmZmZj/MZtE+mpmZPtejcD+rHs4+mpmZPkjh\nej+J1so+mpmZPgrXozy6vQc/exSuPo/CdT2oGQY/exSuPszMzD2XdQQ/exSuPilcDz6H0QI/\nexSuPutROD52LQE/exSuPq5HYT7LEv8+exSuPrgehT6pyvs+exSuPpqZmT6Igvg+exSuPnsU\nrj5mOvU+exSuPlyPwj5F8vE+exSuPj4K1z4kqu4+exSuPh6F6z4CYus+exSuPgAAAD/hGeg+\nexSuPnA9Cj/A0eQ+exSuPuJ6FD+eieE+exSuPlK4Hj98Qd4+exSuPsL1KD9b+do+exSuPjQz\nMz85sdc+exSuPqRwPT8YadQ+exSuPhSuRz/2INE+exSuPoXrUT/V2M0+exSuPvYoXD+0kMo+\nexSuPmZmZj+TSMc+exSuPtejcD9xAMQ+exSuPkjhej9QuMA+exSuPgrXozycrgI/XI/CPo/C\ndT2LCgE/XI/CPszMzD31zP4+XI/CPilcDz7UhPs+XI/CPutROD6yPPg+XI/CPq5HYT6R9PQ+\n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\nCj9G3AU+SOF6P+J6FD8ImP49SOF6P1K4Hj+Bd/E9SOF6P8L1KD/8VuQ9SOF6PzQzMz92Ntc9\nSOF6P6RwPT/wFco9SOF6PxSuRz9r9bw9SOF6P4XrUT/m1K89SOF6P/YoXD9ftKI9SOF6P2Zm\nZj/ak5U9SOF6P9ejcD9Uc4g9SOF6P0jhej+dpXY9SOF6PwAAAAA17i8/TjbZPgAAAABW0Ps+\nTjbZPtmJnT1kwOE+97cWPtmJnT3Uyh0/97cWPsVObD4gjv8+8xPiPsVObD4fgOQ+8xPiPtmJ\nnT1alBs/mPHqPtmJnT0Vvuw+mPHqPgAAAABr4HE/YO8YPwAAAAA9A9A+YO8YPwAAAADNmrg+\nUtoNPwAAAACD9to+UtoNP9mJHT7UuL8+UtoNP9mJHT4+V84+UtoNP9mJnT25wec+Ivc3P9mJ\nnT1vCqs+Ivc3P9mJnT0EEtE9M14dP9mJnT1LUsU+M14dP9mJnT13FmU+t21bP9mJnT31/4c+\nt21bP9mJnT0KrxM+uJZIP9mJnT2GnZo+uJZIPwAAAAAKrxM+RMUCPwAAAADK6eU+RMUCP9mJ\nHT4HHgc/UIgzP9mJHT4cHKk+UIgzPwAAAADNmrg+UtoNPwAAAACD9to+UtoNP9mJHT7UuL8+\nUtoNP9mJHT4+V84+UtoNP9mJnT6iV4o+py9jP9mJnT6EzVo+py9jP9mJnT4AAgk9AACAP9mJ\nnT593CE+AACAP8VObD5yf70+bbLJPsVObD65i/A+bbLJPsVO7D6M99k949VpP8VO7D4LazQ+\n49VpP9mJHT4AAAAA51CxPtmJHT57cwE/51CxPtmJHT7IA5E+y08IP9mJHT7h0NM+y08IP8VO\nbD7h9E0/IKVdPsVObD6TuA4/IKVdPtmJHT5gsBk/rfyEPtmJHT7BZgw/rfyEPk/sxD7Potw+\nXp0+Pk/sxD4VPgw/Xp0+PhQ7MT+k4PI+joCUPhQ7MT/E9eQ+joCUPsVObD4AAIA/Pc/zPsVO\nbD6Avds+Pc/zPgD///8A/////wD///8A//8A////AP///wD///8A////AP///wD/////AP//\n/wD///8A////AP//AP///wD/////AP///wD///8A////AP///wD///8A////AP///wD//wD/\n//8A/////wD///8A////AP///wD//wD///8A/////wD///8A////AP///wD///8A////AP//\n/wD///8A////AP///wD//wD///8A////AP///wD/////AP///wD//wD///8A////AP///wD/\n//8AAAAAMOsWP0422T7ZiZ09g1UHP/e3Fj7FTmw+IAfyPvMT4j7ZiZ09svkIP5jx6j4AAAAA\nBfEsP2DvGD8AAAAAqMjJPlLaDT/ZiR0+CQjHPlLaDT/ZiZ09FGbJPiL3Nz/ZiZ09zJZ5PjNe\nHT/ZiZ09MIt6PrdtWz/ZiZ09C3VkPriWSD8AAAAAqOCXPkTFAj/ZiR0+FazbPlCIMz8AAAAA\nqMjJPlLaDT/ZiR0+CQjHPlLaDT/ZiZ0+ZL53PqcvYz/ZiZ0+/RzEPQAAgD/FTmw+lgXXPm2y\nyT7FTuw+aLMQPuPVaT/ZiR0+e3OBPudQsT7ZiR0+VGqyPstPCD/FTmw+ulYuPyClXT7ZiR0+\nkAsTP638hD5P7MQ+fI/6Pl6dPj4UOzE/NOvrPo6AlD7FTmw+YO82Pz3P8z6ZmJg+mZiYPpmY\nmD4AAIA/AAAAAQEBAQAAAAEBAQEAAAA="}]},"context":{"shiny":false,"rmarkdown":"bookdown::gitbook"},"vertexShader":"#line 2 1\n// File 1 is the vertex shader\n#ifdef GL_ES\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n#endif\n\nattribute vec3 aPos;\nattribute vec4 aCol;\nuniform mat4 mvMatrix;\nuniform mat4 prMatrix;\nvarying vec4 vCol;\nvarying vec4 vPosition;\n\n#ifdef NEEDS_VNORMAL\nattribute vec3 aNorm;\nuniform mat4 normMatrix;\nvarying vec4 vNormal;\n#endif\n\n#if defined(HAS_TEXTURE) || defined (IS_TEXT)\nattribute vec2 aTexcoord;\nvarying vec2 vTexcoord;\n#endif\n\n#ifdef FIXED_SIZE\nuniform vec3 textScale;\n#endif\n\n#ifdef FIXED_QUADS\nattribute vec3 aOfs;\n#endif\n\n#ifdef IS_TWOSIDED\n#ifdef HAS_NORMALS\nvarying float normz;\nuniform mat4 invPrMatrix;\n#else\nattribute vec3 aPos1;\nattribute vec3 aPos2;\nvarying float normz;\n#endif\n#endif // IS_TWOSIDED\n\n#ifdef FAT_LINES\nattribute vec3 aNext;\nattribute vec2 aPoint;\nvarying vec2 vPoint;\nvarying float vLength;\nuniform float uAspect;\nuniform float uLwd;\n#endif\n\n#ifdef USE_ENVMAP\nvarying vec3 vReflection;\n#endif\n\nvoid main(void) {\n  \n#ifndef IS_BRUSH\n#if defined(NCLIPPLANES) || !defined(FIXED_QUADS) || defined(HAS_FOG) || defined(USE_ENVMAP)\n  vPosition = mvMatrix * vec4(aPos, 1.);\n#endif\n  \n#ifndef FIXED_QUADS\n  gl_Position = prMatrix * vPosition;\n#endif\n#endif // !IS_BRUSH\n  \n#ifdef IS_POINTS\n  gl_PointSize = POINTSIZE;\n#endif\n  \n  vCol = aCol;\n  \n// USE_ENVMAP implies NEEDS_VNORMAL\n\n#ifdef NEEDS_VNORMAL\n  vNormal = normMatrix * vec4(-aNorm, dot(aNorm, aPos));\n#endif\n\n#ifdef USE_ENVMAP\n  vReflection = normalize(reflect(vPosition.xyz/vPosition.w, \n                        normalize(vNormal.xyz/vNormal.w)));\n#endif\n  \n#ifdef IS_TWOSIDED\n#ifdef HAS_NORMALS\n  /* normz should be calculated *after* projection */\n  normz = (invPrMatrix*vNormal).z;\n#else\n  vec4 pos1 = prMatrix*(mvMatrix*vec4(aPos1, 1.));\n  pos1 = pos1/pos1.w - gl_Position/gl_Position.w;\n  vec4 pos2 = prMatrix*(mvMatrix*vec4(aPos2, 1.));\n  pos2 = pos2/pos2.w - gl_Position/gl_Position.w;\n  normz = pos1.x*pos2.y - pos1.y*pos2.x;\n#endif\n#endif // IS_TWOSIDED\n  \n#ifdef NEEDS_VNORMAL\n  vNormal = vec4(normalize(vNormal.xyz), 1);\n#endif\n  \n#if defined(HAS_TEXTURE) || defined(IS_TEXT)\n  vTexcoord = aTexcoord;\n#endif\n  \n#if defined(FIXED_SIZE) && !defined(ROTATING)\n  vec4 pos = prMatrix * mvMatrix * vec4(aPos, 1.);\n  pos = pos/pos.w;\n  gl_Position = pos + vec4(aOfs*textScale, 0.);\n#endif\n  \n#if defined(IS_SPRITES) && !defined(FIXED_SIZE)\n  vec4 pos = mvMatrix * vec4(aPos, 1.);\n  pos = pos/pos.w + vec4(aOfs,  0.);\n  gl_Position = prMatrix*pos;\n#endif\n  \n#ifdef FAT_LINES\n  /* This code was inspired by Matt Deslauriers' code in \n   https://mattdesl.svbtle.com/drawing-lines-is-hard */\n  vec2 aspectVec = vec2(uAspect, 1.0);\n  mat4 projViewModel = prMatrix * mvMatrix;\n  vec4 currentProjected = projViewModel * vec4(aPos, 1.0);\n  currentProjected = currentProjected/currentProjected.w;\n  vec4 nextProjected = projViewModel * vec4(aNext, 1.0);\n  vec2 currentScreen = currentProjected.xy * aspectVec;\n  vec2 nextScreen = (nextProjected.xy / nextProjected.w) * aspectVec;\n  float len = uLwd;\n  vec2 dir = vec2(1.0, 0.0);\n  vPoint = aPoint;\n  vLength = length(nextScreen - currentScreen)/2.0;\n  vLength = vLength/(vLength + len);\n  if (vLength > 0.0) {\n    dir = normalize(nextScreen - currentScreen);\n  }\n  vec2 normal = vec2(-dir.y, dir.x);\n  dir.x /= uAspect;\n  normal.x /= uAspect;\n  vec4 offset = vec4(len*(normal*aPoint.x*aPoint.y - dir), 0.0, 0.0);\n  gl_Position = currentProjected + offset;\n#endif\n  \n#ifdef IS_BRUSH\n  gl_Position = vec4(aPos, 1.);\n#endif\n}","fragmentShader":"#line 2 2\n// File 2 is the fragment shader\n#ifdef GL_ES\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n#endif\nvarying vec4 vCol; // carries alpha\nvarying vec4 vPosition;\n#if defined(HAS_TEXTURE) || defined (IS_TEXT)\nvarying vec2 vTexcoord;\nuniform sampler2D uSampler;\n#endif\n\n#ifdef HAS_FOG\nuniform int uFogMode;\nuniform vec3 uFogColor;\nuniform vec4 uFogParms;\n#endif\n\n#if defined(IS_LIT) && !defined(FIXED_QUADS)\nvarying vec4 vNormal;\n#endif\n\n#if NCLIPPLANES > 0\nuniform vec4 vClipplane[NCLIPPLANES];\n#endif\n\n#if NLIGHTS > 0\nuniform mat4 mvMatrix;\n#endif\n\n#ifdef IS_LIT\nuniform vec3 emission;\nuniform float shininess;\n#if NLIGHTS > 0\nuniform vec3 ambient[NLIGHTS];\nuniform vec3 specular[NLIGHTS]; // light*material\nuniform vec3 diffuse[NLIGHTS];\nuniform vec3 lightDir[NLIGHTS];\nuniform bool viewpoint[NLIGHTS];\nuniform bool finite[NLIGHTS];\n#endif\n#endif // IS_LIT\n\n#ifdef IS_TWOSIDED\nuniform bool front;\nvarying float normz;\n#endif\n\n#ifdef FAT_LINES\nvarying vec2 vPoint;\nvarying float vLength;\n#endif\n\n#ifdef USE_ENVMAP\nvarying vec3 vReflection;\n#endif\n\nvoid main(void) {\n  vec4 fragColor;\n#ifdef FAT_LINES\n  vec2 point = vPoint;\n  bool neg = point.y < 0.0;\n  point.y = neg ? (point.y + vLength)/(1.0 - vLength) :\n                 -(point.y - vLength)/(1.0 - vLength);\n#if defined(IS_TRANSPARENT) && defined(IS_LINESTRIP)\n  if (neg && length(point) <= 1.0) discard;\n#endif\n  point.y = min(point.y, 0.0);\n  if (length(point) > 1.0) discard;\n#endif // FAT_LINES\n  \n#ifdef ROUND_POINTS\n  vec2 coord = gl_PointCoord - vec2(0.5);\n  if (length(coord) > 0.5) discard;\n#endif\n  \n#if NCLIPPLANES > 0\n  for (int i = 0; i < NCLIPPLANES; i++)\n    if (dot(vPosition, vClipplane[i]) < 0.0) discard;\n#endif\n    \n#ifdef FIXED_QUADS\n    vec3 n = vec3(0., 0., 1.);\n#elif defined(IS_LIT)\n    vec3 n = normalize(vNormal.xyz);\n#endif\n    \n#ifdef IS_TWOSIDED\n    if ((normz <= 0.) != front) discard;\n#endif\n\n#ifdef IS_LIT\n    vec3 eye = normalize(-vPosition.xyz/vPosition.w);\n    vec3 lightdir;\n    vec4 colDiff;\n    vec3 halfVec;\n    vec4 lighteffect = vec4(emission, 0.);\n    vec3 col;\n    float nDotL;\n#ifdef FIXED_QUADS\n    n = -faceforward(n, n, eye);\n#endif\n    \n#if NLIGHTS > 0\n    // Simulate two-sided lighting\n    if (n.z < 0.0)\n      n = -n;\n    for (int i=0;i<NLIGHTS;i++) {\n      colDiff = vec4(vCol.rgb * diffuse[i], vCol.a);\n      lightdir = lightDir[i];\n      if (!viewpoint[i]) {\n        if (finite[i]) {\n          lightdir = (mvMatrix * vec4(lightdir, 1.)).xyz;\n        } else {\n          lightdir = (mvMatrix * vec4(lightdir, 0.)).xyz;\n        }\n      }\n      if (!finite[i]) {\n        halfVec = normalize(lightdir + eye);\n      } else {\n        lightdir = normalize(lightdir - vPosition.xyz/vPosition.w);\n        halfVec = normalize(lightdir + eye);\n      }\n      col = ambient[i];\n      nDotL = dot(n, lightdir);\n      col = col + max(nDotL, 0.) * colDiff.rgb;\n      col = col + pow(max(dot(halfVec, n), 0.), shininess) * specular[i];\n      lighteffect = lighteffect + vec4(col, colDiff.a);\n    }\n#endif\n    \n#else // not IS_LIT\n    vec4 colDiff = vCol;\n    vec4 lighteffect = colDiff;\n#endif\n    \n#ifdef IS_TEXT\n    vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);\n#endif\n    \n#ifdef HAS_TEXTURE\n\n// These calculations use the definitions from \n// https://docs.gl/gl3/glTexEnv\n\n#ifdef USE_ENVMAP\n    float m = 2.0 * sqrt(dot(vReflection, vReflection) + 2.0*vReflection.z + 1.0);\n    vec4 textureColor = texture2D(uSampler, vReflection.xy / m + vec2(0.5, 0.5));\n#else\n    vec4 textureColor = texture2D(uSampler, vTexcoord);\n#endif\n\n#ifdef TEXTURE_rgb\n\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(textureColor.rgb, lighteffect.a);\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = lighteffect*vec4(textureColor.rgb, 1.);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - textureColor.rgb) * lighteffect.rgb, lighteffect.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(lighteffect.rgb + textureColor.rgb, lighteffect.a);\n#endif\n\n#endif //TEXTURE_rgb\n        \n#ifdef TEXTURE_rgba\n\n#ifdef TEXMODE_replace\n// already done\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = lighteffect*textureColor;\n#endif\n\n#ifdef TEXMODE_decal\n    textureColor = vec4((1. - textureColor.a)*lighteffect.rgb) +\n                     textureColor.a*textureColor.rgb, \n                     lighteffect.a);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - textureColor.rgb) * lighteffect.rgb,\n                    lighteffect.a*textureColor.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(lighteffect.rgb + textureColor.rgb,\n                    lighteffect.a*textureColor.a);\n#endif\n    \n#endif //TEXTURE_rgba\n    \n#ifdef TEXTURE_alpha\n    float luminance = dot(vec3(1.,1.,1.),textureColor.rgb)/3.;\n\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(lighteffect.rgb, luminance);\n#endif \n\n#if defined(TEXMODE_modulate) || defined(TEXMODE_blend) || defined(TEXMODE_add)\n    textureColor = vec4(lighteffect.rgb, lighteffect.a*luminance);\n#endif\n \n#endif // TEXTURE_alpha\n    \n// The TEXTURE_luminance values are not from that reference    \n#ifdef TEXTURE_luminance\n    float luminance = dot(vec3(1.,1.,1.),textureColor.rgb)/3.;\n\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(luminance, luminance, luminance, lighteffect.a);\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = vec4(luminance*lighteffect.rgb, lighteffect.a);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - luminance)*lighteffect.rgb,\n                        lighteffect.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(luminance + lighteffect.rgb, lighteffect.a);\n#endif\n\n#endif // TEXTURE_luminance\n \n    \n#ifdef TEXTURE_luminance_alpha\n    float luminance = dot(vec3(1.,1.,1.),textureColor.rgb)/3.;\n\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(luminance, luminance, luminance, textureColor.a);\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = vec4(luminance*lighteffect.rgb, \n                        textureColor.a*lighteffect.a);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - luminance)*lighteffect.rgb,\n                        textureColor.a*lighteffect.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(luminance + lighteffect.rgb, \n                        textureColor.a*lighteffect.a);\n\n#endif\n\n#endif // TEXTURE_luminance_alpha\n    \n    fragColor = textureColor;\n\n#elif defined(IS_TEXT)\n    if (textureColor.a < 0.1)\n      discard;\n    else\n      fragColor = textureColor;\n#else\n    fragColor = lighteffect;\n#endif // HAS_TEXTURE\n    \n#ifdef HAS_FOG\n    // uFogParms elements: x = near, y = far, z = fogscale, w = (1-sin(FOV/2))/(1+sin(FOV/2))\n    // In Exp and Exp2: use density = density/far\n    // fogF will be the proportion of fog\n    // Initialize it to the linear value\n    float fogF;\n    if (uFogMode > 0) {\n      fogF = (uFogParms.y - vPosition.z/vPosition.w)/(uFogParms.y - uFogParms.x);\n      if (uFogMode > 1)\n        fogF = mix(uFogParms.w, 1.0, fogF);\n      fogF = fogF*uFogParms.z;\n      if (uFogMode == 2)\n        fogF = 1.0 - exp(-fogF);\n      // Docs are wrong: use (density*c)^2, not density*c^2\n      // https://gitlab.freedesktop.org/mesa/mesa/-/blob/master/src/mesa/swrast/s_fog.c#L58\n      else if (uFogMode == 3)\n        fogF = 1.0 - exp(-fogF*fogF);\n      fogF = clamp(fogF, 0.0, 1.0);\n      gl_FragColor = vec4(mix(fragColor.rgb, uFogColor, fogF), fragColor.a);\n    } else gl_FragColor = fragColor;\n#else\n    gl_FragColor = fragColor;\n#endif // HAS_FOG\n    \n}","players":[],"webGLoptions":{"preserveDrawingBuffer":true}},"evals":[],"jsHooks":[]}</script><div class="figure" style="text-align: center">
<span style="display:block;" id="fig:figrgl"></span>
<img src="figure/minimal-figrgl-1.png" alt="A hand rotatable graphics object (within an **R** interactive or suitable PDF/HTML environment)." width="0" height="0"><p class="caption">
Figure 6.42: A hand rotatable graphics object (within an <strong>R</strong> interactive or suitable PDF/HTML environment).
</p>
</div>
<p>In the code above, a initial surface is created that considers all possible combinations of pH and N outcomes (Line 1) and actual occurrences of <code>varespec$Vaccviti</code> at <em>observed</em> combinations (Lines 3 and 4). The function <code>scatter3d()</code> in the package <em>car</em> uses tools from the <em>rgl</em> package to render a three dimensional scatterplot. The scatterplot will be rotatable within an <strong>R</strong> session, and can be rendered as a rotatable graphic in an <strong>R</strong> Markdown HTML<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;See &lt;code&gt;rgl::playwidget()&lt;/code&gt; if you you are reading this document as a pdf.&lt;/p&gt;"><sup>63</sup></a>. The form of the plot is shown in Fig <a href="ch6.html#fig:figrgl">6.42</a>, although its rotatability will require an interactive <strong>R</strong> environment or a ammenable HTML/PDF framework. Plots from <em>rgl</em> can also be rendered and manipulated in Shiny apps (see Ch <a href="ch11.html#ch11">11</a>).</p>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
<p>
</p>
</div>
<div id="exercises-5" class="section level2 unnumbered">
<h2>Exercises<a class="anchor" aria-label="anchor" href="#exercises-5"><i class="fas fa-link"></i></a>
</h2>
<ol style="list-style-type: decimal">
<li>Consider the variables: <code>x &lt;- c(1,2,2.5,3,4,3,5)</code> and <code>y &lt;- c(6,4.3,3,3.1,2,1.7,1)</code>.
<ol style="list-style-type: lower-alpha">
<li>Make a plot with <code>x</code> defining the <em>x</em>-axis and <code>y</code> on the <em>y</em>-axis.</li>
<li>Make every point in the scatterplot a different color.</li>
<li>Make every point a different shape.</li>
<li>Create a legend describing all the shape and color combinations of all points one through seven (call them Point 1, Point 2, etc.).</li>
<li>Convert from a point to an overplotted line and point plot.</li>
<li>Change the label of the <em>x</em>-axis to “<em>Abscissa</em> axis” and the label of the <em>y</em>-axis to be “<em>Ordinate</em> axis” using a <code>plotmath</code> approach. This will require use of the functions <code><a href="https://rdrr.io/r/base/expression.html">expression()</a></code>, <code><a href="https://rdrr.io/r/base/paste.html">paste()</a></code> and <code>italic()</code>.</li>
<li>Place the text “<em>y</em> = -1.203<em>x</em> + 6.539” at coordinates <code>x = 2</code>, <code>y = 2.5</code> using the function <code><a href="https://rdrr.io/r/graphics/text.html">text()</a></code>. Italicize as indicated.</li>
<li>Place a line with a slope of -1.203 and an <em>y</em>-intercept of 6.539 on the plot using the function <code><a href="https://rdrr.io/r/graphics/abline.html">abline()</a></code>.</li>
</ol>
</li>
<li>The <code>Indometh</code> dataframe from the package <em>datasets</em> describes pharmacokinetics of the drug indomethacin following intravenous injections for six human subjects.
<ol style="list-style-type: lower-alpha">
<li>Create a histogram for the variable <code>conc</code>, which gives plasma concentrations of indomethacin in (mcg/ml) in subjects over time. Use an appropriate <em>x</em>-axis label.</li>
<li>Create a scatterplot of <code>conc</code> as a function of <code>time</code> (in hours). Create appropriate axis labels.</li>
<li>Change symbols and colors of points in <strong>(b)</strong> based on levels in <code>Subject</code>.</li>
<li>Create a wide table format for <code>Indometh</code> using: <code>wide &lt;- unstack(Indometh, conc ~ Subject)</code> and <code>names(wide) &lt;- paste("Subject", c(1,4,2,5,6,3))</code>.</li>
<li>Create a stacked barplot and a side by side barplot based on: <code>barplot(as.matrix(wide))</code>.</li>
<li>Use appropriate <em>y</em>-axis labels.</li>
<li>Create a multiple line plot (with a line for each subject) using:
<code>time &lt;- c(0.25, 0.50, 0.75, 1.00, 1.25, 2.00, 3.00, 4.00, 5.00, 6.00, 8.00)</code> and <code>matplot(x = time, y = wide, type = "l")</code>
</li>
<li>Generate appropriate axis labels for the plot.</li>
<li>Create an appropriate legend for the plot created in (h). The colors and line types used by <code><a href="https://rdrr.io/r/graphics/matplot.html">matplot()</a></code> will be 1:6. The order of subjects is 1, 4, 2, 5, 6, 3.</li>
</ol>
</li>
<li>The dataframe <code>life.exp</code> from <em>asbio</em> compares life expectancy of field mice given five different diets.
<ol style="list-style-type: lower-alpha">
<li>Make and interpret a boxplot showing <code>lifespan</code> as a function of <code>treatment</code>.</li>
<li>Make an interval plot by hand showing <code>lifespan</code> as a function of <code>treatment</code> using means as measures of location, and standard deviations to generate error bars.</li>
</ol>
</li>
<li>(Advanced) Conduct an ANOVA and a <em>post hoc</em> pairwise comparison of means with Tukey’s HSD using: <code>anova(lm(lifespan ~ treatment, data = life.exp))</code>, <code>tukey &lt;- with(life.exp, pairw.anova(lifespan, treatment))</code>.
<ol style="list-style-type: lower-alpha">
<li>Create an interval plot summarizing these results using: <code>plot(tukey)</code>.</li>
<li>Interpret (a).</li>
</ol>
</li>
<li>Load the <code>C.isotope</code> dataframe from the package <em>asbio</em>. Using <code>par(mfrow())</code>, create a graphical device holding three plots in a single row, i.e., the three plots will be side by side.
<ol style="list-style-type: lower-alpha">
<li>In the first plot, show <span class="math inline">\(\delta ^{14}\)</span>C as a function of time (<code>decimal.date</code>) using a line plot. Use appropriate axis labels.</li>
<li>In the second plot, show CO<span class="math inline">\(_2\)</span> concentration as a function of time in a scatterplot.</li>
<li>In the third plot, show measurement precision (column four in the dataset) as a function of <span class="math inline">\(\delta ^{14}\)</span>C.</li>
</ol>
</li>
<li>Load the <code>goats</code> dataframe from package <em>asbio</em>.
<ol style="list-style-type: lower-alpha">
<li>Create a scatterplot of <code>NO3</code> as a function of <code>feces</code>.</li>
<li>Make a plot showing <code>NO3</code> and <code>organic.matter</code> as a simultaneous function of <code>feces</code> by adding a second <em>y</em>-axis.</li>
<li>Change symbol sizes in (a) to reflect the values in organic.matter.</li>
<li>Create a 3D scatterplot with <code><a href="https://rdrr.io/pkg/scatterplot3d/man/scatterplot3d.html">scatterplot3d::scatterplot3d</a></code>, depicting <code>NO3</code> as a function of <code>organic.matter</code> and <code>feces</code>.</li>
</ol>
</li>
</ol>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="ch5.html"><span class="header-section-number">5</span> Welcome to the Tidyverse</a></div>
<div class="next"><a href="ch7.html"><span class="header-section-number">7</span> Grid Graphics, Including ggplot2</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#ch6"><span class="header-section-number">6</span> Base Graphics</a></li>
<li><a class="nav-link" href="#introduction"><span class="header-section-number">6.1</span> Introduction</a></li>
<li>
<a class="nav-link" href="#simple-base-graphics-examples"><span class="header-section-number">6.2</span> Simple Base Graphics Examples</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#plot"><span class="header-section-number">6.2.1</span> plot()</a></li></ul>
</li>
<li><a class="nav-link" href="#graphical-devices"><span class="header-section-number">6.3</span> Graphical Devices</a></li>
<li><a class="nav-link" href="#par"><span class="header-section-number">6.4</span> par()</a></li>
<li><a class="nav-link" href="#exporting-graphics"><span class="header-section-number">6.5</span> Exporting Graphics</a></li>
<li>
<a class="nav-link" href="#text-points-and-lines"><span class="header-section-number">6.6</span> text(), points(), and lines()</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#plotting-mathematical-text"><span class="header-section-number">6.6.1</span> Plotting Mathematical Text</a></li>
<li><a class="nav-link" href="#mtext"><span class="header-section-number">6.6.2</span> mtext()</a></li>
</ul>
</li>
<li><a class="nav-link" href="#geometric-shapes"><span class="header-section-number">6.7</span> Geometric Shapes</a></li>
<li><a class="nav-link" href="#axis"><span class="header-section-number">6.8</span> axis()</a></li>
<li><a class="nav-link" href="#font-typefaces"><span class="header-section-number">6.9</span> Font Typefaces</a></li>
<li><a class="nav-link" href="#colors"><span class="header-section-number">6.10</span> Colors</a></li>
<li><a class="nav-link" href="#scatterplots"><span class="header-section-number">6.11</span> Scatterplots</a></li>
<li><a class="nav-link" href="#transformations"><span class="header-section-number">6.12</span> Transformations</a></li>
<li><a class="nav-link" href="#multiple-plots"><span class="header-section-number">6.13</span> Multiple Plots</a></li>
<li><a class="nav-link" href="#histograms"><span class="header-section-number">6.14</span> Histograms</a></li>
<li><a class="nav-link" href="#controlling-graphical-features-using-vectors"><span class="header-section-number">6.15</span> Controlling Graphical Features using Vectors</a></li>
<li><a class="nav-link" href="#secondary-axes"><span class="header-section-number">6.16</span> Secondary Axes</a></li>
<li><a class="nav-link" href="#barplots"><span class="header-section-number">6.17</span> Barplots</a></li>
<li>
<a class="nav-link" href="#boxplots"><span class="header-section-number">6.18</span> Boxplots</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#violin-plots"><span class="header-section-number">6.18.1</span> Violin Plots</a></li></ul>
</li>
<li>
<a class="nav-link" href="#interval-plots"><span class="header-section-number">6.19</span> Interval Plots</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#pairwise-comparisons"><span class="header-section-number">6.19.1</span> Pairwise Comparisons</a></li></ul>
</li>
<li><a class="nav-link" href="#matplot"><span class="header-section-number">6.20</span> matplot()</a></li>
<li><a class="nav-link" href="#interactivity"><span class="header-section-number">6.21</span> Interactivity</a></li>
<li><a class="nav-link" href="#three-dimensional-graphics"><span class="header-section-number">6.22</span> Three Dimensional Graphics</a></li>
<li><a class="nav-link" href="#animation"><span class="header-section-number">6.23</span> Animation</a></li>
<li><a class="nav-link" href="#exercises-5">Exercises</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>An Amalgam of R</strong>: A Primer and Reference for Biologists" was written by Ken Aho. It was last built on 2025-01-29.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
