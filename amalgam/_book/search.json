[{"path":"index.html","id":"preface","chapter":"Preface","heading":"Preface","text":"","code":""},{"path":"index.html","id":"what-this-book-is-about","chapter":"Preface","heading":"What this book is about","text":"book explores ever expanding universe R. Specifically, considers:historical development R language, R\nengine, installation R (Ch 1)historical development R language, R\nengine, installation R (Ch 1)creation R objects fundamental characteristics\n(Ch 2)creation R objects fundamental characteristics\n(Ch 2)R data storage entities, import export user data\nfiles (Ch 3)R data storage entities, import export user data\nfiles (Ch 3)Data management approaches using base R (Ch 4) tidyverse (Ch 5)Data management approaches using base R (Ch 4) tidyverse (Ch 5)R approaches graphics, including base plotting methods (Ch 6)\nggplot2 package (Ch 7)R approaches graphics, including base plotting methods (Ch 6)\nggplot2 package (Ch 7)R functions (Ch 8) including loops, creation \nuser-defined classes generic methodsR functions (Ch 8) including loops, creation \nuser-defined classes generic methodsInterfacing languages (e.g., C, Fortran, C++, Python) software\nenvironments R (Ch 9)Interfacing languages (e.g., C, Fortran, C++, Python) software\nenvironments R (Ch 9)Building custom R packages (Ch 10)Building custom R packages (Ch 10)R Interactive interfaces web applications including\napproaches packages tcltk, plotly shiny (Ch 11)R Interactive interfaces web applications including\napproaches packages tcltk, plotly shiny (Ch 11)fundamental ways R interacts computer (Ch 12)fundamental ways R interacts computer (Ch 12)book covers lot ground, clearly many topics \nconsidered. Subjects explored found \nparticularly useful interesting 20+ years using R biologist statistician. Chapters concerning advanced topics (.e., Chs 8-12) intended starting points exploration, reader directed additional resources necessary.book emphasizes R important computer language. ignored many phenologies computer languages (e.g., Boutin et al. 2002), R large, devoted following decades computational engine language can clearly linked seminal concepts advances computer science. , inception R tool metaprogramming wherein code shared modified programmatically. instance R wide variety widely used APIs languages like C, Fortran, C++, Java, Python, many others.Individuals natural sciences, particularly biologists, \nlikely find book useful individuals \nbackgrounds coding examples applications generally biological. Non-biologists may find, however, examples readily extend settings.","code":""},{"path":"index.html","id":"what-this-book-is-not-about","chapter":"Preface","heading":"What this book is not about","text":"Notably, although statistics primary focus/purpose R, \nprimary emphasis book statistics. Instead focus \nR language, characteristics, capabilities, \nextensions R system. take approach : 1)\ncoverage non-statistical topics challenging , \n2) responsible introduction statistical algorithms \nprogram language (including R) accompanied detailed\ninformation concerning statistical procedures. Many pedagogic resources exist statistical application R. include: Aho (2014) (pedagogic statistical companion book), Venables Ripley (2002), (Faraway 2004, 2016), Crawley (2012), Fox Weisberg (2019), among others. noted text focus inferential statistical methods, emphasize methods handling, summarizing displaying empirical data, steps serve companion prerequisite formal inferential analyses.","code":""},{"path":"index.html","id":"distinguishing-characteristics-of-this-book","chapter":"Preface","heading":"Distinguishing Characteristics of This Book","text":"Many sources emphasized fundamental programming aspects R, largely ignoring statistics, including seminal texts (e.g., Chambers 2008, 2020; Wickham 2016, 2021), definitive CRAN manuals (R Core Team 2024a, 2024b, 2024c), focused particular, potentially non-statistical R attributes, including graphics (Wickham 2016; Murrell 2019) web-based applications (Wickham 2021; Sievert 2020). book brave/foolish attempt amalgamize distill disparate information, occasionally emphasizing topics earlier works ignored. instance, Wickham (2019) admirably emphasizes many foundational advanced programming ideas R, thoroughly consider important programming extensions, including powerful syntheses Python Tcl. Unlike many texts, book also adheres format textbook, numerous worked (often biological) examples, exercises end chapter.","code":""},{"path":"index.html","id":"conventions","chapter":"Preface","heading":"Conventions","text":"document created Windows users R mind. vast majority cases, however, instructions examples extendable operating systems. cases true note steps address inconsistencies.Several conventions followed throughout text. R package names important terms italicized. R function names, function arguments objects written blocked Courier font. Functions operations often written “chunks” whose contents readily copied clipboard using icon located top right chunk (HTML version text ). example:output evaluated chunk generally printed immediately . example:","code":"\nprint(\"hello world\")[1] \"hello world\""},{"path":"index.html","id":"acknowledgements-and-corrections","chapter":"Preface","heading":"Acknowledgements and Corrections","text":"thank individuals reviewed/edited book various forms including Lauren Tucker Adam Zambie. Corrections comments welcome, can sent using book’s GitHub site.","code":""},{"path":"index.html","id":"copyright","chapter":"Preface","heading":"Copyright","text":"Copyright © 2025 – Ken AhoPermission granted copy, distribute, /modify document terms \nGNU Free Documentation License, Version 1.3 later version published Free\nSoftware Foundation; Invariant Sections, Front-Cover Texts, Back-Cover\nTexts. copy license included section entitled “GNU Free Documentation\nLicense”.","code":""},{"path":"ch1.html","id":"ch1","chapter":"1 Welcome to R","heading":"1 Welcome to R","text":"\"believe R currently represents best medium\nquality software support data analysis.\"- John Chambers, Developer S \"R real demonstration power \ncollaboration, don’t think construct something like\nway.\"- Ross Ihaka, original co-developer R ","code":""},{"path":"ch1.html","id":"what-is-r","chapter":"1 Welcome to R","heading":"1.1 What is R?","text":"R computer language open source setting statistics, data management, computation, graphics. outward mien \nR-environment minimalistic, menu-driven interactive\nfacilities (menus exist implementations R). \ncontrast conventional statistical software consisting black\nbox, menu-dominated, often inflexible tools. simplicity R\nallows one easily evaluate, edit, build procedures data\nanalysis, many purposes.","code":""},{"path":"ch1.html","id":"r-and-biology","chapter":"1 Welcome to R","heading":"1.2 R and Biology","text":"statistical ecologist, book written natural scientists, particularly biologists, mind. R useful biologists three major reasons. First, provides access large number cutting edge statistical, graphical, organizational procedures, many designed specifically biological research. Second, biological datasets, including genetic spatiotemporal research can extensive complex. R can readily manage analyze data. Third, analysis biological data often requires analytical computational flexibility. R allows one “get hood”, look code, check see algorithms . , examining R-algorithm unsatisfied, can generally modify code create new code meet specific needs.","code":""},{"path":"ch1.html","id":"popularity-of-r","chapter":"1 Welcome to R","heading":"1.3 Popularity of R","text":"freeware status, overall number people using R\ndifficult determine. Nonetheless, R-consortium website estimates currently two million active R users. r4stats\nwebsite houses --date\nsurveys concerning popularity analytical software. surveys\n(accessed 10/23/2024) indicate R often preferred among\ndata scientists big data projects data mining. R also one\nfrequently cited statistical environments scholarly\narticles, one frequently used languages \nGitHub repository, one frequently\ndiscussed languages Stack Overflow. \n2024 R language ranked 20th \nworld \nInstitute Electrical Electronics Engineers\n(IEEE),  recently (10/23/2024) ranked 6th PopularitY Programming Language (PYPL) Index, uses search string 'X tutorial', indicator future language usage. , 2017 survey, based Stack Overflow queries, R “least disliked\"\nprogramming language.growth popularity R can partially tied \nrelatively straightforward extendability via user generated functions\npackages. characteristic prompts strong sense community\namong R-users, along practical need perpetuation \nupkeep R system. trailing Python, \ncurrently 20000 formally contributed R-packages \nComprehensive R Archive Network\n(CRAN).","code":""},{"path":"ch1.html","id":"Rhist","chapter":"1 Welcome to R","heading":"1.4 A Brief History","text":"R created early 1990s Australian computational statisticians Ross Ihaka Robert Gentleman (Fig 1.1) address scope1 memory use deficiencies primary progenitor language, S (Ihaka Gentleman 1996). Ihaka Gentleman used name R acknowledge influence S (r s juxtaposed alphabet), celebrate personal efforts (R first letter first names).\nFigure 1.1: Ross Ihaka (1954 - ) (L) Robert Gentleman (1959 - ) (R), co-creators R.\ninsistence Swiss statistician Martin Maechler (Fig 1.2l), Ihaka Gentleman distributed R source code 1995 Free Software Foundation’s GNU general license (Ihaka 1998). relatively easy--learn language, R quickly extended code packages developed users. rapid growth R gave rise need group guide progress. led, 1997, establishment R-development core team2, international panel modifies, troubleshoots, manages source code (Fig 1.2).\n\nFigure 1.2: recent version R-core development team.\n","code":""},{"path":"ch1.html","id":"development-of-the-r-language","chapter":"1 Welcome to R","heading":"1.4.1 Development of the R Language","text":"\nR language based older languages, particularly S, developed Bell Laboratories (Richard Becker Chambers 1978; RA Becker Chambers 1981; Richard Becker, Chambers, Wilks 1988), Lisp3 (McCarthy 1978) Scheme, dialect Lisp (Sussman Steele Jr 1998; Steele 1978), developed MIT artificial intelligence laboratory late 1970s (Fig 1.3).\nFigure 1.3: John McCarthy (1927-2011), creator Lisp language, first coin term ‘artifical intelligence’, working MIT AI laboratory.\nappendix book Software Data Analysis, John M. Chambers (Fig 1.2b), primary developer S, recounts unique evolution goals S inception 1976 (Chambers 2008). Chambers notes S originally intended analysis toolbox solely statistics research group Bell Labs, consisting roughly 20 people time. decided S (initially known “system”) fundamental extensibility4, reflecting Bell Labs’ philosophy “collaborations actually enhance research” (Chambers 2008)5. S language definition, details concerning fitting application S statistical models given Richard Becker, Chambers, Wilks (1988) Chambers Hastie (1992), respectively6.S designed diminish inner functional details underlying Fortran7 algorithms making important higher-level processes readily accessible interactive. inspiration goals exploratory data analysis approach John Tukey (Fig 1.4), contemporary Chambers S developers8 Bell Labs (Chambers 2020). 1965 Bell Labs memo (15 years release S) Tukey noted modern statistician found “peaceful collision computing data analysis” (Chambers 1999).\nFigure 1.4: John Tukey (1915-2000), widely known achievements mathematical statistics, including fast Fourier transform (Cooley Tukey 1965), tools exploratory data analysis, including boxplot (Tukey et al. 1977), computer science coined term bit, unit binary infomration memory (Shannon 1948).\nadherence S exploratory data analysis evident high-quality interactivity graphics devices easily-accessible function documentation. initial programmatic objectives S apparent early design sketch describes outer ‘user interface’ layer core Fortran algorithms ultimately produces S object (Fig 1.5). underlying philosophical principles programmatic foundations S strongly affected guided development R (Chambers 2020).\nFigure 1.5: First designs S statistical system, circa 1976 (Chambers 2008). Written lower lefthand corner important note: ‘Names meaningful algorithm, necessarily language.’\n\nS evolved alongside Unix operating system (also developed Bell\nLabs) currently underlies Macintosh Linux (free-Unix)\noperating systems9. early inception S written Unix, allowing S portable machine using Unix. S Unix quickly commercially licensed &T university third party retailers. academic licensing distribution S attracted large number user groups 1980s. However, lack clear open source strategy caused many early users switch S R 1990s. S purchased Insightful\\(^{\\circledR}\\) software 2004 run commercial software S-Plus\\(^{\\circledR}\\). 2021 S-Plus\\(^{\\circledR}\\) morphed include TIBCO connected intelligence software, R open source applications.","code":""},{"path":"ch1.html","id":"r-is-born","chapter":"1 Welcome to R","heading":"1.4.1.1 R is Born","text":"original Scheme-inspired R interpreter consisted roughly 1000 lines C10 code driven command line interface used syntax corresponding S, resulting “free implementation something ‘close ’ version 3 S language (S3)” (Ihaka 1998). R S languages remain similar, code written S can generally run unaltered R. method function implementation R, however, remains similar Scheme. official language definition current version R can found CRAN website, along sources complementary information.","code":""},{"path":"ch1.html","id":"differences-of-r-and-s","chapter":"1 Welcome to R","heading":"1.4.1.2 Differences of R and S","text":"S3 initial release R differed two important ways (Ihaka Gentleman 1996)11. First, R-environment given fixed amount memory start . contrast S-engines adjusted available memory session needs. Among things, difference meant available pre-reserved computer memory, fewer virtual pagination12 problems R (Ihaka Gentleman 1996). also made R faster S many applications (Hornik R Core Team 2023). Second, R variable locations lexically scoped. computer science, variables storage areas identifiers, scope defines context variable name recognized. -called global variables accessible every scope (instance, inside outside functions). contrast, local variables may exist within particular localized scopes. Formal parameters defined R functions, including arguments, (generally) local variables, whereas variables created outside functions global variables. contrast S, lexical scoping allowed functions R access variables effect function defined session. characteristics R functions details concerning lexical scoping addressed Ch 8.","code":""},{"path":"ch1.html","id":"recent-developments","chapter":"1 Welcome to R","heading":"1.4.2 Recent Developments","text":"\nFigure 1.6: Hadley Wickham (1979 - ) chief scientist Rstudio.\n","code":""},{"path":"ch1.html","id":"the-future-of-r","chapter":"1 Welcome to R","heading":"1.4.3 The Future of R","text":"apparent R can tied (particularly via linkages\nFortran Lisp) early examples software engineering, (via John Tukey others) foundational figures data science. future R determined formal informal community users donated years lives development without monetary compensation. Importantly, continued growth R require adaptation changing demography R-users. Like software endeavors, R male dominated (Fig 1.2). However, changing rapidly. example, R Ladies group, founded 2012 Gabriela de Queiroz (Fig 1.7), currently (8/6/2024) 225 chapters 65 countries, 39,000 members worldwide.\nFigure 1.7: Gabriela de Queiroz, chief data scientist IBM.\n","code":""},{"path":"ch1.html","id":"copyrights-and-licenses","chapter":"1 Welcome to R","heading":"1.5 Copyrights and Licenses","text":"R intentionally open-source free. Thus, \nwarranties environment packages. copyright framework R uses GNU (recursive acronym GNU Unix) General Public License (GPL). allows users share change R functions. associated legalese can read typing RShowDoc(\"COPYING\") R-console. functions can legally (easily) recycled altered always give credit developers, package maintainers, whomever wrote R functions code using.","code":""},{"path":"ch1.html","id":"r-and-reliability","chapter":"1 Welcome to R","heading":"1.6 R and Reliability","text":"lack R warranty frightened away scientists. assured, exceptions, R works well better “top line” analytical commercial software. Indeed, statistical software giants SAS\\(^{\\circledR}\\) SPSS\\(^{\\circledR}\\) made R applications accessible within products (Fox 2009), R processes files can shared directly Microsoft Excel\\(^{\\circledR}\\) proprietary software. specialized advanced statistical techniques R often outperforms alternatives diverse array continually updated applications.computing engines packages come conventional R download (see Section 3.5) meet exceed U.S. federal analytical standards clinical trial research (Schwartz et al. 2008). addition, core algorithms used R based seminal well-trusted functions. instance, R random number generators include venerated thoroughly tested functions computer history (Chambers 2008). Similarly, Linear Algebra PACKage (LAPACK) algorithms (Anderson et al. 1999), used R, among world’s stable best-tested software.","code":""},{"path":"ch1.html","id":"installation","chapter":"1 Welcome to R","heading":"1.7 Installation","text":"install R, first go website (http://www.r-project.org/).\npage specify platform using (Fig 1.8, step 1). R can currently used Unix/Linux, Windows Mac operating\nsystems. operating system selected, one can click “base” link download precompiled base binaries R currently exists computer. R previously installed computer click “Install R first time” (Fig 1.8, step 2). delivered window containing link download recent version R clicking “Download” link (Fig 1.8, step 3). Two versions R generally released year, one April one October. Archived, older versions R R packages also available CRAN.\nFigure 1.8: Method installing R Windows first time.\n","code":""},{"path":"ch1.html","id":"exercises","chapter":"1 Welcome to R","heading":"Exercises","text":"following questions concern history general characteristics R.\ncreators R?\nmajor developmental events history R?\nlanguages R derived /similar ?\nfeatures distinguish R languages statistical software?\nthree operating systems R works ?\ncreators R?major developmental events history R?languages R derived /similar ?features distinguish R languages statistical software?three operating systems R works ?Briefly consider R context major historical events computer software artificial intelligence.","code":""},{"path":"ch2.html","id":"ch2","chapter":"2 Some Basics","heading":"2 Some Basics","text":"“Learning write programs stretches mind,\nhelps think better.\"- Bill Gates, 1955-","code":""},{"path":"ch2.html","id":"first-steps","chapter":"2 Some Basics","heading":"2.1 First Steps","text":"Upon opening R Windows, two things appear console R Graphical User Interface (R-GUI)13. license disclaimer (blue text top console) command line prompt, .e., \\(\\boldsymbol{>}\\) (Fig 2.1). prompt indicates R ready command. commands R must begin \\(\\boldsymbol{>}\\).appearance simple interface vary slightly among operating systems. Windows R-GUI, command line prompt user commands colored red, output, including errors warnings, colored blue. Mac OS, command line prompt purple, user inputs blue, output black. Unix/Linux, wherein R generally run shell command line, absent menus, three black14.can exit R time typing q() console, closing GUI window (non-Linux ), selecting Exit pulldown File menu (non-Linux ).\nFigure 2.1: aged, still recognizable R console: R version 2.15.1, ‘Roasted Marshmallows’, ca. 2012.\n","code":""},{"path":"ch2.html","id":"first-operations","chapter":"2 Some Basics","heading":"2.2 First Operations","text":"introduction can use R evaluate simple mathematical expression. Type 2 + 2 press Enter.output term [1] means, “first requested element.” case just one requested element, \\(4\\), solution \\(2 + 2\\). output elements held single console line, R begin second line output element number comprising first element new line. instance, command rnorm(20) take 20 pseudo-random samples (see footnote Section 9.5.7) standard normal distribution (see Ch 3 Aho (2014)). :\nreappearance command line prompt indicates R ready another command. Multiple commands can entered single line, separated semicolons. Note, however, considered poor programming style, may make code difficult understand third party.R commands generally insensitive spaces. allows use spaces make code legible. eyes, command 2 + 2 simply easier read debug 2+2.","code":"\n2 + 2[1] 4\nrnorm(20) [1] -1.07681600 -0.12916910  0.43102091 -0.59504704  0.28437423\n [6]  2.09798848 -0.47150646  0.66189228 -0.50411240  0.57065698\n[11]  0.19438861 -0.09344153  0.75595706 -3.18338031 -2.13038113\n[16] -0.66466199 -0.47244628 -0.46971852  0.28603184 -0.43981785\n2 + 2; 3 + 2[1] 4[1] 5"},{"path":"ch2.html","id":"use-your-scroll-keys","chapter":"2 Some Basics","heading":"2.2.1 Use Your Scroll Keys","text":"many command line environments, scroll keys (Fig 2.2) provide important shortcut R. Instead editing line code tediously mouse-searching earlier command copy, paste modify, can simply scroll back earlier work using upper scroll key, .e.,  \\(\\uparrow\\) . Accordingly, scrolling using  \\(\\downarrow\\)  allow move forward earlier commands.\nFigure 2.2: Typical scroll direction keys keyboard.\n","code":""},{"path":"ch2.html","id":"note-to-self","chapter":"2 Some Basics","heading":"2.2.2 Note to Self: #","text":"R recognize commands preceded #. result good way us leave messages .can even place comments middle expression, long expression finished new line.“best” code writing style recommended one place space # beginning comment, insert two spaces following code placing # middle line. convention followed .","code":"\n# Note at beginning of line\n2 + 2[1] 4\n2 + # Note in middle of line\n+ 2[1] 4"},{"path":"ch2.html","id":"unfinished-commands","chapter":"2 Some Basics","heading":"2.2.3 Unfinished Commands","text":"R unable move new task command line unfinished. example, typeand press Enter. note continuation prompt, +, now command prompt . R telling us command unfinished. can get back command prompt finishing function, clicking Misc\\(>\\)Stop current computation Misc\\(>\\)Stop computations R-toolbar (non-Linux ), typing Ctrl + C (Linux), pressing Esc key (OS).","code":"2 +"},{"path":"ch2.html","id":"expressions-assignments-and-objects","chapter":"2 Some Basics","heading":"2.3 Expressions, Assignments and Objects","text":"entries R either expressions assignments. command expression evaluated, printed, discarded. Examples include: 2 + 2. Conversely, assignment evaluates expression, assigns label output, automatically print result.convert expression assignment use assignment operator, <-, represents arrow points label expression. assignment operator can go either side expression.Example 2.1  \\(\\text{}\\)\ntype:orthen R-object created named x contains result expression 2 + 2. fact, code: x <- 2 + 2 literally means: “x \\(2 + 2\\).” <- operator generally used (instead ->) easier conceptualize relationship object name -> object definiton, reversal.print result assignment (see x), simply type:\\(\\blacksquare\\)Example 2.1 typed x = 2 + 2 assignment results.However, document, continue use arrow operator, <-, object assignments, save equals sign, =, specifying arguments functions (Ch 8).Note R-console can quickly become cluttered confusing. remove clutter console (without actually getting rid objects created session) press Ctrl + L , Edit pulldown menu, click Clear console (non-Linux ).","code":"\nx <- 2 + 2\n2 + 2 -> x\nx[1] 4\nprint(x)[1] 4\nx = 2 + 2\nx[1] 4"},{"path":"ch2.html","id":"naming-objects","chapter":"2 Some Basics","heading":"2.3.1 Naming Objects","text":"assigning names R-objects try keep names simple, avoid names already represent important definitions functions. include: TRUE, FALSE, NULL, NA, NaN, Inf. addition, names:beginning numeric value,containing spaces, colons, semicolons,containing mathematical operators (e.g., *, +, -, ^, /, =),containing important R metacharacters (e.g., @, #, ?, !, %, &, |).However, even “forbidden” names characters can used one encloses backticks, also called accent grave characters. example, code, `?` <- 2 + 2 create object named `?`, containing number 4.Names , possible, descriptive. Thus, object containing 20 random observations normal distribution, name rN20 may superior easily-typed, anonymous name, x. Finally, remember R case sensitive. , following \\(2^4\\) combinations recognized distinct: name, Name, nAme, naMe, namE, NAme, nAMe, naME, NaMe, nAmE, NamE, naME, NAMe, nAME, NaME, NAmE, NAME.","code":""},{"path":"ch2.html","id":"combining-data","chapter":"2 Some Basics","heading":"2.3.2 Combining Data","text":"define collection numbers (data objects) single entity one can use important R function c, means “combine”.Example 2.2  \\(\\text{}\\)\ndefine numbers 23, 34, 10 collectively object named x, type:something like:Note seven added element x.\\(\\blacksquare\\)","code":"\nx <- c(23, 34, 10)\nx + 7[1] 30 41 17"},{"path":"ch2.html","id":"oc","chapter":"2 Some Basics","heading":"2.3.3 Object Classes","text":"can view everything created loaded R object15. idiom object oriented programming (OOP), object may attributes allow evaluated correctly, associated methods appropriate attributes (e.g., specific functions plotting, printing, etc.)16.\ncan list objects available R session using function objects() ls(). Currently, x (applied modified several times) session (global environment), typing:orR objects generally class, identifiable function class().Objects class numeric several common classes can evaluated mathematically. Common R classes shown Table 2.1. create objects classes, learn characteristics, next chapters.Table 2.1: Common R classes object x. listed class printed one created assignment x shown Example, typed class(x)","code":"\nobjects()[1] \"x\"\nls()[1] \"x\"\nclass(x)[1] \"numeric\""},{"path":"ch2.html","id":"bt","chapter":"2 Some Basics","heading":"2.3.4 Object Base Types","text":"R objects -called base types define underlying C language data structures17. currently 24 base types used R (R Core Team 2024a), unlikely developed near future (Wickham 2019). entities listed Table 2.2. meaning usage base types may seem clear, instance, integer character, also class designations (Table 2.1). Several base types specifically addressed later chapters, including list, logical, integer, NULL (Chs 3 7), character (Chs 4 5), closure, special, builtin, environment, pairlist, S4, promise, symbol (Ch 8) raw (Ch 12). Base types meant C-internal processes, .e., , bytecode, promise, ..., weakref, externalptr, char, easily accessible interpreted R code (R Core Team 2024b).Table 2.2: R base types. listed base type printed one created assignment x shown Example typed typeof(x). function mle, used create Example base type S4, requires package stats4.\nBase types numeric objects define storage mode, .e., way R caches primary memory18. Base types can identified using function typeof().see x storage mode \"double\", meaning numeric values stored using 53 bits, resulting recognizable distinguishable values approximately \\(5 \\times 10^{-323}\\) \\(2 \\times 10^{307}\\) (see Ch 12 information).","code":"\ntypeof(x)[1] \"double\""},{"path":"ch2.html","id":"object-attributes","chapter":"2 Some Basics","heading":"2.3.5 Object Attributes","text":"Many R-objects also attributes (.e., characteristics particular object object class). Typing:indicates x additional attributes. However, using coercion (Section 3.3.2) can define x object class matrix (collection data row column format (see Section 3.1.2)).Now x attribute dim (.e., dimension). Specifically,\nx three-celled matrix. three rows one column.Amazingly, classes attributes allow R simultaneously store distinguish objects name. instance:general, advisable name objects frequently used functions. Nonetheless, function mean(), calculates arithmetic mean collection data, distinguishable new user-created object mean, objects different identifiable class characteristics. can remove user-created object mean, function rm(). leaves behind function mean().process objects distinguished R elaborated Section 8.8.","code":"\nattributes(x)NULL\nattributes(as.matrix(x))$dim\n[1] 3 1\nmean <- mean(c(1, 2, 3))\nmean[1] 2\nmean(c(1, 2, 3))[1] 2\nrm(mean)\nmeanfunction (x, ...) \nUseMethod(\"mean\")\n<bytecode: 0x0000020d6bf8a2a8>\n<environment: namespace:base>"},{"path":"ch2.html","id":"help","chapter":"2 Some Basics","heading":"2.4 Getting Help","text":"single perfect source information/documentation aspects R. Detailed manuals CRAN available concerning R language definition, basic operations, package development. resources, however, often assume familiarity Unix/Linux operating systems computer science terminology. Thus, may particularly helpful biologists new R.","code":""},{"path":"ch2.html","id":"help-and","chapter":"2 Some Basics","heading":"2.4.1 help() and ?","text":"comprehensive help system available many R components including operators, loaded package dataframes functions. system can accessed via question mark, ?, operator function help(). instance, wanted know plot() function, type:orDocumentation packaged R functions (Section 3.5) must include annotated description function arguments, along pertinent information, documentation packaged datasets must include descriptions dataset variables19. quality documentation generally excellent functions packages default R download (.e., R-distribution packages, see Section 3.5), vary package package otherwise. list arguments function, default values, can (often) obtained using function formals().help documentation concerning programming metacharacters used R (instance @, #, ?, !, %, &, |), one enclose metacharacters quotes. example, find information logical operator & type help(\"&\") ? \"&\". Placing two question marks front topic cause R search help files concerning respect packages workstation. instance, type:, alternativelyfor huge number help files linear model functions identified fuzzy matching. Help particular R-questions can often found online using search engine http://search.r-project.org/. link provided Help pulldown menu R console (non-Linux ). Helpful online discussions can also found Stack Overflow, Stats Exchange.","code":"\n?plot\nhelp(plot)\nformals(plot)$x\n\n\n$y\n\n\n$...\n??lm\nhelp.search(lm)"},{"path":"ch2.html","id":"demo-and-example","chapter":"2 Some Basics","heading":"2.4.2 demo() and example()","text":"function demo() allows one access coded examples developers worked particular function topic. instance, type:brief demonstration R graphics. Typingwill provide demonstration 3D perspective plots. , typing:provide demonstration available modifiable symbols Hershey family fonts (see Ch 6 Hershey (1967)). Finally, typing:lists demos available loaded libraries particular workstation. function example() usually provides less involved demonstrations man package directories (short user manual, see Ch 10) R package. instance, type:coded demonstration mathematical graphics.","code":"\ndemo(graphics)\ndemo(persp)\ndemo(Hershey)\ndemo()\nexample(plotmath)"},{"path":"ch2.html","id":"vignettes","chapter":"2 Some Basics","heading":"2.4.3 Vignettes","text":"R packages often contain vignettes. short documents generally describe theory underlying algorithms guidance correctly use package functions. Vignettes can accessed function\nvignette(). view vignettes installed packages (Section 3.5.1), type:view vignettes available loaded packages (see Section 3.5.2), type:view vignettes R contributed package asbio (following installation), type:see vignette simpson package asbio, type:function browseVignettes() provides HTML-browser allows interactive vignette searches.","code":"\nvignette(all = TRUE)\nvignette(all = FALSE)\nvignette(package = \"asbio\")\nvignette(\"simpson\", package = \"asbio\")"},{"path":"ch2.html","id":"options","chapter":"2 Some Basics","heading":"2.5 Options","text":"enhance R session, can adjust appearance R-console customize options affect expression output. include characteristics graphics devices, width print output R-console, number print lines print digits. Changes parameters can made going Edit\\(>\\)GUI Preferences R-toolbar. Many parameters can changed using options() function. see alterable options one can type:\nresulting list extensive. modify options, one simply define desired change within parentheses following call options. instance, see default number digits, type:change default number digits output 7 5 current session, type:One can revert back default options restarting R session.","code":"\noptions()\noptions(\"digits\")$digits\n[1] 7\noptions(digits = 5)\n# demonstration using pi\npi[1] 3.1416"},{"path":"ch2.html","id":"advanced-options","chapter":"2 Some Basics","heading":"2.5.1 Advanced Options","text":"store user-defined options start procedures, .Rprofile file exist R program etc directory. location something like: \\(\\ldots\\)R/R-version/etc. R silently run commands .Rprofile file upon opening. Thus, customizing .Rprofile file one can “permanently” set session options, load installed packages, define favorite package repository (Section 3.5), even create aliases defaults frequently used functions..Rprofile file located etc directory -called .Rprofile.site file. Additional .Rprofile files can placed working directory (see ). R check run running .Rprofile.site file.Example 2.3  \\(\\text{}\\)\ncontent one current .Rprofile files.command options(repos = structure(c(\"http://ftp.osuosl.org/pub/cran/\"))) (Line 1) defines preferred CRAN repository mirror site (Section 3.5). function .First( ) (Lines 2-5) run start R session .Last( ) (Lines 6-8) run end session. R functions formally introduced Ch 8. go book become clear lines code force R say hello, load package asbio, print date/time (using function date()) opens, say goodbye, print date/time closes (although farewell seen running R shell interface, e.g., Windows Command Prompt).\\(\\blacksquare\\)One can create .Rprofile files, many types R extension files using function file.create(). instance, code:place empty, editable,.Rprofile file called defaults working directory.\n","code":"options(repos = structure(c(\"http://ftp.osuosl.org/pub/cran/\")))\n.First <- function(){\nlibrary(asbio)\ncat(\"\\nWelcome to R Ken! \", date(), \"\\n\")\n}\n.Last <- function(){\ncat(\"\\nGoodbye Ken\", date(), \"\\n\")\n}\nfile.create(\"defaults.Rprofile\")"},{"path":"ch2.html","id":"the-working-directory","chapter":"2 Some Basics","heading":"2.6 The Working Directory","text":"default, R working directory set home directory workstation. command getwd() shows current file path working directory.working directory can changed command setwd(filepath), filepath location desired directory, using pulldown menus, .e., File\\(>\\)Change dir (non-Linux ). R developed Unix, must specify directory hierarchies using forward slashes doubling backslashes.Example 2.4  \\(\\text{}\\)\nestablish working directory file path Windows directory:\nC:\\Users\\User\\Documents, type:\\(\\blacksquare\\)","code":"\ngetwd()[1] \"C:/Users/ahoken/Documents/GitHub/Amalgam\"\nsetwd(\"C:/Users/User/Documents\")\nsetwd(\"C:\\\\Users\\\\User\\\\Documents\")"},{"path":"ch2.html","id":"saving-and-loading-your-work","chapter":"2 Some Basics","heading":"2.7 Saving and Loading Your Work","text":"noted Ch 1, R session allocated fixed amount memory managed --fly manner. unfortunate consequence R crashes, unsaved information work session lost. Thus, session work saved often. Note R give warning writing session files R console. old file simply replaced. Three general approaches saving non-graphics data possible. : 1) saving history, 2) saving objects, 3) saving R script. three operations can greatly facilitated using R integrated development environment (IDE) like RStudio (Section 2.9).","code":""},{"path":"ch2.html","id":"r-history","chapter":"2 Some Basics","heading":"2.7.1 R History","text":"view history (.e., commands used session) one can use history(n) n number previous command lines one wishes see20. instance, see last three commands, one type21:save session history Windows one can use File\\(>\\)Save History function savehistory(). instance, save session history working directory name history1, type:can view code file text editor. load history previous session one can use File\\(>\\)Load History (non-Linux ) function\nloadhistory(). instance, load history1 type:save history end (almost) every interactive Windows Unix-alike R session, one can alter .Rprofile file .Last function include:","code":"\nhistory(3)\nsavehistory(file = \"history1.Rhistory\")\nloadhistory(file = \"history1.Rhistory\")\n.Last <- function() if(interactive()) try(savehistory(\"~/.Rhistory\"))"},{"path":"ch2.html","id":"saveRobjects","chapter":"2 Some Basics","heading":"2.7.2 R Objects","text":"save objects available current R-session one can use File\\(>\\)Save Workspace (non-Linux ), simply type:procedure saves session objects working directory nameless file using .RData extension. file opened, silently, inception next R- session, cause objects used created previous session available. Indeed, R automatically execute .RData files working directory use session. Stored .RData files can also loaded using File\\(>\\)Load Workspace (non-Linux ). One can also save .RData objects specific directory location use specific file name using: File\\(>\\)Save Workspace, flexible function save().\nR data file formats, including .rda, .RData, (extensions R data files), .R (format R scripts), can read R using function load(). Users new command line environment reassured typing:function file.choose() allow one browse interactively files load using dialog boxes. Detailed procedures importing (reading) exporting (saving) data row column format, explicit delimiter (e.g. .csv files) described Ch 3.","code":"\nsave.image()\nload(file.choose())"},{"path":"ch2.html","id":"r-scripts","chapter":"2 Some Basics","heading":"2.7.3 R Scripts","text":"save R script executable source file, best use integrated development environment (IDE) compatible R. R contains IDE, R-editor, useful writing, editing, saving scripts .r extension files. access R-editor go File\\(>\\)New script (non-Linux ) type shortcut Ctrl + F + N (Fig 2.3). Code written R IDE can sent directly R-console copying pasting selecting code using shortcut Ctrl + R.\nFigure 2.3: R-editor providing code famous computational exercise.\nAside R-editor, number IDEs outside allow straightforward generation R script files, direct link text editors, provide syntax highlighting R code, R-console . include RWinEdt (R package plugin WinEdt ), Tinn-R, recursive acronym Tinn Notepad, ESS (Emacs Speaks Statistics), Jupyter Notebook, web-based IDE originally designed Python, useful many languages, particularly RStudio, introduced later chapter22.Saved R scripts can called executed using function source(). browse interactively source code files, one can type:go File\\(>\\)Source R code.","code":"\nsource(file.choose())"},{"path":"ch2.html","id":"basic-mathematics","chapter":"2 Some Basics","heading":"2.8 Basic Mathematics","text":"large number mathematical operators functions available conventional download R.Elementary mathematical operators, common mathematical constants, trigonometric functions, derivative functions, integration approaches, basic statistical functions shown shown Tables 2.3 - 2.9.","code":""},{"path":"ch2.html","id":"elementary-operations","chapter":"2 Some Basics","heading":"2.8.1 Elementary Operations","text":"\nTable 2.3: Elementary mathematical operators functions R. functions x represents scalar numeric vector.","code":""},{"path":"ch2.html","id":"associativity-and-precedence","chapter":"2 Some Basics","heading":"2.8.2 Associativity and Precedence","text":"Note operation:equivalent \\(2 + (6 \\cdot 5) = 32\\). * operator gets higher priority (precedence) +. Evaluation precedence can modified parentheses:absence operator precedence, mathematical operations R (generally) read left right (, associativity left right) (Table 2.4). corresponds conventional order operations mathematics. instance:Table 2.4: Precedence associativity mathematical operators. Operators listed highest lowest precendece operations.\n","code":"\n2 + 6 * 5[1] 32\n(2 + 6) * 5[1] 40\n2 + 2^(2 + 1)[1] 10"},{"path":"ch2.html","id":"function-arguments","chapter":"2 Some Basics","heading":"2.8.3 Function Arguments","text":"R functions generally require user specify arguments (parentheses) following function name. instance, sqrt() factorial() require one argument, call data . Thus, solve \\(1/\\sqrt{22!}\\), type:solve \\(\\Gamma \\left( \\sqrt[3]{23\\pi} \\right)\\), type:default function log() computes natural logarithms, .e.,log() function can also compute logarithms particular base specifying base optional second argument called base. instance, solve operation: \\(\\log_{10}3 + \\log_{3}5\\), one type:Arguments can specified order occur list arguments function code, calling argument name. code know first argument log() call data, second argument defines base. may , however, remember argument order function, may wish change certain arguments large allotment. case better specify argument calling name defining value equals sign.","code":"\n1/sqrt(factorial(22))[1] 2.9827e-11\ngamma((23 * pi)^(1/3))[1] 7.411\nlog(exp(1))[1] 1\nlog(3, 10) + log(5, 3)[1] 1.9421\nlog(x = 3, base = 10) + log(x = 5, base = 3)[1] 1.9421"},{"path":"ch2.html","id":"constants","chapter":"2 Some Basics","heading":"2.8.4 Constants","text":"R allows easy access conventional constants (Table 2.5).\nTable 2.5: Conventional constants R.","code":""},{"path":"ch2.html","id":"trigonometry","chapter":"2 Some Basics","heading":"2.8.5 Trigonometry","text":"\nR assumes inputs trigonometric functions radians. course degrees can obtained \nradians using \\(Degrees = Radians \\times 180/\\pi\\), conversely \\(Radians = Degrees \\times \\pi /180\\) (Table 2.6).\nTable 2.6: Trigonometric functions R. functions x represents scalar numeric vector.","code":""},{"path":"ch2.html","id":"derivatives","chapter":"2 Some Basics","heading":"2.8.6 Derivatives","text":"function D() finds symbolic numerical derivatives simple expressions. requires two arguments, mathematical function specified expression (.e., object class base type expression, created using function expression(), can evaluated function eval()), denominator difference quotient. example functions expression eval() used:course wouldn’t bother use expression() eval() simple applications. Table 2.7 contains specific examples using D().\nTable 2.7: Evaluation derivatives R.","code":"\neval(expression(2 + 2))[1] 4"},{"path":"ch2.html","id":"integration","chapter":"2 Some Basics","heading":"2.8.7 Integration","text":"function integrate solves definite integrals. requires three arguments. first R function defining integrand. second third lower upper bounds integration.Example 2.5  \\(\\text{}\\)\nsolve:\n\\[\\int^4_2 3x^2dx\\]\ntype:R functions explicitly addressed Ch 8.\n### Statistics\nR, course, contains huge number statistical functions. generally require sample data summarization. Data can brought R spreadsheet files data storage files (learn shortly). learned, data can also assembled R. instance,Statistical estimators can separated point estimators, estimate underlying parameter single true value (Frequentist viewpoint), intervallic estimators, estimate bounds interval expected, preceding sampling, contain parameter probability (Aho 2014). Point estimators can classified estimators location, scale, shape, order statistics (Table 2.8). Measures location estimate typical central value sample. Examples include arithmetic mean sample median. Measures scale quantify data variability dispersion. Examples include sample standard deviation sample interquartile range (IQR). Shape estimators describe shape (.e., symmetry peakedness) data distribution. Examples include sample skewness sample kurtosis. Finally, \\(k\\)th order statistic sample equal \\(k\\)th-smallest value. Examples include data minimum, data maximum, quantiles (including median). Intervallic estimators include confidence intervals (Table 2.9). huge number statistical estimating, modelling, hypothesis testing algorithms also available R environment. guidance, see Venables Ripley (2002), Aho (2014), Fox Weisberg (2019), among others.Table 2.8: Simple point estimators R. term x represents numeric data vector, y represents numeric data vector whose\nelements paired x. cipher asbio:: indicates function located package asbio.\nTable 2.9: intervallic estimators R. term x represents numeric vector. cipher asbio:: indicates function located package asbio","code":"\nf <- function(x){3 * x^2}\nintegrate(f, 2, 4)56 with absolute error < 6.2e-13\nx <- c(1, 2, 3)"},{"path":"ch2.html","id":"RStudio","chapter":"2 Some Basics","heading":"2.9 RStudio","text":"RStudio open source IDE R (Fig 2.4). RStudio greatly facilitates writing R code, saving examining R objects history, many processes. include, limited , documenting session workflows, writing R package documentation, calling receiving code languages, even developing web-based graphical user interfaces. RStudio can currently downloaded (https://posit.co/products/open-source/rstudio/). Like R , RStudio can used Windows, Mac, Unix/Linux operating systems, RStudio freeware commercial versions23. use former .\nFigure 2.4: RStudio logo.\nRStudio generally implemented using four pane workspace (Fig 2.5). : 1) code editor, 2) R-console, 3) environment histories panel, 4) plots miscellany panel.\nFigure 2.5: Interfaces RStudio 2023.06.2 Build 561.\nRStudio code editor panel (Fig 2.5, Panel 1) allows create R scripts scripts languages can called R. code panel can also used create edit session documentation files (see Section 2.9.2 ) important R file types. new R script can created editing within code editor going File\\(>\\)New\\(>\\)R Script. Commands R script can sent R console using shortcut Ctrl + Enter (Windows Linux) Cmd + Enter (Mac).RStudio code editor panel (Fig 2.5, Panel 1) allows create R scripts scripts languages can called R. code panel can also used create edit session documentation files (see Section 2.9.2 ) important R file types. new R script can created editing within code editor going File\\(>\\)New\\(>\\)R Script. Commands R script can sent R console using shortcut Ctrl + Enter (Windows Linux) Cmd + Enter (Mac).R console panel (Fig 2.5, Panel 2) default, identical functionality R console recent version R workstation (assuming paths environments set correctly computer). Thus, console panel can used directly typing executing R code, receiving commands code editor (Panel 1).R console panel (Fig 2.5, Panel 2) default, identical functionality R console recent version R workstation (assuming paths environments set correctly computer). Thus, console panel can used directly typing executing R code, receiving commands code editor (Panel 1).environments history panel (Fig 2.5, Panel 3) can used : 1) show list R objects available R session (Environment tab), 2) show, search, select history previous commands (History tab). panel also provides interface point click import data files including .csv, .xls, many file formats (Import Dataset pulldown within Environment tab).environments history panel (Fig 2.5, Panel 3) can used : 1) show list R objects available R session (Environment tab), 2) show, search, select history previous commands (History tab). panel also provides interface point click import data files including .csv, .xls, many file formats (Import Dataset pulldown within Environment tab).plots files panel (Fig 2.5, Panel 4) can used show: 1) files working directory, 2) scrollable history plots image files, 3) list available packages (via Packages tab), facilities updating installing packages. package GUI list, package currently loaded. Packages installation, updating, loading formally introduced Section 3.5. panel’s Files pulldown tab allows straightforward establishment working directories (although can still done command line using setwd()) (Fig 2.7). panel’s Help tap opens automatically uses ? help particular R topics (Section 2.4).plots files panel (Fig 2.5, Panel 4) can used show: 1) files working directory, 2) scrollable history plots image files, 3) list available packages (via Packages tab), facilities updating installing packages. package GUI list, package currently loaded. Packages installation, updating, loading formally introduced Section 3.5. panel’s Files pulldown tab allows straightforward establishment working directories (although can still done command line using setwd()) (Fig 2.7). panel’s Help tap opens automatically uses ? help particular R topics (Section 2.4).CAUTION!careful managing files plots files panel, can permanently delete files without (currently) possibility recovery Recycling Bin.","code":""},{"path":"ch2.html","id":"rstudio-project","chapter":"2 Some Basics","heading":"2.9.1 RStudio Project","text":"RStudio project can created via File pulldown menu (Fig 2.7). project allows related files (data, figures, summaries, etc.) easily organized together setting working directory location project .Rproj file.\n","code":""},{"path":"ch2.html","id":"workflow","chapter":"2 Some Basics","heading":"2.9.2 Workflow Documentation","text":"can document workflow simultaneously run/test R session code either:Creating R Markdown24 .rmd file can compiled make .html, .pdf, MS Word\\(^{\\circledR}\\) .doc document, orUsing sweave, approach implements LaTeX25 document preparation system.","code":""},{"path":"ch2.html","id":"RMarkdown","chapter":"2 Some Basics","heading":"2.9.2.1 R Markdown","text":"R Markdown document processing workflow RStudio shown Fig 2.6. steps highly modifiable, can also run less automated manner, requiring little understanding underlying processes.\nFigure 2.6: process document creation R Markdown. Functions package rmarkdown control conversion .rmd files Markdown .md files, using utilities package knitr. Pandoc first creates .tex file rendering LaTeX PDF documents.\nUse R Markdown .rmd files requires package rmarkdown (Allaire et al. 2024), comes pre-installed RStudio.initial step, underlying .rmd files must include brief YAML26 header (see ) containing document metadata. remainder .rmd document contain text written Markdown syntax, code chunks. knit() function package knitr Xie (2015), also installed RStudio, executes evaluable code within chunks, formats code output processing within Pandoc, program converting markup files one language another27. Pandoc uses YAML header guide conversion. example, one requested HTML output, simple Markdown text: script converted HTML formatted: <p>script<\/p>. One can also write HTML script CSS code28 directly .rmd document (see Section 11.5).\ndesired output PDF, Pandoc convert .md file temporary intermediate .tex file, processed LaTex typesetting system. Support LaTeX can found official website, large number informal user-driven venues, including Stack Exchange Overleaf, online LaTeX application. LaTeX compile .tex file .pdf file. process, tinytex package (Xie 2024), installs stripped-LaTeX distribution TinyTex, can used.\nCreating R Markdown document simple RStudio. first open empty .rmd document navigating File \\(>\\) New File \\(>\\)R Markdown (Fig 2.7).\nFigure 2.7: Part RStudio File pulldown menu.\ndelivered GUI shown Fig 2.8. Note default Markdown compilation generates HTML document.\nFigure 2.8: RStudio GUI creating R Markdown document.\nGUI opens R Markdown (.rmd) skeleton document tentative YAML header.\nFigure 2.9: YAML header R Markdown (.rmd) skeleton document.\nHTML output can changed one :create LaTex \\(\\rightarrow\\) PDF, orto create Word\\(^{\\circledR}\\) document29.\nknitr package facilitates report building HTML LaTeX \\(\\rightarrow\\) PDF formats, within framework rmarkdown (Fig 2.6). knitr, R Markdown lines beginning ```{r } ending ``` delimit R code “chunk” potentially run R environment. chunk header, ```{r }, can contain additional options. complete list chunk options, run\nCode chunks can generated going Code\\(>\\)Insert Chunk using RStudio shortcut Ctrl + Alt + (Windows Linux) Cmd + Alt + (Mac). R code can also invoked inline R Markdown document using format:instance, seamlessly place three random numbers generated continuous uniform distribution, \\(f(x) = UNIF(0,1)\\), inline text using:run iteration using “hidden” inline R code: 0.05143, 0.27118, 0.48557.Markdown, pound signs (e.g., #, ##, ###) can used (increasingly nested) hierarchical section delimiters. Italic, bold, monospace code fonts can specified enclosing text asterisks, double asterisks, back ticks, respectively. : *italic*, **bold** result : italic bold. brief introduction R Markdown can found : http://rmarkdown.rstudio.com. thorough description R Markdown given Xie, Allaire, Grolemund (2018) Xie, Dervieux, Riederer (2020). latter text currently available online resource.Inline equations Markdown Sweave (discussed ) can specified LaTeX system, uses dollar signs, $, delimit equations. instance, obtain inline equation: \\(P(\\theta|y) = \\frac{P(y|\\theta)P(\\theta)}{P(y)}\\), .e., Bayes theorem, type LaTeX script:$(\\theta|y) = \\frac{P(y|\\theta)P(\\theta)}{P(y)}$cheatsheet LaTeX equation writing can found .R Markdown (.rmd) skeleton file example documentation text, interspersed example R code chunks. modified create simple summary document dataset Loblolly package datasets (Fig 2.10), describes growth characteristics loblolly pine trees (Pinus taeda).\nFigure 2.10: R Markdown (.rmd) file documentation text interspersed R code chunks.\nNote use echo = FALSE final chunk suppress printing R code. snapshot knitted HTML shown Fig 2.11.\nFigure 2.11: HTML document knit Markdown code previous figure. Note code displayed (default) well executed.\ngenerally use function knitr::kable() create R Markdown \\(\\rightarrow\\) Pandoc \\(\\rightarrow\\) HTML tables relatively simple use. code used create Table 2.10.Table 2.10: Loblolly pine dataI often use functions package xtable build R Markdown \\(\\rightarrow\\) Pandoc \\(\\rightarrow\\) LaTeX \\(\\rightarrow\\) PDF tables. approach, one create Table 2.10 using:\nmethod also require one use command results = 'asis' chunk options. One can even call different table approaches fly. instance, use command eval = knitr::is_html_output()), options Markdown chunk using table code optimizes HTML formatting, use eval = knitr::is_latex_output()) create table optimizes LaTeX formatting.\nAside knitr::kable() xtable, many R functions packages can used create R Markdown tables, particularly HTML output. include:kableExtra (Zhu et al. 2022) package extends knitr::kable() including styles fonts, features specific rows, columns, cells, straightforward merging grouping rows /columns. kableExtra features extend HTML PDF formats.DT (Xie, Cheng, Tan 2024), wrapper HTML tables uses JavaScript (see Section 11.3) library DataTables. Among features, DT allows straightforward implementation interactive Shiny apps (Section 11.5).Like DT, reactable package (Lin 2023) creates flexible, interactive HTML embedded tables. DT, reactable tables add complications interactives considered conventional tables R markdown, captions referable labels.Xie, Dervieux, Riederer (2020) discuss several alternatives.\n\nuse function reactable() reactable package create table sortable columns scrollable rows (Table 2.11).Table 2.11: Interactive table Loblolly dataframe generated using reactable::reactable().","code":"\noutput: pdf_document\noutput: word_document\nstr(knitr::opts_chunk$get())\n`r some code`\n`r runif(3)`\nknitr::kable(head(Loblolly))\nprint(xtable::xtable(head(Loblolly)))\n# install.packages(\"reactable\")\nlibrary(reactable)\nreactable(Loblolly, pagination = FALSE, highlight = TRUE, height = 250)"},{"path":"ch2.html","id":"bookdown","chapter":"2 Some Basics","heading":"2.9.2.1.1 Bookdown","text":"\nlarge number useful auxiliary features available R Markdown, R package bookdown (Xie (2023)). include extended capacity figure, table, section numbering referencing. use bookdown must modify output: designation YAML header bookdown-specific output. instance,create HTML document, orto create LaTeX \\(\\rightarrow\\) PDF document. orto create MS Word\\(^{\\circledR}\\) document30.\nNumbering R-generated plots tables R Markdown Bookdown requires specification chunk label language reference r chunk generating plot. chunk use label lobplot. Note space included r. Captions specified chunk header using chunk option fig.cap tab.cap figures tables, respectively. instance,```{r lobplot, echo=FALSE, fig.cap= \"Loblolly pine height versus age.\"}Cross-references within text can made using syntax \\@ref(type:label), label chunk label type environment referenced (e.g., fig, tab, eq). current example, might want type something like: “see Figure \\@ ref(fig:lobplot)”. non-chunk component Markdown document.Specification bookdown output format, result automated numbering sections. turn numbering , one modify YAML output :code indents shown important YAML, like language Python, uses significant indentation. omit numbering certain sections, one retain bookdown output, add {-} unnumbered section heading, e.g.,# section unnumbered {-}Thorough guidance bookdown provided Xie (2016), can viewed open-source online document.","code":"\noutput: bookdown::html_document2\noutput: bookdown::pdf_document2\noutput: bookdown::word_document2\noutput:\n  bookdown::html_document2:\n    number_sections: false"},{"path":"ch2.html","id":"Sweave","chapter":"2 Some Basics","heading":"2.9.2.2 Sweave","text":"Sweave documentation approach, high quality .pdf documents generated LaTeX .tex files, turn created Sweave .rnw files. can also facilitated RStudio. skeleton .rnw document can generated going File\\(>\\)New File\\(>\\)R Sweave31. Fig 2.12 create .rnw file text analyses used Markdown example (Figs 2.10-2.11). note instead Markdown YAML header, now lines preamble defining type desired document (e.g., article) LaTeX packages needed document compilation (e.g, amsmath). Note R code chunks now initiated <<>>=, serves chunk header can contain options, closed @. Non-code text, including figure table captions cross-referencing follow LaTeX guidelines.\nFigure 2.12: Sweave (.rnw) file documentation text interspersed code chunks.\nFig 2.13 shows snapshot .pdf result, following Sweave/LaTeX compilation.\nFigure 2.13: .pdf document resulting compilation Sweave code previous figure.\n","code":""},{"path":"ch2.html","id":"purl","chapter":"2 Some Basics","heading":"2.9.2.3 Purl","text":"R code can extracted .rmd .rnw file using function knitr::purl(). instance, assume R Markdown loblolly pine summary shown Fig 2.10 saved working directory name lob.rmd. Code file extracted script file called lob.R, located working directory, one types:","code":"\npurl(\"lob.rmd\")"},{"path":"ch2.html","id":"exercises-1","chapter":"2 Some Basics","heading":"Exercises","text":"Create R Markdown document contain homework assignment. Modify YAML header allow numbering figures tables, sections. test formatting, perform following steps:\nCreate section header called Question 1 subsection header called (). () type \"completed\".\nsubsection header (b), insert chunk, create simple plot points coordinates: \\(\\{1,1\\}\\), \\(\\{2,2\\}\\), \\(\\{3,3\\}\\), typing code: plot(1:3) chunk. Create label chunk, create caption plot using knitr chunk option, fig.cap.\nsubsection header (c), create cross reference plot (b).\nsubsection header (d), write equation, \\(y_i = \\hat{\\beta}_0 + \\hat{\\beta}_1x_i + \\hat{\\varepsilon_i}\\), using LaTeX. noted earlier, LaTeX equation cheatsheet can found .\nRender (knit) final document either .html file .doc file. Include assigned exercises Chapter directed, using general formatting approach given Question 1.\nCreate R Markdown document contain homework assignment. Modify YAML header allow numbering figures tables, sections. test formatting, perform following steps:Create section header called Question 1 subsection header called (). () type \"completed\".subsection header (b), insert chunk, create simple plot points coordinates: \\(\\{1,1\\}\\), \\(\\{2,2\\}\\), \\(\\{3,3\\}\\), typing code: plot(1:3) chunk. Create label chunk, create caption plot using knitr chunk option, fig.cap.subsection header (c), create cross reference plot (b).subsection header (d), write equation, \\(y_i = \\hat{\\beta}_0 + \\hat{\\beta}_1x_i + \\hat{\\varepsilon_i}\\), using LaTeX. noted earlier, LaTeX equation cheatsheet can found .Render (knit) final document either .html file .doc file. Include assigned exercises Chapter directed, using general formatting approach given Question 1.Perform following operations.\nLeave note .\nCreate examine object called x contains numeric entries 1, 2, 3.\nMake copy x called y.\nShow class y.\nShow base type y.\nShow attributes y.\nList current objects work session.\nIdentify working directory.\nPerform following operations.Leave note .Create examine object called x contains numeric entries 1, 2, 3.Make copy x called y.Show class y.Show base type y.Show attributes y.List current objects work session.Identify working directory.Distinguish R expressions assignments.Distinguish R expressions assignments.Sometimes R reports unexpected results classes base types.\nCreate x <- factor(\"\",\"\",\"b\") show class x.\nType ?factor. factor R?\nShow base type x? surprising? ? Type ?integer. integer R?\nSometimes R reports unexpected results classes base types.Create x <- factor(\"\",\"\",\"b\") show class x.Type ?factor. factor R?Show base type x? surprising? ? Type ?integer. integer R?Solve following mathematical operations using R.\n\\(1 + 3/10 + 2\\)\n\\((1 + 3)/10 + 2\\)\n\\(\\left(4 \\cdot \\frac{(3 - 4)}{23}\\right)^2\\)\n\\(\\log_2(3^{1/2})\\)\n\\(3\\boldsymbol{x}^3 + 3\\boldsymbol{x}^2 + 2\\) \\(\\boldsymbol{x} = \\{0, 1.5, 4, 6, 8, 10\\}\\)\n\\(4(\\boldsymbol{x} + \\boldsymbol{y})\\) \\(\\boldsymbol{x} = \\{0, 1.5, 4, 6, 8\\}\\) \\(\\boldsymbol{y} = \\{-2, 0.5, 3, 5, 8\\}\\).\n\\(\\frac{d}{dx} \\tan(x) 2.3 \\cdot e^{3x}\\)\n\\(\\frac{d^2}{dx^2} \\frac{3}{4x^4}\\)\n\\(\\int_3^{12} 24x + \\ln(x)dx\\)\n\\(\\int_{-\\infty}^{\\infty} \\frac{1}{\\sqrt{2\\pi}}e^{-\\frac{x^2}{2}}dx\\) (.e., find area standard normal pdf).\n\\(\\int_{-\\infty}^{\\infty}\\frac{x}{\\sqrt{2\\pi}}e^{-\\frac{x^2}{2}}dx\\) (.e., find \\(E(X)\\) standard normal pdf).\n\\(\\int_{-\\infty}^{\\infty}\\frac{x^2}{\\sqrt{2\\pi}}e^{-\\frac{x^2}{2}}dx\\) (.e., find \\(E(X^2)\\) standard normal pdf).\nFind sum, cumulative sum, product, cumulative product, arithmetic mean, median variance data x = c(0, 1.5, 4, 6, 8, 10).\nSolve following mathematical operations using R.\\(1 + 3/10 + 2\\)\\((1 + 3)/10 + 2\\)\\(\\left(4 \\cdot \\frac{(3 - 4)}{23}\\right)^2\\)\\(\\log_2(3^{1/2})\\)\\(3\\boldsymbol{x}^3 + 3\\boldsymbol{x}^2 + 2\\) \\(\\boldsymbol{x} = \\{0, 1.5, 4, 6, 8, 10\\}\\)\\(4(\\boldsymbol{x} + \\boldsymbol{y})\\) \\(\\boldsymbol{x} = \\{0, 1.5, 4, 6, 8\\}\\) \\(\\boldsymbol{y} = \\{-2, 0.5, 3, 5, 8\\}\\).\\(\\frac{d}{dx} \\tan(x) 2.3 \\cdot e^{3x}\\)\\(\\frac{d^2}{dx^2} \\frac{3}{4x^4}\\)\\(\\int_3^{12} 24x + \\ln(x)dx\\)\\(\\int_{-\\infty}^{\\infty} \\frac{1}{\\sqrt{2\\pi}}e^{-\\frac{x^2}{2}}dx\\) (.e., find area standard normal pdf).\\(\\int_{-\\infty}^{\\infty}\\frac{x}{\\sqrt{2\\pi}}e^{-\\frac{x^2}{2}}dx\\) (.e., find \\(E(X)\\) standard normal pdf).\\(\\int_{-\\infty}^{\\infty}\\frac{x^2}{\\sqrt{2\\pi}}e^{-\\frac{x^2}{2}}dx\\) (.e., find \\(E(X^2)\\) standard normal pdf).Find sum, cumulative sum, product, cumulative product, arithmetic mean, median variance data x = c(0, 1.5, 4, 6, 8, 10).velocity earth’s rotation axis equator, \\(E\\), approximately 1674.364 km/h, 1040.401 m/h32. can calculate velocity rotation earth latitude equation, \\(V = \\cos(\\)latitude\\(^\\text{o}) \\times E\\). Using R, simultaneously calculate rotational velocities latitudes 0,30,60, 90 degrees north, south, latitude (). Remember, function cos() assumes inputs radians, degrees.velocity earth’s rotation axis equator, \\(E\\), approximately 1674.364 km/h, 1040.401 m/h32. can calculate velocity rotation earth latitude equation, \\(V = \\cos(\\)latitude\\(^\\text{o}) \\times E\\). Using R, simultaneously calculate rotational velocities latitudes 0,30,60, 90 degrees north, south, latitude (). Remember, function cos() assumes inputs radians, degrees.","code":""},{"path":"ch3.html","id":"ch3","chapter":"3 Data Objects, Packages, and Datasets","heading":"3 Data Objects, Packages, and Datasets","text":"\"God trust. others [must] data.\"- Edwin R. Fisher, cancer pathologist","code":""},{"path":"ch3.html","id":"data-storage-objects","chapter":"3 Data Objects, Packages, and Datasets","heading":"3.1 Data Storage Objects","text":"five primary types data storage objects R. : (atomic) vectors, matrices, arrays, dataframes, lists33.","code":""},{"path":"ch3.html","id":"vectors","chapter":"3 Data Objects, Packages, and Datasets","heading":"3.1.1 Atomic Vectors","text":"Atomic vectors contain data order length, dimension. clearly different linear algebra conception vector. linear algebra, row vector \\(n\\) elements dimension \\(1 \\times n\\) (1 row \\(n\\) columns), whereas column vector dimension \\(n \\times 1\\).can create atomic vectors function c, means combine.\ncan add names attribute vector elements. example,\nfunction .matrix(x) (see Section 3.3.2) can used coerce x matrix structure dimension \\(3 \\times 1\\) (3 rows 1 column). Thus, R matrix dimension, vector .Recall (Section 2.3.4) object’s base type defines (R internal) type storage mode object. Recall 25 base types include \"integer\", \"double\", \"complex\", \"character\". Elements vectors must single data storage mode. Thus, vector contain numeric character data.\nImportantly, element-wise operation applied two unequal length vectors, R generate warning automatically recycle elements shorter vector. instance:case, result addition two vectors : \\(1 + 1, 2 + 0, 3 + 4, 1 + 5\\), \\(2 + 13\\). Thus, first two elements first object recycled vector-wise addition.","code":"\nx <- c(1, 2, 3)\nis.vector(x)[1] TRUE\nlength(x)[1] 3\ndim(x)NULL\nx <- c(a = 1, b = 2, c = 3)\nxa b c \n1 2 3 \nattributes(x)$names\n[1] \"a\" \"b\" \"c\"\nattr(x, \"names\") # or  names(x)[1] \"a\" \"b\" \"c\"\ndim(as.matrix(x))[1] 3 1\nc(1, 2, 3) + c(1, 0, 4, 5, 13)Warning in c(1, 2, 3) + c(1, 0, 4, 5, 13): longer object length is not a\nmultiple of shorter object length[1]  2  2  7  6 15"},{"path":"ch3.html","id":"Sec3M","chapter":"3 Data Objects, Packages, and Datasets","heading":"3.1.2 Matrices","text":"Matrices two-dimensional (row column) data structures whose elements data storage mode (typically \"double\").function matrix() can used create matrices.Note matrix() enters data “column.” , first two entries data argument placed column one, last two entries placed column two. One can enter data “row” adding argument byrow = TRUE.Matrix algebra operations can applied directly R matrices (Table 3.1). complex matrix analyses also possible, including spectral decomposition (function eigen()), single value, QR, Cholesky decompositions (functions svd(), qr(), chol(), respectively).Table 3.1: Simple matrix algebra operations R. operations \\(\\boldsymbol{}\\) (correspondingly, ) matrix\nExample 3.1  \\(\\text{}\\)\nmatrix , defined , form:\\[\\boldsymbol{} = \\begin{bmatrix}\n1 & 3\\\\\n2 & 2\n\\end{bmatrix}.\\]\nConsider operations:\\(\\blacksquare\\)can use function cbind() combine vectors matrix columns,use function rbind() combine vectors matrix rows.","code":"\nA <- matrix(ncol = 2, nrow = 2, data = c(1, 2, 3, 2))\nA     [,1] [,2]\n[1,]    1    3\n[2,]    2    2\nB <- matrix(ncol = 2, nrow = 2, data = c(1, 2, 3, 2), byrow = TRUE)\nB     [,1] [,2]\n[1,]    1    2\n[2,]    3    2\nt(A)     [,1] [,2]\n[1,]    1    2\n[2,]    3    2\nA %*% A     [,1] [,2]\n[1,]    7    9\n[2,]    6   10\ndet(A)[1] -4\nsolve(A)     [,1]  [,2]\n[1,] -0.5  0.75\n[2,]  0.5 -0.25\na <- c(1, 2, 3); b <- c(2, 3, 4)\ncbind(a, b)     a b\n[1,] 1 2\n[2,] 2 3\n[3,] 3 4\nrbind(a,b)  [,1] [,2] [,3]\na    1    2    3\nb    2    3    4"},{"path":"ch3.html","id":"arrays","chapter":"3 Data Objects, Packages, and Datasets","heading":"3.1.3 Arrays","text":"Arrays one, two dimensional (matrix), three dimensional data structures whose elements contain single type data. Thus, matrices arrays, arrays matrices.matrices, elements arrays can one data storage mode.\nfunction array() can used create arrays. first argument array() defines data. second argument vector defines number dimensions (length vector), number levels dimension (numbers dimension elements).Example 3.2  \\(\\text{}\\)\n\\(2 \\times 2 \\times 2\\) array:\\(\\blacksquare\\)","code":"\nclass(A)[1] \"matrix\" \"array\" \ntypeof(A) # base type (data storage mode)[1] \"double\"\nsome.data <- c(1, 2, 3, 4, 5, 6, 7, 8)\nB <- array(some.data, c(2, 2, 2))\nB, , 1\n\n     [,1] [,2]\n[1,]    1    3\n[2,]    2    4\n\n, , 2\n\n     [,1] [,2]\n[1,]    5    7\n[2,]    6    8\nclass(B)[1] \"array\""},{"path":"ch3.html","id":"dataframes","chapter":"3 Data Objects, Packages, and Datasets","heading":"3.1.4 Dataframes","text":"Dataframes two-dimensional structures whose columns can different data storage modes (e.g., quantitative categorical). function data.frame() can used create dataframes.\npossibility different data storage modes distinct columns, data storage mode dataframe \"list\". Specifically, dataframe list, whose storage elements columns.names attribute exist dataframe column34.\n$ operator allows access dataframe columns.function attach() allows R recognize column names dataframe global variables.function detach() programming inverse attach().functions rm() remove() entirely remove R-object, including vector, matrix, dataframe session. remove objects workspace one can use rm(list=ls()) (RStudio) “broom” button environments history panel35.safer alternative attach() function (). Using () eliminates concerns multiple variables name becoming mixed functions. variable names dataframe specified () permanently attached R-session.","code":"\ndf <- data.frame(numeric = c(1, 2, 3), non.numeric = c(\"a\", \"b\", \"c\"))\ndf  numeric non.numeric\n1       1           a\n2       2           b\n3       3           c\nclass(df)[1] \"data.frame\"\ntypeof(df)[1] \"list\"\nnames(df)[1] \"numeric\"     \"non.numeric\"\ndf$non.numeric[1] \"a\" \"b\" \"c\"\nattach(df)\nnon.numeric[1] \"a\" \"b\" \"c\"\ndetach(df)\nnon.numericError: object 'non.numeric' not found\nwith(df, non.numeric)[1] \"a\" \"b\" \"c\""},{"path":"ch3.html","id":"lists","chapter":"3 Data Objects, Packages, and Datasets","heading":"3.1.5 Lists","text":"Lists often used contain miscellaneous associated objects. Like dataframes, lists need use single data storage mode. Unlike dataframes, however, lists can include objects two-dimensional different data classes including character strings (.e., units character objects), multiple matrices dataframes varying dimensionality, even lists. function list() can used create lists.\nObjects lists can called using $ operator. character string b ldata.note create R-object containing character strings, need place quotation\nmarks around entries.function str attempts display internal structure R object. extremely useful succinctly displaying contents complex objects like lists.told ldata1 list containing two objects: sequence numbers 1 3, character string.\nfunction .call() useful large scale manipulations data storage objects. example, list containing multiple dataframes column names wanted bind together?something like:wanted replicate df3 dataframe ldata , binding onto bottom three times? something like:Note use function replicate().\n","code":"\nldata1 <- list(a = c(1, 2, 3), b = \"this.is.a.list\")\nldata1$a\n[1] 1 2 3\n\n$b\n[1] \"this.is.a.list\"\nclass(ldata1)[1] \"list\"\ntypeof(ldata1)[1] \"list\"\nldata1$b[1] \"this.is.a.list\"\nx <- c(\"low\", \"med\", \"high\")\nx[1] \"low\"  \"med\"  \"high\"\nstr(ldata1)List of 2\n $ a: num [1:3] 1 2 3\n $ b: chr \"this.is.a.list\"\nldata2 <- list(df1 = data.frame(lo.temp = c(-1,3,5), \n                                high.temp = c(78, 67, 90)),\n              df2 = data.frame(lo.temp = c(-4,3,7), \n                               high.temp = c(75, 87, 80)),\n              df3 = data.frame(lo.temp = c(-0,2), \n                               high.temp = c(70, 80)))\ndo.call(\"rbind\",ldata2)      lo.temp high.temp\ndf1.1      -1        78\ndf1.2       3        67\ndf1.3       5        90\ndf2.1      -4        75\ndf2.2       3        87\ndf2.3       7        80\ndf3.1       0        70\ndf3.2       2        80\ndo.call(\"rbind\", replicate(3, ldata2$df3, simplify = FALSE))  lo.temp high.temp\n1       0        70\n2       2        80\n3       0        70\n4       2        80\n5       0        70\n6       2        80"},{"path":"ch3.html","id":"boolean-operations","chapter":"3 Data Objects, Packages, and Datasets","heading":"3.2 Boolean Operations","text":"Computer operations dichotomously classify true false statements called logical Boolean. R, Boolean operation always return one values TRUE FALSE. R logical operators listed Table 3.2.\nTable 3.2: Logical (Boolean) operators R; x, y, z columns three four R objects.\nNote two ways specify “” (& &&), two ways specify “” (| ||). longer forms “” “” evaluate queries left right, stopping result determined. Thus, form appropriate programming control-flow operations.Example 3.3  \ndemonstration purposes, simple dataframe:R logical operator equals == (Table 3.2). Thus, identify Age outcomes equal 21 type:argument Age == 21 base type logical.\nunary operator “” ! (Table 3.2). Thus, identify Age outcomes equal 21 type:Multiple Boolean queries can made. identify Age data less 19, equal 21.Queries can involve multiple variables. instance, identify males less equal 21 years old weigh less 80 kg.\\(\\blacksquare\\)\n\n","code":"\ndframe <- data.frame(\nAge = c(18,22,23,21,22,19,18,18,19,21),\nSex = c(\"M\",\"M\",\"M\",\"M\",\"M\",\"F\",\"F\",\"F\",\"F\",\"F\"),\nWeight_kg = c(63.5,77.1,86.1,81.6,70.3,49.8,54.4,59.0,65,69)\n)\n\ndframe   Age Sex Weight_kg\n1   18   M      63.5\n2   22   M      77.1\n3   23   M      86.1\n4   21   M      81.6\n5   22   M      70.3\n6   19   F      49.8\n7   18   F      54.4\n8   18   F      59.0\n9   19   F      65.0\n10  21   F      69.0\nwith(dframe, Age == 21) [1] FALSE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE  TRUE\ntypeof(dframe$Age == 21)[1] \"logical\"\nwith(dframe, Age != 21) [1]  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE\nwith(dframe, Age < 19 | Age == 21) [1]  TRUE FALSE FALSE  TRUE FALSE FALSE  TRUE  TRUE FALSE  TRUE\nwith(dframe, Age <= 21 & Sex == \"M\", weight < 80) [1]  TRUE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE"},{"path":"ch3.html","id":"sctc","chapter":"3 Data Objects, Packages, and Datasets","heading":"3.3 Testing and Coercing Classes","text":"already considered functions identifying class arbitrary R object, foo. include class(foo) attr(foo, \"class\") (Section 2.3.3). also considered approaches identifying base type object, including typeof(foo) (Section 2.3.4). section considers methods identifying object membership particular classes base types, coercing object’s class base type membership.\n","code":""},{"path":"ch3.html","id":"testing","chapter":"3 Data Objects, Packages, and Datasets","heading":"3.3.1 Testing","text":"Functions exist logically test object membership major R classes. functions generally begin .prefix include: .matrix(), .array(), .list(), .factor(), .double(), .integer() .numeric(), .character(), many others.\nBoolean function .numeric() can used test object object’s components behave like numbers36.Thus, x contains numbers stored double precision. However,Data objects categorical entries can created using function factor(). statistics term “factor” refers categorical variable whose categories (factor levels) likely replicated treatments experimental design.R class factor streamlines many analytical processes, including summarization quantitative variable respect factor specifying interactions two factors. see interaction levels x levels another factor, y.Sixteen interactions possible, although four actually occur simultaneously considering x y.decrease memory usage37, objects class factor unexpected base type:\nDespite designation, fact categories x distinguished using numbers, entries x numerical meaning evaluated mathematically.Occasionally ordering categorical levels desirable. instance, assume wish apply three different imprecise temperature treatments \"low\", \"med\" \"high\" experiment six experimental units. know exact temperatures levels, know \"med\" hotter \"low\" \"high\" hotter \"med\". provide categorical ordering can use factor(data, ordered = TRUE) function ordered().\nlevels argument factor() specifies correct ordering levels.\nfunction ifelse() can applied atomic vectors one dimensional arrays (e.g., rows columns) evaluate logical argument provide particular outcomes argument TRUE FALSE. function requires three arguments.first argument, test, gives logical test evaluated.second argument, yes, provides output test true.third argument, , provides output test false.instance:generalized approach providing condition defining consequences (often used functions) uses commands else, potentially combination functions () (). instance:\n.","code":"\nx <- c(23, 34, 10)\nis.numeric(x)[1] TRUE\nis.double(x)[1] TRUE\nx <- c(\"a\", \"b\", 10)\nis.numeric(x)[1] FALSE\nx <- factor(c(1,2,3,4))\nx[1] 1 2 3 4\nLevels: 1 2 3 4\nis.factor(x)[1] TRUE\ny <- factor(c(\"a\",\"b\",\"c\",\"d\"))\ninteraction(x, y)[1] 1.a 2.b 3.c 4.d\n16 Levels: 1.a 2.a 3.a 4.a 1.b 2.b 3.b 4.b 1.c 2.c 3.c 4.c 1.d 2.d ... 4.d\ntypeof(x)[1] \"integer\"\nis.numeric(x)[1] FALSE\nx + 5Warning in Ops.factor(x, 5): '+' not meaningful for factors[1] NA NA NA NA\nx <- factor(c(\"med\",\"low\",\"high\",\"high\",\"med\",\"low\"),\n            levels = c(\"low\",\"med\",\"high\"),\n            ordered = TRUE)\nx[1] med  low  high high med  low \nLevels: low < med < high\nis.factor(x)[1] TRUE\nis.ordered(x)[1] TRUE\nifelse(dframe$Age < 20, \"Young\", \"Not so young\") [1] \"Young\"        \"Not so young\" \"Not so young\" \"Not so young\"\n [5] \"Not so young\" \"Young\"        \"Young\"        \"Young\"       \n [9] \"Young\"        \"Not so young\"\nif(any(dframe$Age < 20))\"Young\" else \"Not so Young\"[1] \"Young\"\nif(all(dframe$Age < 20))\"Young\" else \"Not so Young\"[1] \"Not so Young\""},{"path":"ch3.html","id":"s3coer","chapter":"3 Data Objects, Packages, and Datasets","heading":"3.3.2 Coercion","text":"Objects can switched one class another using coercion functions begin . prefix38. Analogues testing (.) functions listed :\n.matrix(), .array(), .list(), .factor(), .double(), .integer() .numeric(), .character().\ninstance, non-factor object can coerced class factor function .factor().Coercion may result removal addition attributes. instance conversion atomic vector matrix results loss names attribute.Coercion may also unexpected results. NAs result attempting coerce object apparent mixed storage modes class numeric.","code":"\nx <- c(23, 34, 10)\nis.factor(x)[1] FALSE\ny <- as.factor(x)\nis.factor(y)[1] TRUE\nx <- c(eulers_num = exp(1), log_exp = log(exp(1)), pi = pi)\nxeulers_num    log_exp         pi \n    2.7183     1.0000     3.1416 \nnames(x)[1] \"eulers_num\" \"log_exp\"    \"pi\"        \ny <- as.matrix(x)\nnames(y)NULL\nx <- c(\"a\", \"b\", 10)\nas.numeric(x)Warning: NAs introduced by coercion[1] NA NA 10"},{"path":"ch3.html","id":"na","chapter":"3 Data Objects, Packages, and Datasets","heading":"3.3.3 NA","text":"R identifies missing values (empty cells) NA, means “available.” Hence, R function identify missing values .na().\nexample:Conversely, identify outcomes missing, use “” operator specify !.na().number R functions get rid missing values. include na.omit().see R dropped missing observation told us observation omitted (observation number 5).Functions R often, always, built capacities handle missing data, instance, calling na.omit(). Consider following dataframe provides plant percent cover data four plant species two sites. Plant species identified four letter codes, consisting first two letters Linnaean genus species names.function complete.cases() checks completeness data rows data array.na.omit() applied context, entire row containing missing observation dropped.Unfortunately, means information four species site one lost. Thus, generally rational remove NA values retaining non-missing values. instance, many statistical functions capacity base summaries non-NA data.","code":"\nx <- c(2, 3, 1, 2, NA, 3, 2)\nis.na(x)[1] FALSE FALSE FALSE FALSE  TRUE FALSE FALSE\n!is.na(x)[1]  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE\nna.omit(x)[1] 2 3 1 2 3 2\nattr(,\"na.action\")\n[1] 5\nattr(,\"class\")\n[1] \"omit\"\nfield.data <- data.frame(ACMI = c(12, 13), ELSC = c(0, 4), CAEL = c(NA, 2),\n                         CAPA = c(20, 30), TACE = c(0, 2))\nrow.names(field.data) <- c(\"site1\", \"site2\")\n\nfield.data      ACMI ELSC CAEL CAPA TACE\nsite1   12    0   NA   20    0\nsite2   13    4    2   30    2\ncomplete.cases(field.data)[1] FALSE  TRUE\nna.omit(field.data)      ACMI ELSC CAEL CAPA TACE\nsite2   13    4    2   30    2\nmean(field.data[1,], na.rm = T)Warning in mean.default(field.data[1, ], na.rm = T): argument is not\nnumeric or logical: returning NA[1] NA"},{"path":"ch3.html","id":"nan","chapter":"3 Data Objects, Packages, and Datasets","heading":"3.3.4 NaN","text":"designation NaN associated current conventions IEEE 754-2008 arithmetic used R. means “number.” Mathematical operations produce NaN include:\n","code":"\n0/0[1] NaN\nInf-Inf[1] NaN\nsin(Inf)Warning in sin(Inf): NaNs produced[1] NaN"},{"path":"ch3.html","id":"null","chapter":"3 Data Objects, Packages, and Datasets","heading":"3.3.5 NULL","text":"object oriented programming, null object referenced value defined neutral behavior (Wikipedia 2023b). Occasionally one may wish specify R object NULL. example, NULL object can included argument function without requiring particular value meaning. NA NaN, NULL specification easy.class base type x NULL:\nemphasized R-objects elements within objects NA, NaN NULL identified Boolean operators == !=. instance:Instead one use .na(), .nan() .null() identify NA, NaN NULL components, respectively. \n","code":"\nx <- NULL\nclass(x)[1] \"NULL\"\ntypeof(x)[1] \"NULL\"\nx == NULLlogical(0)\ny <- NA\ny == NA[1] NA\nis.null(x)[1] TRUE\n!is.null(x)[1] FALSE\nis.na(y)[1] TRUE\n!is.na(y)[1] FALSE"},{"path":"ch3.html","id":"accessing-and-subsetting-data-with","chapter":"3 Data Objects, Packages, and Datasets","heading":"3.4 Accessing and Subsetting Data With []","text":"One can subset data storage objects using square bracket operators, .e., [], along variety functions39. simplicity, focus square brackets subsetting . Gaining skills square brackets greatly enhance ability manipulate datasets R. toy datasets atomic vector (names attribute), matrix, three dimensional array, dataframe, list:\n\nobtain \\(\\)th component atomic vector, matrix, array, dataframe list named foo specify foo[]. instance, first component toy data objects:Importantly, dataframes lists view \\(\\)th element \\(\\)th column \\(\\)th list element, respectively.can also apply double square brackets, .e., [[]] list-type objects, .e., atomic vectors explicit lists, similar results. Note, however, data subsets now missing name attributes.\ndata storage object names attribute, name can placed square brackets obtain corresponding data.advantage square brackets $ application several components can specified simultaneously using former approach:foo row \\(\\times\\) column structure, .e., matrix, array, dataframe, obtain \\(\\)th column foo using foo[,] (foo[[]]) \\(j\\)th row foo using foo[j,]. instance, second column mdat, first row ddat.element foo corresponding row j column can accessed using: foo[j, ], foo[,][j], foo[j,][].Arrays may require two indices. instance, three dimensional array, foo, specification foo[,j,] return entirety \\(j\\)th column \\(\\)th component outermost dimension foo, whereas foo[k,j,] return \\(k\\)th element \\(j\\)th column \\(\\)th component outermost dimension foo.Ranges particular subsets elements data storage object can also selected. instance, access rows two three ddat:can drop data object components using negative integers square brackets. obtain identical result example dropping row one ddat:obtain ddat rows one three two different ways:Square braces can also used rearrange data components:Duplicate components:even replace data components:","code":"\nvdat <- c(a = 1, b = 2, c = 3)\nvdata b c \n1 2 3 \nmdat <- matrix(ncol = 2, nrow = 2, data = c(1, 2, 3, 4))\nmdat     [,1] [,2]\n[1,]    1    3\n[2,]    2    4\nadat <- array(dim = c(2, 2, 2), data = c(1, 2, 3, 4, 5, 6, 7, 8))\nadat, , 1\n\n     [,1] [,2]\n[1,]    1    3\n[2,]    2    4\n\n, , 2\n\n     [,1] [,2]\n[1,]    5    7\n[2,]    6    8\nddat <- data.frame(numeric = c(1, 2, 3), non.numeric = c(\"a\", \"b\", \"c\"))\nddat  numeric non.numeric\n1       1           a\n2       2           b\n3       3           c\nldat <- list(element1 = c(1, 2, 3), element2 = \"this.is.a.list\")\nldat$element1\n[1] 1 2 3\n\n$element2\n[1] \"this.is.a.list\"\nvdat[1]a \n1 \nmdat[1][1] 1\nadat[1][1] 1\nddat[1]  numeric\n1       1\n2       2\n3       3\nldat[1]$element1\n[1] 1 2 3\nvdat[[1]][1] 1\nldat[[1]][1] 1 2 3\nddat[\"numeric\"]  numeric\n1       1\n2       2\n3       3\nddat[c(\"non.numeric\",\"numeric\")]  non.numeric numeric\n1           a       1\n2           b       2\n3           c       3\nmdat[,2][1] 3 4\nddat[1,]  numeric non.numeric\n1       1           a\nmdat[1,2]; mdat[,2][1]; mdat[1,][2] # 1st element from 2nd column[1] 3[1] 3[1] 3\nadat[,2,1][1] 3 4\nadat[1,2,1][1] 3\nadat[2,2,1][1] 4\nddat[2:3,] # note the position of the comma  numeric non.numeric\n2       2           b\n3       3           c\nddat[-1,] # drop row one  numeric non.numeric\n2       2           b\n3       3           c\nddat[c(1,3),]  numeric non.numeric\n1       1           a\n3       3           c\nddat[-2,]  numeric non.numeric\n1       1           a\n3       3           c\nddat[c(3,1,2),]  numeric non.numeric\n3       3           c\n1       1           a\n2       2           b\nldat[c(2,2)]$element2\n[1] \"this.is.a.list\"\n\n$element2\n[1] \"this.is.a.list\"\nddat[,2] <- c(\"d\",\"e\",\"f\")\nddat  numeric non.numeric\n1       1           d\n2       2           e\n3       3           f"},{"path":"ch3.html","id":"subsetting-a-factor","chapter":"3 Data Objects, Packages, and Datasets","heading":"3.4.1 Subsetting a Factor","text":"Importantly, factor level structure factor remain intact even one levels entirely removed.Note level remains characteristic fdat, even though cell containing lone observation removed dataset. outcome allowed desirable certain analytical situations (instance, summarizations acknowledge missing data levels). remove levels longer occur factor, can use function droplevels().","code":"\nfdat <- as.factor(ddat[,2])\nfdat[1] d e f\nLevels: d e f\nfdat[-1][1] e f\nLevels: d e f\ndroplevels(fdat[-1])[1] e f\nLevels: e f"},{"path":"ch3.html","id":"subsetting-with-boolean-operators","chapter":"3 Data Objects, Packages, and Datasets","heading":"3.4.2 Subsetting with Boolean Operators","text":"Boolean (TRUE FALSE) outcomes can used combination square brackets subset data. Consider dataframe used earlier (Exercise 3.3) demonstrate logical commands.extract Age outcomes less equal 21.also use information obtain entire rows dataframe.","code":"\ndframe <- data.frame(\nAge = c(18,22,23,21,22,19,18,18,19,21),\nSex = c(\"M\",\"M\",\"M\",\"M\",\"M\",\"F\",\"F\",\"F\",\"F\",\"F\"),\nWeight_kg = c(63.5,77.1,86.1,81.6,70.3,49.8,54.4,59.0,65,69)\n)\nageTF <- dframe$Age <= 21\ndframe$Age[ageTF][1] 18 21 19 18 18 19 21\ndframe[ageTF,]   Age Sex Weight_kg\n1   18   M      63.5\n4   21   M      81.6\n6   19   F      49.8\n7   18   F      54.4\n8   18   F      59.0\n9   19   F      65.0\n10  21   F      69.0"},{"path":"ch3.html","id":"when-subset-is-larger-than-underlying-data","chapter":"3 Data Objects, Packages, and Datasets","heading":"3.4.3 When Subset Is Larger Than Underlying Data","text":"R allows one make data subset larger underlying data , although results generation filler NAs. Consider following example:atomic vector x length five. ask subset length seven, get:","code":"\nx <- c(-2, 3, 4, 6, 45)\nx[1:7][1] -2  3  4  6 45 NA NA"},{"path":"ch3.html","id":"utlt","chapter":"3 Data Objects, Packages, and Datasets","heading":"3.4.4 Subsetting with upper.tri(), lower.tri(), and diag()","text":"can use square brackets alongside functions upper.tri(), lower.tri(), diag() examine upper triangle, lower triangle, diagonal parts matrix, respectively.\nNote upper.tri() lower.tri() used identify appropriate triangle object mat. Subsetting accomplished using square brackets.","code":"\nmat <- matrix(ncol = 3, nrow = 3, data = c(1, 2, 3, 2, 4, 3, 5, 1, 4))\nmat     [,1] [,2] [,3]\n[1,]    1    2    5\n[2,]    2    4    1\n[3,]    3    3    4\nmat[upper.tri(mat)][1] 2 5 1\nmat[lower.tri(mat)][1] 2 3 3\ndiag(mat)[1] 1 4 4"},{"path":"ch3.html","id":"package","chapter":"3 Data Objects, Packages, and Datasets","heading":"3.5 Packages","text":"R package contains set related functions, documentation, (often) data files bundled together. -called R-distribution packages included conventional download R (Table 3.3). packages directly controlled R core development team extremely well-vetted trustworthy.Packages Table 3.4 constitute R-recommended packages. necessarily controlled R core development team, also extremely useful, well-tested, stable, like R-distribution packages, included conventional downloads R.Aside distribution recommended packages, large number contributed packages created R-users (\\(> 20000\\) 9/12/2023). Table 3.5 lists .","code":""},{"path":"ch3.html","id":"packagei","chapter":"3 Data Objects, Packages, and Datasets","heading":"3.5.1 Package Installation","text":"Contributed packages can installed CRAN (Comprehensive R Archive Network). , one can go Packages\\(>\\)Install package(s) R-GUI toolbar, choose nearby CRAN mirror site minimize download time (non-Unix ). mirror site selected, packages available site appear. One can simply click desired packages install . Packages can also downloaded directly command line using install.packages(\"package name\"). Thus, install package vegan (see Table 3.5), simply type:local web access available, packages can installed compressed (.zip, .tar) files can placed manually workstation inserting package files library folder within top level R directory, path-defined R library folder user directory.installation pathway contributed packages can identified using .libPath().\nprocess can facilitated RStudio via plots files (see Section 2.9).Several functions exist updating packages comparing currently installed versions packages latest versions CRAN repositories. function old.packages() indicates currently installed packages (suitable) later version. packages installed later versions.function update.packages() identify, offer download install later versions installed packages.\n","code":"\ninstall.packages(\"vegan\")\n.libPaths()[1] \"C:/Users/ahoken/AppData/Local/R/win-library/4.4\"\n[2] \"C:/Program Files/R/R-4.4.2/library\"             \nhead(old.packages(repos = \"https://cloud.r-project.org\"))[,c(1,3,4,5)]         Package    Installed Built   ReposVer \nape      \"ape\"      \"5.8\"     \"4.4.1\" \"5.8-1\"  \naskpass  \"askpass\"  \"1.2.0\"   \"4.4.1\" \"1.2.1\"  \nbit      \"bit\"      \"4.0.5\"   \"4.4.1\" \"4.5.0.1\"\nbit64    \"bit64\"    \"4.0.5\"   \"4.4.1\" \"4.6.0-1\"\nbookdown \"bookdown\" \"0.39\"    \"4.4.0\" \"0.42\"   \nbroom    \"broom\"    \"1.0.6\"   \"4.4.1\" \"1.0.7\"  "},{"path":"ch3.html","id":"packagel","chapter":"3 Data Objects, Packages, and Datasets","heading":"3.5.2 Loading Packages","text":"contributed package installed computer never needs re-installed. However, use R session, recommended packages, installed contributed packages need loaded. can done using library() function, point click tools one using RStudio. example, load installed contributed vegan package, type:see two packages loaded load vegan: permute lattice.detach vegan global environment, type:can check specific package loaded using function .packages(). R distribution packages loaded (default) upon opening session. Exceptions include compiler, grid, parallel, splines, stats4, tools.function sapply(), allows application function element vector list, formally introduced Section 4.1.1.package vegan longer loaded application detach(package:vegan).\ncan get summary information session, including details version R used, underlying computer platform, loaded packages function sessionInfo().information important include reporting issues package maintainers.\npackage installed functions can generally accessed using double colon metacharacter, ::, even package actually loaded. instance, function vegan::diversity() allow access function diversity() vegan, even vegan loaded.triple colon metacharacter, :::, can used access internal package functions. functions, however, generally kept internal good reason, probably shouldn’t used outside context rest package.\n","code":"\nlibrary(vegan)Loading required package: permuteLoading required package: latticeThis is vegan 2.6-8\ndetach(package:vegan)\nbpack <- c(\"base\", \"compiler\", \"datasets\", \"grDevices\", \"graphics\",\n           \"grid\", \"methods\", \"parallel\", \"splines\", \"stats\", \"stats4\", \n           \"tcltk\", \"tools\", \"translations\", \"utils\")\nsapply(bpack, function(x) (x %in% .packages()))        base     compiler     datasets    grDevices     graphics \n        TRUE        FALSE         TRUE         TRUE         TRUE \n        grid      methods     parallel      splines        stats \n       FALSE         TRUE        FALSE        FALSE         TRUE \n      stats4        tcltk        tools translations        utils \n       FALSE         TRUE        FALSE        FALSE         TRUE \n\"vegan\" %in% .packages()[1] FALSE\nsi <- sessionInfo()\nsi$R.version$version.string[1] \"R version 4.4.2 (2024-10-31 ucrt)\"\nsi$running[1] \"Windows 10 x64 (build 17134)\"\nhead(names(si$loadedOnly))[1] \"Matrix\"   \"jsonlite\" \"vegan\"    \"compiler\" \"plotrix\"  \"xml2\"    \nhead(vegan::diversity)[1:2][1] function (x, index = \"shannon\", groups, equalize.groups = FALSE, \n[2]     MARGIN = 1, base = exp(1))                                   "},{"path":"ch3.html","id":"other-package-repositories","chapter":"3 Data Objects, Packages, and Datasets","heading":"3.5.3 Other Package Repositories","text":"Aside CRAN, currently three extensive repositories R packages. First, Bioconductor project (http://www.bioconductor.org/packages/release/Software/html) contains large number packages analysis data current emerging biological assays. Bioconductor packages generally stored CRAN. Packages can downloaded Bioconductor using R script called biocLite. access script download package RCytoscape Biocondctor, type:Second, Posit Package Manager (formerly RStudio Package Manager) provides repository interface R packages CRAN, Bioconductor, packages Python system (see Section 9.5). Third, R-forge (http://r-forge.r-project.org/) contains releases packages yet implemented CRAN, miscellaneous code. Bioconductor, Posit, R-forge can specified repositories Packages\\(>\\)Select Repositories R-GUI (non-Unix ). informal R package code repositories currently include GitHub Zenodo.\nTable 3.3: R-distribution packages.\nTable 3.4: R-recommended packages.\nTable 3.5: Useful contributed R packages.\n","code":"\nsource(\"http://bioconductor.org/biocLite.R\")\nbiocLite(\"RCytoscape\")"},{"path":"ch3.html","id":"accessing-package-information","chapter":"3 Data Objects, Packages, and Datasets","heading":"3.5.4 Accessing Package Information","text":"Important information concerning package can obtained packageDescription() family functions. version R contributed package asbio work station:version R used build installed version asbio, package’s build date:\n","code":"\npackageVersion(\"asbio\")[1] '1.11'\npackageDescription(\"asbio\", fields=\"Built\")[1] \"R 4.4.2; ; 2025-01-21 02:43:26 UTC; windows\""},{"path":"ch3.html","id":"accessing-datasets-in-r-packages","chapter":"3 Data Objects, Packages, and Datasets","heading":"3.5.5 Accessing Datasets in R-packages","text":"command:results listing datasets available session within R packages loaded particular R session. Whereas code:results listing datasets available session within installed R packages.one interested datasets particular package, instance package datasets, one type:dataset Loblolly datasets package contains height, age, seed type records sample loblolly pine trees (Pinus taeda). access data can type:40The data now contained dataframe (called Loblolly) can manipulate analyze.Note three classes (nfnGroupedData, nfGroupedData, groupedData) addition dataframe. classes allow recognition nested structure age Seed variables (defined height function age Seed), facilitates analysis data using mixed effect model algorithms package nlme. can get general feel Loblolly dataset accessing first rows using function head():function summary() provides mean conventional five number summary (minimum, 1st quartile, median, 3rd quartile, maximum) quantitative variables (height age) count number observations (six) level categorical variable Seed.R provides spreadsheet-style data editor one types fix(x), x dataframe two dimensional array. instance, command fix(loblolly) open Loblolly pine dataframe data editor (Figure 3.1). x function character string, script editor opened containing x. data editor limited flexibility compared software whose main interface spreadsheet, whose primary purpose data entry manipulation, e.g., Microsoft Excel\\(^{\\circledR}\\). Changes made object using fix() maintained current work session. permanently alter objects brought remotely session. function View(x) (RStudio ) provide non-editable spreadsheet representation dataframe numeric array.\n\nFigure 3.1: default R spreadsheet editor.\n","code":"\ndata()\ndata(package = .packages(all.available = TRUE))\ndata(package = \"datasets\")\ndata(Loblolly)\nclass(Loblolly)[1] \"nfnGroupedData\" \"nfGroupedData\"  \"groupedData\"    \"data.frame\"    \nhead(Loblolly, 5)Grouped Data: height ~ age | Seed\n   height age Seed\n1    4.51   3  301\n15  10.89   5  301\n29  28.72  10  301\n43  41.74  15  301\n57  52.70  20  301\nsummary(Loblolly)     height           age            Seed   \n Min.   : 3.46   Min.   : 3.0   329    : 6  \n 1st Qu.:10.47   1st Qu.: 5.0   327    : 6  \n Median :34.00   Median :12.5   325    : 6  \n Mean   :32.36   Mean   :13.0   307    : 6  \n 3rd Qu.:51.36   3rd Qu.:20.0   331    : 6  \n Max.   :64.10   Max.   :25.0   311    : 6  \n                                (Other):48  "},{"path":"ch3.html","id":"facilitating-command-line-data-entry","chapter":"3 Data Objects, Packages, and Datasets","heading":"3.6 Facilitating Command Line Data Entry","text":"Command line data entry made easier several R functions. function scan() can speed data entry prompt given data point41, separators created function . Data entries can separated using space bar line breaks. scan() function terminated additional blank line end file (EOF) signal. Ctrl + D Unix-alike operating systems Windows.enter numbers 1, 2, 3 datapoints, separated spaces, end data entry using additional line break. data saved object .Sequences can generated quickly R using : operatoror function seq(), allows additional options:Entries can repeated function rep(). example, repeat sequence 1 5, five times, type:Note first argument rep(), defines thing want repeat second argument, 5, specifies number repetitions. can use argument repeat individual elements particular number times.can use seq() rep() simultaneously create complex sequences. instance, repeat sequence 1,3,5,7,9,11,13,15,17,19, three times, type:","code":"a <- scan()\n1: 1 2 3\n4:\nRead 3 items\n1:10 [1]  1  2  3  4  5  6  7  8  9 10\nseq(1, 10) [1]  1  2  3  4  5  6  7  8  9 10\nseq(1, 10, by = 2) # 1 to 10 by two[1] 1 3 5 7 9\nseq(1, 10, length = 4) # 1 to 10 in four evenly spaced points[1]  1  4  7 10\nrep(c(1:5), 5) [1] 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5 1 2 3 4 5\nrep(c(1:5), each = 2) [1] 1 1 2 2 3 3 4 4 5 5\nrep(seq(1, 20, by = 2), 3) [1]  1  3  5  7  9 11 13 15 17 19  1  3  5  7  9 11 13 15 17 19  1  3  5\n[24]  7  9 11 13 15 17 19"},{"path":"ch3.html","id":"importing-data-into-r","chapter":"3 Data Objects, Packages, and Datasets","heading":"3.7 Importing Data Into R","text":"possible enter data R command line, normally inadvisable except small datasets. general much easier import data. R can read data many different kinds formats including .txt, .csv (comma separator) files, files space, tab, carriage return datum separators. generally organize datasets using Excel\\(^{\\circledR}\\) spreadsheet program (although R can handle much larger datasets platforms), save .csv files. import .csv files R using read.table(), read.csv(), scan() functions. function load() can used import data files .rda data formats, R objects. Datasets read R generally class dataframe data storage mode list.","code":""},{"path":"ch3.html","id":"rt","chapter":"3 Data Objects, Packages, and Datasets","heading":"3.7.1 Import Using read.table(), read.csv(), and scan()","text":"read.table() function can import data organized wide range formats. ’s first three arguments important.file defines name file directory hierarchy data read .header logical (TRUE FALSE) value indicating whether file contains column names first line.sep refers type data separator used columns. Comma separated files use commas separate data entries. Thus, case sep = \",\". Tab separators specified \"\\t\". Space separators specified spaces, specified simply \" \".useful read.table() arguments include row.names, header, na.strings. specification row.names = 1 indicates first column imported dataset contains row names. specification header = TRUE, default setting, indicates first row data contains column names. argument na.strings = \".\" indicates missing values imported dataset designated periods. default na.strings = NA.example read.table() usage, assume want import .csv file called veg.csv located folder called veg_data, working directory. first row veg.csv contains column names, first column contains row names. Missing data file indicated periods. type:, note legacy development Unix, R locates files directories using forward slashes (doubled backslashes) rather single Windows backslashes.read.csv() function assumes data .csv format. argument sep unnecessary, results simpler code statement.function scan() can read data essentially unlimited number formats, extremely flexible respect character fields storage modes numeric data.\naddition arguments used read.table(), scan() argumentswhat describes storage mode data e.g., \"logical\", \"integer\", etc., list, components variables including column names (see ), anddec describes decimal point character (European scientists journals often use commas).Assume veg_data/veg.csv column species names, called species, serve dataframe’s row names, 3 columns numeric data, named site1, site2, site3. read data scan using:empty string species = \"\" list comprising argument , indicates species contains character data. Stating remaining variables equal 0, number, indicates contain numeric data.easiest way import data, directory structure unknown complex, use read.csv() read.table(), file.choose() function file argument. instance, typing:can now browse .csv files open , following import, dataframe name df. arguments (e.g., header, row.names) need used, appropriate, import file correctly.Occasionally strange characters, e.g., ï.., may appear front first header name reading files created Excel\\(^{\\circledR}\\) Microsoft applications. due addition Byte Order Mark (BOM) characters indicate, among things, Unicode character encoding file. characters can generally eliminated using argument fileEncoding=\"UTF-8-BOM\" read.table(), read.csv(), scan().\n","code":"\nread.table(\"veg_data/veg.csv\", sep = \",\", header = TRUE, row.names\n= 1, na.strings = \".\")\nread.csv(\"veg_data\\\\veg.csv\", header = TRUE, row.names\n= 1, na.strings = \".\")\nscan(\"veg.csv\", what = list(species = \"\", site1 = 0, site2 = 0, site3 = 0),\nna.strings = \".\")\ndf <- read.csv(file.choose())"},{"path":"ch3.html","id":"import-using-rstudio","chapter":"3 Data Objects, Packages, and Datasets","heading":"3.7.2 Import Using RStudio","text":"RStudio allows direct menu-driven import file types number spreadsheet statistical packages including Excel\\(^{\\circledR}\\), SPSS\\(^{\\circledR}\\), SAS\\(^{\\circledR}\\), Stata\\(^{\\circledR}\\) going File\\(>\\)Import Dataset. note, however, restrictions may exist, may present read.table() read.csv(). summarized Table 3.6.Table 3.6: Data import options RStudio data storage file type.","code":""},{"path":"ch3.html","id":"final-considerations","chapter":"3 Data Objects, Packages, and Datasets","heading":"3.7.3 Final Considerations","text":"generally recommended datasets imported used R smaller 25% physical memory computer. instance, use less 8 GB computer 32 GB RAM. R can handle extremely large datasets, .e. \\(> 10\\) GB, \\(> 1.2 \\times 10^{10}\\) rows. case, however, specific R packages can used aid efficient data handling. Parallel computing workstation modifications may allow even greater efficiency. actual upper physical limit R dataframe \\(2 \\times 10^{31}-1\\) elements. Note exceeds Excel\\(^{\\circledR}\\) 31 orders magnitude (Excel 2019 worksheets can handle approximately \\(1.7 \\times 10^{10}\\) cell elements). R also allows interfacing number relational database storage platforms. include open source entities express queries SQL (Structured Query Language). information see .","code":""},{"path":"ch3.html","id":"exercises-2","chapter":"3 Data Objects, Packages, and Datasets","heading":"Exercises","text":"Create following data structures:\natomic vector object numeric entries 1,2,3,4.\nmatrix object two rows two columns numeric entries 1,2,3,4.\ndataframe object two columns; one column containing numeric entries 1,2,3,4, one column containing character entries \"\",\"b\",\"c\",\"d\".\nlist containing objects created (b) (c).\nUsing class(), identify class data storage mode objects created problems -d. Discuss characteristics identified classes.\natomic vector object numeric entries 1,2,3,4.matrix object two rows two columns numeric entries 1,2,3,4.dataframe object two columns; one column containing numeric entries 1,2,3,4, one column containing character entries \"\",\"b\",\"c\",\"d\".list containing objects created (b) (c).Using class(), identify class data storage mode objects created problems -d. Discuss characteristics identified classes.Assume developed R algorithm saves hourly stream temperature sensor outputs greater \\(20^\\text{o}\\) day separate dataframes places list container, days may several points exceeding threshold days may none. Complete following based list hi.temps given :\nCombine dataframes hi.temps single dataframe using .call().\nCreate dataframe consisting 10 sets repeated measures dataframe hi.temps$day2 using .call().\n\nhi.temps <- list(day1 = data.frame(time = c(), temp = c()),\n                 day2 = data.frame(time = c(15,16), \n                                   temp = c(21.1,22.2)),\n                 day3 = data.frame(time = c(14,15,16),\n                                   temp = c(21.3,20.2,21.5)))\nCombine dataframes hi.temps single dataframe using .call().Combine dataframes hi.temps single dataframe using .call().Create dataframe consisting 10 sets repeated measures dataframe hi.temps$day2 using .call().\n\nhi.temps <- list(day1 = data.frame(time = c(), temp = c()),\n                 day2 = data.frame(time = c(15,16), \n                                   temp = c(21.1,22.2)),\n                 day3 = data.frame(time = c(14,15,16),\n                                   temp = c(21.3,20.2,21.5)))Create dataframe consisting 10 sets repeated measures dataframe hi.temps$day2 using .call().Given dataframe boo , provide solutions following questions:\nIdentify heights less equal 80 inches.\nIdentify heights 80 inches.\nIdentify females (.e. F) greater equal 59 inches less 63 inches.\nSubset rows boo contain data males (.e. M) greater equal 75 inches tall.\nFind mean weight males 75 76 inches tall.\nUse ifelse() () classify heights equal 60 inches \"small\", heights greater equal 60 inches \"tall\".\n\nboo <- data.frame(height.= c(70, 76, 72, 73, 81, 66, 69, 75, \n                                80, 81, 60, 64, 59, 61, 66, 63, \n                                59, 58, 67, 59),\n                  weight.lbs = c(160, 185, 180, 186, 200, 156, \n                                 163, 178, 186, 189, 140, 156, \n                                 136, 141, 158, 154, 135, 120, \n                                 145, 117),\n                  sex = c(rep(\"M\", 10), rep(\"F\", 10)))\nIdentify heights less equal 80 inches.Identify heights less equal 80 inches.Identify heights 80 inches.Identify heights 80 inches.Identify females (.e. F) greater equal 59 inches less 63 inches.Identify females (.e. F) greater equal 59 inches less 63 inches.Subset rows boo contain data males (.e. M) greater equal 75 inches tall.Subset rows boo contain data males (.e. M) greater equal 75 inches tall.Find mean weight males 75 76 inches tall.Find mean weight males 75 76 inches tall.Use ifelse() () classify heights equal 60 inches \"small\", heights greater equal 60 inches \"tall\".\n\nboo <- data.frame(height.= c(70, 76, 72, 73, 81, 66, 69, 75, \n                                80, 81, 60, 64, 59, 61, 66, 63, \n                                59, 58, 67, 59),\n                  weight.lbs = c(160, 185, 180, 186, 200, 156, \n                                 163, 178, 186, 189, 140, 156, \n                                 136, 141, 158, 154, 135, 120, \n                                 145, 117),\n                  sex = c(rep(\"M\", 10), rep(\"F\", 10)))Use ifelse() () classify heights equal 60 inches \"small\", heights greater equal 60 inches \"tall\".Create x <- NA, y <- NaN, z <- NULL.\nTest class x using x == NA .na(x) discuss results.\nTest class y using y == NaN .nan(y) discuss results.\nTest class z using z == NULL .null(z) discuss results.\nDiscuss NA, NaN, NULL designations classes used represent?\nTest class x using x == NA .na(x) discuss results.Test class y using y == NaN .nan(y) discuss results.Test class z using z == NULL .null(z) discuss results.Discuss NA, NaN, NULL designations classes used represent?following questions, use data Table 3.7 .\nWrite data R dataframe called plant. Use functions seq() rep() help.\nUse names() find names variables.\nAccess first row data using square brackets.\nAccess third column data using square brackets.\nAccess rows three five using square brackets.\nAccess rows except rows three, five seven using square brackets.\nAccess fourth element third column using square brackets.\nApply na.omit() dataframe discuss consequences.\nCreate copy plant called plant2. Using square brackets, replace 7th item 2nd column plant2, NA value, value 12.1.\nSwitch locations columns two three plant2 using square brackets.\nExport plant2 dataframe working directory.\nConvert plant2 dataframe matrix using function .matrix. Discuss consequences.\nWrite data R dataframe called plant. Use functions seq() rep() help.Use names() find names variables.Access first row data using square brackets.Access third column data using square brackets.Access rows three five using square brackets.Access rows except rows three, five seven using square brackets.Access fourth element third column using square brackets.Apply na.omit() dataframe discuss consequences.Create copy plant called plant2. Using square brackets, replace 7th item 2nd column plant2, NA value, value 12.1.Switch locations columns two three plant2 using square brackets.Export plant2 dataframe working directory.Convert plant2 dataframe matrix using function .matrix. Discuss consequences.Table 3.7: Data Question 5.Let:\n\\[\\boldsymbol{} = \\begin{bmatrix}\n2 & -3\\\\\n1 & 0\n\\end{bmatrix}\n\\text{ } \\boldsymbol{b} = \\begin{bmatrix}\n1\\\\\n5\n\\end{bmatrix} \\]\nPerform following operations using R:\n\\(\\boldsymbol{}\\boldsymbol{b}\\)\n\\(\\boldsymbol{b}\\boldsymbol{}\\)\n\\(det(\\boldsymbol{})\\)\n\\(\\boldsymbol{}^{-1}\\)\n\\(\\boldsymbol{}'\\)\n\\(\\boldsymbol{}\\boldsymbol{b}\\)\\(\\boldsymbol{b}\\boldsymbol{}\\)\\(det(\\boldsymbol{})\\)\\(\\boldsymbol{}^{-1}\\)\\(\\boldsymbol{}'\\)can solve systems linear equations using matrix algebra framework \\(\\boldsymbol{}\\boldsymbol{x} = \\boldsymbol{b}\\), (thus) \\(\\boldsymbol{}^{-1}\\boldsymbol{b} = \\boldsymbol{x}\\). notation \\(\\boldsymbol{}\\) contains coefficients series linear equations (row), \\(\\boldsymbol{b}\\) vector solutions given individuals equations, \\(\\boldsymbol{x}\\) vector solutions sought system models. Thus, linear equations:\\[\\begin{aligned}\nx + y &= 2\\\\\n-x + 3y &= 4\n\\end{aligned}\\]            :\\[\\boldsymbol{} = \\begin{bmatrix}\n1 & 1\\\\\n-1 & 3\n\\end{bmatrix}, \\boldsymbol{ x} = \\begin{bmatrix}\nx\\\\\ny\n\\end{bmatrix}, \\text{  } \\boldsymbol{b} = \\begin{bmatrix}\n2\\\\\n4\n\\end{bmatrix}.\\]           Thus, \\[\\boldsymbol{}^{-1}\\boldsymbol{b} = \\boldsymbol{x} = \\begin{bmatrix}\n1/2\\\\\n3/2\n\\end{bmatrix}.\\]           Given framework, solve system equations linear algebra using R.\\[\n\\begin{aligned}\n3x + 2y - z &= 1\\\\\n2x - 2y + 4z &= -2\\\\\n-x + 0.5y -z &= 0\n\\end{aligned}\n\\]Complete following exercises concerning R contributed package asbio:\nInstall42 load package asbio current work session.\nAccess help file bplot() (function asbio).\nLoad dataset fly.sex asbio.\nObtain documentation dataset fly.sex describe dataset variables.\nAccess column longevity fly.sex using function ().\nInstall42 load package asbio current work session.Access help file bplot() (function asbio).Load dataset fly.sex asbio.Obtain documentation dataset fly.sex describe dataset variables.Access column longevity fly.sex using function ().Create .csv .txt datasets, place working directory, read R.","code":"\nhi.temps <- list(day1 = data.frame(time = c(), temp = c()),\n                 day2 = data.frame(time = c(15,16), \n                                   temp = c(21.1,22.2)),\n                 day3 = data.frame(time = c(14,15,16),\n                                   temp = c(21.3,20.2,21.5)))\nboo <- data.frame(height.in = c(70, 76, 72, 73, 81, 66, 69, 75, \n                                80, 81, 60, 64, 59, 61, 66, 63, \n                                59, 58, 67, 59),\n                  weight.lbs = c(160, 185, 180, 186, 200, 156, \n                                 163, 178, 186, 189, 140, 156, \n                                 136, 141, 158, 154, 135, 120, \n                                 145, 117),\n                  sex = c(rep(\"M\", 10), rep(\"F\", 10)))"},{"path":"ch4.html","id":"ch4","chapter":"4 Basic Data Management","heading":"4 Basic Data Management","text":"“think, therefore R.\"- William B. King, Psychologist R enthusiast\\(\\text{}\\)\nimportant characteristic R capacity efficiently manage analyze large, complex, datasets. chapter list functions approaches useful data management base R. Data management considerations tidyverse given Chapter 5.","code":""},{"path":"ch4.html","id":"operations-on-arrays-lists-and-vectors","chapter":"4 Basic Data Management","heading":"4.1 Operations on Arrays, Lists and Vectors","text":"Operators can applied individually every row column array, every component list atomic vector using number time saving methods.","code":""},{"path":"ch4.html","id":"apply","chapter":"4 Basic Data Management","heading":"4.1.1 The apply Family of Functions","text":"","code":""},{"path":"ch4.html","id":"apply-1","chapter":"4 Basic Data Management","heading":"4.1.1.1 apply()","text":"Operations can performed quickly rows columns two dimensional arrays function apply(). function requires three\narguments.first argument, X, specifies array analyzed.second argument, MARGIN, connotes whether rows columns analyzed. MARGIN = 1 indicates rows, MARGIN = 2 indicates columns, whereas MARGIN = c(1, 2) indicates rows columns.third argument, FUN, defines function applied margins object first argument.Example 4.1  \nConsider asbio::bats dataset contains forearm length data, millimeters, northern myotis bats (Myotis septentrionalis), along corresponding bat ages days.obtain minimum values days forearm.length columns.straightforward change third argument apply() obtain different summaries, like mean.standard deviationSeveral summary statistical functions exist numerical arrays can used instances place apply(). include rowMeans() colMeans() give sample means specified rows columns, respectively, rowSums() colSums() give sums specified rows columns, respectively. instance:\n\\(\\blacksquare\\)","code":"\nlibrary(asbio)\ndata(bats)\nhead(bats)  days forearm.length\n1    1           10.5\n2    1           11.0\n3    1           12.3\n4    1           13.7\n5    1           14.2\n6    1           14.8\napply(bats, 2, min)          days forearm.length \n           1.0           10.5 \napply(bats, 2, mean)          days forearm.length \n        13.579         23.603 \napply(bats, 2, sd)          days forearm.length \n       12.4610         8.4347 \ncolMeans(bats)          days forearm.length \n        13.579         23.603 "},{"path":"ch4.html","id":"lapply","chapter":"4 Basic Data Management","heading":"4.1.1.2 lapply()","text":"function lapply() allows one sweep functions list components. two main arguments:first argument, X, specifies list analyzed.second argument, FUN, defines function applied element X.Example 4.2  Consider following simple list, whose three components different lengths.sweep function mean() list:Note Boolean outcomes logic coerced numeric outcomes. Specifically, TRUE = 1 FALSE = 0. 1st, 2nd (median), 3rd quartiles x:\\(\\blacksquare\\)","code":"\nx <- list(a = 1:8, norm.obs = rnorm(10), \n          logic = c(TRUE, TRUE, FALSE, FALSE))\nx$a\n[1] 1 2 3 4 5 6 7 8\n\n$norm.obs\n [1]  0.21430 -0.20653  1.43494  0.35765  1.36600  2.29011  0.11071\n [8] -0.32023  0.45659  0.68799\n\n$logic\n[1]  TRUE  TRUE FALSE FALSE\nlapply(x, mean)$a\n[1] 4.5\n\n$norm.obs\n[1] 0.63915\n\n$logic\n[1] 0.5\nlapply(x, quantile, probs = 1:3/4)$a\n 25%  50%  75% \n2.75 4.50 6.25 \n\n$norm.obs\n    25%     50%     75% \n0.13661 0.40712 1.19650 \n\n$logic\n25% 50% 75% \n0.0 0.5 1.0 "},{"path":"ch4.html","id":"sapply","chapter":"4 Basic Data Management","heading":"4.1.1.3 sapply()","text":"function sapply() user friendly wrapper lapply() can return vector array instead list.","code":"\nsapply(x, quantile, probs = 1:3/4)       a norm.obs logic\n25% 2.75  0.13661   0.0\n50% 4.50  0.40712   0.5\n75% 6.25  1.19650   1.0"},{"path":"ch4.html","id":"tapply","chapter":"4 Basic Data Management","heading":"4.1.1.4 tapply()","text":"tapply() function allows summarization one dimensional array (e.g., column row matrix) respect levels categorical variable. function requires three arguments.first argument, X, defines one dimensional array analyzed.second argument, INDEX provide list one factors (see example ) length X.third argument, FUN, used specify function applied X level INDEX.Example 4.3  \\(\\text{}\\)\nConsider dataset asbio::heart, documents pulse rates twenty four subjects four time periods following administration experimental treatment. two active heart medications control. average heart rates treatments.mean heart rates treatments, time frame. Note second argument defined list two components, can coerced factor.\\(\\blacksquare\\)function aggregate() can considered sophisticated extension tapply(). allows objects consideration expressed functions explanatory factors, contains additional arguments data specification time series analyses.\nExample 4.4  \\(\\text{}\\)\nuse aggregate() get identical (reformatted) results prior example.Importantly, first argument, rate ~ drug + time form formula:tilde operator, ~, allows expression formulaic framework: y ~ model, y response variable model specifies system (generally) one predictor variables.\\(\\blacksquare\\)\n","code":"\ndata(heart)\nwith(heart, tapply(rate, drug, mean))  AX23   BWW9   Ctrl \n76.281 81.031 71.906 \nwith(heart, tapply(rate, list(drug = drug, time = time), mean))      time\ndrug      t1     t2     t3     t4\n  AX23 70.50 80.500 81.000 73.125\n  BWW9 81.75 84.000 78.625 79.750\n  Ctrl 72.75 72.375 71.500 71.000\naggregate(rate ~ drug + time, mean, data = heart)   drug time   rate\n1  AX23   t1 70.500\n2  BWW9   t1 81.750\n3  Ctrl   t1 72.750\n4  AX23   t2 80.500\n5  BWW9   t2 84.000\n6  Ctrl   t2 72.375\n7  AX23   t3 81.000\n8  BWW9   t3 78.625\n9  Ctrl   t3 71.500\n10 AX23   t4 73.125\n11 BWW9   t4 79.750\n12 Ctrl   t4 71.000\nf.rate <- with(heart, rate ~ drug + time)\nclass(f.rate)[1] \"formula\""},{"path":"ch4.html","id":"outer","chapter":"4 Basic Data Management","heading":"4.1.2 outer()","text":"Another important function matrix operations outer(). algorithm allows creation array contains possible combinations two atomic vectors arrays respect user-specified function. outer() function three required arguments.first two arguments, X Y, define arrays atomic vectors. X Y can identical one wishes examine pairwise operations array elements (see example ).third argument, FUN, specifies function used operations.Example 4.5  \\(\\text{}\\)\nSuppose wish find means possible pairs observations atomic vector. use following commands:argument FUN = \"+\" indicates wish add elements . divide sums two obtain means. Note diagonal output matrix contains original elements x, mean number original number. upper lower triangles identical mean elements b mean elements b . Note result outer(x, x, \"*\") can also obtained using x %o% x %o% matrix algebra outer product operator R.\\(\\blacksquare\\)\n","code":"\nx <- c(1, 2, 3, 5, 4)\nouter(x, x, \"+\")/2     [,1] [,2] [,3] [,4] [,5]\n[1,]  1.0  1.5  2.0  3.0  2.5\n[2,]  1.5  2.0  2.5  3.5  3.0\n[3,]  2.0  2.5  3.0  4.0  3.5\n[4,]  3.0  3.5  4.0  5.0  4.5\n[5,]  2.5  3.0  3.5  4.5  4.0\nouter(x, x, \"*\")     [,1] [,2] [,3] [,4] [,5]\n[1,]    1    2    3    5    4\n[2,]    2    4    6   10    8\n[3,]    3    6    9   15   12\n[4,]    5   10   15   25   20\n[5,]    4    8   12   20   16\nx %o% x     [,1] [,2] [,3] [,4] [,5]\n[1,]    1    2    3    5    4\n[2,]    2    4    6   10    8\n[3,]    3    6    9   15   12\n[4,]    5   10   15   25   20\n[5,]    4    8   12   20   16"},{"path":"ch4.html","id":"stack-unstack-and-reshape","chapter":"4 Basic Data Management","heading":"4.1.3 stack(), unstack() and reshape()","text":"manipulating lists dataframes often useful move -called “long” “wide” data table formats. operations can handled functions stack() unstack(). Specifically, stack() concatenates multiple vectors single vector along factor indicating observation originated, whereas unstack() reverses process.\nExample 4.6  \\(\\text{}\\)\nConsider 4 x 4 dataframe .stack dataf long table format.unstack sdataf.function reshape() can handle stacking unstacking operations. stack dataf. arguments timevar, idvar, v.names used provide recognizable identifiers columns wide table format, observations within columns, responses combinations.\\(\\blacksquare\\)","code":"\ndataf <- data.frame(matrix(nrow = 4, data = rnorm(16)))\nnames(dataf) <- c(\"col1\", \"col2\", \"col3\", \"col4\")\ndataf       col1       col2     col3     col4\n1  0.273953 -0.0761772 -2.31054  0.25376\n2  0.229788 -0.9152364 -0.31422 -1.05746\n3  0.632600  0.0624385  0.25734  0.16615\n4 -0.068778  0.0020916  0.21208  0.42259\nsdataf <- stack(dataf)\nsdataf       values  ind\n1   0.2739525 col1\n2   0.2297882 col1\n3   0.6326003 col1\n4  -0.0687777 col1\n5  -0.0761772 col2\n6  -0.9152364 col2\n7   0.0624385 col2\n8   0.0020916 col2\n9  -2.3105403 col3\n10 -0.3142168 col3\n11  0.2573384 col3\n12  0.2120784 col3\n13  0.2537554 col4\n14 -1.0574637 col4\n15  0.1661473 col4\n16  0.4225881 col4\nunstack(sdataf)       col1       col2     col3     col4\n1  0.273953 -0.0761772 -2.31054  0.25376\n2  0.229788 -0.9152364 -0.31422 -1.05746\n3  0.632600  0.0624385  0.25734  0.16615\n4 -0.068778  0.0020916  0.21208  0.42259\nreshape(dataf, direction = \"long\",\n        varying = list(names(dataf)),\n        timevar = \"Column\",\n        idvar = \"Column obs.\",\n        v.names = \"Response\")    Column   Response Column obs.\n1.1      1  0.2739525           1\n2.1      1  0.2297882           2\n3.1      1  0.6326003           3\n4.1      1 -0.0687777           4\n1.2      2 -0.0761772           1\n2.2      2 -0.9152364           2\n3.2      2  0.0624385           3\n4.2      2  0.0020916           4\n1.3      3 -2.3105403           1\n2.3      3 -0.3142168           2\n3.3      3  0.2573384           3\n4.3      3  0.2120784           4\n1.4      4  0.2537554           1\n2.4      4 -1.0574637           2\n3.4      4  0.1661473           3\n4.4      4  0.4225881           4"},{"path":"ch4.html","id":"other-simple-data-management-functions","chapter":"4 Basic Data Management","heading":"4.2 Other Simple Data Management Functions","text":"","code":""},{"path":"ch4.html","id":"replace","chapter":"4 Basic Data Management","heading":"4.2.1 replace()","text":"One use function replace() replace elements atomic vector based, potentially, Boolean logic. function requires three arguments.first argument, x, specifies vector analyzed.second argument, list, connotes elements need replaced. logical argument can used replacement index.third argument, values, defines replacement value(s).\nExample 4.7  \\(\\text{}\\)\ninstance:course, one can also use square brackets operation.\\(\\blacksquare\\)","code":"\nAge <- c(21, 19, 25, 26, 18, 19)\nreplace(Age, Age < 25, \"R is Cool\")[1] \"R is Cool\" \"R is Cool\" \"25\"        \"26\"        \"R is Cool\" \"R is Cool\"\nAge[Age < 25] <- \"R is Cool\"\nAge[1] \"R is Cool\" \"R is Cool\" \"25\"        \"26\"        \"R is Cool\" \"R is Cool\""},{"path":"ch4.html","id":"which","chapter":"4 Basic Data Management","heading":"4.2.2 which()","text":"function can used logical commands obtain address indices data storage object.\nExample 4.8  \ninstance:Elements one, two, five meet criterion. can now subset based index w.find element Age closest 24 something like:\\(\\blacksquare\\)","code":"\nAge <- c(21, 19, 25, 26, 18, 19)\nw <- which(Age <= 21)\nw[1] 1 2 5 6\nAge[w][1] 21 19 18 19\nwhich(abs(Age - 24) == min(abs(Age - 24)))[1] 3"},{"path":"ch4.html","id":"sort","chapter":"4 Basic Data Management","heading":"4.2.3 sort()","text":"default, function sort() sorts data atomic vector alphanumeric ascending order.Data can sorted descending order specifying decreasing = TRUE.","code":"\nsort(Age)[1] 18 19 19 21 25 26\nsort(Age, decreasing = T)[1] 26 25 21 19 19 18"},{"path":"ch4.html","id":"rank","chapter":"4 Basic Data Management","heading":"4.2.4 rank()","text":"function rank gives ascending alphanumeric rank elements vector. Ties given average ranks. operation important rank-based permutation analyses .second last observations second smallest Age. Thus, average rank 2.5.","code":"\nrank(Age)[1] 4.0 2.5 5.0 6.0 1.0 2.5"},{"path":"ch4.html","id":"order","chapter":"4 Basic Data Management","heading":"4.2.5 order()","text":"function order() similar () provides element indices accord alphanumeric ordering. allows one sort vector, matrix dataframe ascending descending order, based one several ordered vectors.\nExample 4.9  \\(\\text{}\\)\nConsider dataframe lists plant percent cover data four plant species three sites. accordance field.data example Ch 3, plant species identified four letter codes, corresponding first two letters taxa genus species names.Assume wish sort data respect alphanumeric ordering species codes. obtain ordering codesNow can sort rows field.data based ordering.\\(\\blacksquare\\)","code":"\nfield.data <- data.frame(code = c(\"ACMI\", \"ELSC\", \"CAEL\", \"TACE\"),\n                         site1 = c(12, 13, 14, 11),\n                         site2 = c(0, 20, 4, 5),\n                         site3 = c(20, 10, 30, 0))\nfield.data  code site1 site2 site3\n1 ACMI    12     0    20\n2 ELSC    13    20    10\n3 CAEL    14     4    30\n4 TACE    11     5     0\no <- order(field.data$code)\no[1] 1 3 2 4\nfield.data[o,]  code site1 site2 site3\n1 ACMI    12     0    20\n3 CAEL    14     4    30\n2 ELSC    13    20    10\n4 TACE    11     5     0"},{"path":"ch4.html","id":"unique","chapter":"4 Basic Data Management","heading":"4.2.6 unique()","text":"identify unique values dataset can use function unique().\nExample 4.10  \natomic vector listing species bird survey islands southeast Alaska. Species ciphers follow coding method used Example 4.9. Note large number repeats.Applying unique() obtain listing 24 unique bird species.\\(\\blacksquare\\)","code":"\nAK.bird <- c(\"GLGU\", \"MEGU\", \"DOCO\", \"PAJA\", \"COLO\", \"BUFF\", \"COGO\", \n             \"WHSC\", \"TUSW\", \"GRSC\", \"GRTE\", \"REME\", \"BLOY\", \"REPH\", \n             \"SEPL\", \"LESA\", \"ROSA\", \"WESA\", \"WISN\", \"BAEA\", \"SHOW\", \n             \"GLGU\", \"MEGU\", \"PAJA\", \"DOCO\", \"GRSC\", \"GRTE\", \"BUFF\", \n             \"MADU\", \"TUSW\", \"REME\", \"SEPL\", \"REPH\", \"ROSA\", \"LESA\", \n             \"COSN\", \"BAEA\", \"ROHA\")\n\nlength(AK.bird)[1] 38\nunique(AK.bird) [1] \"GLGU\" \"MEGU\" \"DOCO\" \"PAJA\" \"COLO\" \"BUFF\" \"COGO\" \"WHSC\" \"TUSW\" \"GRSC\"\n[11] \"GRTE\" \"REME\" \"BLOY\" \"REPH\" \"SEPL\" \"LESA\" \"ROSA\" \"WESA\" \"WISN\" \"BAEA\"\n[21] \"SHOW\" \"MADU\" \"COSN\" \"ROHA\""},{"path":"ch4.html","id":"match","chapter":"4 Basic Data Management","heading":"4.2.7 match()","text":"Given two vectors, function match() indexes objects second vector appear elements first vector. instance:\nnumber 2 (1st element y) 5th element x, thus number 5 put 1st vector m created match. number 1 (2nd element y) occur x (NA). number 4 3rd element\ny x. Thus, number 3 given third element m, .Example 4.11  \\(\\text{}\\)\nusefulness match() may seem unclear first, consider scenario want convert species code identifiers field data actual species names. following dataframe species list matches four letter species codes scientific names. Note list contains species field.data dataset used Example 4.9.add column field.data containing actual species names using match().\\(\\blacksquare\\)","code":"\nx <- c(6, 5, 4, 3, 2, 7)\ny <- c(2, 1, 4, 3, 5, 6)\nm <- match(y, x)\nm[1]  5 NA  3  4  2  1\nspecies.list <- data.frame(code = c(\"ACMI\", \"ASFO\", \"ELSC\", \"ERRY\", \"CAEL\",\n\"CAPA\", \"TACE\"), names = c(\"Achillea millefolium\", \"Aster foliaceus\",\n                           \"Elymus scribneri\", \"Erigeron rydbergii\",\n                           \"Carex elynoides\", \"Carex paysonis\",\n                           \"Taraxacum ceratophorum\"))\n\nspecies.list  code                  names\n1 ACMI   Achillea millefolium\n2 ASFO        Aster foliaceus\n3 ELSC       Elymus scribneri\n4 ERRY     Erigeron rydbergii\n5 CAEL        Carex elynoides\n6 CAPA         Carex paysonis\n7 TACE Taraxacum ceratophorum\nm <- match(field.data$code, species.list$code)\nfield.data.new <- field.data # make a copy of field data\nfield.data.new$species.name <- species.list$names[m]\nfield.data.new  code site1 site2 site3           species.name\n1 ACMI    12     0    20   Achillea millefolium\n2 ELSC    13    20    10       Elymus scribneri\n3 CAEL    14     4    30        Carex elynoides\n4 TACE    11     5     0 Taraxacum ceratophorum"},{"path":"ch4.html","id":"whichin","chapter":"4 Basic Data Management","heading":"4.2.8 which() and %in%","text":"can use operator %% conjunction function () achieve results match(). Note arrangement arguments reversed match() (). former : . latter : (species.list$code %% field.data$code).","code":"\nm <- which(species.list$code %in% field.data$code)\nfield.data.new$species.name <- species.list$names[m]\nfield.data.new  code site1 site2 site3           species.name\n1 ACMI    12     0    20   Achillea millefolium\n2 ELSC    13    20    10       Elymus scribneri\n3 CAEL    14     4    30        Carex elynoides\n4 TACE    11     5     0 Taraxacum ceratophorum"},{"path":"ch4.html","id":"regex","chapter":"4 Basic Data Management","heading":"4.3 Matching, Querying and Substituting in Strings","text":"R contains number useful methods handling character string43 data. Strings class base type character.\n","code":""},{"path":"ch4.html","id":"strtrim-and-substr","chapter":"4 Basic Data Management","heading":"4.3.1 strtrim() and substr()","text":"functions strtrim() substr() useful extracting subsets strings string vectors.\nExample 4.12  \\(\\text{}\\)\ntaxonomic codes character vector , first capital letter indicates whether species flowering plant (anthophyte) moss (bryophyte) last four letters give species codes (see Example 4.9).Assume want distinguish anthophytes bryophytes extracting first letter. can done specifying 1 second strtrim argument, width.function substr() useful imposing start end strings subset. extract string components 3-4 (first two letters genus name).\\(\\blacksquare\\)","code":"\nplant <- c(\"A_CAAT\", \"B_CASP\", \"A_SARI\")\nphylum <- strtrim(plant, 1)\nphylum[1] \"A\" \"B\" \"A\"\nplant[phylum == \"A\"][1] \"A_CAAT\" \"A_SARI\"\nsubstr(plant, 3, 4)[1] \"CA\" \"CA\" \"SA\""},{"path":"ch4.html","id":"strsplit","chapter":"4 Basic Data Management","heading":"4.3.2 strsplit()","text":"function strsplit() splits character string substrings based user defined criteria. contains two important arguments.\nfirst argument, x, specifies character string analyzed.second argument, split, character criterion used splitting.Example 4.13  \\(\\text{}\\)\nsplit character string ACMI two, based space words Achillea millefolium.Note result list. get back vector (now two components), can use function unlist().split based letter \"l\".Interestingly, letting split criterion equal NULL results spaces placed every character string.can use outcome reverse order characters string.function rev() provides reversed version first argument, case result strsplit().\nfunction paste() can use paste together character strings.\\(\\blacksquare\\)\nCriteria querying strings can include multiple characters particular order, particular case:Note \"\" \"ABSOLUTELY\" ignored upper case.","code":"\nACMI <- \"Achillea millefolium\"\nstrsplit(ACMI, \" \")[[1]]\n[1] \"Achillea\"    \"millefolium\"\nunlist(strsplit(ACMI, \" \"))[1] \"Achillea\"    \"millefolium\"\nstrsplit(ACMI, \"l\")[[1]]\n[1] \"Achi\"  \"\"      \"ea mi\" \"\"      \"efo\"   \"ium\"  \nstrsplit(ACMI, NULL)[[1]]\n [1] \"A\" \"c\" \"h\" \"i\" \"l\" \"l\" \"e\" \"a\" \" \" \"m\" \"i\" \"l\" \"l\" \"e\" \"f\" \"o\" \"l\"\n[18] \"i\" \"u\" \"m\"\nsapply(lapply(strsplit(ACMI, NULL), rev), paste, collapse = \"\")[1] \"muilofellim aellihcA\"\nx <- \"R is free software and comes with ABSOLUTELY NO WARRANTY\"\nstrsplit(x, \"so\")[[1]]\n[1] \"R is free \"                                  \n[2] \"ftware and comes with ABSOLUTELY NO WARRANTY\""},{"path":"ch4.html","id":"grep-and-grepl","chapter":"4 Basic Data Management","heading":"4.3.3 grep() and grepl()","text":"functions grep() grepl() can used identify elements character vector specified pattern. first two arguments.first argument, pattern specifies patterns matched. can character string, object coercible character string, regular expression (see ).second argument, x, character vector matches sought.Example 4.14  \\(\\text{}\\)\nfunction grep() returns indices identifying entries vector contain queried pattern. character vector , see entries five six genus, Carex.function grepl() thing Boolean outcomes.course, use information subset names.can also get grep return values directly specifying value = TRUE.\\(\\blacksquare\\)\n","code":"\nnames = c(\"Achillea millefolium\", \"Aster foliaceus\",\n                           \"Elymus scribneri\", \"Erigeron rydbergii\",\n                           \"Carex elynoides\", \"Carex paysonis\",\n                           \"Taraxacum ceratophorum\")\n\ngrep(\"Carex\", names)[1] 5 6\ngrepl(\"Carex\", names)[1] FALSE FALSE FALSE FALSE  TRUE  TRUE FALSE\nnames[grep(\"Carex\", names)][1] \"Carex elynoides\" \"Carex paysonis\" \ngrep(\"Carex\", names, value = TRUE)[1] \"Carex elynoides\" \"Carex paysonis\" "},{"path":"ch4.html","id":"gsub","chapter":"4 Basic Data Management","heading":"4.3.4 gsub()","text":"function gsub() can used substitute text specified pattern. Several arguments identical grep() grepl():\n, first argument, pattern, specifies pattern matched.second argument, replacement, specifies replacement matched pattern.third argument, x, character vector wherein matches sought substitutions made.Example 4.15  \\(\\text{}\\)\nsubstitute \"C.\" occurrences \"Carex\" names.\\(\\blacksquare\\)","code":"\ngsub(\"Carex\", \"C.\", names)[1] \"Achillea millefolium\"   \"Aster foliaceus\"       \n[3] \"Elymus scribneri\"       \"Erigeron rydbergii\"    \n[5] \"C. elynoides\"           \"C. paysonis\"           \n[7] \"Taraxacum ceratophorum\""},{"path":"ch4.html","id":"gregexpr","chapter":"4 Basic Data Management","heading":"4.3.5 gregexpr()","text":"function gregexpr() identifies start end matching sections character vector.Example 4.16  \\(\\text{}\\)\nexamine first two entries names, looking genus Aster.output list cryptic best requires explanation. first two elements two list components indicate character number start end matched string. first list component, elements given identifier -1 \"Achillea millefolium\" contain pattern \"Aster\". second list component, elements 1 5 \"Aster\" makes first five letters \"Aster foliaceus\".\\(\\blacksquare\\)\n","code":"\ngregexpr(\"Aster\", names[c(1:2)])[[1]]\n[1] -1\nattr(,\"match.length\")\n[1] -1\nattr(,\"index.type\")\n[1] \"chars\"\nattr(,\"useBytes\")\n[1] TRUE\n\n[[2]]\n[1] 1\nattr(,\"match.length\")\n[1] 5\nattr(,\"index.type\")\n[1] \"chars\"\nattr(,\"useBytes\")\n[1] TRUE"},{"path":"ch4.html","id":"rgx","chapter":"4 Basic Data Management","heading":"4.3.6 Regular Expressions","text":"number R functions managing character strings, including grep(), grepl(), gregexpr(), gsub(), strsplit(), can can incorporate regular expressions. computer programming, regular expression (often abbreviated regex) sequence characters allow pattern matching text. Regular expressions developed within number programming frameworks including POSIX standard (Portable Operating System Interface standard), developed IEEE, particularly language Perl44. Regular expressions R include extended regular expressions (default pattern matching replacement R functions), Perl-like regular expressions.","code":""},{"path":"ch4.html","id":"ergx","chapter":"4 Basic Data Management","heading":"4.3.6.1 Extended Regular Expressions","text":"Default extended regular expressions R use POSIX framework commands45, includes use particular metacharacters. : \\, |, ( ), [ ], ^, $, ., { }, *, +, ?. metacharacters vary meaning depending occur outside square brackets, [ ], inside square brackets. former usage means part character class (see ). non-bracketed usage, metacharacters subset following applications (see https://www.pcre.org/original/pcre.txt):^ start string line.$ end string line.. match character except newline.| start alternative branch.( ) start end subpattern.{ } start end min/max repetition specification.Several regular expression metacharacters can placed end end regular expression specify repetition. instance, \"*\" indicates preceding pattern matched zero times, \"{+}\" indicates preceding pattern matched one times, \"{n}\" indicates preceding pattern matched exactly n times, \"{n,}\" indicates preceding pattern matched n times. Example 4.17  \\(\\text{}\\)\nuse function regmatches(), extracts replaces matched substrings gregexpr() summaries, illustrate.\\(\\blacksquare\\)Example 4.18  \\(\\text{}\\)\nMetacharacters can used together. instance, code demonstrates one might get rid one extra spaces end character strings.\\(\\blacksquare\\)Example 4.19  \\(\\text{}\\)\nbiological example, microbial “taxa” identifiers can include cryptic Amplicon Sequence Variant (ASV) codes, followed general taxonomic assignment. example, ASV identifier bacterium within family Comamonadaceae.can delete ASV code, ends colon, :regex script first argument means: “match character string occurring zero times ends :”.\\(\\blacksquare\\)Example 4.20  \\(\\text{}\\)\nanother example, R Markdown delimits monospace font using accent grave metacharacters, ` `, LaTeX applies font expression \\texttt{ }. convert R Markdown-style character vector containing monospace strings LaTeX-style character vector.codeI subset R Markdown strings char.vec three potential components: 1) ` metacharacter beginning string, 2) text content ` metacharacters, 3) closing ` metacharacter . insert content item 2 (indicated \\\\2) \\texttt{ } using:\\(\\blacksquare\\)\nImportantly, Example 4.20 illustrates procedure use queried character general expression metacharacter. instance, backslash \\texttt. case, metacharacter must escaped using single double backslashes. , \\texttt must specified \\\\\\texttt gsub().Example 4.21  \\(\\text{}\\)\nask string split based appearance ? (regex metacharacter) % ().\\(\\blacksquare\\)","code":"\nstring <- \"%aaabaaab\"\nID <- gregexpr(\"a{1}\", string)\nregmatches(string, ID)[[1]]\n[1] \"a\" \"a\" \"a\" \"a\" \"a\" \"a\"\nID <- gregexpr(\"a{2}\", string)\nregmatches(string, ID)[[1]]\n[1] \"aa\" \"aa\"\nID <- gregexpr(\"a{2,}\", string)\nregmatches(string, ID)[[1]]\n[1] \"aaa\" \"aaa\"\nstring <- c(\"###Now is the time      \",\n            \"# for all  \",\n            \"#\",\n            \" good men\",\n            \"### to come to the aid of their country.       \")\n\nout <- gsub(\" +$\", \"\", string) # drop extra space(s) at end of strings\nout <- gsub(\"^#*\",\"\", out) # drop pound sign(s)\n\npaste(out, collapse = \"\")[1] \"Now is the time for all good men to come to the aid of their country.\"\nasv <- \"6abc517aa40e9e7b9c652902fe04bb1a:f__Comamonadaceae\"\ngsub(\".*:\", \"\", asv)[1] \"f__Comamonadaceae\"\nchar.vec <- c(\"`+`\", \"addition\", \"$2 + 2$\", \"`2 + 2`\")\ngsub(\"(`)(.*)(`)\",\"\\\\\\texttt{\\\\2}\", char.vec)[1] \"\\texttt{+}\"     \"addition\"      \"$2 + 2$\"       \"\\texttt{2 + 2}\"\n\"(`)(.*)(`)\"\n\"\\\\\\texttt{\\\\2}\"\nstring <- \"m?2%b\"\nstrsplit(string, \"[\\\\?%]\")[[1]]\n[1] \"m\" \"2\" \"b\""},{"path":"ch4.html","id":"character-class","chapter":"4 Basic Data Management","heading":"Character class","text":"regular expression character class comprised collection characters, specifying query pattern, situated quotes (single double) square brace metacharacters, e.g., \"[\" \"]\". Thus, code \"[\\\\?%]\" previous example defines character class. Character class pattern matches evaluated single character specified text. reverse occur first character pattern regular expression caret metacharacter, ^. example, expression \"[0-9]\" matches single numeric character string, (regular expression metacharacter - can used specify range) [^abc] matches anything except characters \"\", \"b\" \"c\".Example 4.22  \\(\\text{}\\)\nConsider following examples:\\(\\blacksquare\\)Example 4.23  \\(\\text{}\\)\nregular expression match email addresses:expression literally reads: “1) find one occurrences characters -z -Z 0-9 dashes periods, followed 2) ampersand symbol (literally), followed 3) one occurrences characters -z -Z 0-9 dashes periods, followed 4) literal period, followed one occurrences letters -z -Z.” string wish query:confirm elements 1, 3, 5 string email addresses.\\(\\blacksquare\\)Certain character classes predefined. classes names bounded two square brackets colons, include \"[[:lower:]]\" \"[[:upper:]]\" identify lower upper case letters, \"[:punct:]\" identifies punctuation, [[:alnum:]], identifies alphanumeric characters, \"[[:space:]]\", identifies space characters, e.g., tab newline.ask R return elements string three characters long.pattern matching replacement jobs may best turn default extended regular expressions use exact matching specifying fixed = TRUE. example, R may place periods place spaces character strings column names dataframes arrays.Example 4.24  \\(\\text{}\\)\nConsider following example:Note using gsub(\".\", \" \", countries) results replacement text spaces meaning period metacharacter. get desired result use:course also double escape period.\\(\\blacksquare\\)","code":"\nstring <- \"a1c&m2%b\"\nstrsplit(string, \"[0-9]\") [[1]]\n[1] \"a\"   \"c&m\" \"%b\" \nstrsplit(string, \"[^abc]\") [[1]]\n[1] \"a\" \"c\" \"\"  \"\"  \"\"  \"b\"\npattern <- \"[-a-z0-9_.%]+\\\\@[-a-z0-9_.%]+\\\\.[a-z]+\"\nstring <- c(\"abc_noboby@isu.edu\",\n            \"text with no email\",\n            \"me@mything.com\",\n            \"also\",\n            \"you@yourspace.com\",\n            \"@you\"\n            )\ngrep(pattern, string, ignore.case = TRUE, value = TRUE)[1] \"abc_noboby@isu.edu\" \"me@mything.com\"     \"you@yourspace.com\" \nstring <- c(\"M2Ab\", \"def\", \"?\", \"%\", \"\\n\")\ngrepl(\"[[:lower:]]\", string)[1]  TRUE  TRUE FALSE FALSE FALSE\ngrepl(\"[[:upper:]]\", string)[1]  TRUE FALSE FALSE FALSE FALSE\ngrepl(\"[[:punct:]]\", string)[1] FALSE FALSE  TRUE  TRUE FALSE\ngrepl(\"[[:space:]]\", string) # item five is a newline request[1] FALSE FALSE FALSE FALSE  TRUE\ngrep(\"[[:alnum:]]{3}\", string, value = TRUE)[1] \"M2Ab\" \"def\" \ncountries <- c(\"United.States\", \"United.Arab.Emirates\", \"China\", \"Germany\")\ngsub(\".\", \" \", countries)[1] \"             \"        \"                    \" \"     \"               \n[4] \"       \"             \ngsub(\".\", \" \", countries, fixed = TRUE)[1] \"United States\"        \"United Arab Emirates\" \"China\"               \n[4] \"Germany\"             \ngsub(\"\\\\.\", \" \", countries)[1] \"United States\"        \"United Arab Emirates\" \"China\"               \n[4] \"Germany\"             "},{"path":"ch4.html","id":"perl-like-regular-expressions","chapter":"4 Basic Data Management","heading":"4.3.6.2 Perl-like Regular Expressions","text":"R character string functions grep(), grepl(), regexpr(), gregexpr(), sub(), gsub(), strsplit() allow Perl-like regular expression pattern matching. done specifying perl = TRUE, switches regular expression handling PRCE package. Perl allows handling POSIX predefined character classes, e.g., \"[[:lower:]]\", along wide variety calls generally implemented using metacharacters double backslash commands. examples. \\\\d decimal digit.\\\\D character decimal digit.\\\\h horizontal white space character (e.g., tab, space).\\\\H character horizontal white space character.\\\\s white space character.\\\\S character white space character.\\\\v vertical white space character (e.g., newline).\\\\V character vertical white space character.\\\\w word, .e., letter character components separated white space.\\\\W non word.\\\\b word boundary.\\\\U upper case character (dependent context).\\\\L lower case character (dependent context).Note reversals meaning occur capitalized uncapitalized commands.Example 4.25  \\(\\text{}\\)identify string entries containing numbers.containing non-numeric characters (.e., entries).subset non-numeric entries, one something like:\\(\\blacksquare\\)Example 4.26  \\(\\text{}\\)\nslightly extended example count number words description GNU public licences R (obtained via RShowDoc(\"COPYING\")). Ideas largely follow function DescTools::StrCountW() (Signorell 2023).Text can read connection using function readLines().Note escaped command \\t represent ASCII (American character encoding standard) control character tab return. useful escaped control characters include \\n, indicating new line carriage return.search words, actually identify string components words, identified Perl regex command \\\\W word boundaries, .e., \\\\b. can combine summarily : \\\\b\\\\W+\\\\b. call \\\\W+ indicates non-word match occurring one times. apply regular expression first element GNU.Matches occur three locations, 10, 18, 25, separate four words GNU GENERAL PUBLIC LICENSE. Thus, analyze entire document use:3048 total words license description.\\(\\blacksquare\\)\nOne can identify substrings number using Perl.Example 4.27  \\(\\text{}\\)\nexample, subdivide string two components, first character, .e., \"(\\\\w)\", remaining zero characters: \"(\\\\w*)\". referred substitute argument gsub items \\\\1 \\\\2, respectively. Capitalization substrings handled different ways .functions tolower() toupper() provide simpler approaches convert letters lower upper case, respectively.\\(\\blacksquare\\)\n","code":"\nstring <- c(\"Acidobacteria\", \"Actinobacteria\", \"TM7.1\", \"Gitt-GS-136\", \n            \"Chloroflexia\", \"Bacili\")\n\ngrep(\"\\\\d\", string, perl = TRUE)[1] 3 4\ngrep(\"\\\\D\", string, perl = TRUE)[1] 1 2 3 4 5 6\nstring[-grep(\"\\\\d\", string, perl = TRUE)][1] \"Acidobacteria\"  \"Actinobacteria\" \"Chloroflexia\"   \"Bacili\"        \nGNU <- readLines(RShowDoc(\"COPYING\"))\nhead(GNU)[1] \"\\t\\t    GNU GENERAL PUBLIC LICENSE\"                                               \n[2] \"\\t\\t       Version 2, June 1991\"                                                  \n[3] \"\"                                                                               \n[4] \" Copyright (C) 1989, 1991 Free Software Foundation, Inc.\"                       \n[5] \"                       51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA\"\n[6] \" Everyone is permitted to copy and distribute verbatim copies\"                  \nGNU[1][1] \"\\t\\t    GNU GENERAL PUBLIC LICENSE\"\ngregexpr(\"\\\\b\\\\W+\\\\b\", GNU[1], perl = TRUE)[[1]]\n[1] 10 18 25\nattr(,\"match.length\")\n[1] 1 1 1\nattr(,\"index.type\")\n[1] \"chars\"\nattr(,\"useBytes\")\n[1] TRUE\nsum(sapply(gregexpr(\"\\\\b\\\\W+\\\\b\", GNU, perl = TRUE),\n           function(x) sum(x > 0)) + 1)[1] 3048\nstring <- \"achillea\"\ngsub(\"(\\\\w)(\\\\w*)\", \"\\\\U\\\\1\\\\U\\\\2\", string, perl=TRUE) # all caps[1] \"ACHILLEA\"\ngsub(\"(\\\\w)(\\\\w*)\", \"\\\\L\\\\1\\\\U\\\\2\", string, perl=TRUE) # low, then upper case[1] \"aCHILLEA\"\ngsub(\"(\\\\w)(\\\\w*)\", \"\\\\U\\\\1\\\\L\\\\2\", string, perl=TRUE) # up, then lower case[1] \"Achillea\"\ntoupper(string)[1] \"ACHILLEA\""},{"path":"ch4.html","id":"datetime","chapter":"4 Basic Data Management","heading":"4.4 Date-Time Classes","text":"two basic R date-time classes, POSIXlt POSIXct46. Class POSIXct represents (signed) number seconds since beginning 1970 (UTC time zone) numeric vector. object class POSIXlt comprised list vectors names sec, min, hour, mday (day month), mon (month), year, wday (day week), yday (day year).\nPOSIX naming conventions include:\n%m = Month decimal number (01–12).%d = Day month decimal number (01–31).%Y = Year. Designations 0:9999 accepted.%H = Hour decimal number (00–23).%M = Minute decimal number (00–59Example 4.28  \\(\\text{}\\)\nexample, twenty dates corresponding binary water presence measures (0 = water absent, 1 = water present) recorded 2.5 hour intervals intermittent stream site southwest Idaho (Aho, Derryberry, et al. 2023).convert character string dates date-time object can use function strptime(). :Note dates can now evaluated numerically.can also easily extract time series components.\\(\\blacksquare\\)","code":"\ndates <- c(\"08/13/2019 04:00\", \"08/13/2019 06:30\", \"08/13/2019 09:00\",\n           \"08/13/2019 11:30\", \"08/13/2019 14:00\", \"08/13/2019 16:30\",\n           \"08/13/2019 19:00\", \"08/13/2019 21:30\", \"08/14/2019 00:00\",\n           \"08/14/2019 02:30\", \"08/14/2019 05:00\", \"08/14/2019 07:30\",\n           \"08/14/2019 10:00\", \"08/14/2019 12:30\", \"08/14/2019 15:00\",\n           \"08/14/2019 17:30\", \"08/14/2019 20:00\", \"08/14/2019 22:30\",\n           \"08/15/2019 01:00\", \"08/15/2019 03:30\")\n\npres.abs <- c(1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1)\ndates.ts <- strptime(dates, format = \"%m/%d/%Y %H:%M\")\nclass(dates.ts)[1] \"POSIXlt\" \"POSIXt\" \ndates.df <- data.frame(dates = dates.ts, pres.abs = pres.abs)\nsummary(dates.df)     dates                        pres.abs   \n Min.   :2019-08-13 04:00:00   Min.   :0.00  \n 1st Qu.:2019-08-13 15:52:30   1st Qu.:0.75  \n Median :2019-08-14 03:45:00   Median :1.00  \n Mean   :2019-08-14 03:45:00   Mean   :0.75  \n 3rd Qu.:2019-08-14 15:37:30   3rd Qu.:1.00  \n Max.   :2019-08-15 03:30:00   Max.   :1.00  \ndates.ts$mday # day of month [1] 13 13 13 13 13 13 13 13 14 14 14 14 14 14 14 14 14 14 15 15\ndates.ts$wday # day of week [1] 2 2 2 2 2 2 2 2 3 3 3 3 3 3 3 3 3 3 4 4\ndates.ts$hour # hour [1]  4  6  9 11 14 16 19 21  0  2  5  7 10 12 15 17 20 22  1  3"},{"path":"ch4.html","id":"exercises-3","chapter":"4 Basic Data Management","heading":"Exercises","text":"Using plant dataset Question 5 Exercises end Chapter 3, perform following operations.\nAttempt simultaneously calculate column means plant height soil % N using FUN = mean apply(). issue? ?\nEliminate missing rows plant using na.omit() repeat (). change mean plant height? ?\nModify FUN argument apply() : FUN = function(x) mean(x, na.rm = TRUE). eliminate NAs column column basis.\nCompare results (), (b), (c). best approach? ?\nFind mean variance plant heights Management Type plant using tapply(). Use best practice approach FUN, deduced (d).\nUsing plant dataset Question 5 Exercises end Chapter 3, perform following operations.Attempt simultaneously calculate column means plant height soil % N using FUN = mean apply(). issue? ?Eliminate missing rows plant using na.omit() repeat (). change mean plant height? ?Modify FUN argument apply() : FUN = function(x) mean(x, na.rm = TRUE). eliminate NAs column column basis.Compare results (), (b), (c). best approach? ?Find mean variance plant heights Management Type plant using tapply(). Use best practice approach FUN, deduced (d).questions , use list object list.data.\nUse sapply(list.data, FUN = length) get number components element list.data.\nRepeat () using lapply(). output (b) different ()?\n\nlist.data <- list(= 1:9, height = rnorm(50),\n                  greet = c(\"hello\", \"goodbye\", \"hello\"))\nquestions , use list object list.data.Use sapply(list.data, FUN = length) get number components element list.data.Use sapply(list.data, FUN = length) get number components element list.data.Repeat () using lapply(). output (b) different ()?\n\nlist.data <- list(= 1:9, height = rnorm(50),\n                  greet = c(\"hello\", \"goodbye\", \"hello\"))Repeat () using lapply(). output (b) different ()?frequently used statistical application calculation possible mean differences. Assume arithmetic means treatments trt1, trt2, trt3, trt4 trt5, given object means .\nCalculate possible mean differences using means first two arguments outer(), letting FUN = \"-\".\nExtract meaningful non-redundant differences using upper.tri() lower.tri() (Section 3.4.4). \\({5 \\choose 2} = 10\\) meaningful (simply mean subtracted ) non-redundant differences.\n\nmeans <- c(trt1 = 20.5, trt2 = 15.3, trt3 = 22.1, trt4 = 30.4, \n           trt5 = 28)\nfrequently used statistical application calculation possible mean differences. Assume arithmetic means treatments trt1, trt2, trt3, trt4 trt5, given object means .Calculate possible mean differences using means first two arguments outer(), letting FUN = \"-\".Calculate possible mean differences using means first two arguments outer(), letting FUN = \"-\".Extract meaningful non-redundant differences using upper.tri() lower.tri() (Section 3.4.4). \\({5 \\choose 2} = 10\\) meaningful (simply mean subtracted ) non-redundant differences.\n\nmeans <- c(trt1 = 20.5, trt2 = 15.3, trt3 = 22.1, trt4 = 30.4, \n           trt5 = 28)Extract meaningful non-redundant differences using upper.tri() lower.tri() (Section 3.4.4). \\({5 \\choose 2} = 10\\) meaningful (simply mean subtracted ) non-redundant differences.Using plant dataset Question 5 Exercises Chapter 3, perform following operations.\nUse function replace() identify samples soil N less 13.5% identifying \"Npoor\".\nUse function () identify plant heights greater equal 33.2 dm.\nSort plant heights using function sort().\nSort plant dataset respect ascending values plant height using function order().\nUsing plant dataset Question 5 Exercises Chapter 3, perform following operations.Use function replace() identify samples soil N less 13.5% identifying \"Npoor\".Use function () identify plant heights greater equal 33.2 dm.Sort plant heights using function sort().Sort plant dataset respect ascending values plant height using function order().Using match() %%, replace code column names dataset cliff.sp package asbio, correct scientific names (genus specific epithet) dataframe sp.list .\n\nsp.list <- data.frame(code = c(\"L_ASCA\",\"L_CLCI\",\"L_COSPP\",\"L_COUN\",\n\"L_DEIN\",\"L_LCAT\", \"L_LCST\",\"L_LEDI\",\"M_POSP\",\"L_STDR\",\"L_THSP\",\n\"L_TOCA\",\"L_XAEL\",\"M_AMSE\", \"M_CRFI\",\"M_DISP\",\"M_WECO\",\"P_MIGU\",\n\"P_POAR\",\"P_SAOD\"), \nsci.name = c(\"Aspicilia caesiocineria\",\"Caloplaca citrina\",\n\"Collema spp.\", \"Collema undulatum\", \"Dermatocarpon intestiniforme\",\n\"Lecidea atrobrunnea\", \"Lecidella stigmatea\", \"Lecanora dispersa\",\n\"Pohlia sp.\", \"Staurothele drummondii\", \"Thelidium species\",\n\"Toninia candida\", \"Xanthoria elegans\", \"Amblystegium serpens\",\n\"Cratoneuron filicinum\", \"Dicranella species\", \"Weissia controversa\",\n\"Mimulus guttatus\", \"Poa pattersonii\", \"Saxifraga odontoloma\"))Using match() %%, replace code column names dataset cliff.sp package asbio, correct scientific names (genus specific epithet) dataframe sp.list .Using sp.list dataframe previous question, perform following operations:\nApply strsplit() column sp.list$sci.name create two column dataframe genus corresponding species names.\ntwo character prefix column sp.list$code indicates whether taxon lichen (prefix = \"L_\"), marchantiophyte (prefix = \"M_\"), vascular plant (prefix = \"P_\"). Use grep() identify marchantiophytes.\nUsing sp.list dataframe previous question, perform following operations:Apply strsplit() column sp.list$sci.name create two column dataframe genus corresponding species names.two character prefix column sp.list$code indicates whether taxon lichen (prefix = \"L_\"), marchantiophyte (prefix = \"M_\"), vascular plant (prefix = \"P_\"). Use grep() identify marchantiophytes.Use string vector string answer following questions:\nUse regular expressions pattern argument gsub() get rid extra spaces start string elements preserving spaces words.\nUse predefined character class [[:alnum:]] accompanying quantifier pattern argument grep() count number words whose length greater equal four characters.\n\nstring <- c(\"   Statistics \", \"      \", \" great topic.\")\nUse string vector string answer following questions:Use regular expressions pattern argument gsub() get rid extra spaces start string elements preserving spaces words.Use regular expressions pattern argument gsub() get rid extra spaces start string elements preserving spaces words.Use predefined character class [[:alnum:]] accompanying quantifier pattern argument grep() count number words whose length greater equal four characters.\n\nstring <- c(\"   Statistics \", \"      \", \" great topic.\")Use predefined character class [[:alnum:]] accompanying quantifier pattern argument grep() count number words whose length greater equal four characters.Remove numbers character vector using gsub() appropriate Perl-like regular expression.\n\nx <- c(\"enzyme1\",\"enzyme12\",\"enzyme3\",\"tRNA1\",\"tRNA205\",\n       \"mRNA6\",\"mRNA17\",\"mRNA8\",\"mRNA100\") Remove numbers character vector using gsub() appropriate Perl-like regular expression.Consider character vector times , format: day-month-year hour:minute:second.\nConvert times object class POSIXlt called time.pos using function strptime().\nExtract day week time.pos.\nSort time.pos using sort() verify time.pos quantitative.\n\ntimes <- c(\"12-12-2023 12:12:20\",\n           \"12-01-2021 01:12:40\",\n           \"15-10-2021 23:10:15\",\n           \"25-07-2022 13:09:45\")\nConsider character vector times , format: day-month-year hour:minute:second.Convert times object class POSIXlt called time.pos using function strptime().Convert times object class POSIXlt called time.pos using function strptime().Extract day week time.pos.Extract day week time.pos.Sort time.pos using sort() verify time.pos quantitative.\n\ntimes <- c(\"12-12-2023 12:12:20\",\n           \"12-01-2021 01:12:40\",\n           \"15-10-2021 23:10:15\",\n           \"25-07-2022 13:09:45\")Sort time.pos using sort() verify time.pos quantitative.","code":"\nlist.data <- list(a = 1:9, height = rnorm(50),\n                  greet = c(\"hello\", \"goodbye\", \"hello\"))\nmeans <- c(trt1 = 20.5, trt2 = 15.3, trt3 = 22.1, trt4 = 30.4, \n           trt5 = 28)\nsp.list <- data.frame(code = c(\"L_ASCA\",\"L_CLCI\",\"L_COSPP\",\"L_COUN\",\n\"L_DEIN\",\"L_LCAT\", \"L_LCST\",\"L_LEDI\",\"M_POSP\",\"L_STDR\",\"L_THSP\",\n\"L_TOCA\",\"L_XAEL\",\"M_AMSE\", \"M_CRFI\",\"M_DISP\",\"M_WECO\",\"P_MIGU\",\n\"P_POAR\",\"P_SAOD\"), \nsci.name = c(\"Aspicilia caesiocineria\",\"Caloplaca citrina\",\n\"Collema spp.\", \"Collema undulatum\", \"Dermatocarpon intestiniforme\",\n\"Lecidea atrobrunnea\", \"Lecidella stigmatea\", \"Lecanora dispersa\",\n\"Pohlia sp.\", \"Staurothele drummondii\", \"Thelidium species\",\n\"Toninia candida\", \"Xanthoria elegans\", \"Amblystegium serpens\",\n\"Cratoneuron filicinum\", \"Dicranella species\", \"Weissia controversa\",\n\"Mimulus guttatus\", \"Poa pattersonii\", \"Saxifraga odontoloma\"))\nstring <- c(\"   Statistics is \", \"      a \", \" great topic.\")\nx <- c(\"enzyme1\",\"enzyme12\",\"enzyme3\",\"tRNA1\",\"tRNA205\",\n       \"mRNA6\",\"mRNA17\",\"mRNA8\",\"mRNA100\") \ntimes <- c(\"12-12-2023 12:12:20\",\n           \"12-01-2021 01:12:40\",\n           \"15-10-2021 23:10:15\",\n           \"25-07-2022 13:09:45\")"},{"path":"ch5.html","id":"ch5","chapter":"5 Welcome to the Tidyverse","heading":"5 Welcome to the Tidyverse","text":"“Data like garbage. ’d better know going collect .”- Mark Twain, 1835 - 1910","code":""},{"path":"ch5.html","id":"the-tidyverse","chapter":"5 Welcome to the Tidyverse","heading":"5.1 The Tidyverse","text":"chapter demonstrates data management capabilities tidyverse (Wickham et al. 2019). Thus, Chapter 5 can considered tidyverse reconsideration Ch 4. tidyverse currently collection eight core packages (Fig 5.1). :dplyr Grammar functions data manipulation.forcats Tools solving common problems factors.ggplot2 system “declaratively creating graphics”, based book Grammar Graphics (Wilkinson 2012).purrr enhancement R’s functional programming (FP) toolkit.readr Methods reading rectangular data.stringr Functions facilitate working strings.tibble “modern re-imagining data frame.”tidyr set functions “tidying data.”\nFigure 5.1: main packages tidyverse.\ntidyverse library also contains several useful ancillary packages, including lubridate, reshape2, hms, blob, margrittr, glue. installing tidyverse result installation main ancillary packages, loading tidyverse result complete loading eight main tidyverse packages.Importantly, chapter meant authoritative summary tidyverse. Coverage mostly limited core data management packages magrittr, tibble, dplyr, stringer, ancillary packages lubridate reshape2. tidyverse ggplot2 package major focus Chapter 7. Wickham, Çetinkaya-Rundel, Grolemund (2023) provides succinct thorough introduction tidyverse open source book R Data Science. Useful tidyverse “cheatsheets” can found .tidyverse packages can downloaded using:\n","code":"\ninstall.packages(\"tidyverse\")"},{"path":"ch5.html","id":"pipes","chapter":"5 Welcome to the Tidyverse","heading":"5.2 Pipes","text":"important convention tidyverse widespread use forward pipe operator: |> . programming, pipe set commands connected series, output one command input next47.\nmany cases, use pipes allows clearer representations coding processes48. Incidentally, |> pipe, base package, motivated older forward pipe operator tidyverse package magrittr, %>%. R 4.1, native pipe operator tidyverse |> (although %>% still work magrittr loaded)49. Notably, |> syntactically (algorithmically) streamlined %>%, several features available %>% exist |>, including potential placeholder operator50. Nonetheless, focus |>, %>%, .\nExample 5.1  \\(\\text{}\\)\nConsider circular operation: \\(\\log_e(\\exp(1))\\). write ,number \\(1\\) piped function exp(), result: \\(\\exp(1) = e^1 = e\\), outcome piped function log(), result: \\(\\log_e e = 1\\). first arguments exp() log() simply calls numeric data, provided previous pipe segment, include information x f(x) operations. Thus, functions require previous pipe segment result argument, x |> f() equivalent \\(f(x)\\)51. case multiple arguments need specified, script x |> f(y) equivalent \\(f(x, y)\\), x |> f(y) |> g(z) describes \\(g(f(x, y), z)\\). instance,\\(\\blacksquare\\)\nExample 5.2  \\(\\text{}\\)\nexample illustrates forward pipe works recursively result previous pipe segment.\\(\\blacksquare\\)\nExample 5.3  \\(\\text{}\\)\ncan define result pipe global variable. Consider script (Fig 5.2).\nFigure 5.2: Creating global variable (object) resulting pipeline.\n\\(\\blacksquare\\)\n","code":"\n1 |> exp() |> log()[1] 1\n10 |> log(base = 2)[1] 3.3219\nhead(Loblolly) # First 6 rows of dataGrouped Data: height ~ age | Seed\n   height age Seed\n1    4.51   3  301\n15  10.89   5  301\n29  28.72  10  301\n43  41.74  15  301\n57  52.70  20  301\n71  60.92  25  301\nLoblolly |>\nhead() |>\ntail(2) # Last 2 rows from first 6 rowsGrouped Data: height ~ age | Seed\n   height age Seed\n57  52.70  20  301\n71  60.92  25  301\nx <- seq(1,10,length=100)\ny <- x |> sin()\nplot(x, y, type = \"l\", ylab = \"sin(x)\", xlab = \"x (radians)\")"},{"path":"ch5.html","id":"other-pipes","chapter":"5 Welcome to the Tidyverse","heading":"5.2.1 Other Pipes","text":"worth noting , addition %>%, magrittr contains several potentially useful pipe operators. include assignment pipe tee pipe. assignment pipe operator, %<>%, pipe x one f(x) expressions, assign result name x52. tee pipe operator %T>% works like %>%, except return value x %T>% f(x) x . useful pipeline requires side-effect like plotting printing53.\n","code":""},{"path":"ch5.html","id":"tibble","chapter":"5 Welcome to the Tidyverse","heading":"5.3 tibble","text":"\ntidyverse package tibble provides alternative data.frame format data storage, called tibble. Tibbles classes dataframe tbl_df, allowing posses additional characteristics including enhanced printing (see Example 5.4 ).\nAdditional distinguishing characteristics tibbles include: 1) character vector automatically coerced class factor, 2) recycling (see Section 3.1.1) occurs input length one, 3) partial matching $ used index tibble columns name54. functions tibble() generates tibbles. function as_tibble() coerces dataframe tibble.\nExample 5.4  \\(\\text{}\\)\ncompare dataframe tibble output data.\\(\\blacksquare\\)","code":"\ndata <- data.frame(numbers = 1:3, letters = c(\"a\",\"b\",\"c\"),\n                   date = as.Date(c(\"2021-12-1\", \"2021-12-2\",\n                                    \"2021-12-2\"),\n                           format = \"%Y-%m-%d\"))\ndata  numbers letters       date\n1       1       a 2021-12-01\n2       2       b 2021-12-02\n3       3       c 2021-12-02\nlibrary(tidyverse)\ndatat <- as_tibble(data)\ndatat# A tibble: 3 x 3\n  numbers letters date      \n    <int> <chr>   <date>    \n1       1 a       2021-12-01\n2       2 b       2021-12-02\n3       3 c       2021-12-02"},{"path":"ch5.html","id":"dplyr","chapter":"5 Welcome to the Tidyverse","heading":"5.4 dplyr","text":"\ndplyr package contains collection core tidyverse algorithms data manipulation55. Table 5.1 lists useful dplyr functions.\nTable 5.1: Important dplyr data management functions.\n","code":""},{"path":"ch5.html","id":"summarize","chapter":"5 Welcome to the Tidyverse","heading":"5.4.1 summarize()","text":"\nfunction summarize(), equivalently summarise(), creates new data frame one row combination specified grouping variables. groups given (instance, case group_by used group data), dataframe rows summaries observations required input .data argument.Example 5.5  \\(\\text{}\\)\nuse summarize() obtain means loblolly pine height (feet) age (years).\\(\\blacksquare\\)","code":"\nLoblolly |>\n  summarise(mean.height.ft = mean(height), mean.age.yrs = mean(age))  mean.height.ft mean.age.yrs\n1         32.364           13"},{"path":"ch5.html","id":"group_by","chapter":"5 Welcome to the Tidyverse","heading":"5.4.2 group_by()","text":"\ngroup_by() function often used conjunction dplyr functions, including summarize(), provide underlying grouping framework data summaries.Example 5.6  \\(\\text{}\\)\nuse group_by() summarize() describe Loblolly height data. Specifically, take mean variance Loblolly$height respect categories specified group_by().grouping variable can specified group_by():Clearly, group_by() summarise() allow options base function tapply() (Section 4.1.1.4). latter function provides summaries groups within single categorical INDEX, respect single quantitative vector, single user-defined function.Starting dplyr 1.1.0, can use .argument summarize bypass group_by(), although argument experimental, may deprecated future (see ?summarise).\\(\\blacksquare\\)","code":"\nLoblolly |>\n  group_by(Seed) |>\n  summarise(mean.height.ft = mean(height),\n            var.height.ft2 = var(height)\n            ) |>\n  head(5)# A tibble: 5 x 3\n  Seed  mean.height.ft var.height.ft2\n  <ord>          <dbl>          <dbl>\n1 329             30.3           443.\n2 327             30.6           440.\n3 325             31.9           468.\n4 307             31.3           494.\n5 331             31.0           495.\nLoblolly |>\n  group_by(Seed, age) |>\n  summarise(mean.height.ft = mean(height),\n            var.height.ft2 = var(height)\n            ) |>\n  head(5)`summarise()` has grouped output by 'Seed'. You can override\nusing the `.groups` argument.# A tibble: 5 x 4\n# Groups:   Seed [1]\n  Seed    age mean.height.ft var.height.ft2\n  <ord> <dbl>          <dbl>          <dbl>\n1 329       3           3.93             NA\n2 329       5           9.34             NA\n3 329      10          26.1              NA\n4 329      15          37.8              NA\n5 329      20          48.3              NA\nLoblolly |>\n  summarise(mean.height.ft = mean(height),\n            var.height.ft2 = var(height),\n            .by = Seed) |>\n  head(5)  Seed mean.height.ft var.height.ft2\n1  301         33.247         512.50\n2  303         34.107         552.24\n3  305         35.115         572.51\n4  307         31.328         493.83\n5  309         33.782         535.12"},{"path":"ch5.html","id":"filter","chapter":"5 Welcome to the Tidyverse","heading":"5.4.3 filter()","text":"\nfunction filter() provides straightforward way extract dataframe rows based Boolean operators.Example 5.7  \\(\\text{}\\)\nobtain rows Loblolly associated seed type 301.Loblolly rows associated height responses greater 60 feet.\\(\\blacksquare\\)","code":"\nLoblolly |>\n  filter(Seed == \"301\")Grouped Data: height ~ age | Seed\n   height age Seed\n1    4.51   3  301\n15  10.89   5  301\n29  28.72  10  301\n43  41.74  15  301\n57  52.70  20  301\n71  60.92  25  301\nLoblolly |>\n  filter(height > 60)Grouped Data: height ~ age | Seed\n   height age Seed\n71  60.92  25  301\n72  63.39  25  303\n73  64.10  25  305\n75  63.05  25  309\n77  60.07  25  315\n78  60.69  25  319\n79  60.28  25  321\n80  61.62  25  323"},{"path":"ch5.html","id":"arrange","chapter":"5 Welcome to the Tidyverse","heading":"5.4.4 arrange()","text":"\nfunction arrange() orders rows data frame based alphanumeric ordering specified data.Example 5.8  \\(\\text{}\\)\nuse arrange() sort result previous chunk smallest largest loblolly pine heights.One can use arrange(desc()) sort dataframe descending (largest--smallest) order.\\(\\blacksquare\\)\n","code":"\nLoblolly |>\n  filter(height > 60) |>\n  arrange(height)Grouped Data: height ~ age | Seed\n   height age Seed\n77  60.07  25  315\n79  60.28  25  321\n78  60.69  25  319\n71  60.92  25  301\n80  61.62  25  323\n75  63.05  25  309\n72  63.39  25  303\n73  64.10  25  305\nLoblolly |>\n  filter(height > 60) |>\n  arrange(desc(height))Grouped Data: height ~ age | Seed\n   height age Seed\n73  64.10  25  305\n72  63.39  25  303\n75  63.05  25  309\n80  61.62  25  323\n71  60.92  25  301\n78  60.69  25  319\n79  60.28  25  321\n77  60.07  25  315"},{"path":"ch5.html","id":"slice_min-and-slice_max","chapter":"5 Welcome to the Tidyverse","heading":"5.4.5 slice_min() and slice_max()","text":"\nhelpful dplyr functions slice_min() slice_max() allow subsetting dataframe rows minimum maximum values column, respectively.Example 5.9  \\(\\text{}\\)\\(\\blacksquare\\)","code":"\nLoblolly |>\n  slice_max(height, n = 5)Grouped Data: height ~ age | Seed\n   height age Seed\n73  64.10  25  305\n72  63.39  25  303\n75  63.05  25  309\n80  61.62  25  323\n71  60.92  25  301"},{"path":"ch5.html","id":"select","chapter":"5 Welcome to the Tidyverse","heading":"5.4.6 select()","text":"\nselect() function allows one select particular variables data frame.Example 5.10  \\(\\text{}\\)\ninstance, select height Loblolly.\\(\\blacksquare\\)select() function can used sophisticated ways combining dplyr functions like starts_with() ends_with(), Boolean operators.\nExample 5.11  \\(\\text{}\\)\nselect height age columns calling variable names start \"h\" end \"e\".\\(\\blacksquare\\)","code":"\nLoblolly |> \n  select(height) |>\n  head()   height\n1    4.51\n15  10.89\n29  28.72\n43  41.74\n57  52.70\n71  60.92\nLoblolly |>\n  select(starts_with(\"h\"), ends_with(\"e\")) |>\n  head(3)   height age\n1    4.51   3\n15  10.89   5\n29  28.72  10"},{"path":"ch5.html","id":"mutate","chapter":"5 Welcome to the Tidyverse","heading":"5.4.7 mutate()","text":"\nfunction mutate() creates new dataframe columns functions existing variables.Example 5.12  \\(\\text{}\\)\nselect age height columns using select(), convert height feet height meters using mutate(), plot result side-task using tee pipe, %T>% (note use . placeholder operator) (Fig 5.3), take column means age height. Note default, columns previous pipe segment mutate() output although columns need explicitly mutated. Output columns can specified using mutate() argument .keep.\nFigure 5.3: Plot loblolly pine height function age, converting height meters. base R dialect use: (Loblolly, plot(age, height * 0.3048, ylab = \"Height (m)\", xlab = \"Age (yrs)\")). quite bit harder decipher.\n\\(\\blacksquare\\)\n","code":"\nlibrary(magrittr) # to access tee pipe\n\nLoblolly |>\n  select(c(age, height)) |>\n  mutate(height = height * 0.3048) %T>%\n  plot(.,ylab = \"Height (m)\", xlab = \"Age (yrs)\") |>\n  colMeans()    age  height \n13.0000  9.8647 "},{"path":"ch5.html","id":"across","chapter":"5 Welcome to the Tidyverse","heading":"5.4.8 across()","text":"dplyr function across() allows extensions similar apply() wherein function can applied columns first argument across(). Specifying first argument across() everything() allow application function columns dataframe.Example 5.13  \\(\\text{}\\)\ntake medians quantitative columns Loblolly using across() summarize().\\(\\blacksquare\\)","code":"\nLoblolly |>\n   summarize(across(c(age, height), median))   age height\n1 12.5     34"},{"path":"ch5.html","id":"stringr","chapter":"5 Welcome to the Tidyverse","heading":"5.5 stringr","text":"\nevident Section 4.3, use regular expressions matching, querying substituting strings can confusing. stringr package attempts simplify difficulties. stringr package uses processing tools package stringi (Gagolewski 2022) pattern searching wide array potential approaches. stringr functions prefix str_ take character string string vector first argument.Consider vector plant scientific names used demonstrate string management Section 4.3.Example 5.14  \\(\\text{}\\)\nfunction str_length() can used count number characters string.\\(\\blacksquare\\)\nExample 5.15  \\(\\text{}\\)\nfunction str_detect() tests presence absence pattern string. test presence genus Aster.entries containing Aster.\\(\\blacksquare\\)\nExample 5.16  \\(\\text{}\\)\nsubset names using function stringr::str_subset() obtain species within genus Carex.\\(\\blacksquare\\)Example 5.17  \\(\\text{}\\)\nfunction str_replace() analogous base R function gsub(). can used replace text based pattern.\\(\\blacksquare\\)\n\nstringr functions work regular expressions (Section 4.3.6).Example 5.18  \\(\\text{}\\)\ncount upper lower case vowels function stringr::str_count() using pattern defined regex character class [AEIOUaeiou].use stringr::str_extract() extract strings nine alphanumeric characters long, sort strings pipe.\\(\\blacksquare\\)\n","code":"\nnames = c(\"Achillea millefolium\", \"Aster foliaceus\",\n                           \"Elymus scribneri\", \"Erigeron rydbergii\",\n                           \"Carex elynoides\", \"Carex paysonis\",\n                           \"Taraxacum ceratophorum\")\nstr_length(names)[1] 20 15 16 18 15 14 22\nstr_detect(names, \"Aster\")[1] FALSE  TRUE FALSE FALSE FALSE FALSE FALSE\nstr_detect(names, \"Aster\", negate = TRUE)[1]  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE\nstr_subset(names, \"Carex\")[1] \"Carex elynoides\" \"Carex paysonis\" \nstr_replace(names, \"Carex\", \"C.\")[1] \"Achillea millefolium\"   \"Aster foliaceus\"       \n[3] \"Elymus scribneri\"       \"Erigeron rydbergii\"    \n[5] \"C. elynoides\"           \"C. paysonis\"           \n[7] \"Taraxacum ceratophorum\"\nstr_count(names, \"[AEIOUaeiou]\")[1] 9 7 5 7 6 5 9\nstr_extract(names, \"[[:alnum:]]{9}\") |>\n  sort()[1] \"elynoides\" \"foliaceus\" \"millefoli\" \"rydbergii\" \"scribneri\" \"Taraxacum\""},{"path":"ch5.html","id":"lubridate","chapter":"5 Welcome to the Tidyverse","heading":"5.6 lubridate","text":"\nBase R approaches handling date-time data described Section 4.4. package lubridate (https://lubridate.tidyverse.org/) contains functions simplifying extending operations.Example 5.19  \\(\\text{}\\)\nexample dataset, use time series used illustrate date-time classes Section 4.4.define timezone timezone computer workstation.package lubridate contains data-time parsers may easier use base functions strptime .Date.\ncurrent example, note data month/day/year hour:minute format. can create time series using function lubridate::mdy_hm.lubridate parsers include ymd(), ymd_hms(), dmy(), dmy_hms(), mdy(). lubridate parsers can often handle mixed methods data entry. ymd() documentation following example:\\(\\blacksquare\\)\nLubridate also allows extended mathematical operations date-time objects functions duration(), period(), interval().Example 5.20  \\(\\text{}\\)\nDuration functions include dseconds(), dminutes(), ddays(), dmonths().\\(\\blacksquare\\)\nExample 5.21  \\(\\text{}\\)\nPeriodic functions include seconds(), minutes(), hours(), days().\\(\\blacksquare\\)\nExample 5.22  \\(\\text{}\\)\nInterval functions include int_length(), int_start(), int_end().\\(\\blacksquare\\)\n","code":"\ndates <- c(\"08/13/2019 04:00\", \"08/13/2019 06:30\", \"08/13/2019 09:00\",\n           \"08/13/2019 11:30\", \"08/13/2019 14:00\", \"08/13/2019 16:30\",\n           \"08/13/2019 19:00\", \"08/13/2019 21:30\", \"08/14/2019 00:00\",\n           \"08/14/2019 02:30\", \"08/14/2019 05:00\", \"08/14/2019 07:30\",\n           \"08/14/2019 10:00\", \"08/14/2019 12:30\", \"08/14/2019 15:00\",\n           \"08/14/2019 17:30\", \"08/14/2019 20:00\", \"08/14/2019 22:30\",\n           \"08/15/2019 01:00\", \"08/15/2019 03:30\")\n\nlibrary(lubridate)\ntz <- Sys.timezone(location = TRUE)\ndate_lub <- mdy_hm(dates, tz = tz)\ndate_lub [1] \"2019-08-13 04:00:00 MDT\" \"2019-08-13 06:30:00 MDT\"\n [3] \"2019-08-13 09:00:00 MDT\" \"2019-08-13 11:30:00 MDT\"\n [5] \"2019-08-13 14:00:00 MDT\" \"2019-08-13 16:30:00 MDT\"\n [7] \"2019-08-13 19:00:00 MDT\" \"2019-08-13 21:30:00 MDT\"\n [9] \"2019-08-14 00:00:00 MDT\" \"2019-08-14 02:30:00 MDT\"\n[11] \"2019-08-14 05:00:00 MDT\" \"2019-08-14 07:30:00 MDT\"\n[13] \"2019-08-14 10:00:00 MDT\" \"2019-08-14 12:30:00 MDT\"\n[15] \"2019-08-14 15:00:00 MDT\" \"2019-08-14 17:30:00 MDT\"\n[17] \"2019-08-14 20:00:00 MDT\" \"2019-08-14 22:30:00 MDT\"\n[19] \"2019-08-15 01:00:00 MDT\" \"2019-08-15 03:30:00 MDT\"\nx <- c(20090101, \"2009-01-02\", \"2009 01 03\", \"2009-1-4\",\n       \"2009-1, 5\", \"Created on 2009 1 6\", \"200901 !!! 07\")\nymd(x)[1] \"2009-01-01\" \"2009-01-02\" \"2009-01-03\" \"2009-01-04\" \"2009-01-05\"\n[6] \"2009-01-06\" \"2009-01-07\"\nduration(\"12m\", units = \"seconds\") # seconds in 1 year[1] \"31557600s (~1 years)\"\ndmonths(12)[1] \"31557600s (~1 years)\"\ndate_lub[1][1] \"2019-08-13 04:00:00 MDT\"\ndate_lub[1] + ddays(1)[1] \"2019-08-14 04:00:00 MDT\"\ndays(12) + minutes(2) + seconds(3)[1] \"12d 0H 2M 3S\"\ndate_lub[1][1] \"2019-08-13 04:00:00 MDT\"\ndate_lub[1] - days(12)[1] \"2019-08-01 04:00:00 MDT\"\nint <- interval(start = first(date_lub), end = last(date_lub))\n\nint_length(int) |>\n  duration()[1] \"171000s (~1.98 days)\""},{"path":"ch5.html","id":"reshape2","chapter":"5 Welcome to the Tidyverse","heading":"5.7 reshape2","text":"\nTidyverse functions generally require data long table format. , data stored columns containing values particular variable interest. Unfortunately, format conventional many scientific applications, particularly longitudinal studies follow experimental units time. often wide table format. tidyverse reshape2 package contains several functions converting dataframes wide long table formats, including functions reshape2::melt() tidyr::gather(). reshape2::melt.data.frame() function generates value column based data commonalities outcomes given variable variables defined id argument. remaining column, , captures commonalities given name variable. names value variable output columns can changed arguments value.name variable.name, respectively.\nExample 5.23  \\(\\text{}\\)\nConsider asbio::asthma dataset, wide table format.\ndataset documents effect three respiratory treatments (measured Forced Expiratory Volume one second (FEV1))\n24 asthmatic patients time (11H - 18H, .e, hour 11 hour 18). baseline measure FEV1 (BASEFEV1) also taken 11 hours application treatment.code , function reshape2::melt() used convert long table format, time designations simplified using base function factor(). factor() function can used create categorical variable particular levels (Section 3.3), change names levels. latter application used .\\(\\blacksquare\\)\n","code":"\ndata(asthma)\nhead(asthma)  PATIENT BASEFEV1 FEV11H FEV12H FEV13H FEV14H FEV15H FEV16H FEV17H FEV18H\n1     201     2.46   2.68   2.76   2.50   2.30   2.14   2.40   2.33   2.20\n2     202     3.50   3.95   3.65   2.93   2.53   3.04   3.37   3.14   2.62\n3     203     1.96   2.28   2.34   2.29   2.43   2.06   2.18   2.28   2.29\n4     204     3.44   4.08   3.87   3.79   3.30   3.80   3.24   2.98   2.91\n5     205     2.80   4.09   3.90   3.54   3.35   3.15   3.23   3.46   3.27\n6     206     2.36   3.79   3.97   3.78   3.69   3.31   2.83   2.72   3.00\n  DRUG\n1    a\n2    a\n3    a\n4    a\n5    a\n6    a\nlibrary(reshape2)\nasthma.long <- asthma |> melt(id = c(\"DRUG\", \"PATIENT\"),\n                               value.name = \"FEV1\",\n                               variable.name = \"TIME\")\n\n# here I simplify the names in the TIME variable\nasthma.long$TIME <- factor(asthma.long$TIME,\n                           labels = c(\"BASE\",\n                                      paste(\"H\", 11:18, sep = \"\")))\nhead(asthma.long)  DRUG PATIENT TIME FEV1\n1    a     201 BASE 2.46\n2    a     202 BASE 3.50\n3    a     203 BASE 1.96\n4    a     204 BASE 3.44\n5    a     205 BASE 2.80\n6    a     206 BASE 2.36"},{"path":"ch5.html","id":"exercises-4","chapter":"5 Welcome to the Tidyverse","heading":"Exercises","text":"Create tibble Downs dataframe shown . data comprise part report summarizing ’s syndrome cases British Columbia, compiled British Columbia Health Surveillance Registry (Geyer 1991).\nExamine original Downs dataframe tibble representation Downs printing . gain additional information tibble?\nFind mean variance Age column Downs dataset using pipes dpylr functions.\n\nDowns <- data.frame(Age = c(17, 20.5, 21.5, 29.5, 30.5, 38.5, 39.5,\n                            40.5, 44.5, 45.5, 47),\n                    Births = c(13555, 22005, 23896, 15685, 13954,\n                               4834, 3961, 2952, 596, 327, 249),\n                    Cases = c(16, 22, 16, 9, 12, 15, 30, 31, 22, 11,\n                              7)\n                    )\nExamine original Downs dataframe tibble representation Downs printing . gain additional information tibble?Examine original Downs dataframe tibble representation Downs printing . gain additional information tibble?Find mean variance Age column Downs dataset using pipes dpylr functions.\n\nDowns <- data.frame(Age = c(17, 20.5, 21.5, 29.5, 30.5, 38.5, 39.5,\n                            40.5, 44.5, 45.5, 47),\n                    Births = c(13555, 22005, 23896, 15685, 13954,\n                               4834, 3961, 2952, 596, 327, 249),\n                    Cases = c(16, 22, 16, 9, 12, 15, 30, 31, 22, 11,\n                              7)\n                    )Find mean variance Age column Downs dataset using pipes dpylr functions.Bring world.emissions dataset package asbio.\nUsing forward pipe operator, |>, filter() dplyr, create dataframe just US data.\nUsing |>, filter(), summarise(), find first last year emissions data US.\nUsing |>, %T>%, filter(), mutate(), plot(), plot per capita CO\\(_2\\) emissions US year (intermediate pipeline step) find maximum CO\\(_2\\) emission level. Hint: see Exercise 5.12.\nUsing |> filter() create new dataframe called .repeats eliminates rows entry \"redundant\" world.emissions$continent column.\n.repeats dataframe functions group_by(), summarise(), get mean CO\\(_2\\) levels country time.\nUsing |>, group_by(), summarise() slice_max(), identify 10 countries highest recorded cumulative CO\\(_2\\) emissions.\nUsing forward pipe operator, |>, filter() dplyr, create dataframe just US data.Using |>, filter(), summarise(), find first last year emissions data US.Using |>, %T>%, filter(), mutate(), plot(), plot per capita CO\\(_2\\) emissions US year (intermediate pipeline step) find maximum CO\\(_2\\) emission level. Hint: see Exercise 5.12.Using |> filter() create new dataframe called .repeats eliminates rows entry \"redundant\" world.emissions$continent column..repeats dataframe functions group_by(), summarise(), get mean CO\\(_2\\) levels country time.Using |>, group_by(), summarise() slice_max(), identify 10 countries highest recorded cumulative CO\\(_2\\) emissions.Consider character vector omics (Bonnin 2021).\nUse stringr::str_detect() test strings pattern \"genom\".\nUsing str_detect(), test strings starting pattern \"genom\" using extended regular expression: ^genom str_detect() argument pattern (see Section 4.3.6.1).\nUsing str_detect(), test strings ending pattern \"omics\" using extended regular expression (see Section 4.3.6.1).\nUsing str_subset(), subset string vector omics string entries containing pattern \"genom\".\nUsing str_replace(), replace text \"omics\" \"ome\".\n\nomics <- c(\"genomics\", \"proteomics\", \"proteome\",\n           \"transcriptomics\", \"metagenomics\", \"metabolomics\")\nUse stringr::str_detect() test strings pattern \"genom\".Use stringr::str_detect() test strings pattern \"genom\".Using str_detect(), test strings starting pattern \"genom\" using extended regular expression: ^genom str_detect() argument pattern (see Section 4.3.6.1).Using str_detect(), test strings starting pattern \"genom\" using extended regular expression: ^genom str_detect() argument pattern (see Section 4.3.6.1).Using str_detect(), test strings ending pattern \"omics\" using extended regular expression (see Section 4.3.6.1).Using str_detect(), test strings ending pattern \"omics\" using extended regular expression (see Section 4.3.6.1).Using str_subset(), subset string vector omics string entries containing pattern \"genom\".Using str_subset(), subset string vector omics string entries containing pattern \"genom\".Using str_replace(), replace text \"omics\" \"ome\".\n\nomics <- c(\"genomics\", \"proteomics\", \"proteome\",\n           \"transcriptomics\", \"metagenomics\", \"metabolomics\")Using str_replace(), replace text \"omics\" \"ome\".Consider character vector times , format: day-month-year hour:minute:second.\nConvert times lubridate date-time object using appropriate lubridate function.\nAdd two days seven seconds entry time using lubridate::days.\nUsing lubridate functions, find difference, seconds, beginning end time series.\n\ntimes <- c(\"12-12-2023 12:12:20\",\n           \"12-01-2021 01:12:40\",\n           \"15-10-2021 23:10:15\",\n           \"25-07-2022 13:09:45\")\nConvert times lubridate date-time object using appropriate lubridate function.Convert times lubridate date-time object using appropriate lubridate function.Add two days seven seconds entry time using lubridate::days.Add two days seven seconds entry time using lubridate::days.Using lubridate functions, find difference, seconds, beginning end time series.\n\ntimes <- c(\"12-12-2023 12:12:20\",\n           \"12-01-2021 01:12:40\",\n           \"15-10-2021 23:10:15\",\n           \"25-07-2022 13:09:45\")Using lubridate functions, find difference, seconds, beginning end time series.","code":"\nDowns <- data.frame(Age = c(17, 20.5, 21.5, 29.5, 30.5, 38.5, 39.5,\n                            40.5, 44.5, 45.5, 47),\n                    Births = c(13555, 22005, 23896, 15685, 13954,\n                               4834, 3961, 2952, 596, 327, 249),\n                    Cases = c(16, 22, 16, 9, 12, 15, 30, 31, 22, 11,\n                              7)\n                    )\nomics <- c(\"genomics\", \"proteomics\", \"proteome\",\n           \"transcriptomics\", \"metagenomics\", \"metabolomics\")\ntimes <- c(\"12-12-2023 12:12:20\",\n           \"12-01-2021 01:12:40\",\n           \"15-10-2021 23:10:15\",\n           \"25-07-2022 13:09:45\")"},{"path":"ch6.html","id":"ch6","chapter":"6 Base Graphics","heading":"6 Base Graphics","text":"\"Mankind invented system cope fact intrinsically lousy manipulating numbers. ’s called graph.\"- Charlie Munger, businessman philanthropist","code":""},{"path":"ch6.html","id":"introduction","chapter":"6 Base Graphics","heading":"6.1 Introduction","text":"\nimportant feature R capacity create publication-quality graphics tremendous user flexibility. Generally speaking, R graphics non-interactive changes plots require creation entirely new static plots. may feel like major departure used point--click graphics, characteristic software like Excel\\(^{\\circledR}\\) SigmaPlot\\(^{\\circledR}\\).\ntwo general graphics approaches R: base graphics grid graphics (Murrell 2019). Base graphics applied using R distribution package graphics, whereas grid graphics system relies low level facilities R distributed grid package, generally implemented via high level functions packages. base grid graphics systems generally interact well, although rely distributed grDevices package provides fundamental infrastructure R graphics, including graphical devices. base grid systems follow painters model later output obscures earlier overlapping output.base graphics system focus chapter. grid system, popular adherent, package ggplot2, described Chapter 7.\n","code":""},{"path":"ch6.html","id":"simple-base-graphics-examples","chapter":"6 Base Graphics","heading":"6.2 Simple Base Graphics Examples","text":"base graphics system allows creation wide variety plots single variables multiple variables (see Figs 6.1 6.2, respectively). Approaches making many example plots elaborated later chapter.\nFigure 6.1: Base graphics approaches single variables. Figure follows Murrell (2019). Classes plotted objects distinguished name color main headings: num = numeric, tab = table, fac = factor. row, left right, graphics : 1) scatterplot created applying function plot() vector class numeric, 2) plot() function applied one-dimensional object class table, resulting distributional plot, 3) barplot, useful comparing categorical outcomes, 4) pie chart, 5) dotchart, provides dot variant bar plot), 6) boxplot, .e., interquartile range (hinges) whiskers delimiting outliers, 7) histogram (common graphical distributional summary), 8) stripchart, .e., one dimensional scatter plot provides horizontal view distributional outcomes, 9) stem chart.\n\n\n\nFigure 6.2: Base graphics approaches considering multiple variables. Figure follows Murrell (2019). Classes plotted objects distinguished name color main headings: num = numeric, tab = table, fac = factor. row, left right, graphics : 1) scatterplot based two quantitative variables, 2) scatterplot smoothed densities, 3) sunflower plot, uses special symbols indicate overplotting points, 4) boxplot based factor (two levels) numeric variable, 5) 6) stacked beside barplots matrices, 7) dotchart, 8) stripchart, based two numeric variables, 9) spineplot, special cases mosaic plot (obtained using mosaicplot()), representing generalization stacked (highlighted) bar plot.\n\n\n","code":""},{"path":"ch6.html","id":"plot","chapter":"6 Base Graphics","heading":"6.2.1 plot()","text":"\nworkhorse base graphics function plot(). Figs 6.1 6.2 evident plot() can used number different ways, depending characteristics data plotted. example, data two numeric vectors, conventional scatterplot created. However, first two arguments plot() call numerical vector factor vector (order), boxplot created, first two arguments plot() call factor vector numeric vector (order), stripchart created. , plotting methods particular classes objects can designed can implemented calling plot(). instance, dendrogram Fig 6.3 created using plotting method called plot.agnes(), designed objects class agnes56. However, function can run using generic call plot(). See Ch 8 additional details plotting methods R classes.\n\nFigure 6.3: Dendrogram average linkage classification animals based six variables: warm vs. cold blooded, ability fly, vertebrate invertebrate, whether animal endangered, whether animal lives groups, whether animal hair. plotting function used, plot.agnes(), called using generic name plot().\ndefault, function plot() creates projection user defined Cartesian coordinates. usage plot() \ntwo required arguments.x defines x-coordinate values.y defines y-coordinate values.coordinates one dimension, x supplied, x plotted vertical axis series \\(1:n\\), \\(n\\) number points x. coordinate system can also supplied argument x form formula, list, matrix, dataframe.Important optional arguments include following:pch specifies symbol type(s), .e., plotting character(s) used.col defines color(s) used symbols.cex defines size (character expansion) plot symbols text.xlab ylab allow user specify x y-axis labels.type allows user define type graph drawn. Possible types \"p\" scatterplot points (default), \"l\" line plot, \"b\" , \"c\" line component \"b\", \"o\" overplotted, \"h\" ‘histogram’ like vertical lines (see middle plot top row Fig 6.1), \"s\" stair steps, n\" plotting.Example 6.1  \\(\\text{}\\)\ncan see symbol color alternatives calling plot() (Fig 6.4).\nFigure 6.4: symbol color plotting possibilities plot().\nline one code , x y coordinates sequences numbers 1 20 obtained command 1:20. varied symbol colors plotting characters (col pch, respectively) using 1:20 well. Thus, combination col = 1 pch = 1 results black open circle, whereas combination col = 20, pch = 20 results blue filled circle. Note need enclose axis names quotations R recognize\ntext. Symbol numbers 21-26 allow background color specification using argument bg. Many symbol types also possible.\\(\\blacksquare\\)","code":"\nlibrary(cluster)\naa.ga <- agnes(animals, method = \"average\")\nplot(aa.ga, sub = \"\", main = \"\", which.plots = 2, xlab = \"\")plot(1:20, 1:20, pch = 1:20, col = 1:20,\n     ylab =\"Symbol number\",\n     xlab = \"Color number\",\n     cex = 1.6, cex.lab = 1.1, cex.axis = 1.1)"},{"path":"ch6.html","id":"graphical-devices","chapter":"6 Base Graphics","heading":"6.3 Graphical Devices","text":"Graphics R created within graphics devices, encoded package grDevices. vary respect storage modes, display modes, available typefaces, characteristics. basic R download, six graphics devices available:windows() available Windows releases R. Provides -screen rendering graphics (outside RStudio)57, creates Windows metafile graphics files.pdf() renders graphics .pdf files.postscript() renders graphics PostScript, .ps, graphics files.xfig() renders graphics files using Xfig graphics file format.bitmap() renders graphics bitmap graphics files requires open source software ghostscript.piktex() Writes TeX/PicTeX graphics commands file historical interest .\nnumber graphics devices also exist, although may return warning R compiled use upon installation.cairo_pdf(), cairo_ps() svg() PDF, PostScript SVG (Scalar Vector Graphics) devices based open source Cairo graphics.cairo_pdf(), cairo_ps() svg() PDF, PostScript SVG (Scalar Vector Graphics) devices based open source Cairo graphics.bmp(), jpeg(), png(), tiff() render graphics .bmp, .jpg, .png, .tif bitmap files, respectively.bmp(), jpeg(), png(), tiff() render graphics .bmp, .jpg, .png, .tif bitmap files, respectively.X11() graphics device X11 windowing system, commonly used Unix-alike operating systems, including MacOS.X11() graphics device X11 windowing system, commonly used Unix-alike operating systems, including MacOS.quartz() functional MacOS supports plotting screen (default) various graphics file formats. device requires open source software XQuartz rendering R graphical user interfaces (see Ch 11).quartz() functional MacOS supports plotting screen (default) various graphics file formats. device requires open source software XQuartz rendering R graphical user interfaces (see Ch 11).\nMultiple devices (currently 63) may exist simultaneously R work session, although one active device. find current (active) graphics device can type dev.cur(). get:R tells two devices open. current device Windows device. second device -called “null device.” null device always open serves placeholder. attempt use open new device R. Occasionally, purpose accident, graphics devices (except null device) may become turned . new active graphics device can created time typing:One can close current (active) device using:active device can changed using function dev.set(). instance, three accessible devices, one wished define device three active device, one type:possible scroll graphics devices using keyboard shortcuts. Specifically, let \\(n\\) current device number, combination Ctrl + Alt + F11 (Windows Linux) Cmd + Alt + F11 (Mac) shows device \\(n-1\\), whereas Ctrl + Alt + F12 (Windows Linux) Cmd + Alt + F12 (Mac) shows device \\(n+1\\).\n","code":"\ndev.cur()png \n  2 \ndev.new()\ndev.off()\ndev.set(3)"},{"path":"ch6.html","id":"par","chapter":"6 Base Graphics","heading":"6.4 par()","text":"Parameters graphics device (may contain several plots) can accessed modified using function par(). important arguments par(). can also specified arguments plot(), different results.bg gives background color graphical device. used plot() gives background color plotting symbols.bty box-type drawn around plots. bty one \"o\" (default), \"l\", \"7\", \"c\", \"u\", \"]\" resulting box resembles corresponding upper case letter. value \"n\" suppresses box.fg gives foreground color.font integer specifies font typeface. 1 corresponds regular text (default), 2 bold face,\n3 italic 4 bold italic.las style axis labels: 0 always parallel axis (default), 1 always horizontal, 2 always\nperpendicular axis, 3 always vertical.mar form c(bottom, left, top, right) gives number lines margin specified four sides plot. default c(5, 4, 4, 2) + 0.1.mfrow form c(number rows, number columns) number position plots graphical layout. Multiple graphs can also placed graphical device additional control plot designation multiple elements row column configuration, using function layout().oma specifies outer margins graphical device, given multiple plots, using vector using matrix \nform: c(bottom, left, top, right).usr form c(x1, x2, y1, y2) giving extremes user coordinates plotting\nregion.setting graphical parameters, good practice revert back original parameter values. Assume want background graphics device black. set type:return default settings background type:Defaults also reset closing current graphics device, opening new device. instance, using dev.new().fundamental properties default graphics device, device height, width pointsize, can adjusted using dev.new() function. instance, create graphical device 9 inches wide, 4 inches high, type:Example 6.2  \\(\\text{}\\)\nFig 6.5 shows example applying background foreground colors using bg fg arguments par(), respectively. Note also specification bold font using par() argument font = 3, expansion graphics parameters slightly larger original size, using cex = 1.1.\nFigure 6.5: Use par() change background foreground graphical parameters.\n\\(\\blacksquare\\)Example 6.3  \\(\\text{}\\)\nFig 6.6 shows one can place multiple graphs single graphical device using mfrow argument par(), control figure margins using par() argument mar (line two). also shows basic plot types resulting type argument plot() (lines 4-7).\n\nFigure 6.6: Use par() place multiple graphs single graphical device. figure also demonstrates basic plot types, specified using plot() argument type. Clockwise top-left : 1) point plot (scatterplot), 2) line plot, 3) histogram-like (high density line) plot, 4) plot points lines.\n\\(\\blacksquare\\)","code":"\nold.par <- par(no.readonly = TRUE) # save default, for resetting...\npar(bg = \"black\") # change background parameter\npar(old.par)\ndev.new(width = 9, height = 4)old.par <- par(no.readonly = TRUE)\npar(bg = \"black\", fg = \"white\", font = 3, cex = 1.1)\nplot(1:10, 1:10, xlab = \"x\", ylab = \"y\",\n     col.lab = \"white\")\npar(old.par)old.par <- par(no.readonly = TRUE)\npar(mfrow = c(2,2), cex = 1.1, mar = c(4,4,1,1))\nx <- 1:10; y <- sort(rnorm(10))\nplot(x, y)\nplot(x, y, type = \"l\")\nplot(x, y, type = \"o\")\nplot(x, y, type = \"h\")\npar(old.par)"},{"path":"ch6.html","id":"exporting-graphics","chapter":"6 Base Graphics","heading":"6.5 Exporting Graphics","text":"export R graphics, one can generally copy snapshots clipboard using pull menus graphical device. can pasted programs (e.g., word processors) bitmaps (spatially mapped array bits) metafiles, generic term file format can store multiple types \n(generally graphical) data.create best possible graphs, however, one save device output using graphical device functions.instance, save graphics device image pdf file name example.pdf working directory type:make plot, instanceThe plot shown png() graphical device engaged. final step close device.graphics file now contained working directory. file argument unspecified, pdf() save file called Rplot.pdf.default, bitmap graphics formats: BMP, JPEG, PNG, TIFF, width height 480 pixels, “large” point size (1/72 inch) R. results rather coarse 72 ppi (72 points per inch) image resolution.\nHowever, changing res (resolution) argument graphical device function without changing pointsize, height width arguments generally result unusable figures.\\(500 \\approx 72 \\cdot 6\\), one can generate TIFF greater \\(400\\) ppi TIFF called fig1.tiff typing:respect graphical formats, documentation grDevices package states:“PNG format lossless58 best line diagrams blocks color. JPEG format lossy59,\nmay useful image plots, example. BMP format standard Windows, supported viewers elsewhere. TIFF meta-format: default format written default format tiff(compression = none) lossless stores RGB values uncompressed. files widely accepted, main virtue PNG.”\nsvg(), graphical devices apply cairographics recognize large number symbols fonts available document image generation default setting Windows PostScript PDF devices.","code":"\npdf(file =\"example.pdf\")\nplot(1:10)\ndev.off()\ntiff(\"fig1.tiff\", res = 72 * 6, height = 480 * 6, width = 480 * 6)\nplot(1:10)\ndev.off()"},{"path":"ch6.html","id":"text-points-and-lines","chapter":"6 Base Graphics","heading":"6.6 text(), points(), and lines()","text":"\nfunctions text(), points() lines() can used overlay text, points lines plot, respectively. plot() first two arguments functions x y coordinates plotted entities. arguments concern characteristics plotted items. instance, plot text \"example\" existing plot, plot coordinates x = 0, y = 0, large character expansion, type:result shown Fig 6.7.\nFigure 6.7: Empty plot (even axes suppressed) text overlain.\nfunction paste() can used concatenate elements text strings plots output. instance, try:\ncan placed plot (Fig 6.8) using text().\nFigure 6.8: empty plot text overlain. Note use paste(c, collapse = ' ') collapse string vector c single entity.\nplot dashed line points \\((0, 0)\\) \\((3, 2)\\), type:orThe result shown Fig 6.9.\nFigure 6.9: Plot dashed line overlain.\nplace large, blue, triangle red outline point (1, 1), existing plot type:resulting plot shown Fig 6.10.\nFigure 6.10: Plot point overlain.\n","code":"\nplot(-1:1, -1:1, type = \"n\", axes = F, xlab = \"\", ylab = \"\") # empty plot\ntext(x = 0, y = 0, \"example\", cex = 9)\na <- c(\"a\", \"b\", \"c\")\nb <- c(\"d\", \"e\", \"f\")\nc <- paste(a, b)\nc[1] \"a d\" \"b e\" \"c f\"\nplot(-1:1, -1:1, type = \"n\", axes = F, xlab = \"\", ylab = \"\")\ntext(x = 0, y = 0, paste(c, collapse = ' '), cex = 2)\nlines(x = c(0, 3), y = c(0, 2), lty = 2)\npoints(x = c(0, 3), y = c(0, 2), lty = 2, type = \"l\")\npoints(x = 0, y = 1, pch = 24, col = 2, bg = 4, cex = 8)"},{"path":"ch6.html","id":"plotting-mathematical-text","chapter":"6 Base Graphics","heading":"6.6.1 Plotting Mathematical Text","text":"R useful functions plotting mathematical expressions. include Greek letters, mathematical operators, italicization, sub- super-scripts. mathematical text generally called expression text argument functions text() mtext(). example, formula sample variance overlain Fig 6.11.\nFigure 6.11: Empty plot formula sample variance overlain. Type ?plotmath information.\n","code":"\nplot(-1:1, -1:1, type = \"n\", axes = F, xlab = \"\", ylab = \"\")\nvarexp <- expression(over(sum(paste(\"(\",italic(x[i] - bar(x)),\")\"^2),\n                              italic(i)==1, italic(n)),(italic(n) - 1)))\n\ntext(x = 0, y = 0, varexp, cex = 3)"},{"path":"ch6.html","id":"mtext","chapter":"6 Base Graphics","heading":"6.6.2 mtext()","text":"place text margin plot can use function mtext(). first argument mtext() function requires character string written plot. 2nd argument, side defines plot margin written : 1 = bottom, 2 =left, 3 = top, 4 = right.\ninstance, place text \"Axis 2\" right hand axis existing plot, type:","code":"\nmtext(\"Axis 2\", 4)"},{"path":"ch6.html","id":"geometric-shapes","chapter":"6 Base Graphics","heading":"6.7 Geometric Shapes","text":"Geometric shapes can drawn using number functions including rect() (draws rectangles) polygon() (draws polygons) based user-supplied vertices. instance, place purple rectangle vertices \\((1,1)\\), \\((1,2)\\), \\((2,2)\\), \\((2,1)\\), existing plot, type:See Fig 6.12.\nFigure 6.12: Plot rectangle overlain.\n\n","code":"\nrect(xleft = 0, ybottom = 1, xright = 2, ytop = 2, col = 6)"},{"path":"ch6.html","id":"axis","chapter":"6 Base Graphics","heading":"6.8 axis()","text":"function axis() can used create new axes plot customize axis characteristics. first argument (side) specifies side plot new axis occupy 1 = bottom, 2 =left, 3 = top, 4 = right.instance, create right hand axis type:important axis() arguments include vector axis labels (argument labels), locations labels (argument ).\nExample 6.4  \\(\\text{}\\)\ncreate customized axes rotated, \\(x\\)-axis labels, using axis() text() (Fig 6.13).\nFigure 6.13: Modifying axes axis().\nargument srt = 50 (Line 5) rotates text 50 degrees (srt specified mtext() axis(), hence use text() ). specification xpd = TRUE text() (Line 5) allows text printing extend plot axis margins.\\(\\blacksquare\\)","code":"\naxis(4)plot(1:3, type = \"n\", axes = F, xlab = \"\", ylab = \"\")\naxis(side = 2, at = 1:3, col = \"red\")\naxis(side = 1, at = 1:3, labels = FALSE, col = \"blue\")\ntext(1:3, rep(.65, 3), c(\"Label 1\", \"Label 2\", \"Label 3\"), \n     srt = 50, xpd = TRUE)"},{"path":"ch6.html","id":"font-typefaces","chapter":"6 Base Graphics","heading":"6.9 Font Typefaces","text":"Font typefaces can changed using number graphical functions, including par(), via argument family. general typeface families: \"serif\", \"mono\", \"sans\", Hershey family fonts (type ?Hershey information) transferable across graphics devices employed R. change font graphical device default sans serif (similar Arial) serif (similar Times New Roman) one\ntype:use Courier-type monospace font one use.Many typeface families possible, although may transportable graphical devices graphical storage formats.Example 6.5  \\(\\text{}\\)\ncode bring large number conventional font families using function Foundational Applied Statistics R website. typefaces (many others) typically available Windows platform machines, although supported non-Windows graphics devices. result can seen Figure 6.14 displays text ninety-nine Windows typefaces.\nFigure 6.14: Examples font families can used R graphics.\nNote line 2 code , use function png() generate high resolution .png graphical file. Thus, running entirety preceding code chunk create image file fonts.tiff working directory. save typing inordinate amount code, use loop (see Ch 8) place fonts one time graphics device (lines 9-11). Output closing graphical device shown line 14-15.Importantly, typefaces imported first line code chunk now available graphics functions using Windows graphical device. see first six available Windows fonts one can type:Similarly, one can see available fonts PostScript PDF graphics devices using:\\(\\blacksquare\\)\n","code":"\npar(family = \"serif\")\npar(family = \"mono\")source(url(\"http://www2.cose.isu.edu/~ahoken/book/win_fonts.R\"))\npng(\"fonts.png\", res = 72 * 6, height = 480 * 6, width = 480 * 6)\n  x <- rep(c(2.8, 6.4, 9.6), each = 33)\n  y <- rep(seq(10, 0.25, by = -.2965), 3)\n  font.type <- paste(rep(\"f\", length(fonts)), 1:length(fonts), sep = \"\")\n  par(mar = c(0.1,0.1,0.1,0.1), cex = 1.05)\n  plot(0:10, type = \"n\", xaxt= \"n\", yaxt = \"n\", xlab = \"\", ylab = \"\", \n       bty = \"n\")\n\n  for(i in 1:length(fonts)){\n    text(x[i],y[i], labels=fonts[i] , family = font.type[i])\n  }\ndev.off()\nhead(windowsFonts())$serif\n[1] \"TT Times New Roman\"\n\n$sans\n[1] \"TT Arial\"\n\n$mono\n[1] \"TT Courier New\"\n\n$f1\n[1] \"Agency FB\"\n\n$f2\n[1] \"Albany AMT\"\n\n$f3\n[1] \"ALGERIAN\"\nhead(names(pdfFonts()))[1] \"serif\"      \"sans\"       \"mono\"       \"AvantGarde\" \"Bookman\"   \n[6] \"Courier\"   "},{"path":"ch6.html","id":"colors","chapter":"6 Base Graphics","heading":"6.10 Colors","text":"enormous number color choices R graphics possible can specified least six different ways.First, can specify colors integers Figure 6.4. Additional varieties can obtained drawing color elements function colors() using colors()[number] (Fig 6.15).\n\nFigure 6.15: Color choices colors()\nfunction expand.grid() creates dataframe combinations user-supplied supplied vectors. Note combinations used coordinates plot().\nSecond, can specify colors using actual color names, e.g., \"white\", \"red\", \"yellow\". visual display essentially available named colors R type: example(colors).Second, can specify colors using actual color names, e.g., \"white\", \"red\", \"yellow\". visual display essentially available named colors R type: example(colors).Third, can define colors requesting red green blue (RGB) color intensities, along transparency, using function rgb() (Fig 6.16). Usable light intensities can made vary individually 0 255 (.e., within 8 bit format). Thus, \\(255^4 = 4,228,250,625\\) possible rgb() color combinations. default, red green, blue, alpha (transparency) arguments rgb() defined (0, 1).\nThird, can define colors requesting red green blue (RGB) color intensities, along transparency, using function rgb() (Fig 6.16). Usable light intensities can made vary individually 0 255 (.e., within 8 bit format). Thus, \\(255^4 = 4,228,250,625\\) possible rgb() color combinations. default, red green, blue, alpha (transparency) arguments rgb() defined (0, 1).\n\nFigure 6.16: Demonstration rgb(), emphasizing changes transparency.\nNote use box() line 5, places box around plot.Fourth, similar rgb(), can specify colors using function hcl() controls hues, chroma, luminescence transparency (see Fig 6.17).Fourth, similar rgb(), can specify colors using function hcl() controls hues, chroma, luminescence transparency (see Fig 6.17).Fifth, can define colors using hexadecimal codes60, e.g., blue = \"#0000FF\".\nFifth, can define colors using hexadecimal codes60, e.g., blue = \"#0000FF\".\nSixth, can specify colors using palettes. Figure 6.17 shows six pie plots. pie plot uses different pre-defined color palette. pie slice pie represents distinct segment distinct palette.\nSixth, can specify colors using palettes. Figure 6.17 shows six pie plots. pie plot uses different pre-defined color palette. pie slice pie represents distinct segment distinct palette.\n\nFigure 6.17: Examples color palettes R. Numbers correspond actual color type designations.\nNote functions rainbow(), heat.colors(), topo.colors() (Lines 3-6) require integer specification requesting number colors within particular palette. instanceNote colors rainbow() given hexidecimal format.function palette() can used check define number useful palettes. Colors current palette can obtained typing:list predefined palettes palette() can obtained typing:define current palette one used ggplot2 package (Ch 7), type: palette(\"ggplot2\").\nlarge number useful pre-defined palettes (including color-blind-safe palettes) can obtained using package RColorBrewer (Fig 6.18).\nFigure 6.18: RColorBrewer color-blind-safe, seven category palettes. Top palettes -called ‘sequential’ palettes, middle palettes ‘qualitative’, bottom palettes ‘divergent’.\nhexadecimal names “Set2” palette chunks Figure 6.18.Customized palettes can generated using colorRamp() function returns functions “interpolate set given colors create new color palettes.” Important colorRampPaltette() arguments include:\ntwo required arguments.colors defines colors interpolate.bias positive number controls distinctions among interpolated colors. Larger values indicated greater differences.space one \"RGB\" \"Lab\", indicating whether RGB CIELAB61 color spaces used interpolations.generate plot 15 color palette interpolated colors red blue (Fig 6.19).\nFigure 6.19: Color palette generated function colorRampPalette().\nfunction box() (Line 3) places box around figure whose axes axis labels intentionally omitted.\nnumber packages generation customized palettes. current favorite colorspace interactive function hclwizard(), generates shiny GUI (Ch 11) shown Fig 6.20.\nFigure 6.20: GUI constructed customized palettes generating function colorspace::hclwizard().\n","code":"\ne <- expand.grid(1:20, 1:32)\nplot(e[,1], e[,2], bg = colors()[1:640], pch = 22, cex = 2.5, xaxt = \"n\", \n     yaxt = \"n\", xlab = \"\", ylab = \"\")\ntext(e[,1], e[,2], 1:640, cex = .4)plot(1:10, cex = 15, pch = 19, xlab = \"\", ylab = \"\",\n     col = rgb(red = rep(0.2,10), green = rep(0.5,10),\n               blue = rep(0.8,10),\n               alpha = seq(0.05,1, length = 10)), axes = F)\nbox()layout(matrix(seq(1,6),3,2))\npar(mar=c(1,1,1,1))\npie(rep(1,12), col = rainbow(12), main = \"Rainbow colors\")\npie(rep(1,12), col = heat.colors(12), main = \"Heat colors\")\npie(rep(1,12), col = topo.colors(12), main = \"Topographic colors\")\npie(rep(1,12), col = gray(seq(0,1,1/12)), main = \"Gray colors\")\npie(rep(1,12), col = hcl(h=seq(180,0, length=12)), \n    main = \"Cols from hcl hue\")\npie(rep(1,12), col = hcl(h=seq(360,180,length=12)), \n    main = \"Cols from chroma\")\nrainbow(5)[1] \"#FF0000\" \"#CCFF00\" \"#00FF66\" \"#0066FF\" \"#CC00FF\"\npalette()[1] \"black\"   \"#DF536B\" \"#61D04F\" \"#2297E6\" \"#28E2E5\" \"#CD0BBC\" \"#F5C710\"\n[8] \"gray62\" \npalette.pals() [1] \"R3\"              \"R4\"              \"ggplot2\"        \n [4] \"Okabe-Ito\"       \"Accent\"          \"Dark 2\"         \n [7] \"Paired\"          \"Pastel 1\"        \"Pastel 2\"       \n[10] \"Set 1\"           \"Set 2\"           \"Set 3\"          \n[13] \"Tableau 10\"      \"Classic Tableau\" \"Polychrome 36\"  \n[16] \"Alphabet\"       \nlibrary(RColorBrewer)\ndisplay.brewer.all(n = 7, colorblindFriendly = TRUE)\nbrewer.pal(7, \"Set2\")[1] \"#66C2A5\" \"#FC8D62\" \"#8DA0CB\" \"#E78AC3\" \"#A6D854\" \"#FFD92F\" \"#E5C494\"crp <- colorRampPalette(colors = c(\"red\", \"blue\"))(15)\nplot(1:15, pch = 19, cex = 5, col = crp, axes = F, xlab = \"\", ylab = \"\")\nbox()"},{"path":"ch6.html","id":"scatterplots","chapter":"6 Base Graphics","heading":"6.11 Scatterplots","text":"\nScatterplots project points intersection paired observations describing two quantitative variables. Thus, scatterplots often presented conjunction simple regression analyses (Aho 2014).Example 6.6  \\(\\text{}\\)\nexample scatterplot usage use Loblolly dataset package datasets. Figure 6.21 allows visualization relationship loblolly pine tree age tree height.\nFigure 6.21: Scatterplot height age Loblolly pine tree dataset.\nNow let’s fit simple linear regression loblolly pine height function age. regression line show best possible linear fit response variable function quantitative explanatory variable (Aho 2014). R function linear model lm(). encompasses allows huge number statistical procedures, including regression (see Chs. 9-11 (Aho 2014)). :Note first argument lm() define height function age using tilde operator. Objects class lm ownsummary function. can called simply typing:output shows us Y-intercept, -1.31240, slope, 2.59052, fitted regression line, results null hypothesis tests, along lot information.abline() function allows plotting line existing plot. first two arguments abline() Y-intercept slope (Fig 6.22).\nFigure 6.22: Scatterplot fit overlain.\nNote gotten result using abline(ha.lm).Finally, can overlay 95% confidence interval true regression fitted value (see Aho (2014), Ch 9) using function predict.lm() (Fig 6.23)\nFigure 6.23: Scatterplot confidence interval true mean \\(y\\) given \\(x\\), overlain.\nobject ci, created Line 1, dataframe containing fits, corresponding lower upper confidence interval bounds. ordering \\(x\\)-axis values established Line 3 allow creation lines look like functions \\(x\\). ordering applied Cartesian coordinates Lines 4-5.\\(\\blacksquare\\)\n","code":"\nwith(Loblolly, plot(age, height))\nha.lm <- lm(height ~ age, data = Loblolly)\nsummary(ha.lm)\nCall:\nlm(formula = height ~ age, data = Loblolly)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-7.021 -2.167 -0.439  2.054  6.855 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  -1.3124     0.6218   -2.11    0.038 *  \nage           2.5905     0.0409   63.27   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.95 on 82 degrees of freedom\nMultiple R-squared:  0.98,  Adjusted R-squared:  0.98 \nF-statistic: 4e+03 on 1 and 82 DF,  p-value: <2e-16\nwith(Loblolly, plot(age,height, pch=2, col=3))\nabline(-1.312396, 2.590523)ci <- predict(ha.lm, interval = \"confidence\")\n\no <- order(Loblolly$age)\nageo <- Loblolly$age[o]\ncio <- ci[o,]\n\nwith(Loblolly, plot(age, height, pch=19, col=1))\nabline(-1.312396, 2.590523)\npoints(ageo, cio[,2], type = \"l\", col = \"gray\") # lower CI bound\npoints(ageo, cio[,3], type = \"l\", col = \"gray\") # upper CI bound"},{"path":"ch6.html","id":"transformations","chapter":"6 Base Graphics","heading":"6.12 Transformations","text":"\nImportantly, plot() allows straightforward application log transformations axes. instance, apply \\(\\log_e\\) transformation \\(x\\)-axis \\(y\\)-axis use log = \"x\" log = \"y\", respectively (Fig 6.24).\nFigure 6.24: Graphical \\(\\log_e\\) transformation height axis scatterplot Loblolly pine tree dataset.\n","code":"\nwith(Loblolly, plot(age, height, log = \"y\"))"},{"path":"ch6.html","id":"multiple-plots","chapter":"6 Base Graphics","heading":"6.13 Multiple Plots","text":"shown earlier, multiple graphs can placed graphics device using mfrow mfcol argument par(). section try incorporate number functions discussed far, including plot(), par(), mathematical formulae text(), points(), shapes rending rect(), colors() axis(), mtext().Example 6.7  \\(\\text{}\\)\ndataframe C.isotope package asbio describes variations \\(\\delta ^{14}\\)C time La Jolla California. term \\(\\delta ^{14}C\\) describes ratio carbon 14 carbon 12 (\\(^{14}\\)C unstable, \\(^{12}\\)C stable isotope carbon) compared standard ratio. create figure four subplots, following characteristics:dimensions 8” x 7”.outer margins (number lines) bottom = 0.1, left = 0.1, top = 0, right = 0.inner margins (plot) bottom = 4, left = 4.4, top = 2, right = 2. plot margins light gray. can specify gray gradations function.first plot show \\(\\delta ^{14}\\)C function date. plotting area dark gray, .e., colors()[181]. Points white circles black border.second plot line plot atmospheric carbon function date. light green plotting area: colors()[363].third plot scatterplot \\(\\delta ^{14}\\)C function atmospheric C. Points yellow circles black border. plotting area light red: colors()[580].fourth plot show sample variance atmospheric carbon time series. custom (albeit meaningless) axis, created axis(), labels: , b, c, d. also horizontal axis label inserted mtext().result shown Fig 6.25.\nFigure 6.25: Figure resulting summative example code.\n\\(\\blacksquare\\)\n","code":"library(asbio)\ndata(C.isotope)\ndev.new(height = 8, width = 7)\nop <- par(mfrow = c(2, 2), oma = c(0.1, 0.1, 0, 0), mar = c(4, 4.4, 2, 2),\n          bg = gray(.97))\n#-------------------------------- plot 1 -------------------------------#\nwith(C.isotope, plot(Decimal.date, D14C, xlab = \"Date\", ylab = \n                       expression(paste(delta^14,\"C (per mille)\")), \n                     type = \"n\"))\n\nrect(par(\"usr\")[1], par(\"usr\")[3], par(\"usr\")[2], par(\"usr\")[4],\n     col = colors()[181])\n\nwith(C.isotope, points(Decimal.date, D14C, pch = 21, bg = \"white\"))\n\n#-------------------------------- plot 2 -------------------------------#\nwith(C.isotope, plot(Decimal.date, CO2, xlab = \"Date\", ylab =\n                       expression(paste(CO[2],\" (ppm)\")), \n                     type = \"n\"))\n\nrect(par(\"usr\")[1], par(\"usr\")[3], par(\"usr\")[2], par(\"usr\")[4],\n     col = colors()[363])\n\nwith(C.isotope, points(Decimal.date, CO2, type = \"l\"))\n\n#-------------------------------- plot 3 -------------------------------#\nwith(C.isotope, plot(CO2, D14C, xlab = expression(paste(CO[2], \" (ppm)\")), \n                     ylab = expression(paste(delta^14,\"C (per mille)\")), \n                     type = \"n\"))\n\nrect(par(\"usr\")[1], par(\"usr\")[3], par(\"usr\")[2], par(\"usr\")[4],\n     col = colors()[580])\n\nwith(C.isotope, points(CO2, D14C, pch = 21, bg = \"yellow\"))\n\n#-------------------------------- plot 4 -------------------------------#\nplot(1:10, 1:10, xlab = \"\", ylab = \"\", xaxt = \"n\", yaxt = \"n\", \n     type = \"n\")\n\nrect(par(\"usr\")[1], par(\"usr\")[3], par(\"usr\")[2], par(\"usr\")[4], \n     col = \"white\")\ntext(5.5, 5.5, expression(paste(over(\n  sum(paste(\"(\",italic(x[i] - bar(x)),\")\"^2), \n      italic(i)==1, italic(n)),(italic(n) - 1)),\" = 78.4\")), \n  cex = 1.5)\naxis(side = 1, at = c(2, 4, 6, 8), labels = c(\"a\", \"b\", \"c\", \"d\"))\nmtext(side = 1, \n      expression(paste(\"Variance of \", CO[2], \" concentration\")),\n      line = 3)\npar(op)"},{"path":"ch6.html","id":"histograms","chapter":"6 Base Graphics","heading":"6.14 Histograms","text":"\nHistograms vital considering distributional characteristics quantitative data. consist rectangles whose height proportional equivalent frequency particular numeric intervals (bins) describing variable.Example 6.8  \\(\\text{}\\)\nbrycesite dataset package labdsv consists environmental variables recorded , calculated , 160 plots Bryce Canyon National Park Southern Utah.histogram Fig 6.26 shows distribution aspect (degrees) sites dataset.\nFigure 6.26: Histogram raw aspect measures brycesite dataset.\n\ndistribution appears remarkably uniform.Consideration raw aspect values analyses problematic measurements circular. result values 1 360 numerically 359 units apart, although fact differ one degree. One solution use transformation \\([1 - \\cos(\\text{aspect}^{\\text{o}} - 45)]/2\\). index highest values southwest slopes (225 degrees), lowest values northeast facing slopes (45 degrees). acknowledges fact highest temperatures Northern Hemisphere occur Southwest facing slopes receive ambient warming morning, coupled late afternoon direct radiation. :Fig 6.27 shows distribution transformed aspects now appears bimodal.\nFigure 6.27: Histogram transformed aspect measures brycesite dataset.\n\\(\\blacksquare\\)","code":"\nlibrary(labdsv)\ndata(brycesite)\nwith(brycesite, hist(asp, xlab = \"Aspect (Degrees)\", main = \"\"))\nasp.val <- (1 - cos(((brycesite$asp - 45) * pi)/180))/2\nhist(asp.val, xlab = \"Aspect idex\", main = \"\")"},{"path":"ch6.html","id":"controlling-graphical-features-using-vectors","chapter":"6 Base Graphics","heading":"6.15 Controlling Graphical Features using Vectors","text":"often useful add information graphical elements using variable.Example 6.9  \\(\\text{}\\)\nbrycesite contains information incident radiation received sites, measured Langleys. Langley (Ly) measure energy per unit area, per unit time. precise, one Ly = 1 calorie m\\(^{-2}\\) min\\(^{-1}\\). SI units 1Ly = 41840.00 J m\\(^{-2}\\). Fig 6.28 scatterplot Langleys function aspect index values. addition five topographic positions distinguished using point color shape. clarity also create legend. Note ridge top sites mostly northeastern aspect, hence lower radiation inputs.\nFigure 6.28: Scatterplot aspect index value versus annual radiation topographic positions indicated brycesite dataset.\nNote assign colors plotting characters appropriately, coerce categorical topographic position vector, brycesite$pos, numeric .numeric() (Line 3). result :Ones correspond first alphanumeric level pos, bottom, whereas fives correspond last alphanumeric level, up_slope. color symbols assignments made within plot Line three. Base graphics legends can created using function legend() (Line 5). first argument(s) specific x, y position plot legend, one : \"bottomright\", \"bottom\", \"bottomleft\", \"left\", \"topleft\", \"top\", \"topright\", \"right\", \"center\". legend argument names categories depicted. function levels() used legend argument lists categories vector class factor, alphanumerically.\\(\\blacksquare\\)\n","code":"with(brycesite, plot(asp.val, annrad, xlab = \"Aspect value\",\n                     ylab = \"Annual radiation (Langleys)\",\n                     col = as.numeric(pos), pch = as.numeric(pos)))\n\nlegend(\"bottomright\", legend = levels(brycesite$pos), pch = 1:5, col = 1:5)\nas.numeric(brycesite$pos)  [1] 4 3 3 4 5 3 3 5 3 3 2 2 3 4 3 3 3 1 2 2 2 5 4 4 3 5 4 3 5 3 5 3 2 5 5\n [36] 4 1 1 2 4 4 3 3 3 3 4 3 5 3 3 3 2 5 3 5 3 3 5 5 4 3 3 5 2 3 3 5 2 2 5\n [71] 2 2 3 3 3 2 2 3 3 2 4 3 4 2 5 3 3 2 2 3 5 5 3 5 5 3 3 3 3 5 5 3 3 3 3\n[106] 5 1 2 4 1 2 1 2 3 5 1 5 3 3 3 3 1 3 2 2 5 2 1 2 2 1 2 1 1 1 1 1 1 2 1\n[141] 1 4 5 5 5 4 5 2 2 4 1 5 5 5 3 2 2 1 5 4"},{"path":"ch6.html","id":"secondary-axes","chapter":"6 Base Graphics","heading":"6.16 Secondary Axes","text":"many graphical summaries may necessary add additional axes. base graphics involve laying one plot top another, specifying par(new = TRUE), defining axes = FALSE, depending whether want extra vertical horizontal axes, xlab = FALSE ylab = FALSE, ylab = \"\" xlab = \"\" arguments second plot.Example 6.10  \\(\\text{}\\)\nexample make scatterplot considers brycesite annual radiation annual growing season radiation function aspect value (Fig 6.29).\nFigure 6.29: Scatterplot annual radiation growing season radiation function aspect value index brycesite dataset.\nNote extra room given right hand margin (Line 1) contain labeling secondary vertical axis. code par(new = TRUE) (Line 4) tells R clean graphical device drawing new plot. code axis(4) (Line 7) creates labeling right hand axis. argument axes = FALSE second plot, suppresses default plot plotting axis units left bottom axes.\\(\\blacksquare\\)","code":"op <- par(mar = c(5,4.5,1,4.5), cex = 1.2)\nwith(brycesite, plot(asp.val, annrad, xlab = \"Aspect value\",\n                     ylab = \"Annual radiation (Langleys)\"))\npar(new = TRUE)\nwith(brycesite, plot(asp.val, grorad, pch = 19, axes = FALSE, xlab = \"\",\n                     ylab = \"\"))\naxis(4)\nmtext(side = 4,\"Growing season radiation (Langleys)\", line = 3, cex = 1.2)\nlegend(\"bottomright\", pch=c(1, 19), legend = c(\"Annual radiation\",\n                                            \"Growing season radiation\"))\npar(op)"},{"path":"ch6.html","id":"barplots","chapter":"6 Base Graphics","heading":"6.17 Barplots","text":"\nBarplots frequently used compare single number summaries (e.g., sum, median, mean, etc.) categorical levels.Example 6.11  \\(\\text{}\\)\ngreat concern citizens scientists rising global levels atmospheric greenhouse gasses. Atmospheric CO\\(_2\\) concentrations increased 40% since start industrial revolution potent greenhouse gasses CH\\(_4\\) \\(_2\\) increased approximately 150% 23%, respectively (Brinkmann 2009). take detailed look recent global patterns CO\\(_2\\) emissions human population numbers example, creating different sorts barplots, applying data management techniques introduced Chapter 4. Tidyverse data management approaches used creating ggplot2 graphics Chapter 4. use world.emissions dataframe asbio data source.code , CO\\(_2\\) annual means sample sizes country computed Lines 4-5. subset dataset six countries created Lines 7-8. Country names subset number years data collection combined object called labels Line 10. barplot code.color palette Line 1 code generated using colorspace::hclwizard(). Note rotated x-axis labels (las = 2) log-scale y-axis specified call barplot() Lines 2-3. customized y-axis constructed Lines 4-7. done largely force axis tick labels default vertical format. vertical otherwise use las = 2 barplot(). Figure 6.30 shows shows final result.\nFigure 6.30: Barplot mean annual CO\\(_2\\) emmission levels six countries. Number years used computing means indicated parentheses.\ndepict trends since year 2000, can use stacked barplot (Fig 6.31), side side barplot (Fig 6.32) applying barplot() matrix columns representing categories.code subset data country (Lines 1-4) year (Line 6), create dataframe containing CO\\(_2\\) country data (line 8), converted wide format matrix using unstack() (Line 9).code , hexadecimal colors generated colorspace::hclwizard() brought (Line 1) modified, .e., unlisted, coerced character vector reversed (Line 2), preceding creation barplot (Lines 4-8).\nFigure 6.31: Stacked barplot mean annual CO\\(_2\\) emmission levels six countries 2000-2019.\nSide side barplots generated specifying beside = TRUE barplot() (Line 2 code ).\nFigure 6.32: Side side barplot mean annual CO\\(_2\\) emmission levels six countries 2000-2019.\n\\(\\blacksquare\\)\n","code":"library(asbio)\ndata(world.emissions)\n\nnred <- world.emissions[world.emissions$continent != \"Redundant\",]\nco2 <- with(nred, tapply(co2, country, function(x){mean(x, na.rm = T)}))\nn <- with(nred, tapply(co2, country, function(x){length(x)}))\n\nco2n <- data.frame(cbind(co2, n))\nco2n.sub <- co2n[which(row.names(co2) %in% c(\"Canada\", \"China\", \"Finland\",\n\"Japan\", \"Kenya\", \"United States\")),]\n\nlabels <- paste(rownames(co2n.sub), \" (\", co2n.sub$n, \")\", sep = \"\")cols <- c(\"#5D3003\",\"#347C62\",\"#A79DBE\",\"#DFCCC2\",\"#994E58\", \"#F1F1F1\")\nbarplot(co2n.sub$co2, las = 2, ylab = \"\", yaxt = \"n\", names = labels,\n        log = \"y\", col = cols)\naxis(2)\nmtext(side = 2, \n      expression(paste(CO[2], \" Emissions (metric tons x \", 10^6, \")\")),\n      line = 2.5)csub <- world.emissions[\n  which(world.emissions$country %in% \n          c(\"Canada\", \"China\", \"Finland\", \n            \"Japan\", \"Kenya\", \"United States\")),]\n\nysub <- csub[which(csub$year >= 2000),]\n\ndat <- data.frame(co2 = ysub$co2, country = ysub$country)\ndat1 <- as.matrix(unstack(dat))cols <- read.table(\"colormap_hex.txt\") # file from hclwizard()\ncols <- rev(as.character(unlist(cols)))\n\nbarplot(dat1, log = \"y\", col = cols, yaxt = \"n\", las = 2, names = labels)\naxis(2)\nmtext(side = 2, \n      expression(paste(CO[2], \" Emissions (metric tons x \", 10^6, \")\")),\n      line = 2.5, cex = 1.2)barplot(dat1, log = \"y\", beside = TRUE, col = cols, yaxt = \"n\", las = 2)\n\naxis(2)\nmtext(side = 2, \n      expression(paste(CO[2], \" Emissions (metric tons x \", 10^6, \")\")),\n      line = 2.5, cex = 1.2)"},{"path":"ch6.html","id":"boxplots","chapter":"6 Base Graphics","heading":"6.18 Boxplots","text":"\nBoxplots box whisker plots variants excellent way quickly summarize compare distributions levels categorical variable respect quantitative variable. function boxplot() graphically providing five number summary factor levels (Fig 6.33). Specifically, upper lower hinges boxes boxplot show 1st 3rd quartiles (thus box contains central 50% data). black stripe middle box shows median. whiskers extend extreme data point coef times length box away hinge, coef defined arguments boxplot() (default coef = 1.5). Circle symbols outside whiskers can considered outliers (cf., Tukey et al. 1977).\nFigure 6.33: summary boxplot characteristics.\nExample 6.12  \\(\\text{}\\)\nreconsider world.emissions data using boxplots. Recall approach previous exercise:can use plot(q ~ c) (Fig 6.2) boxplot(q ~ c) make boxplots, q vector quantitative data c corresponding vector categorical data.\nFigure 6.34: Boxplots annual CO\\(_2\\) emmission levels six countries 2000-2019.\n\\(\\blacksquare\\)","code":"csub <- world.emissions[\n  which(world.emissions$country %in% c(\"Canada\", \"China\", \"Finland\",\n                                     \"Japan\", \"Kenya\", \"United States\")),]\nysub <- csub[which(csub$year >= 2000),]\n\ndat <- data.frame(co2 = ysub$co2, country = ysub$country)cols1 <- rev(c(\"#5D3003\",\"#347C62\",\"#A79DBE\",\n               \"#DFCCC2\",\"#994E58\", \"#F1F1F1\"))\nwith(dat, \n     boxplot(co2 ~ country, col = cols1, las = 2, xlab = \"\", \n             ylab = \n               expression(\n                 paste(CO[2], \" Emissions (metric tons x \", 10^6, \")\"))))"},{"path":"ch6.html","id":"violin-plots","chapter":"6 Base Graphics","heading":"6.18.1 Violin Plots","text":"\nAnother graphical tool comparing probability distributions violin plot. contains contains similar components boxplots, including designation boxes whiskers, along rotated kernel density plot side. Thus, allows additional consideration skew, kurtosis potential multimodality distributions. function vioplot package vioplot allows base graphics generation violin plots.\nExample 6.13  \\(\\text{}\\)\nexample compare violin plots based random sampling bimodal, uniform normal distribution (see ?vioplot). Note kernel density generator fits oblique sphere, although uniform PDF rectangle (Fig 6.35).\nFigure 6.35: Violin plots based random sampling bimodal, uniform, normal distribution.\n\\(\\blacksquare\\)","code":"library(vioplot)\n\nmu <- 2\nsig <- 0.6\nbimodal <- c(rnorm(1000,-mu, sig), rnorm(1000, mu, sig))\nuniform <- runif(2000, -4, 4)\nnormal <- rnorm(2000, 0, 3)\nvioplot(bimodal, uniform, normal, col = cols1[1:3],\n        names = \"Bimodal\", \"Uniform\", \"Normal\")"},{"path":"ch6.html","id":"interval-plots","chapter":"6 Base Graphics","heading":"6.19 Interval Plots","text":"\nInterval plots display location measures (e.g. means, medians, etc.), typically bars, along error bars representing measures data dispersion (e.g., standard errors, standard deviations, confidence intervals, interquartile ranges, etc.). Thus, barplots boxplots can considered special types interval plots.Example 6.14  \\(\\text{}\\)\nexample, create interval plot hand using classic dataset R.. Fisher records yield different varieties potatoes. data dataframe asbio::potato. means standard errors mean.\nplot means using barplot save horizontal locations bars object bloc.overlay error bars using function segments() arrows().result shown Fig 6.36.\nFigure 6.36: Interval plot Fisher potato dataset. Bar heights means, error bars represent \\(\\bar{x} \\pm \\hat{\\sigma}_{\\bar{x}}\\).\n\\(\\blacksquare\\) function asbio::bplot allows straightforward creation interval plots specified explanatory response variables. large number location dispersion measures can specified function arguments. recreate Fig 6.36 one simply type:\n","code":"\ndata(potato)\nmeans <- with(potato, tapply(Yield, Variety, mean))\nhead(means)         Ajax Arran comrade British queen  Duke of York       Epicure \n       3.3400        2.2622        3.1367        1.7778        2.1600 \n   Great Scot \n       3.4033 \nses <- with(potato, \n            tapply(Yield, Variety, function(x){sd(x)/sqrt(length(x))}))\nhead(ses)         Ajax Arran comrade British queen  Duke of York       Epicure \n     0.305941      0.070902      0.181184      0.148313      0.146771 \n   Great Scot \n     0.140929 \nbloc <- barplot(means, las = 2, ylab = \"Yield (lbs per plant)\", col = cols)\nsegments(x0 = bloc, y0 = means - ses, y1 = means + ses, x1 = bloc)\nwith(potato, bplot(y = Yield, x = Variety, bar.col = cols, border = cols))"},{"path":"ch6.html","id":"pairwise-comparisons","chapter":"6 Base Graphics","heading":"6.19.1 Pairwise Comparisons","text":"important component many biological analyses multiple pairwise comparisons means (location measures). tests often require control Family-Wise type Error Rate (FWER), , probability incorrectly rejecting least one true null hypothesis family related tests. powerful method controlling FWER post hoc family pairwise tests, following omnibus ANalysis VAriance (ANOVA), Tukey’s honest significant difference (see Aho (2014)).Example 6.15  \\(\\text{}\\)Zelazo, Zelazo, Kolb (1972) performed series experiments determine whether certain exercises allow infants learn walk younger age. experimental treatments : Active Exercise (AE), Passive Exercise (PE), Test-(), Control (C). data dataframe asbio::baby.walk. information type ?baby.walk.Rejection omnibus ANOVA null hypothesis mean treatment differences, allowed pairwise comparison treatment means using Tukey’s procedure. use function asbio::pairw.anova() run analysis.Interval plots can used summarize comparisons. plot method objects class pairw calls bplot() purpose. particular, :\nFigure 6.37: interval plot summarizing results pairwise comparisons baby.walk example.\nstated plot.pairw() function output (Fig 6.37), letters bars summarize result pairwise comparisons. particular, factor levels means letter significantly different using conventional FWER \\(\\alpha = 0.05\\).\\(\\blacksquare\\)\nlook sophisticated graphical methods pairwise comparisons Ch 7.","code":"\ndata(baby.walk)\ntukey <- with(baby.walk, pairw.anova(y = date, x = treatment))\ntukey\n95% Tukey-Kramer confidence intervals \n\n              Diff    Lower    Upper  Decision Adj. p-value\nmuAE-muC    -2.225 -4.35648 -0.09352 Reject H0     0.038997\nmuAE-muPE   -0.525 -2.65648  1.60648    FTR H0     0.897224\nmuC-muPE       1.7 -0.52625  3.92625    FTR H0     0.172932\nmuAE-muTO -1.58333 -3.61562  0.44895    FTR H0     0.160457\nmuC-muTO   0.64167 -1.48981  2.77314    FTR H0     0.829542\nmuPE-muTO -1.05833 -3.18981  1.07314    FTR H0     0.513366\nplot(tukey, ylab = \"Months until walking\", cex.lett = 1.2)\nBars are means.  Errors are SEs.\n\nThe population means of factor levels with the same letter are not\nsignificantly different at alpha = 0.05 using the Tukey HSD method."},{"path":"ch6.html","id":"matplot","chapter":"6 Base Graphics","heading":"6.20 matplot()","text":"function matplot() allows one plot columns one matrix columns another. clear ggplot2 alternative matplot() tidyverse functions require data long table format, whereas matplot() works best data wide table format.\nExample 6.16  \\(\\text{}\\)\ndemonstrate matplot() use dat1 dataset, used create Fig 6.31, contains annual CO\\(_2\\) levels 2000-2019 six countries.code , note allocate additional room top graph legend (Line 1). Note response variable matrix CO\\(_2\\) values whose columns delimit countries (Line 2). xpd argument legend() allows plotting clipped device region generally exceed plot region (Line 6). result shown Fig 6.38.\nFigure 6.38: matrix line plot.\n\\(\\blacksquare\\)","code":"par(mar = c(3,4.5,5,2), cex = 1.1)\nmatplot(x = 2000:2019, y = dat1, col = cols1, type = \"l\", lwd = 1.5,\n        log = \"y\", \n        ylab = expression(\n          paste(CO[2], \" Emissions (metric tons x \", 10^6, \")\")))\n\nlegend(x = 2001, y = 80000, xpd = TRUE,\n       lty = 1:5, ncol = 2, lwd = 1.5, bty = \"n\",\n       col = cols, legend =\n         c(\"Canada\", \"China\", \"Finland\",\n           \"Japan\", \"Kenya\", \"United States\"))"},{"path":"ch6.html","id":"interactivity","chapter":"6 Base Graphics","heading":"6.21 Interactivity","text":"noted earlier, R graphics generally non-interactive. graphical interactivity allowed via function locator(), returns graphical coordinates mouse click occurred plot, identify(), can used add labels symbols mouse click locations. instance, try:Windows, X Window, Cairo graphics devices, sophisticated methods exist interactivity. settings, function setGraphicsEventHandlers() can used call functions events mouse clicks keystrokes occur. instance, open appropriate graphics device try:Still interactive options possible using animations hand rotatable graphics. approaches, often transferable Markdown HTMLs, considered briefly next two sections chapter. Animations using package ggplot2 considered Ch 7. GUI driven graphics interactivity also possible, described Ch 11.\n","code":"\ndev.new(RStudioGD = FALSE) # If one is using RStudio\nplot(1:10)\nidentify(1:10, labels = 1:10)\nexample(\"getGraphicsEvent\")"},{"path":"ch6.html","id":"three-dimensional-graphics","chapter":"6 Base Graphics","heading":"6.22 Three Dimensional Graphics","text":"\noften necessary consider two variables biological graphics. can done number different ways, including use additional axes (e.g., Fig 6.29) (including 3D plots), additional colors, multiple line symbol types (Fig 6.28), even multiple symbol sizes.Example 6.17  \\(\\text{}\\)\nconsider three dimensional plotting use two datasets package vegan describe taiga/tundra ecosystems particular Scandinavian sites. Vegetation data contained dataset varespec soil chemistry data sites contained dataset varechem.Fig 6.39 examine distribution heath plant Vaccinium vitis-idaea (common species boreal forest understories) respect pH soil percent nitrogen. done making symbol sizes change abundance V. vitis-idaea.\nFigure 6.39: Cover Vaccinium vitis-idaea respect pH % soil\nnitrogen. Larger symbols indicate higher percent plant cover.\nVaccinium vitis-idaea appears prefer intermediate low levels soil N, acidic soils. somewhat negative association soil N pH probably due soil leaching, H\\(^+\\) (Al\\(^{3+}\\)) cations strongly adsorbed soil colloids bases poorly drained soils.3D plot associations can created using scatterplot3d() function package scatterplot3d .code , define figure function (named Fig) allow angle rotation 3D scatterplot easily changed using angle argument Fig (Line 2). Functions addressed detail Ch 8. stipulating highlight.3d = TRUE (Line 4), objects closer viewer respect x plane given warmer colors. regression “plane” also overlaid graph (Lines 9-10). fitted plane produced multiple regression model created function lm().\nresult shown Fig 6.40.\nFigure 6.40: Cover Vaccinium vitis-idaea respect pH % soil\nnitrogen, depicted 3D scatterplot.\n\\(\\blacksquare\\)\n","code":"\nlibrary(vegan)\ndata(varespec)\ndata(varechem)\nwith(varechem, plot(N, pH, xlab = \"% soil N\", pch = 16,\n                    cex = varespec$Vaccviti/100 * 15))library(scatterplot3d)\nFig <- function(angle = 55){\ns3d <- scatterplot3d(cbind(varechem$N, varechem$pH, varespec$Vaccviti),\ntype = \"h\", highlight.3d = TRUE, angle = angle, scale = .7, pch = 16,\nxlab = \"N\", ylab = \"pH\", zlab =\n  expression(paste(italic(Vaccinium), \" \", italic(vitis-idaea), \n                   \" % cover\")))\n\nlm1 <-lm(varespec$Vaccviti ~ varechem$N + varechem$pH)\ns3d$plane3d(lm1)\n}\nFig()"},{"path":"ch6.html","id":"animation","chapter":"6 Base Graphics","heading":"6.23 Animation","text":"\nAnimations can created R illustrate wide range processes (Xie 2013; Xie et al. 2018). Functions animation generally based loops (Section 8.4) method slowing loop; usually function Sys.sleep().\nExample 6.18  \\(\\text{}\\)\nadd animation 3D scatterplot shown Fig 6.40. facilitated fact plot function argument whose alteration results modification graph.Recall lapply() returns list length first argument X, whose elements result applying function, given second argument, corresponding elements X. code , argument-less function created containing loop run lapply() (Lines 2 - 5). loop index changes = 1 = 360 (Line 2) changes angle argument function fig(), used creating Fig 6.40. end step loop, system paused tenth second (Line 4) function Sys.sleep() allow “frame” animation viewed separately. (optional) last two lines code, R package animation loaded, function animation::saveGIF() used save animation GIF file format62.animation result shown 6.41.\n\nFigure 6.41: Animated version 3D scatterplot Fig 6.40.\n\\(\\blacksquare\\)Working animations generated R can placed HTML documents created R Markdown, PDF documents created using Sweave-alike approaches (Section 2.9.2). former approach currently requires installation gifski R package specification: animation.hook = \"gifski\" among chunk options animation. latter approach requires loading animate LaTeX package using chunk option fig.show = \"animate\". PDF animations can viewed using number PDF viewers including Foxit\\(^{\\circledR}\\) Adobe\\(^{\\circledR}\\) Acrobat Readers.Example 6.19  \\(\\text{}\\)\ncan also create hand-rotatable 3D figures rgl real-time rendering system.\nFigure 6.42: hand rotatable graphics object (within R interactive suitable PDF/HTML environment).\ncode , initial surface created considers possible combinations pH N outcomes (Line 1) actual occurrences varespec$Vaccviti observed combinations (Lines 3 4). function scatter3d() package car uses tools rgl package render three dimensional scatterplot. scatterplot rotatable within R session, can rendered rotatable graphic R Markdown HTML63. form plot shown Fig 6.42, although rotatability require interactive R environment ammenable HTML/PDF framework. Plots rgl can also rendered manipulated Shiny apps (see Ch 11).\\(\\blacksquare\\)\n","code":"fig.rot <- function(){\nlapply(seq(1, 360), function(i){\n  Fig(i)\n  Sys.sleep(.1)\n  })\n}\n\nfig.rot()\n# save frames into one GIF:\nlibrary(animation)\nsaveGIF(fig.rot(), interval = 1, movie.name = \"vaccinium.gif\")expg <- expand.grid(varechem$pH, varechem$N)\nsubs <- cbind(varechem$pH, varechem$N)\ntf <- (expg[,1] == subs[,1]) & (expg[,2] == subs[,2])\ny <- ifelse(tf == TRUE, varespec$Vaccviti, NA)\nsurface <- data.frame(N = expg[,1], pH = expg[,2], vac.vit = y)\n\nlibrary(car)\nscatter3d(vac.vit ~ N + pH, data = surface, surface = TRUE, fit = \"linear\",\nzlab = \"N\", xlab = \"pH\", ylab = \"Vaccinium vitilus (% cover)\")"},{"path":"ch6.html","id":"exercises-5","chapter":"6 Base Graphics","heading":"Exercises","text":"Consider variables: x <- c(1,2,2.5,3,4,3,5) y <- c(6,4.3,3,3.1,2,1.7,1).\nMake plot x defining x-axis y y-axis.\nMake every point scatterplot different color.\nMake every point different shape.\nCreate legend describing shape color combinations points one seven (call Point 1, Point 2, etc.).\nConvert point overplotted line point plot.\nChange label x-axis “Abscissa axis” label y-axis “Ordinate axis” using plotmath approach. require use functions expression(), paste() italic().\nPlace text “y = -1.203x + 6.539” coordinates x = 2, y = 2.5 using function text(). Italicize indicated.\nPlace line slope -1.203 y-intercept 6.539 plot using function abline().\nMake plot x defining x-axis y y-axis.Make every point scatterplot different color.Make every point different shape.Create legend describing shape color combinations points one seven (call Point 1, Point 2, etc.).Convert point overplotted line point plot.Change label x-axis “Abscissa axis” label y-axis “Ordinate axis” using plotmath approach. require use functions expression(), paste() italic().Place text “y = -1.203x + 6.539” coordinates x = 2, y = 2.5 using function text(). Italicize indicated.Place line slope -1.203 y-intercept 6.539 plot using function abline().Indometh dataframe package datasets describes pharmacokinetics drug indomethacin following intravenous injections six human subjects.\nCreate histogram variable conc, gives plasma concentrations indomethacin (mcg/ml) subjects time. Use appropriate x-axis label.\nCreate scatterplot conc function time (hours). Create appropriate axis labels.\nChange symbols colors points (b) based levels Subject.\nCreate wide table format Indometh using: wide <- unstack(Indometh, conc ~ Subject) names(wide) <- paste(\"Subject\", c(1,4,2,5,6,3)).\nCreate stacked barplot side side barplot based : barplot(.matrix(wide)).\nUse appropriate y-axis labels.\nCreate multiple line plot (line subject) using:\ntime <- c(0.25, 0.50, 0.75, 1.00, 1.25, 2.00, 3.00, 4.00, 5.00, 6.00, 8.00) matplot(x = time, y = wide, type = \"l\")\nGenerate appropriate axis labels plot.\nCreate appropriate legend plot created (h). colors line types used matplot() 1:6. order subjects 1, 4, 2, 5, 6, 3.\nCreate histogram variable conc, gives plasma concentrations indomethacin (mcg/ml) subjects time. Use appropriate x-axis label.Create scatterplot conc function time (hours). Create appropriate axis labels.Change symbols colors points (b) based levels Subject.Create wide table format Indometh using: wide <- unstack(Indometh, conc ~ Subject) names(wide) <- paste(\"Subject\", c(1,4,2,5,6,3)).Create stacked barplot side side barplot based : barplot(.matrix(wide)).Use appropriate y-axis labels.Create multiple line plot (line subject) using:\ntime <- c(0.25, 0.50, 0.75, 1.00, 1.25, 2.00, 3.00, 4.00, 5.00, 6.00, 8.00) matplot(x = time, y = wide, type = \"l\")Generate appropriate axis labels plot.Create appropriate legend plot created (h). colors line types used matplot() 1:6. order subjects 1, 4, 2, 5, 6, 3.dataframe life.exp asbio compares life expectancy field mice given five different diets.\nMake interpret boxplot showing lifespan function treatment.\nMake interval plot hand showing lifespan function treatment using means measures location, standard deviations generate error bars.\nMake interpret boxplot showing lifespan function treatment.Make interval plot hand showing lifespan function treatment using means measures location, standard deviations generate error bars.(Advanced) Conduct ANOVA post hoc pairwise comparison means Tukey’s HSD using: anova(lm(lifespan ~ treatment, data = life.exp)), tukey <- (life.exp, pairw.anova(lifespan, treatment)).\nCreate interval plot summarizing results using: plot(tukey).\nInterpret ().\nCreate interval plot summarizing results using: plot(tukey).Interpret ().Load C.isotope dataframe package asbio. Using par(mfrow()), create graphical device holding three plots single row, .e., three plots side side.\nfirst plot, show \\(\\delta ^{14}\\)C function time (decimal.date) using line plot. Use appropriate axis labels.\nsecond plot, show CO\\(_2\\) concentration function time scatterplot.\nthird plot, show measurement precision (column four dataset) function \\(\\delta ^{14}\\)C.\nfirst plot, show \\(\\delta ^{14}\\)C function time (decimal.date) using line plot. Use appropriate axis labels.second plot, show CO\\(_2\\) concentration function time scatterplot.third plot, show measurement precision (column four dataset) function \\(\\delta ^{14}\\)C.Load goats dataframe package asbio.\nCreate scatterplot NO3 function feces.\nMake plot showing NO3 organic.matter simultaneous function feces adding second y-axis.\nChange symbol sizes () reflect values organic.matter.\nCreate 3D scatterplot scatterplot3d::scatterplot3d, depicting NO3 function organic.matter feces.\nCreate scatterplot NO3 function feces.Make plot showing NO3 organic.matter simultaneous function feces adding second y-axis.Change symbol sizes () reflect values organic.matter.Create 3D scatterplot scatterplot3d::scatterplot3d, depicting NO3 function organic.matter feces.","code":""},{"path":"ch7.html","id":"ch7","chapter":"7 Grid Graphics, Including ggplot2","heading":"7 Grid Graphics, Including ggplot2","text":"“think can learn R, wrong. foreseeable future even able keep new additions.\"- Patrick Burns, CambR User Group Meeting, Cambridge (May 2012)","code":""},{"path":"ch7.html","id":"grid-graphics","chapter":"7 Grid Graphics, Including ggplot2","heading":"7.1 Grid Graphics","text":"large number auxiliary R packages specifically graphics. Many utilize extend base R graphics approaches described Chapter 6. Several successful newer packages, however, rely R grid graphics system (see Murrell (2019)), codified package grid (R Core Team 2023). grid graphics system provides low-level facilities high-level functions generate complete plots. Nonetheless, several successful packages built high-level functions grid foundations including lattice, gridGraphics –converts plots drawn base R graphics, e.g., plot(), identical grid output– highly popular ggplot2 package. Functions latter package major focus chapter.\n","code":""},{"path":"ch7.html","id":"lattice","chapter":"7 Grid Graphics, Including ggplot2","heading":"7.2 lattice","text":"\nAmong applications, lattice package (Sarkar 2008) contains functions implementing trellis graphical system64, -called often utilizes rectangular array plots resembling garden trellis (Ryan Nudd 1993). Trellis plots, generated lattice, important component several widely-used R packages, including nlme, allows generation linear nonlinear mixed effects models (see Aho (2014), Ch 10).Example 7.1  \\(\\text{}\\)\nsimple example call trellis plotting shown Fig 7.1. datasets::Indometh dataframe, previously used Examples Ch 6, records pharmacokinetics drug indomethacin, following intravenous injections given human subjects. dataframe belongs several grouped object classes, defined nlme, plotting methods (Ch 8), implemented generic call plot(). , course, familiar use plot() base R graphics approaches, implemented via graphics package.\n\nFigure 7.1: Example trellis plot. Indomethacin levels tracked six human subjects eight hours following intravenous injections.\n\\(\\blacksquare\\)lattice package contains several high level plotting functions can considered analogues base R graphics functions. include:lattice::xyplot(), similar graphics::plot() default type = \"p\" mode,lattice::histogram(), analogous graphics::hist(),lattice::barchart(), similar graphics::barplot(),lattice::levelplot(), analogous graphics::image(), andlattice::wireframe(), similar graphics::persp().general, trellis plots lattice can created using conditional formula first argument functions. form y ~ x|z, signifies y function x, given levels z.Example 7.2  \\(\\text{}\\)\nConsider summarization association age tobacco use (LOW HIGH) esophageal cancer cases using e.cancer dataset (Breslow Day 1980) asbio (Fig 7.2).\nFigure 7.2: Use lattice::barchart() illustrate changes esophogeal cancer cases subject tobacco use age. Bar heights means.\nNote use pipes tidyverse functions (Ch 5) obtain mean numbers cases combinations levels age.grp tobacco (Lines 3-6). formulacases ~ age.grp|tobacco (Line 8) indicates mean cases considered function levels age.grp, given levels tobacco.\\(\\blacksquare\\)\nApproaches lattice can used may non-trellis applications.Example 7.3  \\(\\text{}\\)\nFigure 7.3 provides examples three dimensional graphics generation using lattice functions levelplot(), contourplot(), wireframe(). functions easiest use data spatial grid format row column numbers defining evenly spaced intervals reference point, cell responses constitute “heights” z (vertical) axis. popular volcano dataset, used figure, describes topography Maungawhau / Mount Eden, scoria cone Mount Eden suburb Auckland, New Zealand. case, rows columns represent 10m Cartesian intervals. first row contains elevations (meters sea level) northernmost points, whereas first column contains elevations westernmost points. argument split plot.trellis() used graphs Fig 7.3 (Lines 5 7). vector 4 integers c(x, y, nx, ny) indicate position current plot x, y position regular array nx ny plots.\nFigure 7.3: Representations Maungawhau (Mt Eden) using lattice functions.\n\\(\\blacksquare\\)\nlattice can used generate nice graphs, many users found coding requirements burdensome non-intuitive. issue, coupled desirable characteristics grid graphics system, prompted development package ggplot2, one tidyverse collection packages (Ch 5).","code":"\nlibrary(nlme)\nplot(Indometh)data(e.cancer)\n\nlibrary(tidyverse)\nmeans <- e.cancer |>  # obtain means\n  group_by(age.grp, tobacco) |>\n  summarize(cases = mean(cases))\n\nlibrary(lattice)\nbarchart(cases ~ age.grp|tobacco, data = means, xlab = \"Age\", \n         ylab = \"No. of cases\")\nlibrary(lattice)\nplot(levelplot(volcano, col.regions = heat.colors, xlab = \"x\", ylab = \"y\"),\n     split = c(1, 1, 1, 2), more = TRUE,\n     panel.width = list(x = 5.4, units = \"inches\"))\n\nplot(wireframe(volcano, panel.aspect = 0.7, zoom = 1, lwd = 0.01, \n               xlab = \"x\", ylab = \"y\", zlab = \"z\"), \n     split = c(1, 2, 1, 2), more = FALSE,\n     panel.width = list(x = 5.4, units = \"inches\"))"},{"path":"ch7.html","id":"ggplot2","chapter":"7 Grid Graphics, Including ggplot2","heading":"7.3 ggplot2","text":"ggplot2 package (formerly ggplot) emulates “grammar graphics”, underlies statistical graphics (Wilkinson 2012). According developer, “ggplot2 \\(\\ldots\\) tries take good parts base lattice\ngraphics none bad.” success ggplot2 package evident rich ecosystem contributed extension packages. Detailed descriptions ggplot2 package can found Wickham (2010), Wickham (2016). Helpful \\(ggplot2\\) “cheatsheets” can found . Like grid packages, ggplot2 play well base R graphics. fact, ggplot2 based unique object oriented system, ggproto system 65.\n","code":""},{"path":"ch7.html","id":"ggplot","chapter":"7 Grid Graphics, Including ggplot2","heading":"7.3.1 ggplot()","text":"function ggplot() used initialize essentially plotting procedures ggplot2. three common approaches:ggplot(df, aes(x, y, aesthetics))\ndf tibble dataframe. aes() represents aesthetic mappings. approach recommended layers use data aesthetics.\ndf tibble dataframe. aes() represents aesthetic mappings. approach recommended layers use data aesthetics.ggplot(df)\ndataframe tibble used identified -front. approach useful graphical layers use different \\(x\\) \\(y\\) coordinates, drawn dataset, df.\ndataframe tibble used identified -front. approach useful graphical layers use different \\(x\\) \\(y\\) coordinates, drawn dataset, df.ggplot()\nggplot skeleton initialized fleshed layers added. approach recommended one dataset used creation graphical layers.\nggplot skeleton initialized fleshed layers added. approach recommended one dataset used creation graphical layers.\nOne three approaches used first line code creating ggplot2 graphic. Layers added representing geoms, themes, aesthetics (see Section 7.3.2 immediately ). clarify coding steps, typically done separating layers lines, connected continuation prompt +.\nExample 7.4  \\(\\text{}\\)\ncode initiated ggplot, Approach 1 discussed , using data dataframe called df contains variables named x y, define \\(x\\) \\(y\\) coordinates plot. also added two geom layers theme, via imaginary functions geom1, geom2 theme1.\\(\\blacksquare\\)","code":"\nggplot(df, aes(x = x, y = y)) +\n  geom1() +\n  geom2() +\n  theme1()"},{"path":"ch7.html","id":"gat","chapter":"7 Grid Graphics, Including ggplot2","heading":"7.3.2 Geoms, Aesthetics, and Themes","text":"ggplot2 package facilitates generation overlays geoms, short “geometric objects”, aesthetics, themes. number ggplot2 geom functions shown Table 7.1. Note arguments geom functions fairly consistent. argument mapping refers aesthetic mappings, often specified ggplot2 function aes(). aesthetic mapping functions shown Table 7.2. explicit definition stat argument required several geoms, e.g., geom_col() geom_bar(), can take form stat = \"identity\", indicating raw unsummarized data plotted. ggplot2 package also allows specification general graphical themes including user-defined themes, via function theme(). exhaustive list \\(> 90\\) potential theme() arguments can found typing ?theme. Pre-defined ggplot2 theme frameworks include theme_gray(), signature ggplot2 theme (grey background white gridlines), theme_bw(), theme_classic(), theme_dark(), theme_minimal(), many others.\nTable 7.1: geom alternatives.\nTable 7.2: example ggplot2 aesthetic functions.\n","code":""},{"path":"ch7.html","id":"boxplots-1","chapter":"7 Grid Graphics, Including ggplot2","heading":"7.3.3 Boxplots","text":"\nFigure 7.4 shows boxplot R.. Fisher’s classic potato dataset Rothamsted Experimental Station (Fisher Mackenzie 1923). three important coding features recognized chunk . First, plot initialized using first approach described previous section: ggplot(df, aes(x, y, aesthetics)) (Line 2). Specifically, dataframe used, potato, identified, coordinates plot defined inside aes(). Second, plot modifications added functions theme() (includes call function element_text() change angle text x-axis), xlab(), finally, geom_boxplot() (Lines 3-5). Third, continuation prompt, +, placed end lines code indicate another graphical layer added plot. ggplot2, +, somewhat analogous forward pipe operator, |>, used tiddyverse (Ch 5). Specifically, denotes continuation ggplot2 plotting commands particular graphic. continuation broken line break (Line 6).\n\nFigure 7.4: example ggplot2 boxplot. general theme plot theme_gray(). signature appearance ggplot2 graphs: grey background white grid lines.\n","code":"data(potato) # in asbio\nggplot(potato, aes(x = factor(Variety), y = Yield)) +\n  theme(axis.text.x = element_text(angle = 50, hjust = 1, vjust = 0.9)) +\n  xlab(\"Variety\") +\n  geom_boxplot()"},{"path":"ch7.html","id":"saving-plots","chapter":"7 Grid Graphics, Including ggplot2","heading":"7.3.4 Saving Plots","text":"Plots can saved using function ggsave() graphical device function, e.g., pdf(), png(), described Ch 6.Note first line code ggplot converted object called g. Lines 5-7, graph rendered, using print.ggplot(g) plot.ggplot(g), compiled.object g ggplot2-specific classes \"gg\" \"ggplot\",base type `list\n","code":"g <- ggplot(potato, aes(x = factor(Variety), y = Yield)) +\n  theme(axis.text.x = element_text(angle = 50, hjust = 1, vjust = 0.9)) +\n  xlab(\"Variety\") +\n  geom_boxplot()\n\npdf(\"potato.pdf\")\nprint(g)\ndev.off()png \n  2 \nclass(g)[1] \"gg\"     \"ggplot\"\ntypeof(g)[1] \"list\""},{"path":"ch7.html","id":"line-plots","chapter":"7 Grid Graphics, Including ggplot2","heading":"7.3.5 Line Plots","text":"Line plots generally rendered using function geom_line().\nFig 7.5 consider Fisher’s potato data line plot approach. presentation allows us consider potato variety fertilizer levels. Note distinguish categories variable Fert using colour lty arguments aes() function calls (Line 1).\nFigure 7.5: Line plot representation potato dataset.\n","code":"ggplot(potato, aes(x = Variety, y = Yield, colour = Fert)) +\n  geom_line(aes(group = Fert, lty = Fert),\n       alpha = .7, linewidth = 1.1) +\n  theme_classic() +\n  theme(axis.text.x = element_text(angle = 50, hjust = 1, vjust = 0.9))"},{"path":"ch7.html","id":"scatterplots-1","chapter":"7 Grid Graphics, Including ggplot2","heading":"7.3.6 Scatterplots","text":"\nsummarize asbio::world.emissions CO\\(_2\\) gross domestic product data, using tidyverse approach.don’t like default ggplot2 margins. Specifically, feel axis label font size small placed close axes. Thus, prior making scatterplot variables, make margin theme, function, calls theme().\ncan call custom theme within ggplot code (Fig 7.6).\nFigure 7.6: example ggplot2 scatterplot using world.emissions dataset.\nalso called complete ggplot2 theme theme_classic() generate uncluttered graph grid lines.Several code steps worth mentioning Fig 7.6. First, note use plotmath code using calls expression() xlab() ylab(). alternative, used labs(x,y) arguments x y contain code xlab() ylab(). Second, \\(\\log_{10}\\) transformations applied axes using ggplot2 functions scale_x_continuous() scale_y_continuous(). alternative, used functions scale_x_log10() scale_y_log10().can also require specific tick locations using scale_y_continuous (Fig 7.7).\nFigure 7.7: Custom tick mark locations overlaid \\(y\\)-axis Fig 7.6.\n\n","code":"library(asbio)\ndata(world.emissions)\nlibrary(dplyr)\ncountry.data <- world.emissions |>\n  filter(continent != \"Redundant\") |>\n  group_by(country) |>\n  summarize(co2 = mean(co2, na.rm = TRUE),\n            gdp = mean(gdp, na.rm = TRUE))margin_theme <- function(){\n  theme(axis.title.x = element_text(vjust=-6, size = 12),\n        axis.title.y = element_text(vjust=6, size = 12),\n        axis.text = element_text(size = 10),\n        plot.margin = margin(t = 7.5, r = 7.5, b = 22, l = 22))\n}g <- ggplot(country.data, aes(x = gdp, y = co2)) +\n  ylab(expression\n       (paste(CO[2], \" Emissions (metric tons x \", 10^6, \")\"))) +\n  xlab(\"GDP (international dollars)\") +\n  geom_point(size = 2) +\n  scale_y_continuous(trans= \"log10\") +\n  scale_x_continuous(trans= \"log10\") +\n  theme_classic() +\n  margin_theme()\ng\ng + scale_y_continuous(breaks = c(1, 50, 150, 500, 750, 1600),\n                       trans= \"log10\")"},{"path":"ch7.html","id":"ggtrans","chapter":"7 Grid Graphics, Including ggplot2","heading":"7.3.7 Transformations","text":"\n\\(\\log_{10}\\) transformations (Fig 7.6, several graphical transformation can readily applied transform function scale_x_continuous() scale_y_continuous() including \"asn\" (arcsine), \"atanh\" (inverse hyperbolic tangent), \"boxcox\", .e., optimal power transform response variable linear model (see Aho (2014)), \"date\", \"exp\", \"hms\", \"log\" (\\(\\log_e\\) transform), \"log1p\" (\\(\\log_e\\) transform, following addition 1 prevent undefined logarithms zeroes), \"log2\", \"logit\" (.e., log odds probability), \"modulus\", \"probit\", \"pseudo_log\" (\\(\\log_e\\) transform, NAs resulting undefined logarithms zeroes, given value zero), \"reciprocal\", \"reverse\", \"sqrt\" \"time\".","code":""},{"path":"ch7.html","id":"adding-model-fits","chapter":"7 Grid Graphics, Including ggplot2","heading":"7.3.8 Adding Model Fits","text":"straightforward add fits statistical models ggplot object, instance object g created Fig 7.6. can include conventional general linear models locally fitted models, like Generalized Additive Models (GAMs) locally weighted scatterplot smoothers (LOWESS), allow association x y “speak ” without assumption underlying global linear association (Aho 2014). default, geom_smooth() provides LOWESS fit using function loess() R distribution stats package. code geom_smooth(method = \"lm\") fits general linear model, case, simple linear regression (Fig 7.8). default, error polygons included fits represent 95% confidence intervals true fitted value. can turned specifying geom_smooth(se = FALSE).\n\nFigure 7.8: regression model overlaid Fig @ref{fig:gscat1}.\n","code":"\ng + geom_smooth(method = \"lm\") # call to lm fit"},{"path":"ch7.html","id":"annotations-in-graphs","chapter":"7 Grid Graphics, Including ggplot2","heading":"7.3.9 Annotations in Graphs","text":"ggplot2 package nice functions graph annotation. Fig 7.9 use function geom_label() label countries. arguments nudge_y nudge_x allow adjustments label locations.\n\nFigure 7.9: Country annotations added Fig 7.6.\nggpmisc package allows annotation statistical models ggplot. accomplished using function ggpmisc::stat_poly_eq() fits model usingstats::lm(), computes model quantities prepares tidy text summaries model including model equation, test statistic values \\(p\\)-values. Computed terms called using ggplot2 function after_stat(), delays aesthetic mapping aes() statistic calculation.\nFig 7.10, equation world.emissions regression model placed figure after_stat(eq.label), adjusted \\(R^2\\) (Aho 2014) placed using after_stat(adj.rr.label). complete list available computed terms, including eq.label adj.rr.label, given documentation stat_poly_eq().\nFigure 7.10: Regression model summaries overlaid Fig 7.6.\npotential criticism ggplot2 graphical rendering approaches readily accessible (code output), statistical summaries often adequately clearly described (documentation output). instance, using geom_smooth() unclear default smoothing parameters actually used, although can set within geom_smooth() function ggplot2::ggplot_build() provides underlying plotting details. exampleThe gginnards package can used generate accessible ggplot analytical information. can done calling gginnards::geom_debug() within ggpmisc::stat_poly_eq().\nexample, recall \\(\\log_{10}-\\log_{10}\\) transformation used generate scatterplot object, g, used project Fig 7.6.\ncan summarize linear model, overlaid Fig 7.8, code:accordance linear model \\(\\log_{10}(\\text{CO}_2) = -10.800518+ 1.110939\\log_{10}(\\text{GDP})\\) obtained using base function lm().","code":"sub <- country.data |>\n  filter(country %in% c(\"Canada\", \"Finland\",\n\"Japan\", \"Kenya\", \"United States\"))\n\ng + geom_point(size = 3, shape = 1, data = sub, col = \"orange\") +\n  geom_label(aes(label = country), data = sub, nudge_y = .25,\n             nudge_x = -.25, alpha = .9, colour  = \"orange\")library(ggpmisc)\n\ng + geom_smooth(method = \"lm\") +\nstat_poly_eq(aes(label = paste(after_stat(eq.label),\n                                  after_stat(adj.rr.label),\n                                  sep = \"*\\\", \\\"*\")))\nhead(ggplot_build(g)$data[[1]])         y      x PANEL group shape colour size fill alpha stroke\n1  0.40732 10.494     1    -1    19  black    2   NA    NA    0.5\n2  0.51149 10.085     1    -1    19  black    2   NA    NA    0.5\n3  1.63089 11.428     1    -1    19  black    2   NA    NA    0.5\n4 -0.31447     NA     1    -1    19  black    2   NA    NA    0.5\n5  1.00675 10.642     1    -1    19  black    2   NA    NA    0.5\n6 -0.95782     NA     1    -1    19  black    2   NA    NA    0.5library(gginnards)\ng + stat_poly_eq(formula = y ~ x, geom = \"debug\",\n                 output.type = \"numeric\",\n                 summary.fun = function(x) x[[\"coef.ls\"]])[1] \"PANEL 1; group(s) -1; 'draw_function()' input 'data' (head):\"\n  npcx npcy label\n1   NA   NA      \n                                                                                           coef.ls\n1 -1.0801e+01, 1.1109e+00, 2.8430e-01, 2.6794e-02, -3.7990e+01, 4.1462e+01, 1.3821e-82, 3.6215e-88\n             coefs r.squared rr.confint.level rr.confint.low\n1 -10.8005, 1.1109   0.91388             0.95        0.89056\n  rr.confint.high adj.r.squared f.value f.df1 f.df2    p.value    AIC\n1         0.92912       0.91335  1719.1     1   162 3.6215e-88 30.353\n     BIC   n rr.label b_0.constant     b_0    b_1 fm.method fm.class\n1 39.652 164                 FALSE -10.801 1.1109     lm:qr       lm\n  fm.formula fm.formula.chr      x      y PANEL group orientation\n1      y ~ x          y ~ x 8.3836 3.2706     1    -1           x\nmodel <- lm(log(co2, base = 10) ~ log(gdp, base = 10), data = country.data)\ncoef(model)        (Intercept) log(gdp, base = 10) \n           -10.8005              1.1109 "},{"path":"ch7.html","id":"secondary-axes-1","chapter":"7 Grid Graphics, Including ggplot2","heading":"7.3.10 Secondary Axes","text":"Secondary axes can difficult implement ggplot2 require user specification one--one transformation primary axis.Example 7.5  \\(\\text{}\\)\ndemonstrate generation ggplot secondary axes, examine two datasets published Rubino et al. (2013) concerning CO\\(_2\\) \\(\\delta ^{13}\\text{C}\\) trapped Antarctic ice layers. wish simultaneously plot CO\\(_2\\) \\(\\delta^{13}\\text{C}\\) function age depositional layer. use primary (left-hand) vertical axis plot CO\\(_2\\) use right hand axis \\(\\delta ^{13}\\text{C}\\). first create composite dataset years CO\\(_2\\) \\(\\delta ^{13}\\text{C}\\) measured.years (ice depths) consideration, CO\\(_2\\) levels vary approximately 271 368 ppm. range around 100 ppm.Experimentation using simple linear transformations (additions /multiplications variable), reveals similar range can generated \\(\\delta ^{13}\\text{C}\\) following transformation: \\(y' = 56 \\cdot y + 729\\).Thus, create:use ggplot code . scatterplot data shown Fig 7.11.\nFigure 7.11: graphical representation data published Rubino et al. (2013), using two vertical axes.\ntwo vital steps creating secondary axis.First, preliminary step transformed raw \\(\\delta^{13}\\)C data allow plotting \\(\\delta^{13}\\)C points range CO\\(_2\\) observations (Line 1). result object data.C$td13C.Second, figure code scale secondary axis based back-transformation transformed data. , solved \\(y\\) \\(y' = 56 \\cdot y + 730\\) found \\(y = (y' - 730)/56\\). underlies code Line 9:\nsec.axis = sec_axis(~ (. - 730)/56, first argument sec_axis().\nNote axis components painstakingly colored using ggplot::theme() (Lines 12-19).\\(\\blacksquare\\)\n","code":"data(Rabino_CO2); data(Rabino_del13C)\n# Match 1st dataset with 2nd\nw <- which(Rabino_CO2$effective.age %in% Rabino_del13C$effective.age)\nR.C <- Rabino_CO2[w,]\n# match 2nd dataset with 1st\nw <- which(Rabino_del13C$effective.age %in% R.C$effective.age)\nR.d <- Rabino_del13C[w,]\ndata.C <- data.frame(CO2 = tapply(R.C$CO2, R.C$effective.age, mean),\n                     d13C = tapply(R.d$d13C.CO2, R.d$effective.age, mean),\n                     year = as.numeric(levels(factor(R.d$effective.age))))\ndata.C |>\n  reframe(range_ppm = range(CO2, na.rm = T))  range_ppm\n1    277.16\n2    368.02\ndata.C |>\n  reframe(range_ppm = range((d13C * 56) + 729, na.rm = T))  range_ppm\n1    277.11\n2    373.34data.C$td13C <- data.C$d13C * 56 + 730ggplot(data.C, aes(x = year, y = CO2)) +\n  geom_point(colour = \"blue\", size = 2.7, alpha = 0.2) +\n  theme_classic() +\n  margin_theme() +\n  ylab(expression(paste(\"C\",O[2], \" (ppm)\"))) +\n  geom_point(data = data.C, aes(x = year, y = td13C), colour = \"red\",\n             size = 2.7, alpha = 0.2) +\n  scale_y_continuous(sec.axis = \n                       sec_axis(~ (. - 730)/56, \n                                name = expression(paste(delta^13, \n                                                        \"C (\\u2030)\")))) +\ntheme(axis.text.y.right = element_text(colour = \"red\")) +\ntheme(axis.text.y.left = element_text(colour = \"blue\")) +\ntheme(axis.title.y.right = element_text(colour = \"red\")) +\ntheme(axis.title.y.left = element_text(colour = \"blue\")) +\ntheme(axis.line.y.right = element_line(colour = \"red\")) +\ntheme(axis.line.y.left = element_line(colour = \"blue\")) +\ntheme(axis.ticks.y.right = element_line(colour = \"red\")) +\nxlab(\"Year\")"},{"path":"ch7.html","id":"defining-graphical-features-using-vectors","chapter":"7 Grid Graphics, Including ggplot2","heading":"7.3.11 Defining Graphical Features using Vectors","text":"already seen, straightforward define figure plotting characteristics (symbols, symbol sizes, colors, line types, etc.) using relevant data.Example 7.6  \\(\\text{}\\)\nFig 7.12 change symbols colors representation asbio::fly.sex dataset based experimental treatments:\nFigure 7.12: representation fly.sex dataset.\nNote linear fits Fig 7.12 actually separate regression models, longevity ~ thorax, level fly.sex$Treatment. single ANCOVA model: lm(longevity ~ thorax * Treatment), although clear ggplot graph. , however, revealed :\\(\\blacksquare\\)","code":"\ng1 + stat_poly_eq(formula = y ~ x, geom = \"debug\",\n                 output.type = \"numeric\",\n                 summary.fun = function(x) x[[\"coef.ls\"]])`geom_smooth()` using formula = 'y ~ x'[1] \"PANEL 1; group(s) 1, 2, 3, 4, 5; 'draw_function()' input 'data' (head):\"\n  npcx npcy label\n1   NA   NA      \n2   NA   NA      \n3   NA   NA      \n4   NA   NA      \n5   NA   NA      \n                                                                                           coef.ls\n1 -5.5699e+01, 1.4779e+02, 1.6834e+01, 2.0795e+01, -3.3087e+00, 7.1071e+00, 3.0654e-03, 3.0692e-07\n2 -5.0242e+01, 1.3613e+02, 2.4519e+01, 2.9186e+01, -2.0491e+00, 4.6640e+00, 5.2023e-02, 1.0753e-04\n3    -43.7248157, 131.4496314, 31.3250601, 37.8123482, -1.3958414, 3.4763678, 0.1760921, 0.0020423\n4 -5.7992e+01, 1.3700e+02, 2.8260e+01, 3.3625e+01, -2.0521e+00, 4.0744e+00, 5.1714e-02, 4.6763e-04\n5 -6.1280e+01, 1.2500e+02, 1.5225e+01, 1.8944e+01, -4.0250e+00, 6.5983e+00, 5.2871e-04, 9.8692e-07\n             coefs r.squared rr.confint.level rr.confint.low\n1 -55.699, 147.790   0.68712             0.95       0.418224\n2 -50.242, 136.127   0.48607             0.95       0.169020\n3 -43.725, 131.450   0.34445             0.95       0.058492\n4 -57.992, 137.001   0.41920             0.95       0.110089\n5   -61.28, 125.00   0.65433             0.95       0.370279\n  rr.confint.high adj.r.squared f.value f.df1 f.df2    p.value    AIC\n1         0.79674       0.67352  50.511     1    23 3.0692e-07 180.72\n2         0.66239       0.46373  21.753     1    23 1.0753e-04 199.31\n3         0.56048       0.31595  12.085     1    23 2.0423e-03 202.90\n4         0.61539       0.39395  16.600     1    23 4.6763e-04 197.51\n5         0.77529       0.63930  43.538     1    23 9.8692e-07 174.04\n     BIC  n rr.label b_0.constant     b_0    b_1 fm.method fm.class\n1 184.38 25                 FALSE -55.699 147.79     lm:qr       lm\n2 202.96 25                 FALSE -50.242 136.13     lm:qr       lm\n3 206.56 25                 FALSE -43.725 131.45     lm:qr       lm\n4 201.16 25                 FALSE -57.992 137.00     lm:qr       lm\n5 177.69 25                 FALSE -61.280 125.00     lm:qr       lm\n  fm.formula fm.formula.chr    x     y group PANEL orientation\n1      y ~ x          y ~ x 0.64 97.00     1     1           x\n2      y ~ x          y ~ x 0.64 92.95     2     1           x\n3      y ~ x          y ~ x 0.64 88.90     3     1           x\n4      y ~ x          y ~ x 0.64 84.85     4     1           x\n5      y ~ x          y ~ x 0.64 80.80     5     1           x"},{"path":"ch7.html","id":"modifying-legends","chapter":"7 Grid Graphics, Including ggplot2","heading":"7.3.12 Modifying Legends","text":"Note legend created Fig 7.12 designation groups initial aesthetics. Legend characteristics generally need modified using theme(). instance, change legend location right-hand side plot left-hand side, use:","code":"\ng1 + theme(legend.position = \"left\")"},{"path":"ch7.html","id":"multiple-plots-1","chapter":"7 Grid Graphics, Including ggplot2","heading":"7.3.13 Multiple plots","text":"can place multiple ggplots single graphics device using several approaches. consider two : 1) facet functions ggplot2 package, 2) ggplot extension functions package cowplot.","code":""},{"path":"ch7.html","id":"faceting","chapter":"7 Grid Graphics, Including ggplot2","heading":"7.3.13.1 Faceting","text":"functions facet_wrap() facet_grid() can used generate sequence plot panels.\nExample 7.7  \\(\\text{}\\)\nmodify Fig 7.12 demonstrate use facet_wrap().\nFigure 7.13: Demonstration facet_wrap using fly.sex dataset.\nLine 4 specify different panels created treatment level using: facet_wrap(vars(Treatment)). also accomplished using: facet_wrap(~Treatment).\\(\\blacksquare\\)","code":"g1 <- ggplot(fly.sex, aes(y = longevity, x = thorax,\n                         group = Treatment)) +\n  geom_point(aes(colour = Treatment, shape = Treatment)) +\n  facet_wrap(vars(Treatment)) +\n  theme_classic() +\n  margin_theme() +\n  geom_smooth(method = \"lm\", se = F, aes(colour = Treatment)) +\n  labs(x = \"Thorax length (mm)\", y = \"Longevity (Days)\")\ng1`geom_smooth()` using formula = 'y ~ x'"},{"path":"ch7.html","id":"cowplot-functions","chapter":"7 Grid Graphics, Including ggplot2","heading":"7.3.13.2 cowplot functions","text":"Multiple plots can also assembled single graphical entity using functions cowplot package. requires creating separate plot objects concatenating cowplot::plot_grid().Example 7.8  \\(\\text{}\\)\nFig 7.14 shows summaries US per capita CO\\(_2\\) emissions GDP since start industrial revolution two plots.\nFigure 7.14: Two plots depicting US per capita trends CO\\(_2\\) emissions GDP.\nfunction plot_grid used Line 17 conjoin ggplot objects g2 g3.\\(\\blacksquare\\)\n","code":"library(cowplot)\nUS <- world.emissions |>\n  filter(country == \"United States\")\n\ng2 <- ggplot(US) +\n  geom_line(aes(year, co2/population), col = \"dark red\") +\n  theme_classic() + margin_theme() +\n  theme(axis.text.x = element_text(angle = 50, hjust = 1, vjust = 0.9)) +\n  labs(x = \"Year\",\n       y = expression(paste(\"Per capita \", CO[2],\n                            \" emissions (tonnes x \", 10^6, \")\")))\n\ng3 <- ggplot(US) +\n  geom_line(aes(year, gdp/population), col = \"blue\") +\n  theme_classic() + margin_theme() +\n  theme(axis.text.x = element_text(angle = 50, hjust = 1, vjust = 0.9)) +\n  labs(x = \"Year\", y = expression(paste(\"Per capita GDP\")))\n\nplot_grid(g2, g3)"},{"path":"ch7.html","id":"univariate-distributional-summaries","chapter":"7 Grid Graphics, Including ggplot2","heading":"7.3.14 Univariate Distributional Summaries","text":"\nnumber ggplot2 functions can used graphically summarize distributions variables. include geom_hist() histograms, geom_area() area plots, geom_freq() frequency plots, geom_dotplot() dot plots, geom_density() density plots.Example 7.9  \\(\\text{}\\)\nFig 7.15 provides multi-plot distributional summary US CO\\(_2\\) data using histogram, area plot, frequency plot. created separate ggplot objects.histogram, area plot, frequency plot created Lines 10-15, 17-22, 24-29, respectively. Note use second margin theme (Lines 5-8) use ggplot2::scale_fill_brewer() define specific RColorBrewer color palettes.plots conjoined, area plot frequency plot splitting first row, histogram occupying entire second row graphical device using cowplot::plot_grid().\nFigure 7.15: Distributional summaries US CO\\(_2\\) data asbio::world.emissions.\n\\(\\blacksquare\\)\n","code":"xlab <- expression(paste(CO[2], \" Emissions (metric tons x \", 10^6, \")\"))\nYears <- factor(c(rep(\"1800-1854\", 55), rep(\"1854-1908\", 55),\n           rep(\"1908-1962\", 55), rep(\"1962-2019\", 55)))\n\nmargin_theme2 <- function(){\n  theme(axis.title.y = element_text(hjust=0.6, vjust = 2.8, size = 10),\n  plot.margin = margin(t = 7.5, r = 7.5, b = 7.5, l = 15))\n}\n\nhistogram <- ggplot(US, aes(co2, fill = Years)) +\n  geom_histogram(binwidth = 500) +\n  theme_classic() +\n  scale_fill_brewer(palette = \"Blues\") +\n  xlab(xlab) + ylab(\"Frequency\") +\n  margin_theme()\n\nareaplot <- ggplot(US, aes(co2, fill = Years)) +\n  geom_area(stat=\"bin\") +\n  theme_classic() +\n  scale_fill_brewer(palette = \"Spectral\") +\n  xlab(\"\") + ylab(\"Frequency\") +\n  margin_theme2()\n\nfreqplot <- ggplot(US, aes(co2, colour = Years)) +\n  geom_freqpoly() +\n  theme_classic() +\n  scale_fill_brewer(palette = \"Spectral\") +\n  xlab(\"\") + ylab(\"\") +\n  margin_theme2()\ntitle <- ggdraw() + draw_label(expression(paste(CO[2] , \" in the US\")), \n                               fontface='bold')\ntop_row <- plot_grid(areaplot, freqplot, ncol = 2, labels = \"AUTO\")\n\nplot_grid(title, top_row, histogram, rel_heights = c(0.2, 1, 1.2),\n          hjust = c(0,0,-0.6), nrow = 3, labels = c(\"\", \"\", \"C\"))"},{"path":"ch7.html","id":"barplots-1","chapter":"7 Grid Graphics, Including ggplot2","heading":"7.3.15 Barplots","text":"\nBarplots straightforward create ggplot2 using function geom_bar().\nExample 7.10  \\(\\text{}\\)\nConsider asthma dataframe asbio. first convert time series long table format using reshape2::melt(), summarize using dplyr::summarise().code Fig 7.16 , group drug treatments group = DRUG (line one) plot bars using mean values summary.FEV using (Line 6). argument stat = \"identity\" allows bar heights represented individual numbers, case means. Use stat = \"identity\" required . argument position = \"dodge\" creates side side bar plots (Line 6).\nFigure 7.16: Barplot asthma data created using geom_bar().\n\\(\\blacksquare\\)\n","code":"library(reshape2); data(asthma)\nasthma.long <- asthma |> melt(id = c(\"DRUG\", \"PATIENT\"),\n                               value.name = \"FEV1\",\n                               variable.name = \"TIME\")\n\nasthma.long$TIME <- factor(asthma.long$TIME,\n                           labels = c(\"BASE\",\n                                      paste(\"H\", 11:18, sep = \"\")))\n\nsummary.FEV <- asthma.long |>\n  group_by(TIME, DRUG) |>\n  summarise(mean = mean(FEV1),\n            se = sd(FEV1)/sqrt(length(FEV1)),\n            meanmse = mean - se,\n            meanpse = mean + se)g <- ggplot(summary.FEV, aes(x = TIME, y = mean, group = DRUG)) +\n  margin_theme() +\n  labs(y = \"Forced Expiratory Volume (1 min)\",\n       x = \"Time Period\")\n\ng + geom_bar(stat = \"identity\", position = \"dodge\", aes(fill = DRUG))"},{"path":"ch7.html","id":"interval-plots-1","chapter":"7 Grid Graphics, Including ggplot2","heading":"7.3.16 Interval Plots","text":"\nggplot2 package allows implementation interval plots.Example 7.11  \\(\\text{}\\)\ninitial demonstration interval plots, continue use barplots Example 7.10. Overlaying errors barplots requires use stat_summary() (Line 1) code . Outcomes meanmse meanpse summary.FEV dataset represent \\(\\bar{x}-SE\\) \\(\\bar{x}+SE\\), respectively. define lower upper values error bars interval plot. called arguments ymin ymax aesthetics geom_errorbar() (Line 5). background color plot changed Line 4. final result shown Fig 7.17.\nFigure 7.17: Error bars overlaid bar plot asthma data.\n\\(\\blacksquare\\)\nExample 7.12  \\(\\text{}\\)\nNext consider overlaying intervals line plot Fig (7.18). code , lines connect points treatment means (Lines 2-3).\nFigure 7.18: Error bars overlaid line plot asthma data.\n\\(\\blacksquare\\)\nExample 7.13  \\(\\text{}\\)\ngeoms can used create interval plots, including ggplot2 function geom_crossbar(). Fig 7.19 show raw data summary standard error crossbars.\nFigure 7.19: Error bars overlaid asthma data using geom_crossbar().\nNote individual data points rather difficult distinguish Fig 7.19. solution plot points using using transparent colors, jitter points respect \\(x\\)-axis (Fig 7.20).\nFigure 7.20: Jitter transparency added points Fig 7.19.\n\\(\\blacksquare\\)","code":"g + stat_summary(fun = \"identity\", geom = \"bar\",\n                 position = position_dodge(width = .9),\n                 aes(colour = DRUG), fill = \"white\") +\n  theme(panel.background = element_rect(fill = gray(0.8))) +\n  geom_errorbar(aes(ymin = meanmse, ymax = meanpse, colour = DRUG),\n                width = 0.2, position = position_dodge(.9))g + geom_point(size = 2, aes(colour = DRUG)) +\n  geom_line(aes(lty = DRUG, colour = DRUG)) +\n  theme_classic() +\n  margin_theme() +\n  geom_errorbar(aes(ymin = meanmse, ymax = meanpse, colour = DRUG), \n                width = 0.2)\ng + geom_crossbar(aes(ymin = meanmse, ymax = meanpse, colour = DRUG,\n                      fill = DRUG), alpha = .2) +\n  geom_point(data = asthma.long, aes(y = FEV1, x = TIME, colour = DRUG))\ng + geom_crossbar(aes(ymin = meanmse, ymax = meanpse, colour = DRUG,\n                      fill = DRUG), alpha = .2) +\n  geom_jitter(data = asthma.long, aes(y = FEV1, x = TIME, colour = DRUG), \n              alpha = .4, width = 0.15) + \n  theme_classic()"},{"path":"ch7.html","id":"pairwise-comparisons-1","chapter":"7 Grid Graphics, Including ggplot2","heading":"7.3.16.1 Pairwise Comparisons","text":"Results statistical pairwise comparisons can overlain ggplot2 rendered boxplots interval plots using number approaches. package ggpubr (Kassambara 2023) generates ggplot2-based ``publication ready plots’’, including interval plots showing pairwise comparisons. Examples given largely follow documentation ggpubr.\nExample 7.14  \\(\\text{}\\)Crampton et al. (1947) measured lengths odontoblasts (cells responsible tooth growth) 60 guinea pigs respect three dosage levels vitamin C (0.5, 1, 2 mg/day), two delivery methods, orange juice (OJ) ascorbic acid (VC). data dataframe ToothGrowth package datasets. ToothGrowth dose contains dosages supp contains delivery levels.code , following important steps:Lines 1-3, bring ggpubr package (Line 1), rename dataframe ToothGrowth df coerce dose column factor.Lines 5-7, use function ggpubr::ggboxplot() define basic plot characteristics.Lines 8-11, nuances added plot including customized axis labels (Lines 8-9), customized legend title (Line 10), alteration axis scale (Line 11).Lines 13-18, annotations pairwise comparisons delivery methods (OJ VC) within dosages added graph using function ggpubr::geom_pwc().Line 14, specify want delivery methods (supp) compared, indicate don’t want lines extending compared levels label lines (comparison, see Fig 7.23).Line 15, indicate type test used delivery method comparisons, labeling format. \"{p.adj.format}{p.adj.signif}\" indicates adjusted p-value significance level adjusted p-value printed.Lines 16-17, specify use Bonferroni correction simultaneous inference three tests, print results non-significant.result shown Fig 7.21.\nFigure 7.21: Boxplot showing pairwise comparison delivery levels dosage Toothgrowth dataframe.\nconsider complex example compares delivery methods (supp) dosage levels (dose). accomplished applying ggpubr::geom_pwc() twice (Lines 3-7 Lines 11-15) printing results (Fig 7.22).\nFigure 7.22: Boxplot showing pairwise comparison delivery levels delivery levels dosage Toothgrowth dataframe.\ncode , create interval plot barplot appearance using ggpubr::ggbarplot() (Fig 7.23. Note requires different approach customizing title legend (Line 7).\nFigure 7.23: Barplot showing pairwise comparison dosage levels delivery methods Toothgrowth dataframe. Bar heights means, errors standard deviations.\n\\(\\blacksquare\\)\nCAUTION!function ggpubr::geom_pwc() can potentially misused, illustrating need clear explanations (understanding) applying statistical algorithms. default test specification geom_pwc() Wilcox test, seldom powerful method comparing shifts location treatments (although strongly resistant violations normality). argument test = t_test (specified Figs 7.21-7.23) runs \\(t\\)-tests isolation pairwise comparison, thus utilize omnibus ANOVA mean squared error, reducing power. Bonferroni \\(p\\)-value adjustment method used Figs 7.21-7.23 also famous low power. Given situation, may prudent use ggpubr::geom_pwc() graphical framework summaries, including \\(p\\)-values can inserted manually. can done function ggpubr::stat_pvalue_manual() whose usage demonstrated .","code":"library(ggpubr)\ndf <- ToothGrowth\ndf$dose <- as.factor(df$dose)\n\nbxp <- ggboxplot(\n  df, x = \"dose\", y = \"len\",\n  color = \"supp\", palette = c(\"#00AFBB\", \"#E7B800\")) +\n  ylab(expression(paste(\"Odontoblast length (\", mu,\"g)\"), sep = \"\")) +\n  xlab(\"Dosage (mg/day)\") +\n  guides(color=guide_legend(\"Delivery:\"))  +\n  scale_y_continuous(expand = expansion(mult = c(0.05, 0.10)))\n\nbxp + geom_pwc(\n  aes(group = supp), tip.length = 0,\n  method = \"t_test\", label = \"{p.adj.format}{p.adj.signif}\",\n  p.adjust.method = \"bonferroni\", p.adjust.by = \"panel\",\n  hide.ns = TRUE\n)# 1. Add p-values of OJ vs VC in each dose group\nbxp.complex <- bxp +\n  geom_pwc(\n    aes(group = supp), tip.length = 0,\n    method = \"t_test\", label = \"p.adj.format\",\n    p.adjust.method = \"bonferroni\", p.adjust.by = \"panel\"\n  )\n# 2. Add pairwise comparisons between dose levels\n# Nudge up the brackets by 20% of the total height\nbxp.complex <- bxp.complex +\n  geom_pwc(\n    method = \"t_test\", label = \"p.adj.format\",\n    p.adjust.method = \"bonferroni\",\n    bracket.nudge.y = 0.2\n  )\n# 3. Display the plot\nbxp.complexbp <- ggbarplot(\n  df, x = \"supp\", y = \"len\", fill = \"dose\",\n  palette = \"npg\", add = \"mean_sd\",\n  position = position_dodge(0.8)) +\n  ylab(expression(paste(\"Odontoblast length (\", mu,\"m)\"), sep = \"\")) +\n  xlab(\"Delivery method\") +\n  scale_fill_discrete(name = \"Dosage:\")\n\nbp +\n  geom_pwc(\n    aes(group = dose), tip.length = 0.05,\n    method = \"t_test\", label = \"p.signif\",\n    bracket.nudge.y = -0.08\n  ) +\n  scale_y_continuous(expand = expansion(mult = c(0, 0.1)))"},{"path":"ch7.html","id":"trellis-plots-with-faceting","chapter":"7 Grid Graphics, Including ggplot2","heading":"7.3.17 Trellis Plots with Faceting","text":"\nLike package lattice, ggplot2 contains functions making trellis plots. use approach examine individual patient responses time asthma dataset.Trellising can enabled using ggplot2 functions facet_wrap() facet_grid(). Fig 7.24 define faceting within facet_grid() using PATIENT column data subset asthma.long.. function ggplot2::vars() facet_grid() analogous use aes() geoms.\nFigure 7.24: trellis plot showing individual patient responses time asthma dataset.\n\n","code":"\n# subset data to allow readable plots\nasthma.long.a <- asthma.long |>\n  filter(PATIENT %in% 201:208)g <- ggplot(asthma.long.a, aes(y = FEV1, x = TIME, colour = DRUG,\n                                group = DRUG)) +\n  geom_point() +\n  geom_line() +\n  theme_light() + margin_theme() +\n  theme(axis.text.y = element_text(size=rel(0.7))) +\n  facet_grid(rows = vars(PATIENT)) +\n  scale_colour_brewer(palette = \"Dark2\") +\n  ylab(\"Forced Expiratory Volume (1 min)\") +\n  xlab(\"Time period\")\ng"},{"path":"ch7.html","id":"multivariate-distributional-summaries","chapter":"7 Grid Graphics, Including ggplot2","heading":"7.3.18 Multivariate Distributional Summaries","text":"Bivariate summaries can shown many ways using ggplot2 approach.\nExample 7.15  \\(\\text{}\\)\nFig 7.25, insert density grobs (graphical objects) margins scatterplot five European countries using cowplot functions axis_canvas(), insert_xaxis_grob(), insert_xaxis_grob(), gg_draw(). right margin shows GDP distributions country, whereas top margin shows CO\\(_2\\) emission distributions country. also change symbol sizes year main graph. Larger symbols indicate recent years.\nFigure 7.25: Bivariate summaries European countries asbio::world.emissions dataset.\n\\(\\blacksquare\\)\n","code":"europe <- world.emissions |>\n  filter(country == c(\"France\", \"Italy\", \"Germany\", \"United Kingdom\")) |>\n  filter(year <= 2019 & year > 1950) # comparable data\n\npmain <- ggplot(europe, aes(x=co2, y=gdp, color= country)) +\n  geom_point(aes(size = year), alpha = .6) +\n  xlab(xlab) + ylab(\"GDP (International dollars)\") +\n  margin_theme() +\n  theme_classic()\n\nxdens <- axis_canvas(pmain, axis = \"x\") +\n  geom_density(data = europe, aes(x = co2, fill = country), alpha=0.6, \n               size=.2)\n\nydens <- axis_canvas(pmain, axis = \"y\") +\n  geom_density(data = europe, aes(y = gdp, fill = country), alpha=0.6, \n               size=.2)\n\np1 <- insert_xaxis_grob(pmain, xdens, grid::unit(.2, \"null\"), \n                        position = \"top\")\np2 <- insert_yaxis_grob(p1, ydens, grid::unit(.2, \"null\"), \n                        position = \"right\")\nggdraw(p2)"},{"path":"ch7.html","id":"maps","chapter":"7 Grid Graphics, Including ggplot2","heading":"7.3.19 Maps","text":"\nggplot2 ecosystem support mapping, including import ARC-GIS shape files, creation map polygons. function sf::st_read() allows loading simple spatial features, including shapefiles, package ggspatial provides number creating useful maps ggplot2 framework.\nExample 7.16  \\(\\text{}\\)\nexample create map small stream network southwest Idaho named Murphy Creek. Data concerning creek, including shapefiles, contained package streamDAG (Aho, Kriloff, et al. 2023).\nfunction ggplot2::geom_sf() (Line 2 ) can used draw different geometric objects depending features present data, e.g., points, lines, polygons. current case line generated. function ggplot2::expand_limits() (Line 6) used increase spatial range \\(y\\)-axis otherwise extremely narrow (since single W E trending line, representing watershed, generated geom_sf()). ggspatial functions annotation_scale() annotation_north_arrow() provide spatially explicit scalebars north-indicating arrows, respectively (Lines 8-9). final product shown Fig 7.26.\nFigure 7.26: Map Murphy Creek drainage system southwest Idaho (outlet coordinates: 43.71839 \\(^\\text{o}\\)N, 116.13747 \\(^\\text{o}\\)W).\n\\(\\blacksquare\\)\n","code":"\nlibrary(sf); library(ggspatial); library(streamDAG)\nmur_sf <- st_read(system.file(\"shape/Murphy_Creek.shp\", \n                              package=\"streamDAG\"))\ndata(mur_coords)\ncoords <- mur_coords[,c(2,3)]Reading layer `Murphy_Creek' from data source \n  `C:\\Users\\ahoken\\AppData\\Local\\R\\win-library\\4.4\\streamDAG\\shape\\Murphy_Creek.shp' \n  using driver `ESRI Shapefile'\nSimple feature collection with 2 features and 2 fields\nGeometry type: LINESTRING\nDimension:     XY\nBounding box:  xmin: 512860 ymin: 4789000 xmax: 514720 ymax: 4789300\nProjected CRS: NAD83 / UTM zone 11Ng <- ggplot(mur_sf) +\n  geom_sf(colour = \"lightblue\", lwd = 2) +\n  theme_classic() +\n  geom_point(data = coords, aes(x = E, y = N), shape = 21,\n             fill = \"orange\", size = 2.5) +\n  expand_limits(y = c(4788562,4789700)) +\n  ylab(\"\") + xlab(\"\") +\n  annotation_scale() +\n  annotation_north_arrow(pad_x = unit(10.5, \"cm\"), pad_y = unit(6.6, \"cm\"))\ng"},{"path":"ch7.html","id":"animation-1","chapter":"7 Grid Graphics, Including ggplot2","heading":"7.3.20 Animation","text":"\nAnimations ggplot2 can created using looping strategies applied Ch 6. Looping explicitly considered context functions Chapter 8.Example 7.17  \\(\\text{}\\)\ninitial demonstration, reconsider asthma data (Fig 7.16). first construct function, asthma.plot() render ggplot. lone argument asthma.plot(), upper, defines upper time limit consideration longitudinal asthma drug study (Line 3). upper argument called geom_line() (Lines 5-6) subset, necessary, underlying data. Vital animation print.ggplot() function (Line 12). Failure include code create empty animation.Next, create function runs asthma.plot() range values upper. function consists loop run lapply() (lines 2-3). final lines code (lines 8-9) allow animation saved using function saveGIF() package animation66.\nanimation result shown Fig 7.27.\nFigure 7.27: Animation demonstration using asthma dataset.\n\\(\\blacksquare\\)Amazing animations can created package gganimate. demonstrated using several examples.\nExample 7.18  \\(\\text{}\\)\nexample create scatterplot animation world emissions dataset. code , steps particularly important animation occur Lines 14-17.Line 14 plot title modified animation progresses, allowing tracking years. code title = 'Year: {frame_time}' gganimate convention extracting corresponding time sequence values (case column world.emission$year) projection.line 16 function gganimate::transition_time() calls frame transitions specific point time column year. Usefully, gganimate sets transition time states transition_time() correspond actual time difference .line 17 ease_aes() used linearly smooth animation (terms coloration geometric positioning features) animation frames. function based analogous functions package tweener.package gapminder contains rational color designations (.e., variations prime colors within continents) 142 countries. Countries without color designation colored gray scale_colour_manual().final result shown Fig 7.28.\nFigure 7.28: Animated scatterplot CO\\(_2\\) levels time countries within continents. Symbol size scaled population size.\n\\(\\blacksquare\\)\nExample 7.19  \\(\\text{}\\)\nnext example uses gganimate animate variation CO\\(_2\\) levels time within continents, using boxplots.final result shown Fig 7.29.\nFigure 7.29: Animated boxplot CO\\(_2\\) levels time countries within continents.\n\\(\\blacksquare\\)Example 7.20  \\(\\text{}\\)\nfinal (rather complex) example, animate non-perennial character Murphy Creek (Fig 7.26) time.prepare making map animation, first bring dataset documents presence/absence surface water \\(=\\{0,1\\}\\) 28 locations (.e., nodes) 1163 time steps, mur_node_pres_abs (Line 1). 27 stream sections bounded 28 nodes defined stream segments. select time designations, even intervals, create data subset 250 time steps (Lines 2-8).code , function sf::st_coordinates() used pull spatial coordinates Murphy Creek shapefile underlying map Fig 7.26.\nalso use several functions streamDAG package, including streamDAGs(), creates graph-theoretic representation Murphy Creek (see Aho, Kriloff, et al. (2023)), thus defines stream flows location location. function streamDAG::STIC.RFimpute() wrapper random forest algorithm missForest::missForest(), allows imputation missing stream presence/absence data dataset mur_node_pres_abs. function arc.pa..nodes() streamDAG creates stream segment surface water presence/absence outcomes based data downstream bounding node segment (approach = \"dstream\"). function vector_segments() streamDAG used create dataframe vs contains arcs designations shapefile coordinates sf.coords, based coordinates object node.coords, function assign_pa_to_segments() adds surface water presence/absence designations vs based outcomes object arc.pa, whew.Using data summaries created steps , can finally create animated ggplot map.final result, Fig 7.30, shows changing patterns surface water presence Murphy Creek network summer 2019.\nFigure 7.30: Paterns drying Murphy Creek, Idaho shown animated map. Blue segments indicate presence surface water. Gray segments indicate missing data.\n\\(\\blacksquare\\)\n","code":"summary.FEV$time <- rep(c(0,11:18), each = 3)\n\nasthma.plot <- function(upper){\n  a <- ggplot() +\n    geom_line(data = summary.FEV[summary.FEV$time > 10 & \n                                   summary.FEV$time <= upper,],\n              aes(x = time, y = mean, colour = DRUG)) +\n    ylim(2.6, 4) +\n    xlim(11, 18) +\n    margin_theme() +\n    labs(y = \"Forced Expiratory Volume (1 min)\",\n         x = \"Time (Hrs)\")\n  print(a)\n}asthma.animate <- function() {\n  lapply(12:18, function(i){\n    asthma.plot(i)\n  })\n}\n\n# run animation\nasthma.animate()\n\n# save frames into one GIF:\nlibrary(animation)\nsaveGIF(asthma.animate(), interval = 1, movie.name=\"asthma.gif\")library(gganimate)\nlibrary(gapminder)\nworld.data.sub <- world.emissions |>\n  filter(continent != \"Redundant\") |>\n  filter(year > 1950)\n\ng <- ggplot(world.data.sub, aes(x = gdp, y = co2, size = population,\n                                colour = country)) +\n  geom_point(alpha = 0.7, show.legend = FALSE) +\n  scale_colour_manual(values = country_colors) +\n  scale_size(range = c(2, 12)) +\n  scale_x_log10() + scale_y_log10() +\n  facet_wrap(~continent) +\n  labs(title = 'Year: {frame_time}', x = 'GDP') +\n  ylab(bquote(CO[2])) +\n  transition_time(as.integer(year)) +\n  ease_aes('linear')\n  margin_theme()\ngg <- ggplot(world.data.sub, aes(x = continent, y = co2,\n                           group = continent)) +\n  geom_boxplot(aes(fill = continent), show.legend = FALSE) +\n  scale_y_log10() +\n  labs(title = 'Year: {frame_time}', x = '',\n       y = \"CO\\U2082\") +\n  theme(axis.text.x = element_text(angle = 50, hjust = 1,\n                                   vjust = 0.9, size = 12)) +\n  transition_time(as.integer(year))\ngdata(mur_node_pres_abs)\nu <- unique(mur_node_pres_abs$Datetime)\nn <- length(u)\nframes <- 250\ntimes.sub <- u[round(seq(1, n, length = frames),0)]\n\nw <- which(mur_node_pres_abs$Datetime %in% times.sub)\nmnpa.sub <- mur_node_pres_abs[w,]mur_graph <- streamDAGs(\"mur_full\")\n# impute missing presence/absence data\nout <- STIC.RFimpute(mnpa.sub[,-1])\nmur.pa.sub <- out$ximp\n# arcs from nodes\narc.pa <- arc.pa.from.nodes(mur_graph, mur.pa.sub, approach = \"dstream\")\n\nnode.coords <- data.frame(mur_coords[,(2:3)])\nrow.names(node.coords) <- mur_coords[,1]\nsf.coords <- st_coordinates(mur_sf)[,-3]\n\nvs <- vector_segments(sf.coords, node.coords, realign = TRUE, \n                      colnames(arc.pa), arc.symbol = \" -> \")\ndatetime <- mnpa.sub$Datetime\nvsn <- assign_pa_to_segments(vs, frames, arc.pa, datetime = datetime)g <- ggplot(mur_sf) +\n  geom_sf(colour = \"gray\", lwd = 1.8) +\n  theme_classic() +\n  geom_line(data = vsn, aes(x = x, y = y, group = arc.label,\n                            colour = as.factor(Presence)),\n              show.legend = FALSE, lwd = 1.5) +\n  scale_colour_manual(values = c(\"orange\",\"lightblue\")) +\n  geom_point(data = node.coords, aes(x = E, y = N), shape = 21,\n             fill = \"white\", size = 1.4) +\n  expand_limits(y = c(4788562,4789700)) +\n  annotation_scale() +\n  labs(title = \"Date: {frame_time}\", x = \"\", y = \"\") +\n  annotation_north_arrow(pad_x = unit(10.5, \"cm\"), \n                         pad_y = unit(6.6, \"cm\")) +\n  transition_time(as.Date(vsn$Time))"},{"path":"ch7.html","id":"exercises-6","chapter":"7 Grid Graphics, Including ggplot2","heading":"Exercises","text":"Complete following data management steps asbio::world.emissions data.\nEliminate redundant rows using continent != 'Redundant' dplyr::filter.\nFilter subset data years 1955-2019.\nFilter subset data 8 countries interest (choice).\nName dataset emissions.sub.\nemissions.sub dataset, plot CO\\(_2\\) emissions function year scatterplot. Save ggplot object (e.g., g).\nComplete following data management steps asbio::world.emissions data.Eliminate redundant rows using continent != 'Redundant' dplyr::filter.Filter subset data years 1955-2019.Filter subset data 8 countries interest (choice).Name dataset emissions.sub.emissions.sub dataset, plot CO\\(_2\\) emissions function year scatterplot. Save ggplot object (e.g., g).Continuing Question 1, overlay linear regression model g using geom_smooth(method = \"lm\").\nExtract fitted model components using g + stat_poly_eq(formula = y ~ x, geom = \"debug\") library gginnards. model slope?\nInterpret meaning shaded envelope around line.\nAnnotate model onto graph using: g + stat_poly_eq() library ggpmisc.\nContinuing Question 1, overlay linear regression model g using geom_smooth(method = \"lm\").Extract fitted model components using g + stat_poly_eq(formula = y ~ x, geom = \"debug\") library gginnards. model slope?Interpret meaning shaded envelope around line.Annotate model onto graph using: g + stat_poly_eq() library ggpmisc.Continuing Question 1, (1) color points g country (use transparency allow viewing points laying atop ), (2) vary point size population size.Continuing Question 1, (1) color points g country (use transparency allow viewing points laying atop ), (2) vary point size population size.Continuing Question 1, add label g identifying US emissions 2005.Continuing Question 1, add label g identifying US emissions 2005.Continuing Question 1, use /add reference lines g (choice relevant \\(x\\) \\(y\\)-axis location).Continuing Question 1, use /add reference lines g (choice relevant \\(x\\) \\(y\\)-axis location).Continuing Question 1, alter \\(y\\)-axis limits g (choice limits).Continuing Question 1, alter \\(y\\)-axis limits g (choice limits).Continuing Question 1, create (1) boxplot, (2) interval plot showing CO\\(_2\\) emissions function country. Interpret meaning hinges, centers, whiskers boxplot interpret “errors” interval plot.Continuing Question 1, create (1) boxplot, (2) interval plot showing CO\\(_2\\) emissions function country. Interpret meaning hinges, centers, whiskers boxplot interpret “errors” interval plot.(Advanced) dataframe npk package datasets, use functions package ggpubr overlay results pairwise comparisons population means interval plots. Specifically:\nUse ggbarplot() make barplot showing mean Yields standard errors function nitrogen N phosphate P. Vary bar colors using P. Create appropriate axis legend labels.\nOverlay pairwise comparisons N P levels barplot using function geom_pwc(). Specify method = t_test since multiple tests N occur within levels P.\n(Advanced) dataframe npk package datasets, use functions package ggpubr overlay results pairwise comparisons population means interval plots. Specifically:Use ggbarplot() make barplot showing mean Yields standard errors function nitrogen N phosphate P. Vary bar colors using P. Create appropriate axis legend labels.Overlay pairwise comparisons N P levels barplot using function geom_pwc(). Specify method = t_test since multiple tests N occur within levels P.asbio::goats dataframe, use ggplot approaches \\(\\dots\\)\nMake plots distribution NO3 using two following functions: geom_area(), geom_freq(), geom_dotplot(), geom_density().\nCreate scatterplot NO3 function feces, Change symbol sizes reflect values organic.matter.\nPlot NO3 organic.matter simultaneous functions feces adding second y-axis.\nasbio::goats dataframe, use ggplot approaches \\(\\dots\\)Make plots distribution NO3 using two following functions: geom_area(), geom_freq(), geom_dotplot(), geom_density().Create scatterplot NO3 function feces, Change symbol sizes reflect values organic.matter.Plot NO3 organic.matter simultaneous functions feces adding second y-axis.Using gganimate, asbio::asthma dataframe, track subject FEV1 levels time geom_point(). Use faceting distinguish drug levels.Using gganimate, asbio::asthma dataframe, track subject FEV1 levels time geom_point(). Use faceting distinguish drug levels.","code":""},{"path":"ch8.html","id":"ch8","chapter":"8 Functions","heading":"8 Functions","text":"“computer tell , may much different mind.”- Joseph Weizenbaum, Important early software developer AI ethisist","code":""},{"path":"ch8.html","id":"intro2functions","chapter":"8 Functions","heading":"8.1 Introduction to Functions","text":"computer programming, function set instructions performing specific task, providing specific output. Essentially processes R run via functions. example, command: x <- 2, assigns label x numeric value 2. actually accomplished, however, via function `<-`. , one rewrite expression x <- 2 :Similarly, summations evaluated underlying function `+`.Function call translations, example, 2 + 2 `+`(2, 2), made silently R-interpreter67, makes unnecessary compile R code executable files (see Ch 9).\n\n","code":"\n`<-`(x, 2)\nx[1] 2\n`+`(2, 2)[1] 4"},{"path":"ch8.html","id":"function-and-function-base-types","chapter":"8 Functions","heading":"8.1.1 function() and Function Base Types","text":"Generally speaking, R function –risk sounding repetitive– function defined function function() 🙂. Arguments R functions contained set parentheses call function() . function contents follow, generally delineated curly brackets. Thus, form:function.name <- function(arg.1, arg.2,...., arg.n){function contents}\nRecall Chapter 2 three R base types specific functions: closure, special, builtin. Functions base types special builtin constrained base package, include primitive functions built R system, implemented C. Types builtin special can distinguished functions evaluate arguments, respectively (R Core Team 2024b).Example 8.1  summarization continued chunk . Line 1, function split() used split data prim.objs distinguishing base type categories using typeof(get()) within sapply() (Lines 2 3). Numbers items groups tabulated using sapply() (Line 5). currently 168 builtin 42 special primitive functions R.first 20 special primitive functions:first 20 builtin primitive functions:Clearly, primitive functions base type special builtin include conventional operators (bounding accent grave characters). example, `$` base type special,`+` base type builtin.\\(\\blacksquare\\)Primitive functions generally make calls function .Primitive(), identifies underlying C routine used evaluating outer function. example, see `+`, codified R, calls C routine identified \"+\".\n","code":"base.objs <- objects(\"package:base\", all = TRUE)\nprim.objs <- base.objs[sapply(base.objs, function(x) is.primitive(get(x)))]base.types <- split(prim.objs, \n                    sapply(prim.objs, \n                           function(x) typeof(get(x))))\n\nsapply(base.types, length)builtin special \n    166      42 \nbase.types$special[1:20] [1] \"$\"         \"$<-\"       \"&&\"        \".Internal\" \"::\"       \n [6] \":::\"       \"@\"         \"@<-\"       \"[\"         \"[[\"       \n[11] \"[[<-\"      \"[<-\"       \"{\"         \"||\"        \"~\"        \n[16] \"<-\"        \"<<-\"       \"=\"         \"break\"     \"call\"     \nbase.types$builtin[1:20] [1] \"-\"                  \"!\"                  \"!=\"                \n [4] \"%%\"                 \"%*%\"                \"%/%\"               \n [7] \"&\"                  \"(\"                  \"*\"                 \n[10] \"...elt\"             \"...length\"          \"...names\"          \n[13] \".C\"                 \".cache_class\"       \".Call\"             \n[16] \".Call.graphics\"     \".class2\"            \".External\"         \n[19] \".External.graphics\" \".External2\"        \ntypeof(`$`)[1] \"special\"\ntypeof(`+`)[1] \"builtin\"\n`+`function (e1, e2)  .Primitive(\"+\")"},{"path":"ch8.html","id":"base-type-closure","chapter":"8 Functions","heading":"8.1.2 Base Type closure","text":"\nPrimitive functions (types special builtin) created users outside R development core team. Thus, base type closure represents kind function R-users can actually create easily modify. name “closure” refers programming style underlying functions, assigned particular environment local internal objects (see Section 5.4 Chambers (2008)). Consider simple homemade function square.().Functions base type closure three components.formal arguments constitute arguments control function. formals can accessed via function formals(). instance,formals function pairlist base type.\nbody constitutes actual function code. function body() returns body function unevaluated expression.environment base type defines data structure function requires computations. environment required R functions, whether builtin, special, closure. object assignment (including naming function) occurs “top level” R session (e.g., outside body function), environment global environment. global environment maintained throughout session can saved across sessions using, instance, function save.image() (Section 2.7.2). Environments functions can checked, created, changed using function environment().\nenvironment square.() global environment.environment session .contrast, environment function mean() base package.Functions base, including mean(), accessible, base package namespace loaded automatically (along R distribution packages) upon opening R.Example 8.2  \\(\\text{}\\)\nbiological example, create function calculating predicted sizes biological populations geometric growth. geometric growth equation (Eq. (8.1)) often used represent population growth species unlimited resources non-overlapping generations:\\[\\begin{equation}\nf(t) = N_0\\lambda^t,\n\\tag{8.1}\n\\end{equation}\\]: \\(N_0 =\\) initial number individuals, \\(\\lambda =\\) geometric rate increase, \\(t\\) = number time intervals generations. :Note function three arguments: N.0, lambda, t.function-user must specify . first line code function body solves \\(N_0\\lambda^t\\). Importantly, second (last) line body code specifies object actually want returned, Nt. Without “return value” nothing returned function. one requires multiple return objects, one can place single suitable container like list.increase clarity, one place first curly bracket line arguments, place last curly bracket line. Readability can also improved use tabs spaces. Note indented lines containing related operations. distinguishes lines first (argument) line end (return) line. Note also spaces placed commas, operators, including assignment operator. also good general practice code writing68.run function different values N.0, lambda, t.\\(\\blacksquare\\)","code":"\nsquare.me <- function(x){\n  x^2\n}\n\nsquare.me(4)[1] 16\ntypeof(square.me)[1] \"closure\"\nformals(square.me)$x\ntypeof(formals(square.me))[1] \"pairlist\"\nbody(square.me){\n    x^2\n}\nenvironment(square.me)<environment: R_GlobalEnv>\nenvironment()<environment: R_GlobalEnv>\nenvironment(mean)<environment: namespace:base>\nisNamespaceLoaded(\"base\")[1] TRUE\nGeo.growth <- function(N.0, lambda, t){\n  Nt <- N.0 * lambda^t\n  Nt\n}\nGeo.growth(N.0 = 100, lambda = 1.2, t = 20)[1] 3833.8\nGeo.growth(N.0 = 30, lambda = 0.2, t = 3)[1] 0.24\nGeo.growth(N.0 = 30, lambda = 1, t = 3)[1] 30"},{"path":"ch8.html","id":"global-vs.-local-variables","chapter":"8 Functions","heading":"8.2 Global vs. Local Variables","text":"noted Ch 1, objects R lexically scoped, allowing distinctions global local variables. Global variables objects exist within global environment consequently broadly accessible, whereas local variables accessible particular settings. Objects defined within function, including arguments, (generally) local function, thus accessible within body function.see object N.t, defined last line Geo.growth(), local function, since detected global environment69.Global variables can assigned functions using super-assignment operator, <<-, although found need operator rare (see Section 11.2.1).\nExample 8.3  \\(\\text{}\\)\napply family functions data management, including apply(), tapply(), sapply() lapply() (Section 4.1.1) allow inclusion user-defined functions (see Example 8.1 earlier chapter). function stan() centers scales (standardizes) outcomes. , element dataset subtracted mean, divided standard deviation). can call stan() within apply(), using latter function’s third (FUN) argument.consequence transformation, columns object mean (zero), variance (one)\\(\\blacksquare\\)Example 8.4  \\(\\text{}\\)\nfunction called stats() simultaneously calculate large number distinct summary statistics.Note function contains two arguments (Line one): call numeric data vector, x, number significant digits used printing output. digits given default value (digits = 5), first argument needs specified user. first line code body function (Line 2) indicates package asbio required function (package contains functions asbio::skew() asbio::kurt() calculating data skew kurtosis, respectively.\nLines 3-8 dataframe created called ds. dataframe one\ncolumn called statistics, contain numeric entries eleven statistical summaries x. summaries rounded number digits specified digits.\nLines 7-8 define row names ds. names statistics calculated function. last line code body (Line 9) prints ds.can readily apply stats() directly single numeric column.apply function multiple columns, instance, calling stats() within apply(). instance:\\(\\blacksquare\\)","code":"\nNtError: object 'Nt' not found\nGeo.growth <- function(N.0, lambda,t){\n  Nt <<- N.0 * lambda^t\n  Nt\n}\n\ng <- Geo.growth(N.0 = 30, lambda = 1, t = 3)\nNt[1] 30\nstan <- function(x){\n  (x - mean(x))/sd(x)\n}\n\nout <- apply(Loblolly[,1:2], 2, stan)\napply(out, 2, mean) # zero with rounding error    height        age \n1.6687e-16 1.8508e-17 \napply(out, 2, var)height    age \n     1      1 stats <- function(x, digits = 5){\n  require(asbio)\n  ds <- data.frame(statistics = round(c(length(x), min(x), max(x),\n                                        mean(x), median(x), sd(x), var(x),\n                                        IQR(x), sd(x)/sqrt(length(x)),\n                                        kurt(x), skew(x)), digits))\n  rownames(ds) <- c(\"n\", \"min\", \"max\", \"mean\", \"median\", \"sd\",\n                    \"var\", \"IQR\", \"SE\", \"kurtosis\", \"skew\")\n  ds\n}\nstats(Loblolly[,1])         statistics\nn          84.00000\nmin         3.46000\nmax        64.10000\nmean       32.36440\nmedian     34.00000\nsd         20.67360\nvar       427.39793\nIQR        40.89500\nSE          2.25568\nkurtosis   -1.47347\nskew       -0.06434\napply(Loblolly[,c(1:2)],2,stats)$height\n         statistics\nn          84.00000\nmin         3.46000\nmax        64.10000\nmean       32.36440\nmedian     34.00000\nsd         20.67360\nvar       427.39793\nIQR        40.89500\nSE          2.25568\nkurtosis   -1.47347\nskew       -0.06434\n\n$age\n         statistics\nn          84.00000\nmin         3.00000\nmax        25.00000\nmean       13.00000\nmedian     12.50000\nsd          7.89998\nvar        62.40964\nIQR        15.00000\nSE          0.86196\nkurtosis   -1.37375\nskew        0.18925"},{"path":"ch8.html","id":"useful-functions-for-writing-functions","chapter":"8 Functions","heading":"8.3 Useful Functions for Writing Functions","text":"","code":""},{"path":"ch8.html","id":"swtch","chapter":"8 Functions","heading":"8.3.1 switch()","text":"useful tool function writing switch(). evaluates switches among user-designated alternatives can defined function argument.Example 8.5  \\(\\text{}\\)\nfunction switches five different estimators location (.e., estimators typical central value sample). sample mean, trimmed mean (using 10% trimming), geometric mean, median, Huber’s \\(M\\)-estimator. See Chapter 4 Aho (2014) details concerning estimators.\nImportant function pairing estimator argument overall function (Line 1) call estimator first argument switch (Line 3). final component switch address contingency location estimator specified codified function. done using stop() function appropriate message (Line 9).\\(\\blacksquare\\)\n","code":"location <- function(x, estimator){\n  require(asbio)\n  switch(estimator,\n    mean = mean(x), # arithmetic mean\n    trim = mean(x, trim = 0.1), # trimmed mean\n    geo = exp(mean(log(x))), # geometric mean (use for means of rates)\n    med = median(x), # median\n    huber = huber.mu(x), # Huber M-estimator\n    stop(\"Estimator not included\"))\n}\nlocation(Loblolly[,2], \"geo\")[1] 10.198\nlocation(Loblolly[,2], \"trim\")[1] 12.765"},{"path":"ch8.html","id":"match.arg","chapter":"8 Functions","heading":"8.3.2 match.arg()","text":"possible specify partial matching argument designations using function match.arg().Example 8.6  \\(\\text{}\\)\ninstance, knew (wanted specify) first couple letters location estimator options previous function, location()?\nspecify step like following.\nincorporated location() Lines 3-4 . Note also change first argument switch estimator (Line 5), may incomplete spelling location estimator name, method, contain complete index names index.Now something like:\\(\\blacksquare\\)\n","code":"\nindices <- c(\"mean\", \"trim\", \"geo\", \"median\", \"huber\")\nmethod <- match.arg(estimator, indices)location <- function(x, estimator){\n  require(asbio)\n  indices <- c(\"mean\", \"trim\", \"geo\", \"median\", \"huber\")\n  method <- match.arg(estimator, indices)\n  switch(method,\n    mean = mean(x), # arithmetic mean\n    trim = mean(x, trim = 0.1), # trimmed mean\n    geo = exp(mean(log(x))), # geometric mean (use for means of rates)\n    med = median(x), # median\n    huber = huber.mu(x), # Huber M-estimator\n    stop(\"Estimator not included\"))\n}\nlocation(Loblolly[,2],\"t\")[1] 12.765\nlocation(Loblolly[,2],\"h\")[1] 13"},{"path":"ch8.html","id":"section","chapter":"8 Functions","heading":"8.3.3 ...","text":"triple dot (...) operator70 allows customization existing functions within another function. Thus, useful writing wrapper functions (functions whose chief purpose customization embedded function).Example 8.7  \\(\\text{}\\)\nImagine wished create wrapper function plot() allowed simultaneous computation customized plotting simple linear regression model. something like:first two formal arguments x y line Line 1, establish plotting coordinates points, define outcomes explanatory response variables, respectively. third argument triple dot operator (Line 1). first line body function (Line 2) create general linear regression model using function lm(). Line 3 creates plot , importantly, calls triple dot operator arguments plot.reg(). allows specification possible plot() arguments, arguments within plot.reg(). instance, usage plot.reg() , specify x y axis labels, plotting character type, symbols colors (Fig 8.1). last line code (Line 4) plots regression line.\nFigure 8.1: Representation loblolly pine tree height function age. Regression fit overlaid. Seed types distinguished colors.\n\\(\\blacksquare\\)\n","code":"plot.reg <- function(x, y, ...){\n  reg <- lm(y ~ x)\n  plot(x, y, ...)\n  abline(reg)\n}\nwith(Loblolly, plot.reg(age, height, pch = 19, col = as.numeric(Seed),\n         ylab = \"Height (ft)\", xlab = \"Age (yrs)\"))"},{"path":"ch8.html","id":"invisible","chapter":"8 Functions","heading":"8.3.4 invisible()","text":"invisible() function can useful one wishes results computed saved necessarily printed.Example 8.8  \\(\\text{}\\)\nAssume want retain plot.reg() plotting function, wish potential access actual statistical summaries regression model. rewrite plot.reg() :Note added argument, plot (Line 1), control whether plot created via (plot) (Line 3). suppressing plotting get graphics (text) output:However, assign name function’s output, print assigned object, get summary output regression model:\\(\\blacksquare\\)","code":"plot.reg <- function(x, y, plot = TRUE, ...){\n  reg <- lm(y ~ x)\n  if(plot){ plot(x, y, ...)\n  abline(coef(reg))}\n  invisible(summary(reg))\n}\nwith(Loblolly, plot.reg(age, height, plot = FALSE))\nlob.model <- with(Loblolly, plot.reg(age, height, plot = FALSE))\nlob.model\nCall:\nlm(formula = y ~ x)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-7.021 -2.167 -0.439  2.054  6.855 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  -1.3124     0.6218   -2.11    0.038 *  \nx             2.5905     0.0409   63.27   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.95 on 82 degrees of freedom\nMultiple R-squared:  0.98,  Adjusted R-squared:  0.98 \nF-statistic: 4e+03 on 1 and 82 DF,  p-value: <2e-16"},{"path":"ch8.html","id":"loops","chapter":"8 Functions","heading":"8.4 Loops","text":"Loop functions exist form virtually programming languages. “loop” R initiated using function (). construct requires specification three entities\nindex variable, e.g., ,\nstatement \nsequence index variable refers loop commences.Code defining loop follows, generally delineated curly brackets. parallel function writing good style place first curly bracket line call , place last curly bracket line. Thus, basic loop format:\nloop, values index used directly indirectly specify \\(\\)th element something (e.g., matrix column, vector entry, etc.) loop sequence commences. replacement/definition process takes place “loop contents.” instance,","code":"for(i in seq){\n  loop contents\n}\nfor(i in 1:3){\n  print(i)\n}[1] 1\n[1] 2\n[1] 3"},{"path":"ch8.html","id":"extending-scalar-arguments","chapter":"8 Functions","heading":"8.4.1 Extending Scalar Arguments","text":"One application loop make functions scalar input arguments amenable multi-element vector, matrix dataframe inputs.Example 8.9  \\(\\text{}\\)\nlibrary created, plant.ecol, lives Github. can access code:package devtools facilities building R packages source code, contains functions, e.g., install_github(), downloading packages unconventional repositories71. function plant.ecol::radiation.heatl() calculates annual incident solar radiation (MJ cm\\(^{-2}\\) yr\\(^{-1}\\)) heatload, northern hemisphere thermal index acknowledges highest levels heat loading occur southwest facing slopes north equator. function requires three arguments location interest: slope, aspect, north latitude, measured degrees.\nfunction designed accommodate scalar inputs (single values slope, aspect lat). create loop allow calculation multiple values matrix. instance, potential values five sites.first create storage containers radiation heatload results.potential loop problem.function forced loop around letting = 1 first loop, = 2, second loop, = 5 final loop. results.\\(\\blacksquare\\)\n","code":"\nlibrary(devtools)\ninstall_github(\"moondog1969/plant.ecol\")\nlibrary(plant.ecol)\nformals(radiation.heatl)$slope\n\n\n$aspect\n\n\n$lat\nenvdata <- data.frame(slope = c(10, 12, 15, 20, 3),\n                aspect = c(148, 110, 0, 30, 130),\n                latitude = c(40, 50, 20, 25, 45))\nrad.out <- 1:nrow(envdata) -> hl.outfor(i in 1:length(rad.out)){\n  temp <- with(envdata, radiation.heatl(slope[i],\n                                         aspect[i],\n                                         latitude[i]))\n  rad.out[i] <- temp$radiation\n  hl.out[i] <- temp$heat.load\n}\ncbind(rad.out, hl.out)     rad.out  hl.out\n[1,] 0.99766 0.94551\n[2,] 0.85008 0.77345\n[3,] 0.93030 0.96684\n[4,] 0.85604 0.83957\n[5,] 0.91852 0.90011"},{"path":"ch8.html","id":"building-on-a-previous-result","chapter":"8 Functions","heading":"8.4.2 Building on a Previous Result","text":"Another application loop iteratively build results previous step(s) loop.Example 8.10  \\(\\text{}\\)\nConsider following function counts number even entries vector integers.Recall Ch 2 %% modulus operator R. , finds remainder division. definition remainder even integer divided two zero. loop iteration function adds one numeric object res current integer loop even (remainder zero divided two).\\(\\blacksquare\\)","code":"evencount <- function(x){\n  res <- 0\n  for(i in 1 : length(x)){\n    if(x[i] %% 2 == 0) res <- res + 1\n    }\n  res\n}\nevencount(1:3)[1] 1\nevencount(c(1,2,3,4,10))[1] 3"},{"path":"ch8.html","id":"summarizing-categorical-variables","chapter":"8 Functions","heading":"8.4.3 Summarizing Categorical Variables","text":"third loop application summarization data respect levels categorical variable.Example 8.11  \\(\\text{}\\)\nexample create statistical summaries height age Seed type Loblolly dataset, using stats function created earlier. first create empty list hold result:Loblolly$Seed. specified : (levels(Loblolly$Seed)). Note Line 2, first two columns Loblolly dataset subset levels Seed. results seed type 305.\\(\\blacksquare\\)","code":"\nresult <- list()for(i in levels(Loblolly$Seed)){\n    temp <- Loblolly[,1:2][Loblolly$Seed ==i,]\n    result[[i]] <- as.data.frame(apply(temp, 2, stats))\n    names(result[[i]]) <- c(\"Age\",\"Height\")\n}\nresult$'305' # \"name\" of one of the 14 Loblolly seed types              Age   Height\nn          6.0000  6.00000\nmin        4.7900  3.00000\nmax       64.1000 25.00000\nmean      35.1150 13.00000\nmedian    37.3050 12.50000\nsd        23.9271  8.60233\nvar      572.5056 74.00000\nIQR       36.8850 12.50000\nSE         9.7682  3.51188\nkurtosis  -1.8479 -1.47809\nskew      -0.1613  0.25449"},{"path":"ch8.html","id":"looping-without-for","chapter":"8 Functions","heading":"8.4.4 Looping Without for()","text":"Looping R also possible using general styles Algol-like72 languages (e.g., C, C++, Pascal, Fortran). accomplished constructs (), repeat, break.\nExample 8.12  \\(\\text{}\\)\nConsider example 2 added base number updated number becomes greater equal 10: :, explicitly track loop, use:, simplyHere took values 1, 3, 5, 7, 9, 11 loop commenced (information accumulated object ). equaled 11, condition continuation loop failed loop halted.CAUTION!care exercised () repeat since infinite loops result impossible breaks specified.\\(\\blacksquare\\)","code":"\ni <- 1\nwhile (i < 10) i <- i + 2\ni[1] 11\ni <- 1; out <- i\n\nwhile(TRUE){\n    j <- i + 2\n    out <- paste(out, j, sep = \",\")\n    i <- j\n    if (i > 9) break\n}\n\nout[1] \"1,3,5,7,9,11\"\ni <- 1; out <- i\n\nrepeat{\n    j <- i + 2\n    out <- paste(out, j, sep = \",\")\n    i <- j\n    if (i > 9) break\n}\n\nout[1] \"1,3,5,7,9,11\""},{"path":"ch8.html","id":"final-looping-considerations","chapter":"8 Functions","heading":"8.4.5 Final Looping Considerations","text":"Despite potential usefulness, loops can run slowly R interpreted language (see Ch 9). Loops can often avoided altogether. example, one rewrite earlier evencount() function :\nincreases efficiency, documented function system.time():Loops can often run efficiently using apply() family functions (see animation examples using lapply() Chs 6 7).\nloops necessary, speed issue, use alternative approaches (e.g., lapply()) awkward suboptimal, one can call compiled C, C++, Fortran script within R run loop. topic addressed Ch. 9.","code":"\nevencounti <- function(x){\n  out <- ifelse(x %% 2 == 0, 1, 0)\n  sum(out)\n}\n# even outcomes from a random Poisson process\nevencounti(rpois(1000, 2))[1] 503\nsystem.time(evencount(1:1000000))   user  system elapsed \n   0.19    0.00    0.21 \nsystem.time(evencounti(1:1000000))   user  system elapsed \n   0.07    0.00    0.06 "},{"path":"ch8.html","id":"FunctionalProgramming","chapter":"8 Functions","heading":"8.5 Functional Programming","text":"\nfunctional programming one uses declarative programming style applies “pure” (often argument-less) functions73. Binary infix operations require exactly two operands, provide excellent examples functional programming. primitive functions `+`, `-`, `*` (Section 8.1) binary operator functions. two operands supplied, functions still work pairs. Thus,equivalent toOne can create personalized operator functions using syntax: `% operator name %` \"% operator name %\".Example 8.14  \\(\\text{}\\)\nmight useful operator-style function computing cumulative sums individual numbers (although cumsum() already numerical complex objects). call new operator %+%.make operator work two numbers, second operand must multi-element numeric object.\\(\\blacksquare\\)Useful R functions functional programming include Reduce(), Filter(), Find(), Map(), Negate(), Position().\nExample 8.15  \\(\\text{}\\)\napplied example, recall Section 4.2.8 %% operator can used indicate match () left operand. clarify, however, one might specify %%. operations !%% %!%, example, work. code creates %!% operator using function Negate().apply `%!%` subset bacterial phylum names.\\(\\blacksquare\\)\n","code":"\n`+`(1,`+`(2,3))[1] 6\n1 + 2 + 3[1] 6\n`%+%` <- function(a,b){c(a, a + cumsum(b))}\n\n2.1 %+% 7.4[1] 2.1 9.5\n2.1 %+% c(2.6, 1.5)[1] 2.1 4.7 6.2\n`%!in%` <- Negate(`%in%`)\nbig <- c(\"Abawacabacteria\", \"Absconditabacteria\", \"Acidobacteriota\", \n         \"Actinomycetota\", \"Aminicenantes\", \"Atribacterota\", \n         \"Aquificota\", \"Azambacteria\")\nsmall <- c(\"Acidobacteriota\", \"Actinomycetota\")\n\nw <- which(big %!in% small) \nbig[w][1] \"Abawacabacteria\"    \"Absconditabacteria\" \"Aminicenantes\"     \n[4] \"Atribacterota\"      \"Aquificota\"         \"Azambacteria\"      "},{"path":"ch8.html","id":"functions-with-classes-and-methods","chapter":"8 Functions","heading":"8.6 Functions with Classes and Methods","text":"R object classes can particular methods plotting, printing, summarization. Following relatively simple series steps, methods can implemented using generic function names, .e., plot(), print(), summary(). example, function lm() creates objects class lm.specific summary, print, plot methods object class lm. Code methods can viewed typing stats:::summary.lm, stats:::print.lm, stats:::plot.lm, respectively. stats:::print.lm called automatically print object class lm. instance,, simply,20 500 functions workstation can called print, depending class object printed.Importantly, limited pre-existing object classes R (e.g., lm, numeric, factor, etc.). Instead, can create user-defined classes function output. classes can also methods plotting, printing, summarization.","code":"\nmodel <- lm(height ~ age, data = Loblolly)\nclass(model)[1] \"lm\"\nprint(model)\nCall:\nlm(formula = height ~ age, data = Loblolly)\n\nCoefficients:\n(Intercept)          age  \n      -1.31         2.59  \nmodel\nCall:\nlm(formula = height ~ age, data = Loblolly)\n\nCoefficients:\n(Intercept)          age  \n      -1.31         2.59  \nmethods(print)[1:20] [1] \"print,ANY-method\"            \"print,diagonalMatrix-method\"\n [3] \"print,modelMatrix-method\"    \"print,sparseMatrix-method\"  \n [5] \"print.aareg\"                 \"print.abbrev\"               \n [7] \"print.abuocc\"                \"print.acf\"                  \n [9] \"print.activeConcordance\"     \"print.addtest\"              \n[11] \"print.AES\"                   \"print.agnes\"                \n[13] \"print.all_vars\"              \"print.allPerms\"             \n[15] \"print.anosim\"                \"print.anova\"                \n[17] \"print.Anova\"                 \"print.anova.gam\"            \n[19] \"print.anova.lme\"             \"print.anova.loglm\"          "},{"path":"ch8.html","id":"s3-and-s4","chapter":"8 Functions","heading":"8.6.1 S3 and S4","text":"R two-main approaches developing OOP classes: S3, S474 75 Wickham (2019) notes:“S3 allows functions return rich results user-friendly display programmer-friendly internals”“S4 rigorous system forces think carefully program design. ’s particularly well-suited building large systems evolve time receive contributions many programmers.”S3 methods tend easier develop S4 methods, approach recommended applications R. amenability S4 interfacing multiple programmers explains approach required contribution highly collaborative Bioconductor project. S4 OOP classes associated methods implemented via R-distribution package methods. focus S3 methods , briefly consider S4 methods.\n","code":""},{"path":"ch8.html","id":"s3","chapter":"8 Functions","heading":"8.6.1.1 S3","text":"S3 classes created using function class().Note object ISU class attribute \"univ\". sloop package contains functions help distinguish OOP class frameworks. function sloop::otype() can used determine object S3, S4, RC, R6.\nobject ISU S3.S3 (S4 object) fairly useless without associated methods. simple print method object class univ, .e., list components: name, founded, n.students.dramatically changes way object ISU printed.Functions useful creating print methods include cat() (used ) structure(). function cat() concatenates text single character vector, prints results. simple example, code bind string ``iteration = '', random integer generated Poisson distribution rpois(1, 10), apply double line break .function structure() allows one assign attribute set data.\ncan identify methods specific class using function sloop::ftype.Example 8.16  \\(\\text{}\\)\ncomplex example output object function S3 class. function asbio::pairw.anova used adjusting \\(p\\)-values resulting multiple pairwise comparisons following omnibus ANOVA (ANalysis VAriance). Objects generated function class pairw S3.Objects class pairw print plot methods.correct S3 method generic function call, e.g., print(), identified using process called method dispatch. Method dispatch steps R identifiable using function sloop::s3_dispatch. process identifying correct printing method object class pairw.actual print method’s output:method used objects asbio whose output class pairw. include objects functions providing pairwise comparisons factor levels following: omnibus Friedman’s test76, pairw.fried(), omnibus Welch’s test77, pairw.oneway().\\(\\blacksquare\\)\nViewing code S3 methods functions may require use double colon operator, e.g., asbio::plotpairw, triple colon operator, :::.Example 8.17  \\(\\text{}\\)\nextended exercise fashion advanced function, S3 class create associated methods, using number approaches discussed far chapter.ecological studies, \\(\\alpha\\)-diversity measures level species evenness richness within individual plots dataset. widely used alpha diversity indices Simpson’s index, \\(D_1\\), Shannon-Weiner index, \\(H'\\).\\[\\begin{equation}\nD_1 = 1 - \\sum_{=1}^S p_i^2\n\\tag{8.2}\n\\end{equation}\\]\\[\\begin{equation}\nH' = -\\sum_{=1}^S p_i  \\ln p_i\n\\tag{8.3}\n\\end{equation}\\]\\(S\\) denotes number species, \\(p_i\\) proportional abundance \\(\\)th species, \\(= 1,2,\\ldots,S\\).features want advanced \\(\\alpha\\)-diversity function :Arguments specifying (1) dataset analysis, (2) type \\(\\alpha\\)-diversity want calculated. , two arguments.function capable handing summaries communities single site, whose data single numeric vector, dataframes describing abundances taxa multiple sites.Assignment correct names sites () results.Partial matching diversity method names using arg.match.S3 class.Invisible components, appropriate class print plot methods.breakdown important components function alpha.div() .arguments (Line 1), x assumed either 1) dataframe taxa abundances sites, sites rows (identified row names) taxa columns, 2) numeric vector containing abundances distinct taxa single site.first lines code function body (Lines 2-4), function attempts obtain site names x. x dataframe, done using rn <- rownames(x). x vector describing single site, distinguishing site names probably important, hence code rn = noquote(\"\").alpha.div() function contains three sub-functions: prop() (Lines 11-16), allows computation \\(p_i\\), used create object p., simp() (Lines 20-25), calculates Simpson’s diversities, shan() (Lines 27-32), calculates Shannon-Weiner diversities. latter function contains exception handling steps taxa abundances zero undefined Eq (8.3). instance, p.[p.> 0] Line 28, x[x != 0] Line 30.Partial matching diversity method names (.e., \"simpson\" \"shannon\") facilitated function match.arg().Switching diversity methods done via switch() (Lines 34-36).function output list named , contain four objects: proportional abundances taxa, rownames x (.e, site names), diversity method used, actual calculated diversities (Line 38).last line body code, assigned user-defined class a_div made invisible.apply function dataset varespec library vegan.Printing output object v.div results rather messy rendering list, prompting creation a_div print method. print.a_div() function succinctly effectively summarize results alpha.div allowing access additional (invisible) information.function printing can relatively simple.required argument, x print.a_div (Line 1), object class a_div, created function alpha.div(), e.g., object v.div. Recall list containing multiple objects.object x$method used create tidy text summary diversity method used (Lines 2-3). string combined another string printed line break :\ncat(method, \" diversity:\", \"\\n\", sep = \"\")}` (Line 4).actual diversities printed help function structure() Lines 5-6.Output alpha.div() can also used plotting. plot function objects class a_div.plot method allows creation two distinct types ggplots calling distinct sub-functions, ptype1() ptype2() via argument plot.RAC (Line one).Barplots site diversities produced using default plot.RAC = FALSE run function ptype2() Lines 21-31 (Fig 8.2)Rank abundance curves (RACs) created specifying plot.RAC = TRUE runs function ptype1() Lines 10-19 (Fig 8.3). RAC plots allow graphical expressions taxa richness evenness, may even provide insights regarding resource exploitation community (Magurran 1988).\nFigure 8.2: Barplot site diversities vegan::varespec data. Note bar colors varied using diversities , .e., fill = div.\n\nFigure 8.3: Rank abundance curves vegan::varespec dataset. Line lengths indicate species richness. Larger negative slopes indicate less species evenness.\n\\(\\blacksquare\\)\n","code":"\nISU <- list(name = \"Idaho State University\", n.students = 12000,  \n            founded = 1905)\nclass(ISU) <- \"univ\"\nISU$name\n[1] \"Idaho State University\"\n\n$n.students\n[1] 12000\n\n$founded\n[1] 1905\n\nattr(,\"class\")\n[1] \"univ\"\nlibrary(sloop)\notype(ISU)[1] \"S3\"\nprint.univ <- function(x){\n  cat(x$name, \" was founded in \", x$founded, \",\\nand has an enrollment of \",\n      x$n.students, \" students.\", sep = \"\")\n}\nISUIdaho State University was founded in 1905,\nand has an enrollment of 12000 students.\ncat(\"iteration = \", rpois(1, 10), \"\\n\\n\", sep = \"\")iteration = 6\nstructure(.Data = 1:6, dim = 2:3)     [,1] [,2] [,3]\n[1,]    1    3    5\n[2,]    2    4    6\nstructure(.Data = 1:6, names = LETTERS[1:6])A B C D E F \n1 2 3 4 5 6 \nftype(print.univ)[1] \"S3\"     \"method\"\neggs <- c(11,17,16,14,15,12,10,15,19,11,23,20,18,17,27,33,22,26,28)\ntrt <- factor(rep(1:4, c(5,5,4,5)))\n\ntukey <- pairw.anova(y = eggs, x = trt)\nclass(tukey)[1] \"pairw\"\notype(tukey)[1] \"S3\"\nftype(print.pairw) # print method for class pairw[1] \"S3\"     \"method\"\nftype(plot.pairw) # plot method for class pairw[1] \"S3\"     \"method\"\ns3_dispatch(print(tukey))=> print.pairw\n * print.default\ntukey\n95% Tukey-Kramer confidence intervals \n\n         Diff     Lower    Upper  Decision Adj. p-value\nmu1-mu2   1.2  -4.71976  7.11976    FTR H0     0.935298\nmu1-mu3  -4.9 -11.17885  1.37885    FTR H0      0.15489\nmu2-mu3  -6.1 -12.37885  0.17885    FTR H0     0.058287\nmu1-mu4 -12.6 -18.51976 -6.68024 Reject H0     0.000101\nmu2-mu4 -13.8 -19.71976 -7.88024 Reject H0      3.7e-05\nmu3-mu4  -7.7 -13.97885 -1.42115 Reject H0     0.014218\nwelch <- pairw.oneway(y = eggs, x = trt)\nwelch\n95% Welch adjusted confidence intervals \n\n         Diff     Lower    Upper  Decision Adj. p-value\nmu1-mu2   1.2  -3.39503  5.79503    FTR H0      0.55425\nmu1-mu3  -4.9    -8.991   -0.809    FTR H0     0.068803\nmu2-mu3  -6.1 -11.06986 -1.13014    FTR H0     0.068803\nmu1-mu4 -12.6 -17.53547 -7.66453 Reject H0    0.0032699\nmu2-mu4 -13.8 -19.36022 -8.23978 Reject H0    0.0027003\nmu3-mu4  -7.7 -12.95069 -2.44931 Reject H0      0.04229alpha.div <- function(x, method = \"simpson\"){\n  if(is.data.frame(x)) rn <- rownames(x) else {\n    if(ncol(as.matrix(x) == 1)) rn = noquote(\"\") else \n      rn = 1:nrow(as.matrix(x))\n  }\n\n  indices <- c(\"simpson\", \"shannon\"); method <- match.arg(method, indices)\n\n  x <- as.matrix(x)\n\n  prop <- function(x){\n      if(ncol(x) == 1) out <- x/sum(x)\n      else\n      out <- apply(x, 1, function(x) x/sum(x))\n      out\n    }\n\n    p.i <- prop(x)\n\n  simp <- function(x, p.i){\n      if(ncol(x) == 1) D <- 1 - sum(p.i^2)\n      else\n      D <- 1 - apply(p.i^2, 2, sum)\n      D\n    }\n\n  shan <- function(x, p.i){\n      if(ncol(x) == 1) H <- -sum(p.i[p.i > 0] * log(p.i[p.i > 0]))\n      else\n      H <- apply(p.i, 2, function(x)-sum(x[x != 0] * log(x[x != 0])))\n      H\n    }\n\n  div <- switch(method,\n                simpson = simp(x, p.i),\n                shannon = shan(x, p.i))\n\n    out <- list(p.i = p.i, rn = rn, method = method, div = div)\n  class(out) <- \"a_div\"; invisible(out)\n}\nlibrary(vegan)\ndata(varespec)\nv.div <- alpha.div(varespec)\nclass(v.div)[1] \"a_div\"\notype(v.div)[1] \"S3\"print.a_div <- function(x, digits = 5){\n  method <- ifelse(x$method == \"simpson\", \"Simpson\",\n                   \"Shannon-Weiner\")\n  cat(method, \" diversity:\", \"\\n\", sep = \"\")\n  rq <- structure(x$div,  names = x$rn)\n  print(rq, digits = digits)\n  invisible(x)\n}\nprint(v.div)Simpson diversity:\n     18      15      24      27      23      19      22      16      28 \n0.82171 0.76276 0.78101 0.74414 0.84108 0.81819 0.80310 0.82477 0.55996 \n     13      14      20      25       7       5       6       3       4 \n0.81828 0.82994 0.84615 0.83991 0.70115 0.56149 0.73888 0.64181 0.78261 \n      2       9      12      10      11      21 \n0.55011 0.49614 0.67568 0.50261 0.80463 0.85896 plot.a_div <- function(x, plot.RAC = FALSE){\n  require(ggplot2)\n  margin_theme <- function(){\n  theme(axis.title.x = element_text(vjust=-5),\n        axis.title.y = element_text(vjust=5),\n        plot.margin = margin(t = 7.5, r = 7.5,\n                             b = 20, l = 15))\n  }\n\n  ptype1 <- function(){\n  spi <- apply(x$p.i, 2, function(x)sort(x, decreasing = TRUE))\n  sspi <- data.frame(p.i = stack(as.data.frame(spi))[,1])\n  sspi$Rank <- rep(1:nrow(x$p.i), ncol(x$p.i))\n  sspi$Site <- rep(x$rn,  each = nrow(x$p.i))\n    ggplot(sspi, aes(y = p.i, x = Rank, group = Site)) +\n      geom_line(aes(y = p.i, x = Rank, colour = Site), alpha = .4) +\n      ylab(expression(italic(p[i]))) +\n      theme_classic() + margin_theme()\n  }\n\n  ptype2 <- function(){\n      diversity <- data.frame(div =  x$div, Site = factor(x$rn))\n      method <- ifelse(x$method == \"simpson\", \"Simpson diveristy\",\n                   \"Shannon-Weiner diveristy\")\n      ggplot(diversity) +\n      geom_bar(aes(y = div, x = Site, fill = div), show.legend = FALSE,\n               stat = \"identity\") +\n      theme_classic() +\n      margin_theme() +\n      ylab(method) + xlab(\"Site\")\n  }\n  if(plot.RAC)  ptype1() else ptype2()\n}\nplot(v.div)\nplot(v.div, plot.RAC = TRUE)"},{"path":"ch8.html","id":"s4","chapter":"8 Functions","heading":"8.6.1.2 S4","text":"S4 class defined using function setClass(). Unlike S3 objects classes, S4 class components, .e., slots, must defined setClass(), along sub-classes components. create S4 class called univ comparison S3 class univ created previous section.S4 class univ three slots: name, n.students, founded. S4 objects created using new() function.\nobject ISU S4 class univ.structure object:Just components list accessed using $, slots S4 object accessed using @.function slot().set S4 methods using function setMethod(). S4 show() method (analogous S3 print()) objects class univ.\nExample 8.18  \\(\\text{}\\)\nreal-world S4 example, function stats4::mle() estimates parameters probability density functions using method maximum likelihood. estimate rate parameter Poisson distribution, \\(\\lambda\\), based sample count data.MLE Poisson rate parameter, data outcomes y, approximately 11.545. Notably, equal sample mean y.class fit0 mle. class S4 designation.\nslot structure object class mle complex:\\(\\blacksquare\\)","code":"\nsetClass(\"univ\", slots = list(name = \"character\", n.students = \"numeric\",\n                              founded = \"numeric\"))\nISU <- new(Class = \"univ\", name = \"Idaho State University\", \n           n.students = 12000, founded = 1905)\nclass(ISU)[1] \"univ\"\nattr(,\"package\")\n[1] \".GlobalEnv\"\ntypeof(ISU)[1] \"S4\"\notype(ISU)[1] \"S4\"\nstr(ISU)Formal class 'univ' [package \".GlobalEnv\"] with 3 slots\n  ..@ name      : chr \"Idaho State University\"\n  ..@ n.students: num 12000\n  ..@ founded   : num 1905\nISU@founded[1] 1905\nslot(ISU, \"founded\")[1] 1905\nsetMethod(\"show\",\n\"univ\",\nfunction(object) {\n cat(object@name, \"was founded in\", object@founded, \n     \"and has an enrollment of\",\n     object@n.students, \"students.\", sep = \" \")\n}\n)\n\nISUIdaho State University was founded in 1905 and has an enrollment of 12000 students.\n# count data\ny <- c(26, 17, 13, 12, 20, 5, 9, 8, 5, 4, 8)\n\n# MLE for lambda in a Poisson distribution given data in y\nnLL <- function(lambda) - sum(dpois(y, lambda, log = T))\n# mle finds negative log-likelihoods\nfit0 <- stats4::mle(nLL, start = list(lambda = 5),\n                    nobs = length(y))\nfit0\nCall:\nstats4::mle(minuslogl = nLL, start = list(lambda = 5), nobs = length(y))\n\nCoefficients:\nlambda \n11.545 \nmean(y)[1] 11.545\nclass(fit0)[1] \"mle\"\nattr(,\"package\")\n[1] \"stats4\"\notype(fit0)[1] \"S4\"\nstr(fit0)Formal class 'mle' [package \"stats4\"] with 10 slots\n  ..@ call     : language stats4::mle(minuslogl = nLL, start = list(lambda = 5), nobs = length(y))\n  ..@ coef     : Named num 11.5\n  .. ..- attr(*, \"names\")= chr \"lambda\"\n  ..@ fullcoef : Named num 11.5\n  .. ..- attr(*, \"names\")= chr \"lambda\"\n  ..@ fixed    : Named num NA\n  .. ..- attr(*, \"names\")= chr \"lambda\"\n  ..@ vcov     : num [1, 1] 1.05\n  .. ..- attr(*, \"dimnames\")=List of 2\n  .. .. ..$ : chr \"lambda\"\n  .. .. ..$ : chr \"lambda\"\n  ..@ min      : num 42.7\n  ..@ details  :List of 6\n  .. ..$ par        : Named num 11.5\n  .. .. ..- attr(*, \"names\")= chr \"lambda\"\n  .. ..$ value      : num 42.7\n  .. ..$ counts     : Named int [1:2] 14 8\n  .. .. ..- attr(*, \"names\")= chr [1:2] \"function\" \"gradient\"\n  .. ..$ convergence: int 0\n  .. ..$ message    : NULL\n  .. ..$ hessian    : num [1, 1] 0.953\n  .. .. ..- attr(*, \"dimnames\")=List of 2\n  .. .. .. ..$ : chr \"lambda\"\n  .. .. .. ..$ : chr \"lambda\"\n  ..@ minuslogl:function (lambda)  \n  ..@ nobs     : int 11\n  ..@ method   : chr \"BFGS\""},{"path":"ch8.html","id":"advanced-biometric-examples","chapter":"8 Functions","heading":"8.7 Advanced Biometric Examples","text":"Customized R functions can used provide straightforward solutions complex mathematical procedures associated biological research.Example 8.19  \\(\\text{}\\)\nBiologists often need solve systems dependent differential equations models describing propagation electrochemical signals via action action potentials neurons (Hodgkin Huxley 1952), models involving species interactions (e.g., competition predation). instance, Lotka-Volterra competition model form:\\[\\begin{equation}\n\\begin{split}\n\\frac{dN_1}{dt} &= r_{max1}N_1\\frac{K_1-N_1-\\alpha_{12}N_2}{K_1}\\\\\n\\frac{dN_2}{dt} &= r_{max2}N_2\\frac{K_2-N_2-\\alpha_{21}N_1}{K_2}\n\\end{split}\n\\tag{8.4}\n\\end{equation}\\]\\(t\\) denotes time, \\(r_{max1}\\) maximum per capita rate increase (empirical rate) species 1, \\(r_{max2}\\) empirical rate species 2, \\(N_1\\) \\(N_2\\) number individuals species 1 2, respectively, \\(K_1\\) = carrying capacity species 1, .e., maximum population size species, \\(K_2\\) = carrying capacity species 2, \\(\\alpha_{12}\\) competitive effect species 2 growth species 1, \\(\\alpha_{21}\\) competitive effect species 1 growth rate species 2.first bring package deSolve, contains functions solving ordinary differential equations (ODEs).define starting values \\(N_1\\) \\(N_2\\) model parameters.Next, specify Lotka-Volterra equations function. include argument time = time even though explicitly used function. required ODE evaluators deSolve.complex part function occurs Lines 4-8 system ODEs Eq (8.4) solved. Note use () make components object pars accessible braces Lines 4 8.deSolve::rk4() function solves simultaneous differential equations using classical Runge-Kutta 4th order integration (Butcher 1987)78. arguments rk4() , order, initial population numbers species 1 2, time frames considered, function evaluated, parameter values.object contains number individuals species 1 2 (\\(N_1\\) \\(N_2\\)) time frames 1-200 (Fig 8.4).\nFigure 8.4: Solutions Lotka Volterra ODEs \\(t = \\{1, 2, ..., 200\\}\\). Species 1 2 coexist, levels appreciably carrying capacities result interspecific competition.\n\\(\\blacksquare\\)\nExample 8.20  \\(\\text{}\\)\nParameter estimation biostatistics often requires optimization mathematical functions (finding function minima maxima). useful function application uniroot(), searches interval zero root function. instance, many location estimators (estimate “central”\n“typical” values, e.g., estimators true underlying mean) zero root function:\n\\[\\begin{equation}\n\\sum_{= 1}^n(x_i - \\hat{\\mu})\n\\tag{8.5}\n\\end{equation}\\]\\(x_i\\) \\(\\)th observation dataset, \\(\\hat{\\mu}\\) estimator true location value. use uniroot() find location estimate provides zero root function.data use tree heights dataframe loblolly.\nvalue identical sample mean tree heights.Indeed, sample mean always zero root Eq. (8.5).\nNormally differences data points location estimate squared, preceding summation. Minimizing function process ordinary least squares.\\(\\blacksquare\\)","code":"\nlibrary(deSolve)\nxstart <- c(N1 = 10, N2 = 10)\npars <- c(r1 = 0.5, r2 = 0.4, K1 = 400, K2 = 300, a2.1 = 0.4,\n             a1.2 = 1.1)LV <- function(time = time, xstart = xstart, pars = pars){\n  N1 <- xstart[1]\n  N2 <- xstart[2]\n    with(as.list(pars),{\n    dn1 <- r1 * N1 * ((K1 - N1 - (a1.2 * N2))/K1)\n    dn2 <- r2 * N2 * ((K2 - N2 - (a2.1 * N1))/K2)\n    res <- list(c(dn1, dn2))\n    })\n}\nout <- as.data.frame(rk4(xstart, time = 1:200, LV, pars))\nplot(out$time, out$N2, xlab = \"Time\", ylab = \"Number of individuals\",\n     type = \"l\")\nlines(out$time, out$N1, type = \"l\", col = \"red\", lty = 2)\nlegend(\"bottomright\", lty = c(1, 2), legend = c(\"Species 2\", \"Species 1\"),\ncol = c(1, 2))\ndata <- Loblolly$height\nf <- function(x) sum(data - x)\nuniroot(f, c(min(data), max(data)))$root[1] 32.364\nmean(data)[1] 32.364"},{"path":"ch8.html","id":"howfunctionswork","chapter":"8 Functions","heading":"8.8 The Process of Function Evaluation in R","text":"construction","code":""},{"path":"ch8.html","id":"promises","chapter":"8 Functions","heading":"8.8.1 Promises","text":"\n","code":""},{"path":"ch8.html","id":"exercises-7","chapter":"8 Functions","heading":"Exercises","text":"Divide plant height soil N values dataset Q. 3 Exercises Chapter 3 (first two columns dataset) respective column sums specifying appropriate function 3rd argument apply().Divide plant height soil N values dataset Q. 3 Exercises Chapter 3 (first two columns dataset) respective column sums specifying appropriate function 3rd argument apply().McIntosh’s index site biodiversity (McIntosh 1967):\n\\[U = \\sqrt{\\sum_{= 1}^s n_i^2}\\]\n\\(s\\) total number species particular site, \\(n_i\\) number individuals \\(\\)th species, \\(= 1,2,3,\\ldots s\\), site.\nWrite function calculate index.\nCheck running following collection \\(n_is\\) obtained single site: ni <- c(5,4,5,3,2).\nMcIntosh’s index site biodiversity (McIntosh 1967):\n\\[U = \\sqrt{\\sum_{= 1}^s n_i^2}\\]\n\\(s\\) total number species particular site, \\(n_i\\) number individuals \\(\\)th species, \\(= 1,2,3,\\ldots s\\), site.Write function calculate index.Check running following collection \\(n_is\\) obtained single site: ni <- c(5,4,5,3,2).Satterthwaite formula approximating degrees freedom \\(t\\) distribution, heteroscedasticity.\n\\[\\frac{\\left(\\frac{S_x^2}{n_x} + \\frac{S_y^2}{n_y}\\right)^2}{\\frac{\\left(S^2_x/n_x\\right)^2}{n_x-1}+\\frac{\\left(S^2_y/n_y\\right)^2}{n_y-1}}\\]\n\\(S^2_x\\) sample variance variable \\(x\\), \\(S^2_y\\) sample variance variable \\(y\\), \\(n_x\\) sample size \\(x\\), \\(n_y\\) sample size \\(y\\).\nWrite function equation variables \\(x\\) \\(y\\) arguments.\nTest function x <- c(1,2,3,2,4,5) y <- c(2,3,7,8,9,10,11).\nSatterthwaite formula approximating degrees freedom \\(t\\) distribution, heteroscedasticity.\n\\[\\frac{\\left(\\frac{S_x^2}{n_x} + \\frac{S_y^2}{n_y}\\right)^2}{\\frac{\\left(S^2_x/n_x\\right)^2}{n_x-1}+\\frac{\\left(S^2_y/n_y\\right)^2}{n_y-1}}\\]\n\\(S^2_x\\) sample variance variable \\(x\\), \\(S^2_y\\) sample variance variable \\(y\\), \\(n_x\\) sample size \\(x\\), \\(n_y\\) sample size \\(y\\).Write function equation variables \\(x\\) \\(y\\) arguments.Test function x <- c(1,2,3,2,4,5) y <- c(2,3,7,8,9,10,11).Create function, implementing switch(), can calculate first second derivative mathematical expression respect \"x\". Test x^3.Create function, implementing switch(), can calculate first second derivative mathematical expression respect \"x\". Test x^3.Create function calculates trimmed means columns quantitative matrix dataframe. Within function, use triple dot operator argument mean(), allow: 1) user-defined trimming (trim argument function mean()), 2) user-defined handling NA outcomes (na.rm also argument mean()). function two arguments: one input data, one triple dot operator, ... . Test function first two columns asbio::cliff.sp. test specify 10% trimming, removal missing values.Create function calculates trimmed means columns quantitative matrix dataframe. Within function, use triple dot operator argument mean(), allow: 1) user-defined trimming (trim argument function mean()), 2) user-defined handling NA outcomes (na.rm also argument mean()). function two arguments: one input data, one triple dot operator, ... . Test function first two columns asbio::cliff.sp. test specify 10% trimming, removal missing values.classic computer science loop applications.\nsequence Fibonacci numbers based function:\n\\[\\begin{align*}\nf(n) &= f(n-1) + f(n-2) \\text{ } n > 2\\\\\nf(1) &= f(2) = 1\n\\end{align*}\\]\n\\(n\\) represents \\(n\\)th step sequence. Using loop, create first 100 numbers sequence, .e., find \\(f(1)\\) \\(f(100)\\). check, first five numbers sequence : 1, 1, 2, 3, 5.\ninteresting chaotic recursive sequence function:\n\\[\\begin{align*}\nf(n) &= f(n- f(n - 1)) + f(n - f(n-2)) \\text{ } n > 2\\\\\nf(1) &= f(2) = 1\n\\end{align*}\\]\nUsing loop, create first 100 numbers sequence, .e., find \\(f(1)\\) \\(f(100)\\). check, first five numbers sequence : 1, 1, 2, 3, 3.\nclassic computer science loop applications.sequence Fibonacci numbers based function:\n\\[\\begin{align*}\nf(n) &= f(n-1) + f(n-2) \\text{ } n > 2\\\\\nf(1) &= f(2) = 1\n\\end{align*}\\]\n\\(n\\) represents \\(n\\)th step sequence. Using loop, create first 100 numbers sequence, .e., find \\(f(1)\\) \\(f(100)\\). check, first five numbers sequence : 1, 1, 2, 3, 5.interesting chaotic recursive sequence function:\n\\[\\begin{align*}\nf(n) &= f(n- f(n - 1)) + f(n - f(n-2)) \\text{ } n > 2\\\\\nf(1) &= f(2) = 1\n\\end{align*}\\]\nUsing loop, create first 100 numbers sequence, .e., find \\(f(1)\\) \\(f(100)\\). check, first five numbers sequence : 1, 1, 2, 3, 3.Create R animation creating loop 360 steps long changes font-size, color, string rotation name (character string) otherwise empty plot. Assuming index used, loop include something resembling code:\n\nplot(1:10, type = \"n\")\ntext(5.5, \"name\", cex = /36, srt = , col = )\nSys.sleep(0.1)Create R animation creating loop 360 steps long changes font-size, color, string rotation name (character string) otherwise empty plot. Assuming index used, loop include something resembling code:Stirling number second kind (Stirling partition number) counts number ways set \\(n\\) objects can partitioned \\(k\\) groups. generally denoted \\(S(n,k)\\) \\(\\left\\{n \\atop k \\right\\}\\), calculated :Stirling number second kind (Stirling partition number) counts number ways set \\(n\\) objects can partitioned \\(k\\) groups. generally denoted \\(S(n,k)\\) \\(\\left\\{n \\atop k \\right\\}\\), calculated :\\[\\left\\{n \\atop k \\right\\} = \\sum_{=0}^k \\frac{(-1)^{k-} ^n}{(k-)!!}.\\]         Write function calculates \\(\\left\\{n \\atop k \\right\\}\\) without using loop.\n         Use form: stirling2 <- function(n, k){function contents}.Bell number, \\(B_n\\), counts number ways set \\(n\\) elements can partitioned (Bell 1938). , \\(B_n\\) sum Stirling numbers particular set, \\(k = \\{1,2,\\ldots,n\\}\\):\\[B_n = \\sum_{k=1}^n \\left\\{{n\\atop k}\\right\\}.\\]         Write function calculating \\(B_n\\) uses stirling2, Q 8, loop.\n         Use form: belln <- function(n){function contents}.exercise concerns speed loops R. Use tapply() simultaneously find mean estimates Loblolly$height level Loblolly$seed, without loop, find run times operations using system.time(). , run following chunks:\n\nsystem.time(tapply(Loblolly$height, Loblolly$Seed, mean))\n\n<- 1:nlevels(Loblolly$Seed)\nsystem.time((levels(Loblolly$Seed)){\n  temp <- Loblolly[Loblolly$Seed == ,]\n  [] <- mean(temp$height)\n})\nDescribe discuss results.exercise concerns speed loops R. Use tapply() simultaneously find mean estimates Loblolly$height level Loblolly$seed, without loop, find run times operations using system.time(). , run following chunks:Describe discuss results.Write function solve systems ODEs \n\\[\\begin{align*}\n\\frac{dx}{dt} &= ax + \\\\\n\\frac{dy}{dt} &= cx + dy\n\\end{align*}\\]\ntest function, let \\(= 3\\), \\(b = 4\\), \\(c = 5\\), \\(d = 6\\), solve \\(t = 1,2,\\ldots,20\\), using classical Runge-Kutta 4\\(^\\text{th}\\) order integration, implemented function deSolve::rk4. Initial values \\(x\\) \\(y\\) can anything \\(\\{0,0\\}\\).Write function solve systems ODEs \n\\[\\begin{align*}\n\\frac{dx}{dt} &= ax + \\\\\n\\frac{dy}{dt} &= cx + dy\n\\end{align*}\\]\ntest function, let \\(= 3\\), \\(b = 4\\), \\(c = 5\\), \\(d = 6\\), solve \\(t = 1,2,\\ldots,20\\), using classical Runge-Kutta 4\\(^\\text{th}\\) order integration, implemented function deSolve::rk4. Initial values \\(x\\) \\(y\\) can anything \\(\\{0,0\\}\\).Make output function previous question S3 class, create plotting method objects class.Make output function previous question S3 class, create plotting method objects class.","code":"\nplot(1:10, type = \"n\")\ntext(5.5, \"your name\", cex = i/36, srt = i, col = i)\nSys.sleep(0.1)\nsystem.time(tapply(Loblolly$height, Loblolly$Seed, mean))\nout <- 1:nlevels(Loblolly$Seed)\nsystem.time(for(i in levels(Loblolly$Seed)){\n  temp <- Loblolly[Loblolly$Seed == i,]\n  out[i] <- mean(temp$height)\n})"},{"path":"ch9.html","id":"ch9","chapter":"9 R Interfaces","heading":"9 R Interfaces","text":"“try things; R won’t break.\"- Duncan Murdoch, R-help (May 2016)Code languages can interfaced R command line prompt within R scripts. instance, already considered use Perl regex calls managing character strings Ch 4 (Section 4.3). examples include code interfaces C, C++ (via package Rcpp, Eddelbuettel et al. (2023), Eddelbuettel (2013), Eddelbuettel Balamuta (2018)), Fortran, MATLAB (via package R.matlab, Bengtsson (2022)), Python (via package reticulate, Ushey, Allaire, Tang (2023)), Java (via package rJava, Urbanek (2021)). R can also called number different languages including C C++ (see package RInside, Eddelbuettel, Francois, Bachmeier (2023)), Java (via Java package RCaller, Satman (2014)), Python (via Python package, rpy2). instance, R package RCytoscape, Bioconductor project, allows cross-communication popular Java-driven software molecular networks Cytoscape, R.costs benefits interfacing R languages (Chambers 2008). Costs include:Non interpreted languages (see Section 9.1 immediately ) require compilation. Therefore may wise limit code package-development applications (Ch 10) since R built-procedures can facilitate process package building.Interfacing older low level languages (e.g., Fortran C (Section 9.3)) increases possibility programming errors, often serious consequences, including memory faults. , bugs bite!Interfacing languages may increase possibility programs limited specific platforms.R programs can often written succinctly. instance, Morandat et al. (2012) found R programs 40% smaller analogous programs written C.Despite issues, number strong potential benefits. include:huge number useful, well-tested, algorithms written languages, often straightforward interface procedures R.system speed languages may much better R many tasks. instance, algorithms written non-interpreted languages, often much faster corresponding procedures written R.Non-OOP languages may efficient R respect memory usage.chapter considers interfaces several important programming languages, including Fortran, C, C++, particularly, Python. Interfaces languages used primarily GUI generation web-based applications, example, Tcl/Tk, JavaScript, JavaScript Object Notation (JSON), HTML, Cascading Style Sheets (CSS), considered Ch 11.account frequent use distinct computer languages chapter, following chunk coloring conventions used hereafter book79:\n","code":"\n# R code! Fortan code// C and C++ code# Python code:: Shell command line"},{"path":"ch9.html","id":"interp","chapter":"9 R Interfaces","heading":"9.1 Interpreted versus Compiled Languages","text":"Along many useful languages (e.g., Python, JavaScript), R generally applied interpreted language. Interpreted code must translated binary can executed. process can slow function run times, particularly function includes iterative procedures like loops. Non-interpreted (compiled) languages include C, Fortran, Java. languages, compiler (translation program) used transform source code target “object” language, generally binary (Ch 11). end product compilation called executable file (Figure 9.1). Executables languages can called within R run R functions procedures.\n\nFigure 9.1: Creating executable file compiled language.\n","code":"\nknitr::opts_knit$get('rmarkdown.pandoc.to')[1] \"html\""},{"path":"ch9.html","id":"markint","chapter":"9 R Interfaces","heading":"9.2 Interfacing with R Markdown/RStudio","text":"Language program interfacing R often greatly facilitated use R Markdown chunks. many languages R supported R Markdown, via knitr. language definition particular R Markdown chunk given first term chunk. instance, ```{r} ``` initiates conventional R code chunk, whereas ```{python}``` initiates Python code chunk. current R Markdown language engines (note items 52-64 explicit computer languages).evident output , R Markdown engines extend compiled languages including Fortran (engine = fortran) C (engine = c). Ideally, accomplished compiling source code chunk --fly, automated step, using native R compilers, automatically loading resulting compiled executable potential calls R chunks (Xie, Dervieux, Riederer 2020). process may hampered, however, number factors including non-administrator permissions environmental path definitions, particularly Windows computers. result, present complex, dependable method code compilation execution .","code":"\nnames(knitr::knit_engines$get()) [1] \"awk\"         \"bash\"        \"coffee\"      \"gawk\"        \"groovy\"     \n [6] \"haskell\"     \"lein\"        \"mysql\"       \"node\"        \"octave\"     \n[11] \"perl\"        \"php\"         \"psql\"        \"Rscript\"     \"ruby\"       \n[16] \"sas\"         \"scala\"       \"sed\"         \"sh\"          \"stata\"      \n[21] \"zsh\"         \"asis\"        \"asy\"         \"block\"       \"block2\"     \n[26] \"bslib\"       \"c\"           \"cat\"         \"cc\"          \"comment\"    \n[31] \"css\"         \"ditaa\"       \"dot\"         \"embed\"       \"eviews\"     \n[36] \"exec\"        \"fortran\"     \"fortran95\"   \"go\"          \"highlight\"  \n[41] \"js\"          \"julia\"       \"python\"      \"R\"           \"Rcpp\"       \n[46] \"sass\"        \"scss\"        \"sql\"         \"stan\"        \"targets\"    \n[51] \"tikz\"        \"verbatim\"    \"theorem\"     \"lemma\"       \"corollary\"  \n[56] \"proposition\" \"conjecture\"  \"definition\"  \"example\"     \"exercise\"   \n[61] \"hypothesis\"  \"proof\"       \"remark\"      \"solution\"    \"glue\"       \n[66] \"glue_sql\"    \"gluesql\"    "},{"path":"ch9.html","id":"FC","chapter":"9 R Interfaces","heading":"9.3 Fortran and C","text":"\nS, progenitor R, created time Fortran routines dominated numerical programming, R arose C approaching peak popularity. result, strong connections languages, particularly C, remain R80. R contains specific base functions interfacing C Fortran executables: .C() .Fortran()81, respectively. flexible general interface functions, introduced later versions R, may better performance characteristics, include .Call() .External().Recall R object class numeric automatically assigned base type double, although can coerced base type integer (potentially result information loss elimination “decimal” component). Fortran, C, many languages require explicit user-assignments underlying base types.one interfacing R Fortran C, limited number base types possible (Table 9.1), one need use appropriate coercion functions R objects one wishes use objects Fortran C scripts82. Interfaced C script arguments must pointers83 arguments Fortran scripts must arrays types given Table 9.1.\nTable 9.1: Correpsonding types R, C, Fortran. Table adapted Chambers (2008).","code":""},{"path":"ch9.html","id":"compile","chapter":"9 R Interfaces","heading":"9.3.1 Compiling Executables","text":"Raw Fortran source code generally saved .f, (.f90 .f95; modern Fortran) file, whereas C source code saved .c file. One can create file correct file type extension using file.create(). example, create file called foo.f90 can open (working directory) text editor (e.g., Notepad, RStudio) build Fortran script.Windows executable files compiled source code generally .exe .cmd extension, whereas Mac OS executable files generally .app extension. use R, however, files must shared library executables (see ), .dll .extensions Windows Unix-alike (e.g., Mac-OS) operating systems, respectively. Shared library objects different conventional executables evaluated directly. case, R required executable entry point84.\nR contains shared library compilers Fortran C within Rcmd executable, located R bin directory, along several important executables. Rcmd typically invoked shell command line (Windows one can access editor typing cmd Search bar) using format: R CMD command args. command currently one INSTALL, REMOVE, SHLIB, BATCH, build, check, Rprof, Rdconfig, Rdiff, Rd2pdf, Stangle, Sweave, config, open, texify, args defines arguments specific R CMD command. shell script:\nprompt building shared library object user-defined script foo, generally Fortran C source code85. compilation shared libraries facilitated installation toolbox bundle Rtools along accessible environmental path.Notably, SHLIB compilers work Fortran code written subroutine86 C code written void formats87. result, neither code type return value directly88.Example 9.1  \\(\\text{}\\)\nsimple example calling Fortran C compiled executables, R, speed looping. content follows class notes created Charles Geyer University Minnesota. Clearly, example also run without looping. Equation (9.1) shows simple formula converting temperature measurements degrees Fahrenheit degrees Celsius.\\[\\begin{equation}\nC = 5/9(F - 32)\n\\tag{9.1}\n\\end{equation}\\]\\(C\\) \\(F\\) denote temperatures Celsius Fahrenheit, respectively.Fortan subroutine calculating Celsius temperatures dataset Fahrenheit measures, using loop.Fortran code consists following steps:Line 1 subroutine invoked using Fortran function subroutine. subroutine named FtoC, arguments x (Fahrenheit temperatures) n (number temperatures)Line 2 entry given n defined integer (Table 9.1).Line 3 define x double precision numeric vector length n.Line 4 define looping index used, , integer.Lines 5-7 proceed Fortran loop. code 100 = 1, n means loop 1) run initially 100 times, 2) lower limit 1, 3) upper limit n. code: x() = (x()-32)*(5./9.) calculates Eq. (9.1). code 5./9. used result division can non-integer. code 100 continue allows loop continue n.Line 8 subroutine ends. Fortran scripts must end end.save code filename FtoC.f90, transfer appropriate directory (use C:/Users/ahoken/Documents/Amalgam/Amalgam_Bookdown/scripts/). open shell editor (Windows command shell can accessed typing cmd Search bar), navigate R bin\\x64 directory. Windows machine, address : C:\\Program Files\\R-4.4.1\\bin\\x64.shell language Windows somewhat similar POSIX (Portable Operating System Interface) compliant shell language generally used Unix-like systems (guidance can found ). instance, command cd changes directories, command cd .. navigates (toward root directory).compile FtoC.f90 using script R CMD SHLIB FtoC.f90. Thus, shell command line enter:Note change back slashes (Unix-style) forward slashes specifying addresses SHLIB.\ncommand creates compiled Fortran executable FtoC.dll. Specifically, Fortran compiler, GNU Fortran (GCC), used create Unix-style shared library FtoC.o (GCC short GNU compiler collection). file converted .dll file, aided RTools GCC 10/MinGW-w64 compiler toolchain. default, .dll saved directory contained source code. compilation process can followed (difficulty) cryptic shell output :\n\nanalogous C loop function converting Fahrenheit Celsius.C code consists following steps.Line 1 line break. currently appears required compilation C void functions SHLIB.Line 2 void function initialized two arguments. code int *nin means “access value nin points define integer.” code double *x means: “access value x points define double precision.”Lines 8-9 define C loop. loops general format: ( init; condition; increment ) {statement(s); }. init step executed first . Next condition evaluated. true, loop executed. syntax ++ literally means: = + 1.One , save source code, FtoCc.c, within appropriate directory. compile code using command R CMD SHLIB FtoCc.c. Thus, shell command line enter:creates shared library executable FtoCc.dll.R-wrapper can call Fortran executable, call = \"Fortran\", C executable, call = \"C\", use R looping, call = \"R\". Several new functions used. Line 10 function dyn.load() used load shared Fortran library file FtoC.dll, Lines 14-15 dyn.load() loads shared C library file FtoCc.dll. Note variable nin pointed toward n, x included argument dyn.load() Line 15. Line 11 function .Fortran() used execute FtoC.dll, Line 16 .C() used execute FtoCc.dll.create \\(10^8\\) potential Fahrenheit temperatures converted Celsius using (unnecessary) looping.Note first Fortran, C, R loops provide identical temperature transformations. first 6 transformations:However, run times dramatically different89. C executable much faster R, venerable Fortran executable even faster C!\\(\\blacksquare\\)\n","code":"\nfile.create(\"foo.f90\")R CMD SHLIB foosubroutine FtoC(n, x)\ninteger n\ndouble precision x(n)\ninteger i\ndo 100 i = 1, n\nx(i) = (x(i)-32)*(5./9.)\n100 continue\nendcd C:\\Program Files\\R\\R-4.4.2\\R\\bin\\x64  \nR CMD SHLIB C:/Users/ahoken/Documents/Amalgam/Amalgam_Bookdown/scripts/FtoC.f90\nvoid ftocc(int *nin, double *x)\n{\n  int n = nin[0];\n  int i;\n  for (i=0; i<n; i++)\n    x[i] = (x[i] - 32) * 5 / 9;\n}cd C:\\Program Files\\R\\R-4.4.2\\R\\bin\\x64  \nR CMD SHLIB C:/Users/ahoken/Documents/Amalgam/Amalgam_Bookdown/scripts/FtoCc.c F2C <- function(x, call = \"R\"){\n  n <- length(x)\n  if(call == \"R\"){\n    out <- 1:n\n    for(i in 1:n){\n    out[i] <- (x[i] - 32) * (5/9)\n    }\n  }\n  if(call == \"Fortran\"){\n    dyn.load(\"C:/Users/ahoken/Documents/Amalgam/Amalgam_Bookdown/scripts/FtoC.dll\")\n    out <- .Fortran(\"ftoc\", n = as.integer(n), x = as.double(x))\n  }\n  if(call == \"C\"){\n    dyn.load(\"C:/Users/ahoken/Documents/Amalgam/Amalgam_Bookdown/scripts/FtoCc.dll\",\n             nin = n, x)\n    out <- .C(\"ftocc\", n = as.integer(n), x = as.double(x))\n  }\n  out\n}\nx <- runif(100000000, 0, 100)\nhead(x)[1] 76.391 68.578 12.061 71.886 66.711 72.958\nhead(F2C(x[1:10], \"Fortran\")$x)[1]  24.661  20.321 -11.077  22.159  19.284  22.755\nhead(F2C(x[1:10], \"C\")$x)[1]  24.661  20.321 -11.077  22.159  19.284  22.755\nhead(F2C(x[1:10], \"R\"))[1]  24.661  20.321 -11.077  22.159  19.284  22.755\nsystem.time(F2C(x, \"Fortran\"))   user  system elapsed \n   0.54    0.22    0.76 \nsystem.time(F2C(x, \"C\"))   user  system elapsed \n   0.52    0.39    0.91 \nsystem.time(F2C(x, \"R\"))   user  system elapsed \n   5.44    0.41    5.96 "},{"path":"ch9.html","id":"c","chapter":"9 R Interfaces","heading":"9.4 C++","text":"","code":""},{"path":"ch9.html","id":"python","chapter":"9 R Interfaces","heading":"9.5 Python","text":"Python, whose image logo shown Fig 9.2, similar R several respects. Python formally introduced early 90s, open source OOP language rapidly gaining popularity, user code evaluated --fly manner. Python, like R, interpreted language.\nFigure 9.2: symbol Python, high-level, general-purpose, programming language.\nLike R, comments Python made using metacharacter #90. Boolean operators similar, although, unary operator “” R !, Python actually , Python uses True False instead TRUE FALSE., however, several fundamental differences. include fact white spaces R code (including tabs) simply reflect coding style preferences –example, increase code clarity– Python indentations denote code blocks91. , Python indentations serve purpose R curly braces. Another important difference R object names can contain . (dot), Python . means: “attribute namespace.” Useful guidance converting R code analogous Python code can found .Python can downloaded free (https://www.python.org/downloads/), can activated Windows command line using command py, activated Mac Unix/Linux command line using command python (Fig 9.3). previous sections Fortran, C, C++, short section meant thorough introduction Python. General guidance Python language can found (https://docs.python.org/) many sources including books.\nFigure 9.3: Python command line interface Windows.\nNote standard command line prompt Python shell >>>. can exit Python command line typing quit().\n","code":""},{"path":"ch9.html","id":"reticulate","chapter":"9 R Interfaces","heading":"9.5.1 reticulate","text":"\nprimary interest interfacing Python R, Python , use R base operations. require R package reticulate.RStudio (via reticulate) can used IDE Python92. capacity RStudio :Generate Python specific environment (allow separate listing Python R objects).Call separate R Python environments, depending language currently used chunk. Python code can run R Markdown (via RStudio) defining python (instead r) first option R Markdown chunk.can specify path Python system (allowing us use different versions Python) reticulate::use_python. important specific versions Python may dramatically affect usability basic Python functions. code specifies use current version Python, accessed Sys.(), finds full paths program executables.\nPython command line interface can also called directly R using:Python can closed resulting interface (returning one R) typing:One can obtain information version Python currently used reticulate running function retuclate::py_config (R).Example 9.2  \\(\\text{}\\)following Python operations, run directly RStudio.Python assignment operator =.see aforementioned importance indentation.Lack indented “block” following produce error. Indentations code can made flexibly (e.g., one space, two space, tab, etc.) used consistently.\\(\\blacksquare\\)\n","code":"\n# install.packages(\"reticulate\")\nlibrary(reticulate)\nuse_python(Sys.which(\"python\"))\nrepl_python()exit\nreticulate::py_config()python:         C:/Users/ahoken/AppData/Local/Programs/Python/Python311/python.exe\nlibpython:      C:/Users/ahoken/AppData/Local/Programs/Python/Python311/python311.dll\npythonhome:     C:/Users/ahoken/AppData/Local/Programs/Python/Python311\nversion:        3.11.3 (tags/v3.11.3:f3909b8, Apr  4 2023, 23:49:59) [MSC v.1934 64 bit (AMD64)]\nArchitecture:   64bit\nnumpy:          C:/Users/ahoken/AppData/Local/Programs/Python/Python311/Lib/site-packages/numpy\nnumpy_version:  1.24.2\n\nNOTE: Python version was forced by RETICULATE_PYTHON_FALLBACK2 + 24x = 2\nx + x4if x < 0:\n  print(\"negative\")\nelse:\n  print(\"positive\")positive"},{"path":"ch9.html","id":"packages","chapter":"9 R Interfaces","heading":"9.5.2 Packages","text":"Like R, Python consists core language, set built-functions, modules, libraries (.e., Python standard library), vast collection (\\(>200,000\\)) supplemental libraries. Imported libraries extremely important Python distributed version limited functional capabilities (compared R). number important Python supplemental libraries, contain multiple packages, shown Table 9.2.Table 9.2: Important Python supplemental libraries. information use hyperlinks.\ncan install Python packages libraries using pip package manager Python93. Installation needs occur workstation (similar install.packages() R). Following installation, one can load package particular work session using Python function import (analogous library() R)94.Installation Python package, foo, reticulate, via pip, can accomplished using function reticulate::py_install (R)95.\nexample, install scipy library use command:load scipy library use Python function import():","code":"\npy_install(\"foo\", pip = TRUE)\npy_install(\"scipy\", pip = TRUE) # Run in R, if scipy has not been installedimport scipy "},{"path":"ch9.html","id":"functions-in-packages","chapter":"9 R Interfaces","heading":"9.5.3 Functions in Packages","text":"Functions within Python packages obtained using package.function syntax.\nimport numpy run function pi (contained numpy).writing lot mumpy functions, Python allow define simplified library prefix. instance, created shortcut numpy called np use shortcut access numpy functions pi() sin().\nUse command numpy import * cause names functions NumPy overwrite functions name packages. , run numpy.pi simply using pi.\nimport package pyplot library matplotlib, rename package plt, create plot using function pyplot.plot() (plt.plot()) calling:Line 2, command range(10) creates sequence integers zero ten. used first argument plt.plot(), specifies plot \\(x\\)-coordinates. \\(y\\) coordinates specified second argument, \\(x\\)-coordinates reused \\(y\\) coordinates. command 'bo' places blue filled circles \\(x\\),\\(y\\) coordinates. Documentation matplotlib.pyplot.plot() can found .\n","code":"import numpy\nnumpy.pi3.141592653589793import numpy as np\nnp.sin(20 * np.pi/180) # sin(20 degrees)0.3420201433256687import matplotlib.pyplot as plt\nplt.plot(range(10), 'bo')"},{"path":"ch9.html","id":"dataset-storage-types","chapter":"9 R Interfaces","heading":"9.5.4 Dataset Storage Types","text":"four different built-dataset storage types Python: lists, tuples, sets, dictionaries (Table 9.3). Data storage types Python objects can identified Python function type().\nTable 9.3: four Python dataset storage types.can make Python list, can contain text numeric data, using square brackets function list().\nempty list can specified []Like R, can index list elements using square brackets. Importantly, [0] refers first element list .third element :Square brackets can also used reassign list valuesWe can use function .append() append entries end list. instance, append number 9 object previous example, type:Unlike Python list, data object called tuple, designated using parentheses, contains elements changed:Multidimensional numerical arrays, including matrices, can created using functions numpy. define:\\[\\boldsymbol{B} =\n\\begin{bmatrix}\n1 & 4 & 5 \\\\\n9 & 7.2 & 4\n\\end{bmatrix}\n\\]find \\(\\boldsymbol{B} - 5\\).Extensive linear algebra tools contained libraries numpy scipy.","code":"a = [20, 7, \"Hi\", 7, \"end\"]empty = []\nempty[]a[0]20a[3]7a[3] = 10\na[20, 7, 'Hi', 10, 'end']a.append(9)\na[20, 7, 'Hi', 10, 'end', 9]b = (1,2,3,4,5)\nb[0]1b[0] = 10 # produces errorB = np.array([[1, 4, 5], [9, 7.2, 4]])\nBarray([[1. , 4. , 5. ],\n       [9. , 7.2, 4. ]])B - 5array([[-4. , -1. ,  0. ],\n       [ 4. ,  2.2, -1. ]])"},{"path":"ch9.html","id":"mathematical-operations","chapter":"9 R Interfaces","heading":"9.5.5 Mathematical Operations","text":"Basic Python mathematical operators generally (always) identical R. instance, note exponentiation ** used instead ^ (Table 9.4).Table 9.4: Basic Python mathematical functions operators.\nSymbolic derivative solutions functions can obtained using functions library sympy. Results package functions can printed LaTeX pretty mathematics.solve:\n\\[\\frac{d}{dx} 3e^{-x^2}\\]\\[- 6 x e^{- x^{2}}\\]\nLine 2, x defined symbolically using sympy.symbols() function. variable x used term expression fx Line 3. function fx differentiated Line 4 using function sympy.diff().\nIntegration Python can handled function quad() scipy. find:\n\\[\\int_0^1 3e^{-x^2} dx\\]perform integration must install scipy.integrate library using pip bring function quad().\ndefine integrand Python function using function def(). , def() analogous function() R.now run quad() user function f defined bounds integration.first number value definite integral (case, area function f 0 1). second measure absolute error numerical approximation.\n","code":"\npy_install(\"sympy\", pip = TRUE) # run in R if sympy hasn't been installedfrom sympy import *\nx = symbols ('x')\nfx = 3 * exp(-x ** 2)\nprint(diff(fx))from scipy.integrate import quaddef f(x):\n  return 3 * np.exp(-x**2)quad(f, 0, 1)(2.240472398437281, 2.487424042782217e-14)"},{"path":"ch9.html","id":"reading-in-data","chapter":"9 R Interfaces","heading":"9.5.6 Reading in Data","text":"Data delimited files, including .csv files, can read Python using mumpy function loadtxt().Example 9.3  \\(\\text{}\\)\nAssume comma separated dataset, named ffall.csv, located Python working directory, describing free fall properties object six seconds, columns observation number, time (seconds), altitude (mm) uncertainty (mm). Python working directory (need R working directory RStudio) can identified using function getcwd() library os.can load freefall.csv using:first row skipped (using skiprows = 1) contained column names re-assigned brought data.\n\n\n\nNote , unlike R, columns dataset automatically attached global environment upon loading, overwrite objects name.File readers pandas less clunky (similar R).\ncan bring freefall.csv using function pandas.read_csv():object ffall Pandas DataFrame, different several respects, R dataframe. Column arrays ffall can called using syntax: ffall., using braces. instance:\\(\\blacksquare\\)RStudio, R Python (reticulate) sessions considered separately. process, accessing Python R, R data types automatically converted equivalent Python types. Conversely, values returned Python R converted back R types. possible, however, access others’ session.reticulate operator py allows one interact Python session directly R console. convert pandas DataFrame ffall recognizable R dataframe, within R.allows examine R functions.Lines 1 2 chunk , bring Python library pandas R function reticulate:import(). code pd <- import(\"pandas\", convert = FALSE) Python equivalent : import pandas pd.\nexpected, column names constitute names attribute dataframe ffallR.ffall dataset, however, different characteristics Python object. Note code pandas function read_csv() accessed using pd$read_csv() instead pd.read_csv() R chunk used.names attribute pandas DataFrame ffallP, perceived R, contains 200 entities, many provided built-Python module statistics. first 20.can use entities obtain statistical summaries column array, revealing approach R/Python syntheses.analysis R expression need explicitly converted R objects using function py_to_r().","code":"import os\nos.getcwd()'C:\\\\Users\\\\ahoken\\\\Documents\\\\GitHub\\\\Amalgam'obs, time, height, error = np.loadtxt(\"ffall.csv\", \ndelimiter = \",\", skiprows = 1, unpack = True)height/1000 # height in metersarray([0.18 , 0.182, 0.178, 0.165, 0.16 , 0.148, 0.136, 0.12 , 0.099,\n       0.083, 0.055, 0.035, 0.005])\npy_install(\"pandas\")  # Run if pandas is not installed import pandas as pd # run in a Python chunk\nffall = pd.read_csv('ffall.csv')\nffall    obs  time  height  error\n0     1   0.0     180   3.50\n1     2   0.5     182   4.50\n2     3   1.0     178   4.00\n3     4   1.5     165   5.50\n4     5   2.0     160   2.50\n5     6   2.5     148   3.00\n6     7   3.0     136   2.50\n7     8   3.5     120   3.00\n8     9   4.0      99   4.00\n9    10   4.5      83   2.50\n10   11   5.0      55   3.60\n11   12   5.5      35   1.75\n12   13   6.0       5   0.75ffall.height0     180\n1     182\n2     178\n3     165\n4     160\n5     148\n6     136\n7     120\n8      99\n9      83\n10     55\n11     35\n12      5\nName: height, dtype: int64ffall[\"height\"]0     180\n1     182\n2     178\n3     165\n4     160\n5     148\n6     136\n7     120\n8      99\n9      83\n10     55\n11     35\n12      5\nName: height, dtype: int64\nffallR <- py$ffall\ncolMeans(ffallR)     obs     time   height    error \n  7.0000   3.0000 118.9231   3.1615 \npd <- import(\"pandas\", convert = FALSE)\nnames(ffallR)[1] \"obs\"    \"time\"   \"height\" \"error\" \nffallP <- pd$read_csv(\"ffall.csv\")\nhead(names(ffallP), 20) [1] \"abs\"        \"add\"        \"add_prefix\" \"add_suffix\" \"agg\"       \n [6] \"aggregate\"  \"align\"      \"all\"        \"any\"        \"apply\"     \n[11] \"applymap\"   \"asfreq\"     \"asof\"       \"assign\"     \"astype\"    \n[16] \"at\"         \"at_time\"    \"attrs\"      \"axes\"       \"backfill\"  \nffallP$mean()obs         7.000000\ntime        3.000000\nheight    118.923077\nerror       3.161538\ndtype: float64\nffallP$var()obs         15.166667\ntime         3.791667\nheight    3495.243590\nerror        1.512147\ndtype: float64\nffallP$kurt()obs      -1.200000\ntime     -1.200000\nheight   -0.692166\nerror     0.445443\ndtype: float64\ntrans <- ffallP$transpose() # transpose matrix\ntransR <- py_to_r(trans)\n\napply(transR, 1, mean)     obs     time   height    error \n  7.0000   3.0000 118.9231   3.1615 "},{"path":"ch9.html","id":"pvR","chapter":"9 R Interfaces","heading":"9.5.7 Python versus R","text":"R allows much greater flexibility Python explicit statistical analyses graphical summaries. example, Python statistics library Pymer4 actually uses generalized linear mixed effect model (see Aho (2014)) functions R package lme4 complete computations. Additionally, Python tends less efficient R pseudo-random number generation96, since requires looping generate multiple pseudo-random outcomes (see Van Rossum Drake (2009)).Example 9.4  \\(\\text{}\\)\ngenerate \\(10^8\\) pseudo-random outcomes continuous uniform distribution (processor details footnoted Example 9.1).R:Python:operation takes much longer Python R.Python code requires explanation. Lines 1 2, Python modules \\(time\\) \\(random\\) loaded Python standard library, Line 3 empty list ranP created filled loop commences. Line 5, start time operation recorded using function time() module time. Line 6 sequence length \\(10^8\\) defined reference index variable loop commences. Lines 7 8 random number generated using function random() module random number appended ranP. Note Lines 7 8 indented indicate reside loop. Finally, Line 9 start time subtracted end time get system time operation.\\(\\blacksquare\\)\nhand, system time efficiency Python may better R many applications, including management large datasets (Morandat et al. 2012).Example 9.5  \\(\\text{}\\)\nadd randomly generated dataset R:Python:operation, Python faster.\\(\\blacksquare\\)course, IDEs like RStudio allow, package reticulate, simultaneous use R Python systems, allowing one draw strengths language.","code":"\nsystem.time(ranR <- runif(1e8))   user  system elapsed \n   2.50    0.10    2.61 import time\nimport random\nranP = []\n\nstart_time = time.time()\nfor i in range(0,9999999):\n  n = random.random()\n  ranP.append(n)\ntime.time() - start_time5.81349515914917\nsystem.time(ranR + ranR)   user  system elapsed \n   0.17    0.14    0.31 start_time = time.time()\ndiff = ranP + ranP\ntime.time() - start_time0.11191940307617188"},{"path":"ch9.html","id":"exercises-8","chapter":"9 R Interfaces","heading":"Exercises","text":"Fortran script calculates circumference earth (km) given latitude (measured radians). additional information, see Question 6 Exercise 2. Explain happening line code .\nhi.temps$day2 using .call().Create file circumf.f90 containing code save appropriate directory. Take screen shot directory.Create file circumf.f90 containing code save appropriate directory. Take screen shot directory.Compile circumf.f90 create circumf.dll. Windows require shell script:Compile circumf.f90 create circumf.dll. Windows require shell script:      supply Root part address, Approriate directory directory containing circumf.f90.\n      Take screenshot show created circumf.dll. Running shell code may require use shell Administrator.)wrapper97 circumf.dll. , supply Approriate directory. Explain happening Lines 2, 4, 5. , finally, run: cearthf(0:90).\nhi.temps$day2 using .call().C script identical functionality Fortran script Q. 1. code: #include <math.h> allows access C mathematical functions, including cos(). Describe happening Lines 7-10.Repeat Qs, 2 3 C subroutine circumc.Repeat Qs, 2 3 C subroutine circumc.R wrapper circumc.dll. Explain happening Lines 4-6 run: cearthc(0:90).R wrapper circumc.dll. Explain happening Lines 4-6 run: cearthc(0:90).Make Python list elements \"pear\", \"banana\", \"cherry\".\nExtract second item list.\nReplace first item list \"melon\".\nAppend number 3 list.\nMake Python list elements \"pear\", \"banana\", \"cherry\".Extract second item list.Replace first item list \"melon\".Append number 3 list.Make Python tuple elements \"pear\", \"banana\", \"cherry\".\nExtract second item tuple.\nReplace first item tuple \"melon\". issue?\nAppend number 3 tuple. issue?\nMake Python tuple elements \"pear\", \"banana\", \"cherry\".Extract second item tuple.Replace first item tuple \"melon\". issue?Append number 3 tuple. issue?Using def(), write Python function square value x, adds constant c squared value x.Using def(), write Python function square value x, adds constant c squared value x.Exercises Ch 2, use Python (call Python R) complete Problem 4 (-h). Document work R Markdown (note much better Python simplifying derivatives).Exercises Ch 2, use Python (call Python R) complete Problem 4 (-h). Document work R Markdown (note much better Python simplifying derivatives).","code":"subroutine circumf(x, n)\ndouble precision x(n)\ninteger n\nx = cos(x)*40075.017\nendcd Root part of address\\bin\\x64  \nR CMD SHLIB Appropriate directory/circumf.f90cearthf <- function(latdeg){\n  x <- latdeg * pi/180\n  n <- length(x)\n  dyn.load(\"Appropriate directory/circumf.dll\")\n  out <- .Fortran(\"circumf\", x = as.double(x), n = as.integer(n))\n  out\n}\n#include <math.h>\n\n\nvoid circumc(int *nin, double *x)\n{\n  int n = nin[0];\n  int i;\n  for (i=0; i<n; i++)\n    x[i] = (cos(x[i]) * 40075.017);\n}cearthc <- function(latdeg){\n  x <- latdeg * pi/180\n  n <- length(x)\n  dyn.load(\"Appropriate directory/circumc.dll\",\n           nin = n, x)\n  out <- .C(\"circumc\", n = as.integer(n), x = as.double(x))\n  out\n}"},{"path":"ch10.html","id":"ch10","chapter":"10 Building R Packages","heading":"10 Building R Packages","text":"“two ways constructing software design: One way make simple obviously deficiencies, way make complicated obvious deficiencies. first method far difficult.”- Tony Hoare, Pioneering British computer scientist","code":""},{"path":"ch10.html","id":"introduction-1","chapter":"10 Building R Packages","heading":"10.1 Introduction","text":"One strengths R capacity format share user-designed software packages. Clearly possible apply R one’s entire scientific career without creating R package. However, development package, even distributed formal repository, ensures software trustworthy portable. Importantly, chapter provides overview basic topics package development. thorough guide package creation document Writing R Extensions, maintained R development core team.","code":""},{"path":"ch10.html","id":"package-components","chapter":"10 Building R Packages","heading":"10.2 Package Components","text":"R package directory files, generally nested subdirectories. Specifically,DESCRIPTION NAMESPACE files define fundamental characteristics package, e.g., author(s), maintainer, package version, dependency packages, etc.Subdirectories, nested files, contain package contents. following subdirectories possible, although need exist within package.R subdirectory contains package R code, stored .r files, almost always exist.data subdirectory contains package datasets, usually stored .rda files, can created using save().man subdirectory contains package documentation, stored .rd files, functions (R directory) data (data), almost always exists.(optional) src subdirectory contains raw source code requiring compilation (C, C++, Fortran). building package R call R CMD SHLIB (see Section 9.3.1) create appropriate binary shared library files.potential subdirectories include: demo, exec, inst, po, tests, tools, vignettes.Fig 10.1 shows contents streamDAG package. directories, files, contained within parent directory called streamDAG.\n\nFigure 10.1: Subdirectory level components streamDAG package.\nExample 10.1  \\(\\text{}\\)Creation package components can facilitated function package.skeleton() . package.skeleton() documentation Examples (see ?package.skeleton), assume want build package contains two silly functions: (f g) two silly datasets: (d e).specify list argument package.skeleton() give package name mypkg.Running code cause package skeleton mypkg sent working directory. Note skeleton contains subdirectories: data, r, man (Fig 10.2). datasets d e converted .rda files package.skeleton() placed data subdirectory. functions f g converted .r files placed r subdirectory. Documentation skeletons functions datasets, .rd files, placed man subdirectory. Package DESCRIPTION, NAMESPACE files, throw-away (Read--delete-) file also created (Fig 10.2).\nFigure 10.2: Subdirectory level components toy mypkg package.\n\\(\\blacksquare\\)","code":"\nf <- function(x, y) x + y\ng <- function(x, y) x - y\nd <- data.frame(a = 1, b = 2)\ne <- rnorm(1000)\npackage.skeleton(list = c(\"f\",\"g\",\"d\",\"e\"), name = \"mypkg\")"},{"path":"ch10.html","id":"datasets-the-data-subdirectory","chapter":"10 Building R Packages","heading":"10.3 Datasets (the data Subdirectory)","text":"Datasets R stored data subdirectory. Three data formats possible:Raw .r codeTabular data (e.g., .txt, .csv files)Data `images'' created using functionsave()`, e.g., .rda .Rdata files. approach generally recommended, particularly large datasets. create simple .rda dataset, send working directory.\nData packages either accessible via lazy loading (allows increased accessibility) data() function. former approach, package data objects loaded upon loading package environment, however promises created, requiring object loaded name entered session. Lazy loading always occurs package R code optional package data. Lazy loading data can specified ‘LazyData’ field package’s DESCRIPTION file (see ). Examples lazy loaded data include objects package datasets. Note require data() loading:latter, common approach, data(*foo*) must called allow availability dataset foo.","code":"\nx <- rnorm(5)\nsave(x, file = \"x.rda\")\ndatasets::BOD # data describing Biochemical Oxygen Demand  Time demand\n1    1    8.3\n2    2   10.3\n3    3   19.0\n4    4   16.0\n5    5   15.6\n6    7   19.8\nlibrary(asbio)\ndata(bighorn.sel) # bighorn sheep resource use and availability\nbighorn.sel          resources avail  y1  n1\n1          Riparian  0.06   0 445\n2           Conifer  0.13   6 445\n3       Mt. Shrub 1  0.16   9 445\n4             Aspen  0.15  18 445\n5      Rock outcrop  0.06  14 445\n6  Sage/Bitterbrush  0.17  63 445\n7  Windblown ridges  0.12  46 445\n8        Mt shrub 2  0.04  62 445\n9  Prescribed burns  0.09 178 445\n10         Clearcut  0.02  49 445"},{"path":"ch10.html","id":"r-code-the-r-subdirectory","chapter":"10 Building R Packages","heading":"10.4 R Code (the r Subdirectory)","text":"Code functions generally stored r directory, .r files. IDEs like RStudio, contain options generation .r scripts, e.g., File \\(>\\) New File \\(>\\) R script, can greatly aid process. Single .r files can contain multiple functions, although one function per file approach may easier manage.\n","code":""},{"path":"ch10.html","id":"documentation-the-man-subdirectory","chapter":"10 Building R Packages","heading":"10.5 Documentation (the man Subdirectory)","text":"functions become complex, may become difficult keep track meaning function arguments, characteristics function output, using simple notes--self approach, e.g., . R documentation (.rd) files provide framework documenting, R functions, methods, datasets. prompt() family functions can greatly facilitate creation .rd files. Example 10.1, function package.skelton() used functions prompt() promptData build documentation skeletons functions datasets, respectively. instance, code applied create documentation function f().code causes file f.rd generated, sent working directory editing (Fig 10.3).\nFigure 10.3: Documentation file skeleton toy function f()\nguidance completing .rd files provided notes skeleton generated prompt(). removed notes Fig 10.3 save space. , authoritative resource documentation building Writing R Extensions.Package documentation files can placed man directory compiled single documentation entity package compiled98, compiled singly R objects user deems worthy documentation. latter approach facilitated Preview widget RStudio, available upon opening .rd file. Running Preview file f.rd resulting .html preview shown Fig 10.4.\nFigure 10.4: Preview .html generated code shown Fig 10.3.\n.rd file can converted legible documentation .html, .pdf formats depositing file R directory containing R CMD routines (e.g., bin/x64), running appropriate R CMD algorithms command line. Windows requires first navigating directory containing R CMD routines using Windows shell command line editor (see Ch 9). Important R CMD documentation rendering algorithms include:R CMD Rd2pdf foo.rd`, can used compile documentation file foo.rd .pdf document.R CMD Rd2txt foo.rd`, can used compile documentation file foo.rd pretty text format.R CMD Rdconv foo.rd`, can used compile documentation file foo.rd variety formats including plain text, HTML, LaTeX.\n","code":"\nf <- function(x, y) x + y\nprompt(f, filename = \"f\")Created file named 'f'.\nEdit the file and move it to the appropriate directory."},{"path":"ch10.html","id":"the-description-file","chapter":"10 Building R Packages","heading":"10.6 The DESCRIPTION File","text":"DESCRIPTION file contains basic information package. DESCRIPTION file skeleton mypkg package, created package.skeleton() Example 10.1, shown Fig 10.5.\nFigure 10.5: DESCRIPTION file toy mypkg package.\nDESCRIPTION file Debian control file format (see ?read.dcf. Specifically, fields DESCRIPTION must start field name, comprised ASCII (Ch 12) printable characters, followed colon. value field given colon additional space (Fig 10.5). allowed, field values longer one line must use space tab start new line. Specification ‘Package’, ‘Version’, ‘License’, ‘Description’, ‘Title’, ‘Author’, ‘Maintainer’ fields, shown Fig 10.5, mandatory.‘Package’ field gives name package.‘Version’ field gives user-specified package version. sequence least two non-negative integers separated single usages ‘.’ /‘-’ characters.‘Title’ field provide descriptive title package. use title case (capitals principal words), continuation lines.‘Author’ field describes wrote package. Note package contains wrappers work others, included src directory, sole author.‘Maintainer’ field provides single name followed valid email address angle brackets (Fig 10.5).‘Description’ field provide comprehensive description package . Several (complete) sentences, complete, although limited one paragraph. field value start package name, ‘package...’.‘License’ field provides standard open source\nlicense information package. Failure specify license information may prevent others legally using, distributing package. Standard licenses available (https://www.R-project.org/Licenses/) include GPL-2, GPL-3, LGPL-2, LGPL-2.1, LGPL-3, AGPL-3, Artistic-2.0, BSD_2_clause, BSD_3_clause MIT. See Writing R Extensions information.optional fields include: ‘Copyright’, ‘Date’, ‘Depends’, ‘Imports’, ‘Suggests’, ‘Enhances’, ‘LinkingTo’, ‘Additional_repositories’, ‘SystemRequirements’, ‘URL’, ‘BugReports’, ‘Collate’, ‘LazyData’, ‘KeepSource’, ‘ByteCompile’, ‘UseLTO’, ‘StagedInstall’, ‘Biarch’, ‘BuildVignettes’, ‘VignetteBuilder’, ‘NeedsCompilation’, ‘OS_type’, ‘Type’. See Writing R Extensions information fields.\n","code":""},{"path":"ch10.html","id":"the-namespace-file","chapter":"10 Building R Packages","heading":"10.7 The NAMESPACE File","text":"R namespace management system allows package authors specify variables package can exported package users, variables imported packages. mandatory NAMESPACE file toy mypkg package extremely simple (Fig 10.6). indicates four objects contained package, associated names, can exported. one wishes export objects names large package, simpler specify: exportPattern(.).\nFigure 10.6: NAMESPACE file toy mypkg package.\nImport exported variables packages requires specification import importFrom. import directive imports exported variables specified package(s). Thus, import(foo)\nimports exported variables package foo. package requires exported variables package, importFrom can used. NAMESPACE directive importFrom(foo, f, g) indicates f g package foo imported.ensure S3 methods package classes available, one must register methods NAMESPACE file. instance, package function print.foo() serves print method class foo, one include S3method(print, foo) line NAMESPACE.\n## Package Compilation\ncompilation C Fortran files (Ch 9), conversion individual .rd files, building installation user-designed package requires depositing package contents R directory containing R CMD routines.[providing navigation address package R CMD]\\(^{,}\\)[Probably R CMD routine isn’t clearly tied development R packages Rcmd BATCH, used running R scripts command line.] , one must run R CMD routines command line, requiring (Windows) user navigate directory containing R CMD routines Windows shell command line. unnecessary Unix-like operating system (including MacOS), algorithms can called directly computer’s command line. R CMD routines package building include:R CMD build foo, build package foo.R CMD check foo.tar.gz, check tarballed package foo.tar.gz, created R CMD build.R CMD INSTALL foo.tar.gz can used install package foo.\nExample 10.2  \\(\\text{}\\)\nContinuing Example 10.1, complete following steps package building/compression, checking, installation.Build tarballed version mypkg package using: R CMD build mypkg.check tarballed version package using: R CMD check mypkg_0.1.tar.gz.Note checks R CMD check can extensive (output just excerpt). Checks even taxing one uses option ---cran performs assessments one must pass submission CRAN.Finally, Install mypkg package workstation using: R CMD INSTALL mypkg_0.1.tar.gz.\\(\\blacksquare\\)","code":""},{"path":"ch10.html","id":"exercises-9","chapter":"10 Building R Packages","heading":"Exercises","text":"Create .rd documentation file function McIntosh’s index site biodiversity Exercise 2 8. Make .pdf .html .rd file using appropriate R CMD routines.Create .rd documentation file function McIntosh’s index site biodiversity Exercise 2 8. Make .pdf .html .rd file using appropriate R CMD routines.Create R package consisting least one function. Specifically,\nCreate skeleton package using package.skeleton().\nFinish .rd file(s) man.\nComplete DESCRIPTION file.\nComplete NAMESPACE file.\nBuild package using R CMD build.\nCheck package using R CMD check. Modify package (necessary) ERRORS WARNINGS occur.\nCreate R package consisting least one function. Specifically,Create skeleton package using package.skeleton().Finish .rd file(s) man.Complete DESCRIPTION file.Complete NAMESPACE file.Build package using R CMD build.Check package using R CMD check. Modify package (necessary) ERRORS WARNINGS occur.","code":""},{"path":"ch11.html","id":"ch11","chapter":"11 Interactive and Web Applications","heading":"11 Interactive and Web Applications","text":"“user interface like joke. explain , ’s good.”- Martin LeBlanc, Iconfinder cofounder","code":""},{"path":"ch11.html","id":"introduction-to-guis","chapter":"11 Interactive and Web Applications","heading":"11.1 Introduction to GUIs","text":"GUIs (Graphical User Interfaces) allow users interact software using graphical icons point--click specifications. interactive control components GUI called widgets. following commonly used GUI widgets:\nbutton: typically GUI controller binary (e.g., /run/don’t run) operations.radiobutton: controller allowing selection group mutually-exclusive options linked specific operations.checkbutton: controller allows selection binary multiple mutually-exclusive options, often linked second variable, allowing flexible rendering secondary set widgets.spinbox: Provides “spin-able” set mutually exclusive options can selected linked operations.combobox: text field popdown selection list.slider: sliding controller defines numeric value linked variable changes uniformly range.message box: message window typically prompts user response corresponding linked operation.scrollbar: modifiable viewport scrollable object (e.g., text can examined line line).pulldown menus: Interactive menus pulldown tabs menubuttons specify operations, potentially including links GUIs.R allows building GUIs run functions interact graphics using number methods language frameworks.\nnoted R GUIs mixed bag. plus side, R GUIs: 1) increase user-friendliness allowing point click operations, 2) allow rapid visual assessment alteration function arguments via widgets, 3) often amenable graphics manipulations, 4) often useful data exploration heuristic demonstrations. hand, R GUIs: 1) often result loss flexibility controlling functions, 2) may contain visually confusing mish-mash widgets, 3) constitute mysterious black boxes, contrary “mission statement” R (Chambers 2008). , command line (non-GUI) code entry allows exact record characteristics given objects, specifications provided functions. allows straightforward tracking, dissemination, repeatability computational analyses.explore three methods generating GUIs, named principal R package allowing implementation: tcltk, plotly, shiny.","code":""},{"path":"ch11.html","id":"tcltk","chapter":"11 Interactive and Web Applications","heading":"11.2 tcltk","text":"R distribution package tcltk (pronounced: tickle tee kay) allows building GUIs providing binding wrapper Tcl language, via Tk toolkit, configuration called Tcl/Tk (Ousterhout 1991)99. programming, binding refers application programming interface (API) provides glue code allow programming language implement foreign language software package (Wikipedia 2024e). Python bindings Tcl/Tk provided Python library tkinter included Python standard library packages. Much better support exists tkinter tcltk. Additionally, many non-Tcl/Tk approaches exist GUI building Python, although included Python standard library.Lack guidance tcltk package likely due absence large user group. Assistance creation tcltk GUIs can found several older articles R News (since replaced R Journal) (Dalgaard 2001, 2002; Fox 2007), book “Programming GUIs R” (Lawrence Verzani 2018), GUI code number newer R packages, including Rcmdr (Fox 2005; Fox, Marquez, Bouchet-Valat 2023) asbio (Aho 2023). Despite resources, however, expected users refer Tcl/Tk package manual argument lists descriptions tcltk functions. Arguments tcltk functions (generally) names functionality Tcl/tk equivalents, although experimentation may necessary.\nTcl/Tk cross platform, uses facilities particular underlying OS. Xlib (X11) (windowing system, written C, bitmap displays) Unix/Linux, Cocoa Mac OS, Graphics Device Interface (GDI) Windows.-called Themed Tk (Ttk) GUIs often advantages older Tk GUIs, including anti-aliased font rendering, part Tk distribution since Tcl version 8.5. Naming conventions tcltk indicate whether functions binding Tk Ttk operations. former function names start tk, latter start ttk.Notably, tcltk GUIs use manipulate R graphics devices, particularly slider widgets, may work poorly native RStudio graphics device: RStudioGD. Thus, run sorts GUIs RStudio, one open non-RStudioGD device using:\nExample 11.1  \\(\\text{}\\)\nbinding mechanisms tcltk can viewed examining underlying code seminal functions. tcltk function tcl() provides generic interface calling Tk Tcl command100. Indeed, many tcltk commands simply calls tcl().see tcl() calls .Tcl.objv() whose arguments, turn, formatted .Tcl.args.objv().function .Tcl.objv() calls underlying C algorithm, .C_dotTclObjv(), using .External() ostensibly binds tcl() Tcl/Tk.compiled C executable (Section 9.1), tcltk.dll, housed tlctk package libs/x64 directory (Ch 10).\n\\(\\blacksquare\\)Example 11.2  \\(\\text{}\\) initial foray tcltk GUI-building create button interface whose purpose provide message, means destruction.Line 1, load tcltk package.Line 2, use use tktoplevel() hierarchically define “top level” widget object tt.Lines 3-4, create text message object, hello, spacer object, spacer. latter used make room message button created next two lines code.Lines 5-6 button widget object DM.created, using function tkbutton(). first argument name parent widget, tt. text argument provides text label button. arguments foreground, background, padx used define foreground color (color button text label), background color button, make button wider, respectively. command argument defines function button initiates. case, function tkdestroy(), destroys GUI.Line 8, tkpack() used place button parent widget.GUI shown Fig 11.1.\nFigure 11.1: simple tcltk GUI.\n\n\\(\\blacksquare\\)","code":"\ndev.new(noRStudioGD = TRUE)\nrequire(tcltk)\ntclfunction (...) \n.Tcl.objv(.Tcl.args.objv(...))\n<bytecode: 0x0000020d6ae6cc38>\n<environment: namespace:tcltk>\n.Tcl.objvfunction (objv) \nstructure(.External(.C_dotTclObjv, objv), class = \"tclObj\")\n<bytecode: 0x0000020d6ae70228>\n<environment: namespace:tcltk>\ntcltk:::.C_dotTclObjv$dllDLL name: tcltk\nFilename: C:/Program\n       Files/R/R-4.4.2/library/tcltk/libs/x64/tcltk.dll\nDynamic lookup: FALSEtt <- tktoplevel()\nhello <- tkmessage(tt, text = \"Hello world!\")\nspacer = tklabel(tt, padx = 20)\nDM.but <- tkbutton(tt, text = \"Exit\", foreground = \"red\",\n                   background = \"lightgreen\", padx = 10,\n                   command = function() tkdestroy(tt))\ntkpack(hello, spacer, DM.but)"},{"path":"ch11.html","id":"asswidget","chapter":"11 Interactive and Web Applications","heading":"11.2.1 Assigning and Manipulating Widget Values","text":"often useful “remember” object characteristics assignment values course GUI’s usage. example, may necessary count number times button pressed, display particular message based previous response. GUI actions carried local variables functions, modifications variables lost function exits. usually good practice, one can use super assignment operator <<- inside function create global variables. retain values function exits.\ntclVar() function can used create empty specific values, can used call functions tcltk package. example, specify empty tclVar() value, one use:access myvar information widgets R one use:Conjoined use super-assignment operator tclVar() tcl() often important altering object parameters within tcltk functions.\n","code":"\nmyvar <- tclVar('')\nrmyvar <- tclvalue(myvar)"},{"path":"ch11.html","id":"user-functions-and-tcltk-guis","chapter":"11 Interactive and Web Applications","heading":"11.2.2 User functions and tcltk GUIs","text":"Callbacks functions linked GUI events. tclk functions can user-defined, although arguments. Callbacks, user defined otherwise, generally executed using command argument widget function. Recall, example, use tkbutton(tt, command = functiton() tkdestroy) Example 11.2. general, callback function foo() called using command = foo() command = substitute(foo()). Use substitute(foo()) allows substitution variable values foo(). Calling function bar() within callback foo() may require coding similar foo <- function(){substitute(bar())}. See, instance, asbio::anm.ci.tck().\nExample 11.3  \\(\\text{}\\)\nConsider following silly example finding sum two numbers.Line 1, use tktoplevel() define “top level” widget.Line 2, specify empty initial values variables tw1 tw2 using tclVar(). values editable users via tkentry() widgets.Lines 3-4, use function tkentry() provide widgets users enter numbers summed.Lines 6-9, create function sumf. function tclvalue(), used compute summation object temp, allows Tcl variables tclVar() evaluated R. variables, however, class character, require .numeric(), shown, mathematical evaluation. One Line 8 (final line code sumf, tkconfigure() used potentially change ans, tkentry() object defined Line 11.Line 11, tkentry() object ans created initial empty value assigned.Lines 12-16, widgets placed GUI using tkgrid(). use grid geometry approaches including tkgrid() elaborated next. tkbutton widget final (bottom) grid GUI calls sumf using either command = sumf, shown, command = substitute(sumf()).\nresulting GUI shown Fig 11.2.\nFigure 11.2: simple tcltk GUI, demonstrating use tclVar() tclvalue().\n\\(\\blacksquare\\)","code":"tt <- tktoplevel()\ntw1 <- tclVar(''); tw2 <- tclVar('')\ntke1 <- tkentry(tt, width = 6, textvariable = tw1, justify = \"center\")\ntke2 <- tkentry(tt, width = 6, textvariable = tw2, justify = \"center\")\n\nsumf <- function(){\n  temp <- as.numeric(tclvalue(tw1)) + as.numeric(tclvalue(tw2))\n  tkconfigure(ans, text = paste(temp))\n}\n\nans <- tklabel(tt, text = '', background=\"white\", relief = \"sunken\", padx = 20)\ntkgrid(tke1, tklabel(tt, text = '+'), tke2, tklabel(tt, text = '='), ans)\ntkgrid(tklabel(tt, text = ''), columnspan = 5)\ntkgrid(tkbutton(tt, text = 'Get Sum!', foreground = \"red\",\n                   background = \"lightgreen\", command = sumf),\n       columnspan = 5, sticky = \"e\")"},{"path":"ch11.html","id":"gui-geometry","chapter":"11 Interactive and Web Applications","heading":"11.2.3 GUI Geometry","text":"important consideration GUI development geometry management, e.g., dimensions GUI organization widgets. default, Tcl/Tk GUI windows autosized hold widgets added. Widgets may reorganized sizes windows altered. Window becomes small contain widgets, last widget added first removed.initial size GUIs can specified using function tkcanvas(). result code shown Fig 11.3\nFigure 11.3: tcltk GUI whose initial width specified using tkcanvas().\nThree different geometry managers available Tcl/Tk inserting widgets GUIs. called placer, packer, grid manager. placer tool seldom used GUI creation (Dalgaard 2001). Thus, concentrate GUI construction using packer grid manager approaches. one approaches generally used creation GUI. initial Examples 11.2 11.3 use simple applications packing grid management, respectively.","code":"\ntt <- tktoplevel()\ntktitle(tt) = \"Wide GUI\"\ndim <- tkcanvas(tt, height = 30, width = 500)\ntkgrid(dim)"},{"path":"ch11.html","id":"packing","chapter":"11 Interactive and Web Applications","heading":"11.2.3.1 Packing","text":"function tkpack() packs widgets around edges conceptual cavity. Control process provided side, options: \"left\", \"right\", \"top\" \"bottom\".\nExample 11.4  \\(\\text{}\\)\nNote result code (Fig 11.4).Line 1, top level widget designated.Line 2, character vector created, containing possible side options function tkpack().Lines 3-5, four item list generated containing four tkbutton widgets.Lines 6-7, buttons accessed buttons list packed, order, specified locations \"top\", \"right\", \"bottom\", \"left\". argument fill = \"\" ensures buttons occupy allocated parcels respect tkpack() conceptual central cavity. top button specified first, takes entire top GUI. right button, codified next, occupies entire right-side GUI, except area now occupied top, . object fill parcel can anchored GUI location using tkpack() argument anchor. accomplished specifying compass-style values like \"n\" \"sw\" place widget middle top, bottom left parcel, respectively. default option anchor = \"center\".\nFigure 11.4: demonstration result packing using tkpack(). Code follows (Dalgaard 2001).\n\\(\\blacksquare\\)Example 11.5  \\(\\text{}\\)\nCalculator construction often used pedagogic exercise computer programming. extended example packing using tkframe(), build tcltk calculator GUI. example indebted lecture notes 2011 statistical programming course UC Berkeley.important coding concept used pairing base R functions parse() (converts string expression) eval() (evaluates expression). combination allows mathematical evaluation character string. Consider string \"9 * 3\". mathematical solution can obtained using:\ncalculator GUI require three functions: mkput(), clearit(), docalc(). functions creates global variable, calcinp, using super assignment operator, <<-, provides input calculator. , three functions, tkconfigure() used change calculator’s display, based input GUI calculator keys.Line 1 chunk , calcinp initially set empty character string, .e., calcinp <- ''.Line 1 chunk , calcinp initially set empty character string, .e., calcinp <- ''.Lines 3-8, callback function mkput defined. Note mkput contains argument-less function. allows mkput argument, sym, satisfying tcltk requirement argument-less callbacks. code Line 5, calcinp <<- paste(calcinp, sym, sep=''), generates global, updated form calcinp, combines older calcinp value new calculator key specification, sym. resulting string placed display using tkconfigure().Lines 3-8, callback function mkput defined. Note mkput contains argument-less function. allows mkput argument, sym, satisfying tcltk requirement argument-less callbacks. code Line 5, calcinp <<- paste(calcinp, sym, sep=''), generates global, updated form calcinp, combines older calcinp value new calculator key specification, sym. resulting string placed display using tkconfigure().callback function clearit , clears display (Line 10), redefines calcinp empty string (Line 11).callback function clearit , clears display (Line 10), redefines calcinp empty string (Line 11).callback function docalc , evaluates general eval(parse(text = calcinp)) framework created key entry, provides exception handling case key stroke errors using (class(result) == 'try-error'); calcinp <<- 'Error' Lines 15-16. Importantly, function try() (Line 14) assign class try-error expression fails.\ncall three functions GUI , generated code (Lines 21-60).largest calculator code component defines form arrangement calculator key (27-60). Note buttons packed, row, using tkpack() within tkframe() objects. button widgets use command = mkput except clear key, uses command = clearit, equals key, uses command = docalc.slightly modified form GUI (colored buttons)101 shown Fig 11.5.\nFigure 11.5: Tcl/Tk calculator GUI generated using R package tcltk.\nPython library tkinter provides well supported binding resource Tcl/Tk. know (Ch 9) Python code can run R, using package reticulate. Fig 11.6 shows analogous calculator one shown Fig 11.5, generated R via Python script calc.py, contained book website. important note resulting GUI generated RStudio R chunk, via reticulate, code engines running GUI Python, thus, actually require R.function reticulate::source_python() allows one access Python source code.\n\nFigure 11.6: Tcl/Tk calculator GUI generated using Python code via Python binding library tkinter. Code follows Python demo geeksforgeeks website.\n\\(\\blacksquare\\)\n","code":"tt <- tktoplevel()\nedge <- c(\"top\",\"right\",\"bottom\",\"left\")\nbuttons <- lapply(1:4, \n                  function(i) tkbutton(tt, text = edge[i],\n                     background = \"lightgreen\", foreground = \"red\"))\nfor (i in 1:4)\ntkpack(buttons[[i]], side=edge[i], fill = \"both\")\ntxt = \"9 * 3\"\neval(parse(text = txt))[1] 27calcinp <- ''\n\nmkput <- function(sym){\n       function(){\n          calcinp <<- paste(calcinp, sym, sep='')\n            tkconfigure(display, text = calcinp)\n          }\n}clearit <- function(){\n      tkconfigure(display, text = '')\n      calcinp <<- ''\n      }docalc <- function(){\n      result = try(eval(parse(text = calcinp)))\n      if(class(result) == 'try-error')\n        calcinp <<- 'Error'\n      else calcinp <<- result\n      tkconfigure(display, text = calcinp)\n      calcinp <<- ''\n      }base <- tktoplevel()\ntkwm.title(base,'Calculator')\n\ndisplay <- tklabel(base,justify='right',background=\"white\",\n                   relief=\"sunken\", padx = 50)\ntkpack(display,side='top')\nrow1 <- tkframe(base)\ntkpack(tkbutton(row1,text='7',command=mkput('7'),width=3),side='left')\ntkpack(tkbutton(row1,text='8',command=mkput('8'),width=3),side='left')\ntkpack(tkbutton(row1,text='9',command=mkput('9'),width=3),side='left')\ntkpack(tkbutton(row1,text='+',command=mkput('+'),width=3),side='left')\ntkpack(row1,side='top')\n\nrow2 <- tkframe(base)\ntkpack(tkbutton(row2,text='4',command=mkput('4'),width=3),side='left')\ntkpack(tkbutton(row2,text='5',command=mkput('5'),width=3),side='left')\ntkpack(tkbutton(row2,text='6',command=mkput('6'),width=3),side='left')\ntkpack(tkbutton(row2,text='-',command=mkput('-'),width=3),side='left')\ntkpack(row2,side='top')\n\nrow3 <- tkframe(base)\ntkpack(tkbutton(row3,text='1',command=mkput('1'),width=3),side='left')\ntkpack(tkbutton(row3,text='2',command=mkput('2'),width=3),side='left')\ntkpack(tkbutton(row3,text='3',command=mkput('3'),width=3),side='left')\ntkpack(tkbutton(row3,text='*',command=mkput('*'),width=3),side='left')\ntkpack(row3,side='top')\n\nrow4 <- tkframe(base)\ntkpack(tkbutton(row4,text='0',command=mkput('0'),width=3),side='left')\ntkpack(tkbutton(row4,text='(',command=mkput('('),width=3),side='left')\ntkpack(tkbutton(row4,text=')',command=mkput(')'),width=3),side='left')\ntkpack(tkbutton(row4,text='/',command=mkput('/'),width=3),side='left')\ntkpack(row4,side='top')\n\nrow5 <- tkframe(base)\ntkpack(tkbutton(row5,text='.',command=mkput('.'),width=3),side='left')\ntkpack(tkbutton(row5,text='^',command=mkput('^'),width=3),side='left')\ntkpack(tkbutton(row5,text='C',command=clearit,width=3),side='left')\ntkpack(tkbutton(row5,text='=',command=docalc,width=3),side='left')\ntkpack(row5,side='top')\nlibrary(reticulate)\npy_run_file(source_python(\"http://www2.cose.isu.edu/~ahoken/book/calc.py\"))"},{"path":"ch11.html","id":"grid-manager","chapter":"11 Interactive and Web Applications","heading":"11.2.3.2 Grid Manager","text":"Use tkpack() tkframe() provides great deal flexibility creating GUI layouts. , however, insufficient handling number issues including lining widgets vertically horizontally. grid manager function tkgrid() can used lay widgets rows columns using arguments column row. Importantly, column = 0 row = 0 equate first column first row, respectively, GUI container widget. Additional important\ntkgrid() arguments include columnspan, rowspan, sticky. latter argument analogous side tkpack().Example 11.6  \\(\\text{}\\)\ncallback function creates single large blue dot R graphics device whose vertical position can altered slider widget.operation evalq(foo), (Line 2) , equivalent eval(quote(foo)). operation quote(foo) simply returns argument foo object class “call”.\n}GUI code uses grid geometry place widgets specified GUI rows columns.Line 6, insure interactive work RStudio system creating non-RStudio graphics device default device \"RStudioGD\". code work inside outside RStudio.Line 8, create environment slider widget using new.env().Line 9, use use tktoplevel() hierarchically define “top level” widget object tt, make title.Line 10, define 50 initial value slider widget created.Line 11, Tk label created based slider output. Note pairing tclVar() input tclvalue() output. process, SliderValueLabel label object configured make value equal SliderValue object.Lines 12-13, SliderValueLabel inserted two text strings grid geometry.Lines 16-18, slider parameterized using function tkscale(). use substitute() allows substitution values variables bound plot.() function.Line 20, slider placed GUI column 0 row 1 (first column second row).Lines 21-22, message created placed GUI column 3 row 1 (fourth column second row).\nform final GUI shown Figure 11.7.\nFigure 11.7: tcltk GUI manipulating R plot.\n\\(\\blacksquare\\)Example 11.7  \\(\\text{}\\)\nanother grid manager example radiobutton GUI allows selection bacterial phylum printing \"Correct\", \"Incorrect\" text console, based button selection. also embeds photo.Line 1, top level widget, tt, designated.Line 2, GUI title created.Lines 3-4, text “phylum shown?” placed column 1, row 1 position, using grid manager function tkgrid().Lines 5-9, character vector bacterial phylum names created use GUI.Line 11 initial phylum selection specified. use tclVar(values[0]) means selection initially designated.Line 13, function tkimage.create() used import photo .gif formatting (currently accepted format). first argument \"photo\" indicates image created photo. second argument creates object name import, \"cyano\" called later code.Lines 15-17, callback function, callback() created print text \"correct\" Cyanobacteriota selected, print \"incorrect\" selection made.Line 19, embedded frame created hold radiobuttons.Lines 20-27, sapply() used run user-defined function embeds radiobuttons level character vector values.\nLine 21-23, function creates object radio_button using ttkradiobutton(). Note top-level path name, tt given first argument, initial radiobutton designation given second argument, arguments text value change levels vaues change. function callback() called using ttkradiobutton() command argument respond selected radiobutton.\nLines 25-26, radiobuttons stacked, one row time, using tkgrid(), sapply() cycles levles values.\nLine 21-23, function creates object radio_button using ttkradiobutton(). Note top-level path name, tt given first argument, initial radiobutton designation given second argument, arguments text value change levels vaues change. function callback() called using ttkradiobutton() command argument respond selected radiobutton.Lines 25-26, radiobuttons stacked, one row time, using tkgrid(), sapply() cycles levles values.Lines 29-30, aesthetic empty row created bottom column one create additional space.Lines 31-32, object l created function ttklabel() hold image object cyno, created Line 13.Lines 33-34, image embedded entirety column two.final form GUI shown Fig 11.8.\n\nFigure 11.8: radiobutton tcltk GUI. Photo CSIRO, CC 3.0, https://commons.wikimedia.org/w/index.php?curid=3548094\n\\(\\blacksquare\\)","code":"plot.me <- function(){\n  y <- evalq(tclvalue(SliderValue)) # Evaluate the expression\n  plot(1, as.numeric(y),xlab = \"\", ylab = \"%\", xaxt = \"n\", ylim = c(0,100),\n       cex = 4, col = 4, pch = 19)\n}if(names(dev.cur()) == \"RStudioGD\") dev.new(noRStudioGD = TRUE)\n\nslider.env <<- new.env()\ntt <- tktoplevel(); tkwm.title(tt, \"Slider demo\")\nSliderValue <- tclVar(\"50\")\nSliderValueLabel <- tklabel(tt, text = as.character(tclvalue(SliderValue)))\ntkgrid(tklabel(tt, text = \"Slider Value: \"),\n       SliderValueLabel, tklabel(tt, text = \"%\"))\ntkconfigure(SliderValueLabel, textvariable = SliderValue)\n\nslider <- tkscale(tt, from = 100, to = 0, showvalue = F,\n                  variable = SliderValue, resolution = 1,\n                  orient = \"vertical\", command = substitute(plot.me()))\n\ntkgrid(slider, column = 0, row = 1, columnspan = 2)\nmessage = tkmessage(tt, text = \"Move the slider to see changes in the plot\")\ntkgrid(message, column = 3, row = 1)tt <- tktoplevel()\ntkwm.title(tt, \"Bacterial phyla\")\ntkgrid(tklabel(tt, text = \"Which phylum is shown?\", padx = 5,\n               pady = 5, font = \"bold\"), column = 1, row = 1)\n\nvalues <- c(\"Acidobacteriota\", \"Armatimonadota\",\n            \"Caldisericota\", \"Cyanobacteriota\",\n            \"Elusimicrobiota\", \"Spirochaetota\",\n            \"Thermomicrobia\")\n\nvar <- tclVar(values[0]) # initially, no phyla selected\n\ntkimage.create(\"photo\", \"cyano\", file = \"figs11/cyano.gif\")\n\ncallback <- function() ifelse(tclvalue(var) == \"Cyanobacteriota\",\n                              print(\"Correct\"),\n                              print(\"Incorrect\"))\n\nlf <- ttkframe(tt)\nsapply(values, function(x) {\n  radio_button <- ttkradiobutton(tt, variable = var,\n                                 text = x, value = x,\n                                 command = callback)\n\n tkgrid(radio_button, pady = 0, padx = 5, sticky = \"nw\",\n        column = 1, rowspan = 1)\n })\n\ntkgrid(tklabel(tt, text = \"\"), sticky = \"n\", column = 1,\n       row = 9, columnspan = 1)\nl <- ttklabel(tt, image = \"cyano\", relief = \"ridge\")\ntkgrid(l, sticky = \"nw\", rowspan = 10, column = 2,\n       row = 0, pady = 25, padx =  10)"},{"path":"ch11.html","id":"widget-modifications","chapter":"11 Interactive and Web Applications","heading":"11.2.4 Widget Modifications","text":"Tcl/Tk provides shared modification settings many widgets. include standard arguments foreground (widget foreground color, see choices ), background (widget background color), image (image display widget)102, relief (3D appearance widget), font, text (text string placed widget), among many others. aware, however, standard Tk widget modifiers may always align Ttk modifiers.Example 11.8  \\(\\text{}\\)example GUI working (non-functional) widgets allows demonstration relief, background, foreground color options different types widgets.See Fig 11.9.\nFigure 11.9: Standard widget modifications. Relief styles varied within widget type, background foreground colors varied among widget types.\n\\(\\blacksquare\\)","code":"types = c(\"flat\", \"groove\", \"raised\", \"ridge\",\n          \"solid\", \"sunken\")\nbg = c(\"beige\", \"AntiqueWhite1\", \"aquamarine4\", \"burlywood3\")\nfg = c(\"BlueViolet\",\"aquamarine3\", \"white\", \"black\")\n          \nbase = tktoplevel()\ntkwm.title(base,\"Widget Styles\")\n\ncnames <- tkframe(base)\ntkpack(tklabel(cnames, text = \"Labels\", font = \"bold\"),\n       side = \"left\", padx = 3)\ntkpack(tklabel(cnames, text = \"Buttons\", font = \"bold\"),\n       side = \"left\", padx = 17)\ntkpack(tklabel(cnames, text = \"Radiobuttons\", font = \"bold\"),\n       side = \"left\", padx = 0)\ntkpack(tklabel(cnames, text = \"Sliders\", font = \"bold\"),\n       side = \"left\", padx = 22)\ntkpack(cnames, side = \"top\", fill = \"both\")\n\nmkframe <- function(type){\n  fr <- tkframe(base)\n  tkpack(tklabel(fr, text = type, relief = type, \n                 fg = fg[1], bg = bg[1]),\n         side = \"left\", padx = 5)\n  tkpack(tkbutton(fr, text = type, relief = type, \n                 fg = fg[2], bg = bg[2]),\n         side = \"left\", padx = 30)\n  tkpack(tkradiobutton(fr, text = type, relief = type, \n                 fg = fg[3], bg = bg[3]),\n         side = \"left\", padx = 10)\n  tkpack(tkscale(fr, from = 0, to = 10, showvalue = T,\n                 variable = 1, resolution = 1,\n                 orient = \"horizontal\",\n                 relief = type, fg = fg[4], \n                 bg = bg[4]), side = \"left\", padx = 14)\n\n  tkpack(fr, side = \"top\", pady = 5)\n}\n\nsapply(types, mkframe)"},{"path":"ch11.html","id":"additional-tcltk-packages-and-toolkits","chapter":"11 Interactive and Web Applications","heading":"11.2.5 Additional tcltk Packages and Toolkits","text":"Several R packages developed streamline extend capacities tcltk package. include fgui (Hoffmann Laird 2009) PBSmodelling (Jon T. Schnute, Couture-Beil, Haigh 2023; Jon T. Schnute et al. 2013) provides wrappers Tcl/Tk routines simplify facilitate GUI creation. gWidgets2 package ambitiously sought create R simplifying binding frameworks several GUI toolkits including GTK, qt, Tcl/Tk103. Currently, however, gWidgets2 port tcltk, called gWidgets2tcltk, working. gWidgets2tcltk package currently used build interactive self test questions pedagogic statistics package asbio (Fig 11.10).\nFigure 11.10: self-test GUI using gWidgets2tcltk function gcheckboxgroup. GUI code type: fix(selftest.typeIISS.tck1).\n\nnumber Tcl/Tk extensions R available SciViews family packages (Grosjean 2024), including svDialogs (attempt creating standard cross-platform dialog boxes), svGUI, tcltk2. packages, however, updated (least CRAN) several years.\n","code":"\nasbio::selftest.typeIISS.tck1()"},{"path":"ch11.html","id":"JS","chapter":"11 Interactive and Web Applications","heading":"11.3 JS and JSON Interactive Apps","text":"Many newer interactive R applications designed implemented using JavaScript104 (JS) JavaScript Object Notation105 (JSON). GUIs generated approaches often embedded HTML106 format, thus can viewed web browsers.several widely used R packages generating sorts apps. two popular plotly shiny.plotly creates interactive HTML/web graphics via plotly.js JS library interactive charts.plotly creates interactive HTML/web graphics via plotly.js JS library interactive charts.shiny package designed RStudio developers utilizes packages, chiefly htmltools htmlwidgets.107 provide direct interfaces HTML embedded GUIs R.shiny package designed RStudio developers utilizes packages, chiefly htmltools htmlwidgets.107 provide direct interfaces HTML embedded GUIs R.next two sections Chapter focus packages approaches.\n","code":""},{"path":"ch11.html","id":"plotly","chapter":"11 Interactive and Web Applications","heading":"11.4 plotly","text":"\npackage plotly (Sievert 2020), uses R package jsonlite, provides R binder JSON. JSON code read JS library plotly.js create interactive HTML embedded graphics (Fig 11.11). Charts resulting process interactive standardized plotly format, although don’t represent GUIs conventional sense.\nFigure 11.11: graph Sievert (2020) shows process creating HTML-embedded plotly chart graph generated R.\nExample 11.9  \\(\\text{}\\)provide simple demonstration bring libraries, including plotly, world.emissions data package asbio.Plotly graphs rendered using function plot_ly().Line 8, call plot_ly(). Note use tilde operator call x y axis variables, .e., x = ~year, y = ~co2.Lines 9-18, call additional plot characteristics using tidyverse pipe operators.\nLine 9 use add_lines() add line trace plot.\nPlot characteristics can modified large number ways using lists within function layout (Lines 10-18).\nLine 9 use add_lines() add line trace plot.Plot characteristics can modified large number ways using lists within function layout (Lines 10-18).result shown Fig 11.12.\nviewing document HTML, lines plot interactive, plot contain menu allows summarization single multiple data points, panning zooming.\n\nFigure 11.12: Simple plolty chart interactive trace standard plotly menu.\n\n\\(\\blacksquare\\)","code":"library(tidyverse); library(plotly)\nlibrary(asbio); data(world.emissions)\n\nsubset <- world.emissions |>\n  filter(country %in% c(\"United States\", \"Mexico\", \"China\",\n                        \"Germany\", \"Russia\", \"Canada\")) |>\n  filter(year > 1950 & year <= 2019)plot_ly(subset, x = ~year, y = ~co2) |>\n  add_lines(color = ~country) |>\n  layout(\n        yaxis = list(tickfont = list(size = 20),\n                     title ='CO\\U2082 (million tonnes)',\n                     titlefont = list(size = 23)),\n        xaxis = list(tickfont = list(size = 20),\n                     title='Year',\n                     titlefont = list(size = 23)),\n        legend = list(font = list(size = 20))\n        )"},{"path":"ch11.html","id":"ggplot-and-plotly","chapter":"11 Interactive and Web Applications","heading":"11.4.1 ggplot and plotly","text":"Ggplot2 objects can converted (imperfectly) plotly objects using function plolty::ggplotly().\nUnfortunately, large number ggplot layout characteristics including figure margins locations \\(x\\) \\(y\\) axis labels translate ggplotly(). Instead, must call potentially exhaustive hierarchically nested list components. can pain, may expedient build separate list function objects facilitate process.Example 11.10  \\(\\text{}\\)illustrate extend previous example. First, create nested list object, k, specifies desired margin axis characteristics.create simple ggplot boxplot, g. get desired characteristics mapped plotly graph call list components k within plotly::layout(). Fig 11.13 shows result.\nFigure 11.13: Simple plolty barplot based ggplot.\n\\(\\blacksquare\\)Example 11.11  \\(\\text{}\\)another application using function GGally::ggcoef() create coefficient plot. coefficient plot displays statistical model parameter estimates confidence intervals. can make plot interactive (HTML) using ggplotly() (Fig 11.14).\nFigure 11.14: Coefficient plot function GGally::ggcoef(), rendered using ggplotly().\n\n\\(\\blacksquare\\)","code":"k <- list(\n  yaxis = list(title = list(font = list(size = 18)),\n               tickfont = list(size = 14)),\n  xaxis = list(title = list(font = list(size = 18)),\n               tickfont = list(size = 15)),\n    margin = list(t = 20, r = 20, b = 80, l = 80))g <- ggplot(subset, aes(x = country, y = co2)) +\n  geom_boxplot(aes(fill = country)) +\n  theme_classic() +\n  ylab(\"CO\\U2082 (million tonnes)\") +\n  xlab(\"Country\")\n\nggplotly(g) %>%\n  layout(showlegend = FALSE, xaxis = k$xaxis, yaxis = k$yaxis,\n         margin = k$margin)library(GGally)\nmodel <- lm(log(co2) ~ country + year,\n            data = subset)\n\ngg <- ggcoef(model,\n             exclude_intercept = TRUE,\n             errorbar_height = .1,\n             color = \"blue\") +\n  theme_bw()\n\nggplotly(gg) %>%\n  layout(yaxis = list(tickfont = list(size = 15),\n                       title ='',\n                       titlefont = list(size = 18)),\n          xaxis = list(tickfont = list(size = 15),\n                        title='Parameter estimates',\n                        titlefont = list(size = 18)),\n           legend = list(font = list(size = 15))\n           )"},{"path":"ch11.html","id":"shiny","chapter":"11 Interactive and Web Applications","heading":"11.5 shiny","text":"Probably easiest flexible way create interactive HTML apps tools package shiny. Unlike ploty apps, shiny apps allow real-time interfacing R computations. RStudio internals facilitate shiny app creation embedding webpages. Examples given often based apps described Hadley Wickham’s book Mastering Shiny (Wickham 2021).\nshiny app three components:user interface (ui) specification defines app looks.server function defines app works. function (generally) three arguments input, output, session.app execution call conjoins user interface server functions. done shinyApp()Example 11.12  first example, R code rendering text HTML app (Fig 11.15).\nFigure 11.15: simple shiny app. Code follows Wickham (2021).\nui: shiny::fluidPage() layout function defines basic visual structure app (Lines 1-4). Among things function allows definition app rows using shiny::fluidRow(), columns (within rows) using shiny::column(). Fluid pages can rescale components real-time fill available GUI window width.server: simple example server function contains commands (Lines 5-6). Although, matter convention, server arguments: input, output, session still included.shinyApp: app function pairs ui/server objects (Line 7).\\(\\blacksquare\\)\nOne can open R script shiny app skeleton RStudio going File\\(>\\)New File\\(>\\)Shiny Web Application. allow RStudio recognize script app code. , turn, allows running app either sending code console (e.g., using Ctrl + Enter), using Run App button Shiny Web Application toolbar.Example 11.13  simple app lists provides details datasets package asbio (Fig 11.16).ui: fluidPage() includes shiny::selectInput(), input control function provides user select box widget. appropriate label \"Dataset\" defined. Selection box choices third column data(package = \"asbio\")$results, contains names dataframe object names asbio.server: , server function contains commands (Lines 5-6).shinyApp: app function pairs ui/server objects (Line 7).\n\nFigure 11.16: shiny app allow scrolling asbio datasets.\napp Fig 11.16 limited usefulness provides asbio dataframe object names. Indeed, get information simply running data(package = \"asbio\"). insert additional features user interface server increase functionality (Fig 11.17).code data(list = adata[1:length(adata)]) loads asbio datasets global environment (Line 2).code data(list = adata[1:length(adata)]) loads asbio datasets global environment (Line 2).ui: fluidPage() now specifies three features, occur top bottom app, listed (Lines 4-8).\nfunctionsshiny::verbatimTextOutput() (Line 6) shiny::tableOutput() (Line 7) controls define output (depending order specified fluidPage()) displayed. Specifically, verbatimTextOutput() displays code, tableOutput() displays tables.\nui: fluidPage() now specifies three features, occur top bottom app, listed (Lines 4-8).functionsshiny::verbatimTextOutput() (Line 6) shiny::tableOutput() (Line 7) controls define output (depending order specified fluidPage()) displayed. Specifically, verbatimTextOutput() displays code, tableOutput() displays tables.server: server function modified allow interaction user interface (Lines 10-20). allows generations two objects: output$summary (Line 11) output$table (Line 12), based input$dataset ui.\noutput$summary (lines 10-14) rendered expression shiny::renderPrint(). particular, output summary() (Line 13) columns input$dataset made available object dataset Line 12. output operation coupled verbatimTextOutput(\"summary\") ui.\noutput$table (Lines 16-19) rendered expression shiny::renderTable(). show raw data scrollable table dataframe specified ui. output operation coupled tableOutput(\"table\") ui.\nserver: server function modified allow interaction user interface (Lines 10-20). allows generations two objects: output$summary (Line 11) output$table (Line 12), based input$dataset ui.output$summary (lines 10-14) rendered expression shiny::renderPrint(). particular, output summary() (Line 13) columns input$dataset made available object dataset Line 12. output operation coupled verbatimTextOutput(\"summary\") ui.output$table (Lines 16-19) rendered expression shiny::renderTable(). show raw data scrollable table dataframe specified ui. output operation coupled tableOutput(\"table\") ui.shinyApp: , generate app using: shinyApp(ui, server) (Line 22).shinyApp: , generate app using: shinyApp(ui, server) (Line 22).\n\nFigure 11.17: modified shiny app provide summaries scrollable asbio datasets.\n\\(\\blacksquare\\)","code":"library(shiny)\nui <- fluidPage(\n  \"Hello, world!\"\n)\nserver <- function(input, output, session) {\n}\nshinyApp(ui, server)ui <- fluidPage(\n  selectInput(\"dataset\", label = \"Dataset\",\n              choices = data(package = \"asbio\")$results[,3])\n)\nserver <- function(input, output, session) {\n}\nshinyApp(ui, server)adata <- data(package = \"asbio\")$results[,3]\ndata(list = adata[1:length(adata)]) # loads all asbio datasets\n\nui <- fluidPage(\n  selectInput(\"dataset\", label = \"Dataset\", choices = adata),\n  verbatimTextOutput(\"summary\"),\n  tableOutput(\"table\")\n)\n\nserver <- function(input, output, session){\n    output$summary <- renderPrint({\n    dataset <- get(input$dataset)\n    summary(dataset)\n  })\n\n  output$table <- renderTable({\n      dataset <- get(input$dataset)\n    dataset\n  })\n}\n\nshinyApp(ui, server)"},{"path":"ch11.html","id":"ui-details","chapter":"11 Interactive and Web Applications","heading":"11.5.1 ui Details","text":"Input widget functions specified ui. ui input function, e.g., selectInput() first argument \"foo\", inputId = \"foo\" can called server operations using script input$foo. input functions 2nd argument called label creates user-readable label control widget app. 3rd input argument typically value creates starting value widget control. Fig 11.18 shows many standard shiny ui input functions (without output). Important ui import functions also listed Table 11.1.\nFigure 11.18: variety shiny input widgets operations can specified ui. row, figure depicts widgets generated functions: actionButton(), submitButton(), checkboxInput, checkboxGroupInput(), dateInput(), dateRangeInput(), fileInput(), helpText(), numericInput(), radioButtons(), selectInput(), sliderInput(), textInput(). Also see Table 11.1.\n\nTable 11.1: important shiny ui input functions.","code":"\nsource(\"shiny_widgets.R\")\nshiny_widgets()"},{"path":"ch11.html","id":"output","chapter":"11 Interactive and Web Applications","heading":"11.5.1.1 Output","text":"Output functions ui create placeholders can filled server function. inputs, outputs require unique ID. instance, Fig 11.19, provides simple summary asbio::world.emissions dataset, output$code output$text generated server placed fluid page using textOutput(\"text\") verbatimTextOutput(\"code\").\nFigure 11.19: simple app providing single descriptive statistics summary.\nTable 11.2 lists potential ui output functions can used shiny apps.Table 11.2: important shiny ui output functions.\n","code":"library(asbio)\ndata(world.emissions)\n\nUS <- world.emissions |>\n  filter(country == \"United States\")\n\nui <- fluidPage(\n  textOutput(\"text\"),\n  verbatimTextOutput(\"code\")\n)\nserver <- function(input, output, session) {\n  output$text <- renderText({\n    \"Summary of the US CO\\u2082 data \\n\"\n  })\n  output$code <- renderPrint({\n    summary(US$co2)\n  })\n}\n\nshinyApp(ui, server)"},{"path":"ch11.html","id":"server-details","chapter":"11 Interactive and Web Applications","heading":"11.5.2 server Details","text":"noted earlier, server function requires three arguments: input, output, session. input argument allows assembly items ui front-end create list-like object. output argument server provides output ui inputs, often via rendering handling functions (Table 11.3).Table 11.3: shiny server rendering handling functions.\nFig 11.20 shows app sliders inputs, generated using function sliderInput() ui, text (product) output provided ui server, via renderText().\nFigure 11.20: simple slider app.\n","code":"ui <- fluidPage(\n  sliderInput(\"x\", label = \"If x is\", min = 1, max = 50, value = 30),\n  sliderInput(\"y\", label = \"And y is\", min = 1, max = 50, value = 30),\n  \"then x times y is\",\n  textOutput(\"product\")\n)\n\nserver <- function(input, output, session) {\n  output$product <- renderText({\n    input$x * input$y\n  })\n}\n\nshinyApp(ui, server)"},{"path":"ch11.html","id":"running-shiny-apps-in-r-markdown","chapter":"11 Interactive and Web Applications","heading":"11.5.3 Running shiny Apps in R Markdown","text":"Unlike plotly graphics, shiny apps automatically interactive R markdown rendered document. However, easy make shiny app interactive setting (provided R open run app). One simply adds runtime:shiny R Markdown YAML header. Thus, YAML header R markdown format Fig 11.21. Note approach now possible Bookdown.\nFigure 11.21: YAML header allow inclusion shiny apps R Markdown generated HTML.\nadjustments R Markdown code may needed (e.g., figure margins renderPlot() may need changed) make apps fit nicely page. shiny app work remotely (outside R session) server implementing R used implement app’s code. process detailed end chapter.","code":""},{"path":"ch11.html","id":"reactive-programming","chapter":"11 Interactive and Web Applications","heading":"11.5.4 Reactive Programming","text":"can increase efficiency Shiny apps using reactive programming wherein outputs automatically update inputs change. reactive programming specify interactive dependencies input changes, related outputs automatically updated. code results app shown Fig 11.22. Note output updates ``reactively’’ type individual characters name.\nFigure 11.22: Reactive behavior simple shiny app.\nReactive programming usually occurs complex settings previous example requires function reactive.Example 11.14  \\(\\text{}\\)\nextended example, imagine wish rapidly examine green house emissions data fifty countries asbio::world.emissions dataset highest current populations. first step, data tidying create stats summary callback function use later.ui: define relatively complex ui provide sufficient inputs outputs server function.Note use fluidRow() layout function. Shiny app rows, created fluidRow(), contain twelve columns. can divided various ways using shiny::column()(Fig 11.23).functions htmltools::br() htmltools::h1() HTML tags package htmltools, imported shiny. h1() function creates first level heading. Thus, equivalent HTML operator <h1>. br() functions equates HTML line break tag, .e., <br>. list HTML equivalent tags provided ?htmltools::builder.function plotOutput() allows input interactive R graphs, including ggplots (see ).\n\nFigure 11.23: Behavior shiny app rows columns, ui. Figure taken Wickham (2021).\nserver:: server function contains several new features, including use function reactive().code:provides data subset particular country needs calculated , re-used. also allows spontaneous (possible) interaction ui respect choice. reactive object selected called several times, function, server function.\n- object output$plot <- renderPlot() ggplot generated selected() called plotOutput(\"plot\") ui.\nshinyApp: , generate app using:final form app shown Fig 11.24.\nFigure 11.24: shiny app graphically depict changing CO\\(_2\\) levels time user-selected country.\n\\(\\blacksquare\\)Example 11.15  \\(\\text{}\\)Wickham (2021) used \\(t\\)-test computations demonstrate reactive programming shown (modifications) . first delineate two callback functions wish use app.function t.test() runs \\(t\\)-tests true normal population means. particular, assuming \\(X_1 \\sim N(\\mu_1, \\sigma^2_1)\\), \\(X_2 \\sim N(\\mu_2, \\sigma^2_2)\\) generally consider hypotheses:\\[\\begin{align*}\n\\text{H}_0: \\mu_1 &= \\mu_2 \\\\\n\\text{H}_\\text{}: \\mu_1 &\\neq \\mu_2\n\\end{align*}\\]default, t.test() assume homoscedasticty (, allows \\(\\sigma^2_1 \\neq \\sigma^2_2\\)). Thus, uses Satterthwaite method estimate degrees freedom null \\(t\\)-distribution test statistic (Aho 2014). GUI create run \\(t\\)-tests randomly generated data two user-specified normal distributions x1 x2.function sprintf() t_test() uses C code return formatted combination text variable outcomes. code combines text inputs double precision values (indicated f) \\(p\\)-values, bounds 95% confidence interval true mean difference. code %0.3f indicates rounding three significant digits. , code \\n creates text line break.ui: use function numericInput() specify characteristics normal distributions consideration. sliderInput() function used specify x-limits app-rendered ggplot frequency plot.server: server use reactive programming generate random samples normal distribution. Specifically, object x1 obtain random sample size input$n1 normal distribution mean input$mean1 standard deviation input$sd1. parameter values specified ui.\n- shinyApp: , generate app using:final form app shown Fig 11.25.\n\nFigure 11.25: shiny app demonstrate mechanism \\(t\\)-tests.\n\\(\\blacksquare\\)","code":"ui <- fluidPage(\n  textInput(\"name\", \"What's your name?\"),\n  textOutput(\"greeting\")\n)\n\nserver <- function(input, output, session) {\n  output$greeting <- renderText({\n   paste0(\"Hello \", input$name, \"!\")\n  })\n}\nshinyApp(ui, server)library(tidyverse)\nnot.redundant <- world.emissions |> filter(continent != \"Redundant\")\n\npop.max <- not.redundant |>\n  group_by(country) |>\n  summarise(max.pop = max(population)) |>\n  arrange(desc(max.pop))\n\n# names of 50 largest countries\ncountry_names <- setNames(nm = pop.max$country[1:50])\n\n# 50 largest countries data\ntop50 <- not.redundant |>\n  filter(country %in% pop.max$country[1:50])\n\n# summary stats\nsummarize <- function(x, rn = c(\"CO2\", \"CH4\", \"NOx\", \"total GHG\")){\n    mean <- apply(x, 2, function(x) mean(x, na.rm = T))\n    max <- apply(x, 2, function(x) max(x, na.rm = T))\n    sum <- apply(x, 2, function(x) sum(x, na.rm = T))\n    n <- apply(x, 2, function(x) length(which(!is.na(x))))\n    df <- data.frame(mean = mean, max = max, cumulative = sum, n = n)\n    row.names(df) <- rn\n    df\n}ui <- fluidPage(\n  titlePanel(h1(\"Greenhouse gasses\", align = \"center\")), #h1 = HTML heading\n  fluidRow(\n    column(6,\n      selectInput(\"country\", choices = country_names, label = \"Country\")\n    )\n  ),\n  fluidRow(\n    column(4, tableOutput(\"diag\")), # table\n  ),\n  br(), # line break\n  br(),\n  fluidRow(\n    column(12, plotOutput(\"plot\")) # plot\n  )\n)server <- function(input, output, session) {\n  selected <- reactive(top50 %>% filter(country == input$country))\n\n  output$diag <- renderTable(\n  summarize(select(selected(), co2, methane, nitrous_oxide, total_ghg)),\n  colnames = TRUE, rownames = TRUE\n  )\n\n  output$plot <- renderPlot({\n  selected() %>%\n       ggplot(aes(year, co2)) +\n       geom_line() +\n       labs(x = \"Year\",\n            y = expression(paste(CO[2], \" emissions (\", 10^6, \" tonnes)\")))\n  })\n}\nselected <- reactive(top50 %>% filter(country == input$country))shinyApp(ui, server)freqpoly <- function(x1, x2, binwidth = 0.1, xlim = c(-3, 3)) {\n  require(ggplot2)\n  df <- data.frame(\n    x = c(x1, x2),\n    group = c(rep(\"x1\", length(x1)), rep(\"x2\", length(x2)))\n  )\n  ggplot(df, aes(x, colour = group)) +\n    geom_freqpoly(binwidth = binwidth, linewidth = 1) +\n    coord_cartesian(xlim = xlim)\n}\n\nt_test <- function(x1, x2) {\n  test <- t.test(x1, x2)\n  sprintf(\n    \"p-value: %0.3f \\nCI for µ1 - µ2: [%0.2f, %0.2f]\",\n     test$p.value, test$conf.int[1], test$conf.int[2]\n  )\n}ui <- fluidPage(\n  fluidRow(\n    column(4,\n      \"Distribution 1\",\n      numericInput(\"n1\", label = \"n\", value = 200, min = 1),\n      numericInput(\"mean1\", label = \"µ\", value = 0, step = 0.1),\n      numericInput(\"sd1\", label = \"\\u03c3\", value = 0.5, min = 0.1, step = 0.1)\n    ),\n    column(4,\n      \"Distribution 2\",\n      numericInput(\"n2\", label = \"n\", value = 200, min = 1),\n      numericInput(\"mean2\", label = \"µ\", value = 0, step = 0.1),\n      numericInput(\"sd2\", label = \"\\u03c3\", value = 0.5, min = 0.1, step = 0.1)\n    ),\n    column(4,\n      \"Frequency polygon\",\n      numericInput(\"binwidth\", label = \"Bin width\", value = 0.1, step = 0.1),\n      sliderInput(\"range\", label = \"range\", value = c(-3, 3), min = -5, max = 5)\n    )\n  ),\n  fluidRow(\n    column(12, plotOutput(\"hist\"))\n  ),\n  fluidRow(\n    column(1),\n    column(5, verbatimTextOutput(\"ttest\")),\n    column(2),\n    column(3, actionButton(\"simulate\", \"Simulate!\")),\n    column(1)\n  )\n)server <- function(input, output, session) {\n  x1 <- reactive({input$simulate\n        rnorm(input$n1, input$mean1, input$sd1)})\n  x2 <- reactive({input$simulate\n        rnorm(input$n2, input$mean2, input$sd2)})\n\n  output$hist <- renderPlot({\n    freqpoly(x1(), x2(), binwidth = input$binwidth, xlim = input$range)\n  }, res = 96)\n\n  output$ttest <- renderText({\n    t_test(x1(), x2())\n  })\n}shinyApp(ui, server)"},{"path":"ch11.html","id":"additional-layout-control","chapter":"11 Interactive and Web Applications","heading":"11.5.5 Additional Layout Control","text":"already learned techniques like fluidRow() control single page layouts fluidPage(). Another popular HTML layout uses side panels. can implemented shiny ui using functions sidebarLayout() sidebarPanel(). Sidebar formatting summarized Fig 11.26.\n\nFigure 11.26: Sidebar formatting shiny. Figure taken Wickham (2021).\nExample 11.16  \\(\\text{}\\)\nexample displaying normal distribution using sliders sidebars.ui: user interface specifies sidebar layout, using sidebarLayout(), contains sidebar panel designated sidebarPanel, main panel, designated mainPanel().server: output server base R plot normal PDF.}\n- shinyApp: , use shinyApp() generate app.final form app shown Fig 11.27.\nFigure 11.27: shiny app demonstrating normal distribution.\nInterestingly, app appears less reactive analogous plot GUI generated tcltk. Compare app Fig 11.27 asbio::see.norm.tck().\\(\\blacksquare\\)","code":"ui <- fluidPage(\n   titlePanel(h1(\"Normal Distribution\", align = \"center\")),\n   sidebarLayout(\n      sidebarPanel(\n         sliderInput(\"mu\", \"\\u03BC\", step = 0.2, min = -3,\n                     max = 3, value = 0),\n         sliderInput(\"sigma\", \"\\u03C3\", min = 0.5, max = 3,\n                     value = 1), width = 4\n      ),\n    mainPanel(plotOutput(\"plot\"))\n))server <- function(input, output, session) ({\n   xmin <- -4; xmax <- 4; ymin <- 0; ymax <- 0.8\n   xx <- seq(xmin, xmax, length = 100)\n\n   output$plot <- renderPlot({\n       yy <- dnorm(xx, input$mu, input$sigma)\n       plot(xx, yy, type = \"l\", xlim = c(xmin, xmax), ylim = c(ymin, ymax),\n            xlab = expression(italic(x)),\n            ylab = expression(paste(italic(f), \"(\", italic(x), \")\", sep = \"\")),\n            cex.axis = 1.2, cex.lab = 1.2, lwd = 1.4)\n     })\n})shinyApp(ui, server)"},{"path":"ch11.html","id":"multi-page-apps","chapter":"11 Interactive and Web Applications","heading":"11.5.5.1 Multi-page Apps","text":"Complex apps may impossible fit onto single page. shiny, simplest way break app page multiple pages use tabsetPanel() tabPanel().\nWickham (2021) provide widget output empty server (Fig 11.28). ui tabset panel generated using tabsetPanel(). entity three panels, generated using tabPanel(). first panel \"Import data\" currently contains content.\n\nFigure 11.28: shiny multipanel example.\ntabset can input id argument used.\nallows app behave differently depending tab currently visible (Fig 11.29).\nFigure 11.29: Tabs multi-page app.\ntabs displayed horizontally, limit number. functions navlistPanel(), navbarPage(), navbarMenu() provide vertical layouts allow tabs longer titles (Fig 11.30).\n\nFigure 11.30: multi-page app vertical tabs.\n","code":"ui <- fluidPage(\n  tabsetPanel(\n    tabPanel(\"Import data\",\n      fileInput(\"file\", \"Data\", buttonLabel = \"Upload...\"),\n      textInput(\"delim\", \"Delimiter\", \"\"),\n      numericInput(\"skip\", \"Rows to skip\", 0, min = 0),\n      numericInput(\"rows\", \"Rows to preview\", 10, min = 1)\n    ),\n    tabPanel(\"Set parameters\"),\n    tabPanel(\"Visualise results\")\n  )\n)\n\nserver <- function(input, output, session) {\n}\nshinyApp(ui, server)ui <- fluidPage(\n  sidebarLayout(\n    sidebarPanel(\n      textOutput(\"panel\")\n    ),\n    mainPanel(\n      tabsetPanel(\n        id = \"tabset\",\n        tabPanel(\"panel 1\"),\n        tabPanel(\"panel 2\"),\n        tabPanel(\"panel 3\")\n      )\n    )\n  )\n)\nserver <- function(input, output, session) {\n  output$panel <- renderText({\n    paste(\"Current panel: \", input$tabset)\n  })\n}\nshinyApp(ui, server)ui <- fluidPage(\n  navlistPanel(\n    id = \"tabset\",\n    \"Heading 1\",\n    tabPanel(\"panel 1\", \"Panel one contents\"),\n    \"Heading 2\",\n    tabPanel(\"panel 2\", \"Panel two contents\"),\n    tabPanel(\"panel 3\", \"Panel three contents\")\n  )\n)\n\nserver <- function(input, output, session) {\n}\nshinyApp(ui, server)"},{"path":"ch11.html","id":"layout-themes","chapter":"11 Interactive and Web Applications","heading":"11.5.5.2 Layout Themes","text":"Customization general shiny layout can obtained utilizing modifying Bootstrap108 themes classes.\ncan include layouts specific mobile apps (see package RInterface) Google’s material design frame (see package shinymaterial).\nuse \"darkly\" bootswatch (Fig 11.31). choices include \"sandstone\", \"flatly\", \"united\".\nFigure 11.31: shiny app using darkly bootswatch Bootstrap.\ncontrol shiny apps can achieved programming directly HTML, CSS, Java109. fact, HTML code uis revealed running ui functions directly R console (Fig 11.32).\nFigure 11.32: Representation shiny code HTML code.\n","code":"ui <- fluidPage(\n  theme = bslib::bs_theme(bootswatch = \"darkly\"),\n  sidebarLayout(\n    sidebarPanel(\n      textInput(\"txt\", \"Text input:\", \"text here\"),\n      sliderInput(\"slider\", \"Slider input:\", 1, 100, 30)\n    ),\n    mainPanel(\n      h1(paste0(\"Theme: darkly\")),\n      h2(\"Header 2\"),\n      p(\"Some text\")\n    )\n  )\n)\n\nserver <- function(input, output, session) {\n}\nshinyApp(ui, server)"},{"path":"ch11.html","id":"plotoutput-interactives","chapter":"11 Interactive and Web Applications","heading":"11.5.6 plotOutput Interactives","text":"One perks plotOutput() can input responds mouse pointer events. controls also possible tcltk GUIs. shiny plot can respond four different mouse events: click, dblclick (double click), hover (.e., mouse stays place), brush (rectangular selection tool).Example 11.17  \\(\\text{}\\)\nConsider following simple example:Note use req(), ensure app doesn’t anything first click. resulting app shown Fig 11.33.\nFigure 11.33: mouse interactive shiny app.\nuse nearPoints() return dataframe point near mouse click.resulting app shown Fig 11.34.\nFigure 11.34: Another mouse interactive shiny app.\n\\(\\blacksquare\\)","code":"US <- world.emissions %>% filter(country == \"United States\")\n\nui <- fluidPage(\n  plotOutput(\"plot\", click = \"plot_click\"),\n  verbatimTextOutput(\"info\")\n)\n\nserver <- function(input, output) {\n  output$plot <- renderPlot({\n    par(mar = c(5,5,2,2))\n    plot(US$year, US$co2, xlab = \"Year\",\n         ylab = expression(paste(CO[2], \" (\",10^6, \" tonnes)\")), type = \"l\")\n  }, res = 96)\n\n  output$info <- renderPrint({\n    req(input$plot_click)\n    x <- round(input$plot_click$x, 2)\n    y <- round(input$plot_click$y, 2)\n    cat(\"[year = \", x, \", CO2 = \", y, \" million tonnes]\", sep = \"\")\n  })\n}\nshinyApp(ui, server)US.ghg <- data.frame(US[,c(3,4,10,11,12,14,15)])\n\nui <- fluidPage(\n  plotOutput(\"plot\", click = \"plot_click\"),\n  tableOutput(\"data\")\n)\nserver <- function(input, output, session) {\n  output$plot <- renderPlot({\n    par(mar = c(5,5,2,2))\n    plot(US.ghg$year, US.ghg$co2, xlab = \"Year\",\n         ylab = expression(paste(CO[2], \" (\",10^6, \" tonnes)\")),\n         type = \"l\")\n  }, res = 96)\n\n  output$data <- renderTable({\n    nearPoints(US.ghg, input$plot_click,\n               xvar = \"year\", yvar = \"co2\")\n  })\n}\nshinyApp(ui, server)"},{"path":"ch11.html","id":"putting-your-app-online","chapter":"11 Interactive and Web Applications","heading":"11.5.7 Putting Your App Online","text":"shiny app work remotely (outside R session) server implementing R used call app’s code. RStudio helps housing shiny server site shinyapps.io (Fig 11.35). site currently free charge relatively small number personal applications.\nFigure 11.35: shiny apps website (https://www.shinyapps.io/).\npersonal shinyapps.io account shown Fig 11.36.\nFigure 11.36: personal shiny apps website, three apps.\naccount houses links apps summarizing green house gas data, Hardy Weinberg equilibrium.","code":""},{"path":"ch11.html","id":"comparison-of-gui-generating-approaches","chapter":"11 Interactive and Web Applications","heading":"11.6 Comparison of GUI-generating Approaches","text":"Three R GUI building approaches described chapter. package tcltk uses Tcl/Tk GUI building tools alongside native windowing capacities Windows, Unix-like Mac operating systems. plotly shiny libraries render GUIs HTML framework. final comparative summary three approaches given Table 11.4.Table 11.4: Comparison three approaches GUI generation R introduced chapter.","code":""},{"path":"ch11.html","id":"exercises-10","chapter":"11 Interactive and Web Applications","heading":"Exercises","text":"Make tcltk GUI solves reports solutions differential equations.Make tcltk GUI solves reports solutions differential equations.Make plotly graph gglot2 graph using ggplotly.Make plotly graph gglot2 graph using ggplotly.Make shiny app greet someone. Hint: place two code chunks ui server function, respectively.Make shiny app greet someone. Hint: place two code chunks ui server function, respectively.      Make app interactive inside R Markdown rendered document.\n      Along code, include snapshot app action.friend designed app solves exponential growth function population initial population size 10, intrinsic growth rate 2, times, \\(t\\), 1 50:\n\\[f(t) = 10 \\times \\exp(2 \\times t).\\]      function generate error? ?\n      Fix code provide snapshot app action.","code":"\ntextInput(\"name\", \"What's your name?\")\noutput$greeting <- renderText({paste0(\"Hello \", input$name)})\nui <- fluidPage(\n  sliderInput(\"t\", label = \"If t is\", min = 1, max = 50, value = 30),\n  \"then the population size is\",\n  textOutput(\"exp.growth\")\n)\nserver <- function(input, output, session) {\n  output$exp.growth <- renderText({10 * exp(2 * t)})\n}\nshinyApp(ui, server)"},{"path":"ch12.html","id":"ch12","chapter":"12 R and Your Computer","heading":"12 R and Your Computer","text":"“can imagine anything, can create impossible.”- Alan Turing, (1912–1954)","code":""},{"path":"ch12.html","id":"how-do-computers-work","chapter":"12 R and Your Computer","heading":"12.1 How Do Computers Work?","text":"better understand R need understand underlying constraints computer systems use run R.\nComputers accept data, process data, produce output, store processed results. generally accomplished generation, integration storage electrical signals microscopic scales. list (current often changing) computer hardware terms given .Power supply: Converts alternating current (AC) electric power low-voltage direct current (DC) power.Power supply: Converts alternating current (AC) electric power low-voltage direct current (DC) power.Motherboard: circuit board connecting computer components including CPU, RAM memory disk drives.Motherboard: circuit board connecting computer components including CPU, RAM memory disk drives.Central Processing Unit (CPU): microprocessor performs calculations allow computer function. Specifically, CPU processes program instructions sends results processing execution computer components.Central Processing Unit (CPU): microprocessor performs calculations allow computer function. Specifically, CPU processes program instructions sends results processing execution computer components.Graphics Processing Unit (GPU): electronic circuit originally designed accelerate computer graphics, now widely applied non-graphic, highly parallel, calculations.Graphics Processing Unit (GPU): electronic circuit originally designed accelerate computer graphics, now widely applied non-graphic, highly parallel, calculations.Chipset: Mediates communication CPU computer components.Chipset: Mediates communication CPU computer components.Random Access Memory (RAM): Stores code data primary memory allow directly accessed CPU. RAM volatile memory requires power retain stored information. Thus, power interrupted, RAM data can lost. RAM types include dynamic random access memory (DRAM) static random-access memory (SRAM). DRAM constitutes modern computer main memory graphics cards. DRAM typically takes form integrated circuit chip can consist billions memory cells, cell consisting pairing tiny capacitor110 transistor111, allowing cell store read write one bit information (Fig 12.1). SRAM uses latching circuitry holds data permanently presence power, whereas DRAM decays seconds must periodically refreshed. Memory access via SRAM much faster DRAM, although DRAM circuits much less expensive construct.Random Access Memory (RAM): Stores code data primary memory allow directly accessed CPU. RAM volatile memory requires power retain stored information. Thus, power interrupted, RAM data can lost. RAM types include dynamic random access memory (DRAM) static random-access memory (SRAM). DRAM constitutes modern computer main memory graphics cards. DRAM typically takes form integrated circuit chip can consist billions memory cells, cell consisting pairing tiny capacitor110 transistor111, allowing cell store read write one bit information (Fig 12.1). SRAM uses latching circuitry holds data permanently presence power, whereas DRAM decays seconds must periodically refreshed. Memory access via SRAM much faster DRAM, although DRAM circuits much less expensive construct.\nFigure 12.1: Sixteen DRAM memory cells representing bit information computational storage, reading, writing. read binary word line 0101... row two circuit, binary signals sent bit lines sense amplifiers.\nDisk drives: including CD, DVD, hard disk (HDD), solid state disk (SSD) used secondary memory. , memory directly accessible CPU. Secondary memory can accessed retrieved even computer . Secondary memory also non-volatile thus can used store data programs extended periods. User files software (like R) generally stored HDDs SSDs. Flash memory, uses modified metal–oxide–semiconductor field-effect transistors (MOSFETs), typically used USB SSD devices provide secondary memory can erased reprogrammed. Flash memory can also used RAM applications.Disk drives: including CD, DVD, hard disk (HDD), solid state disk (SSD) used secondary memory. , memory directly accessible CPU. Secondary memory can accessed retrieved even computer . Secondary memory also non-volatile thus can used store data programs extended periods. User files software (like R) generally stored HDDs SSDs. Flash memory, uses modified metal–oxide–semiconductor field-effect transistors (MOSFETs), typically used USB SSD devices provide secondary memory can erased reprogrammed. Flash memory can also used RAM applications.Read-Memory (ROM): Stores BIOS (see ) runs computer powered (cold boot) restarted (warm boot reboot). ROM constitutes primary memory.Read-Memory (ROM): Stores BIOS (see ) runs computer powered (cold boot) restarted (warm boot reboot). ROM constitutes primary memory.Basic Input Output System (BIOS): Basic boot (startup) power management firmware (software provides low level control computer hardware). Newer motherboards use -called Unified Extensible Firmware Interface (UEFI) address BIOS limitations, including restrictive 16 bit addresses.Basic Input Output System (BIOS): Basic boot (startup) power management firmware (software provides low level control computer hardware). Newer motherboards use -called Unified Extensible Firmware Interface (UEFI) address BIOS limitations, including restrictive 16 bit addresses.Video card: Processes computer graphics.Video card: Processes computer graphics.\n","code":""},{"path":"ch12.html","id":"base-2-and-base-10","chapter":"12 R and Your Computer","heading":"12.2 Base-2 and Base-10","text":"understand computer processes, important distinguish base-2 (binary) base-10 (decimal) numerical systems. cases, base refers number unique digits. Thus, base-2 systems can two unique digits, commonly \\(0\\) \\(1\\), base-10 system 10 unique digits: \\(0,1,2,3,4,5,6,7,8,9\\). latter –widely used system– probably arose ten fingers counting112. radix (commonly decimal symbol) used distinguish integer part number fractional part (Fig 12.2). radix convention used base-2 base-10 systems. example, decimal number \\(4\\frac{3}{4}\\), integer component \\(4\\) fractional component \\(\\frac{3}{4}\\), can expressed \\(4.75\\). binary equivalent \\(4\\frac{3}{4}\\) 100.110.Traditionally, base-10 number expressed rational fraction whose denominator power ten (Fig 12.2). However, decimal system can extended real number, allowing conceptual infinite sequence digits following radix (Wikipedia 2024c).\nFigure 12.2: decimal place value chart. radix (decimal) placed ones thenths columns distinguish decimal number components greater one (left), components less one greater zero (right).\n","code":""},{"path":"ch12.html","id":"bits-and-bytes","chapter":"12 R and Your Computer","heading":"12.3 Bits and Bytes","text":"Computers designed around bits bytes. bit binary (base-2) unit digital information. Specifically, bit represent 0 1. convention occurs computer systems typically use electronic circuits exist one two states, . instance, DRAM memory cells (Fig 12.1) convert electrical low high voltages binary 0 1 responses, respectively, purpose reading, writing, storing data. Although bits used software conventional computer operating systems, mechanisms easily revealed R.Bits generally counted units bytes. somewhat arbitrary historical reasons, byte equals eight bits. Two major systems exist counting bytes. decimal method, common system, uses powers 10, allowing implementation SI prefixes (.e., kilo = \\(10^3 = 1000\\), mega = \\(10^6\\) = \\(1000^2\\), giga = \\(10^9\\) = \\(1000^3\\), etc.) (Table 12.1). computer hard drive 1 gigabyte (1 billion bytes) memory \\(1 \\times 10^9\\) bytes = \\(8 \\times 10^9\\) bits memory. binary system, used frequently Windows describe RAM, defines byte units multiples 1024.\n\nTable 12.1:  Frequently used byte units.\nsingle bit can describe \\(2^1 = 2\\) distinct digital objects. entity represented 0, entity represented 1. follows \\(2^2 = 4\\) distinct objects can described two bits, \\(2^3 = 8\\) entities can described three bits, on113.","code":""},{"path":"ch12.html","id":"decimal-to-binary","chapter":"12 R and Your Computer","heading":"12.4 Decimal to Binary","text":"count ten binary using: 0 = 0, 1 = 1, 10 = 2, 11 = 3, 100 = 4, 101 = 5, 110 = 6, 111 = 7, 1000 = 8, 1001 = 9, 1010 = 10. Thus, require four bits count ten. Note binary sequences positive integers greater equal one, start one.","code":""},{"path":"ch12.html","id":"positive-integers","chapter":"12 R and Your Computer","heading":"12.4.1 Positive Integers","text":"can obtain binary expression integer part decimal number iteratively performing integer division two, cataloging modulus. iterations stopped quotient one reached. modulus sequence read right left (backwards). whole number interest greater one (.e., whole number 0 1) place one front reversed sequence, binary sequences numbers greater equal one must start one.Example 12.1  \\(\\text{}\\)\nConsider number 23:\\[\n\\begin{aligned}\n&\\text{Modulus (remainder)     }& 1&           & 1&          & 1&         & 0&\\\\\n&\\text{Integer Quotient        }            & 23/2 = 11& & 11/2 = 5& & 5/2 = 2& & 2/2 = 1&\n\\end{aligned}\n\\]reversed sequence 0111. place one front get binary representation 23: 10111. function dec2bin() asbio work us:\n\\(\\blacksquare\\)","code":"\nlibrary(asbio)\ndec2bin(23)[1] 10111"},{"path":"ch12.html","id":"sec:pf","chapter":"12 R and Your Computer","heading":"12.4.2 Positive Fractions","text":"fractional part decimal number can converted binary similar fashion.identify fractional expression non integer, start binary sequence 0. (zero followed decimal symbol).Double fraction converted, record 1 product \\(\\ge 1\\), 0 otherwise.subsequent binary digits, multiply two fractional part previous multiplication. product \\(\\ge 1\\), record 1. , record 0.Example 12.2  \\(\\text{}\\)\nConsider fraction \\(\\frac{1}{4}\\). :\\[\n\\begin{aligned}\n&\\text{Binary outcome}& 0              & & 1          && 0         && 0\\\\\n&\\text{Product}& 1/4 \\times 2 = 1/2 < 1 & & 1/2 \\times 2 = 1\\ge 1 && 0 \\times 2 = 0 < 1&& 0 \\times 2 = 0 < 1 \\end{aligned}\n\\]\\(\\blacksquare\\)clear repeating sequence zeroes, due product two second step. allows us stop growth binary expression. fractions, binary sequence read conventionally, left right. Thus, binary expression \\(\\frac{1}{4}\\) 0.01 .","code":"\ndec2bin(0.25)[1] 0.01"},{"path":"ch12.html","id":"binary-to-decimal","chapter":"12 R and Your Computer","heading":"12.5 Binary to Decimal","text":"addition binary digit (.e., bit) represents doubling information storage. instance, increase two bits three bits, number describable integers increases four (integers 0 3) eight (integers 0 7). result say rightmost digit set binary digits represents \\(2^0\\), next represents \\(2^1\\), \\(2^2\\), . can defined equation based Horner’s method (Horner 1815) allows conversion binary decimal numbers:\\[\\begin{equation}\n\\sum_{\\kappa=\\min(\\kappa)}^{\\max(\\kappa)}\\alpha\\beta^\\kappa\n\\tag{12.1}\n\\end{equation}\\]\\(\\alpha\\) quantity known significand, contains bit (0, 1) outcomes. purpose binary expressions, modifying base, \\(\\beta\\), 2. term \\(\\kappa\\) called (appropriately) exponent.maximum minimum values \\(\\kappa\\) determined counting number placeholder digits binary expression represented significand, respect binary radix point (Fig 12.3). Note counting starts respect 0 (first digit left radix) positive (bits left radix) negative (bits right radix) values exponent, \\(\\kappa\\). radix reference prompted method called floating point arithmetic.\nFigure 12.3: Conceptualization binary decimal conversion, given Eq (12.1).\n","code":""},{"path":"ch12.html","id":"positive-integers-1","chapter":"12 R and Your Computer","heading":"12.5.1 Positive Integers","text":"positive integers entirety corresponding binomial expression left radix point (Fig 12.3). Thus, minimum value \\(\\kappa\\) zero maximum value \\(\\kappa\\) number digits (bits) binary expression, minus one.Equation (12.1) represents dot product. , equation sum element-wise multiplication two vectors. instance, find integers represented single binary bit, multiply binary digit value, 0 1, power two represents. single bit signature occur right-address left radix, value exponent 0 (Fig 12.3). , \\(\\min(\\kappa)\\) = \\(\\max(\\kappa)\\) = 0 Eq. (12.1).single bit equals 0 :\\[0 \\times 2^0 = 0,\\]single bit equals 1 :\\[1 \\times 2^0 = 1.\\]Accordingly, find decimal version set binary values, take sum products binary digits corresponding (decreasing) powers base 2.Example 12.3  \\(\\text{}\\)\nexample, binary number 010101 equals:\\[\\begin{aligned}\n(0 \\times 2^5) + (1 \\times 2^4) + (0 \\times 2^3) + (1 \\times 2^2) + (0 \\times 2^1) + (1 \\times 2^0) &=\n0 + 16 + 0 + 4 + 0 +1 \\\\&= 21.\n\\end{aligned}\n\\]function bin2dec asbio calculation us.\\(\\blacksquare\\)","code":"\nbin2dec(010101)[1] 21"},{"path":"ch12.html","id":"positive-fractions","chapter":"12 R and Your Computer","heading":"12.5.2 Positive Fractions","text":"positive fractions, values \\(\\kappa\\) exponent decrease minus one bits increase one (Fig 12.3). Thus, obtain decimal fractions binary fractions multiply bit’s binary value decreasing negative powers base two, starting 0, find sum, shown Eq (12.1).Example 12.4  \\(\\text{}\\)\nexample, binary value 0.01 equals:\n\\[(0 \\times 2^0) + (0 \\times 2^{-1}) + (1 \\times 2^{-2}) = 0.25\\]\\(\\blacksquare\\)","code":"\nbin2dec(0.01)[1] 0.25"},{"path":"ch12.html","id":"terminality","chapter":"12 R and Your Computer","heading":"12.5.2.1 Terminality","text":"decimal fractions clear terminal binary sequence. , binary representation decimal fraction finite number digits exist. results mere binary approximations decimal numbers (Goldberg 1991). instance, 10 bit binary expression \\(\\frac{1}{10}\\) isBut translating back decimal find:Increasing number bits binary expression increases precision,decimal approximation remains imperfect.Note imperfect conversion gives actual result division \\(\\frac{1}{10}\\) software current conventional computers (just R)!may seem surprising rational fractions like \\(\\frac{1}{10}\\) may non-terminating binary expressions. Terminality, however, occur decimal fraction product 2 results successive multiplication steps described Section 12.4.2. product occur \\(\\frac{1}{10}\\).\nLack terminality binary expressions prompts need quantifying imprecision computers systems. can obtained Eq (12.1). particular, exponent Eq (12.1) determines minimum maximum possible encoded numeric values, number digits significand determines numeric precision. Indeed, changing base 2 10, Eq (12.1) can used quantify precision binary decimal numbers.Example 12.5  \\(\\text{}\\)\ninstance, decimal number \\(1,245.42\\) scientific notation: \\(1.24542 \\times 10^3\\). expression precision six digits, Eq (12.1) significand six digits. Note applying digits Eq. (12.1) :\\[\n\\begin{aligned}\n1 \\times 10^3 & + & 2 \\times 10^2 & + & 4 \\times 10^1 & + & 5 \\times 10^0 & + & 4 \\times 10^{-1} & + &2 \\times 10^{-2} & = \\\\\n         1000 & + & 200 & + & 40 & + & 5 & + & 0.4 & + &0.02 & = 1245.42\n\\end{aligned}\n\\]\\(\\blacksquare\\)","code":"\ndec2bin(0.1)[1] 0.0001100110\nbin2dec(0.0001100110)[1] 0.0996\ndec2bin(0.1, max.bits = 14)[1] 0.00011001100110\noptions(digits = 20)\nbin2dec(0.00011001100110)[1] 0.10000000000000000555\noptions(digits = 20)\n1/10[1] 0.10000000000000000555"},{"path":"ch12.html","id":"double-precision","chapter":"12 R and Your Computer","heading":"12.6 Double Precision","text":"\nprograms, workstations, results computations stored 32 bits (.e., 4 bytes) 64 bits (8 bytes) information. 64 bit double precision format allows high precision representations positive negative integers fractional components. framework, one bit allocated sign stored item, 53 bits assigned significand, 11 bits given exponent (Fig 12.4).\nFigure 12.4: IEEE 754 double-precision binary floating-point format Figure taken (https://commons.wikimedia.org/w/index.php?curid=3595583).\ncan represented mathematically complex form Eq (12.1):\\[\\begin{equation}\n(-1)^{\\text{sign}}\\left(1 + \\sum_{=1}^{52} b_{52-} 2^{-} \\right)\\times 2^{e-1023}\n\\tag{12.2}\n\\end{equation}\\]gives assumed numeric value 64-bit double-precision datum exponent bias.\\Example 12.6  \\(\\text{}\\)\nfunction bit64() taken Examples documentation base function numToBits(), converts digital numbers 64 bits. function distinguishes:single bit giving sign number (0 = positive, 1 = negative).11 bit exponent.52 bit significand (without implicit leading 1).\ndouble precision representation \\(\\frac{1}{3}\\)see follows form Eq (12.2). exponent 01111111101 represents decimal number 1021:one plus dot product significand base-2 raised sequence -1 -52, multiplied \\(2^{1021 - 1023}\\), :, :\\[\n\\begin{aligned}\nvalue &= (-1)^{\\text{sign}}\\left(1 + \\sum_{=1}^{52} b_{52-} 2^{-} \\right)\\times 2^{e-1023}\\\\\n&= -1^{0} \\times (1 + 2^{-2} + 2^{-4} + \\dots + 2^{-52}) \\times 2^{1021-1023}\\\\\n&\\approx 1.33\\bar{3} \\times 2^{-2}\\\\\n&\\approx \\frac{1}{3}\n\\end{aligned}\n\\]\\(\\blacksquare\\)11 bit width double precision exponent allows expression numbers \\(10^{-308}\\) \\(10^{308}\\), full 15–17 decimal digits precision. clearly demonstrated R. Specifically, imprecision problems non-terminal fractions become evident decimal numbers greater 16 displayed digital digits.Additionally, current upper numerical limit R (ver 4.3.2) somewhere :andThe subnormal representation compromises precision, allows allows fractional representations approaching \\(5 \\times 10^{-324}\\). approach used R, whose smallest represented fraction :andBinary fractional numbers expressed respect decimal, number digits (often) dictated significand. Given 13 bits following binary translations decimal numbers: 1 = 1/1, 0.1 = 1/2, = 1/3, 0.01 = 1/4, 0.00110011 = 1/5, = 1/6, = 1/7, 0.001 = 1/8, = 1/9, = 1/10.","code":"\nbit64 <- function(x)\n  noquote(vapply(as.double(x),\n                 function(x) {\n                   b <- substr(as.character(rev(numToBits(x))), 2L, 2L)\n                   paste0(c(b[1L], \" \", b[2:12], \" | \", b[13:64]), collapse = \"\")\n                   }, \"\")\n  )\nbit64(1/3)[1] 0 01111111101 | 0101010101010101010101010101010101010101010101010101\nbin2dec(01111111101)[1] 1021\nsigd <- strsplit(\"0101010101010101010101010101010101010101010101010101\", NULL)\nsigd <- as.numeric(unlist(sigd))\nbase2 <- 2^(-1:-52)\n(1 + sum(sigd * base2)) * 2^-2[1] 0.3333\noptions(digits = 18)\n1/3[1] 0.333333333333333315\n1.8 * 10^307[1] 1.8e+307\n1.8 * 10^308[1] Inf\n5.0 * 10^-323[1] 4.94065645841246544e-323\n5.0 * 10^-324[1] 0"},{"path":"ch12.html","id":"binary-characters","chapter":"12 R and Your Computer","heading":"12.7 Binary Characters","text":"\nCharacters can also expressed binary. American Standard Code Information Interchange (ASCII) consists 128 characters, requires one byte = eight bits114. newer eight bit Unicode Transformation Format (UTF-8) system –widely used Unicode system– can represent 1,112,064 valid code points, using 1 4 bytes = 8 32 bits (Wikipedia 2024k). Specifically, perspective UTF-16 system, UTF-8 system uses portions seventeen planes 115, consisting sixteen bits (, thus, \\(2^{16} = 65,536\\) code variants). results quantity:\\[(17 \\times 2^{16}) - 2^{11} = 1,112,064\\]\\(2^{11} = 2048\\) subtraction acknowledges 2048 technically-invalid Unicode surrogates (Wikipedia 2024j). first 128 UTF-8 characters ASCII characters, allowing back-comparability ASCII.Example 12.7  \\(\\text{}\\)R uses UTF-8 system characters. can observe process binary character assignment using functions .raw(), rawToChar(), rawToBits(). base type raw (Section 2.3.4) intended hold raw byte information.\nlist 128 ASCII characters.\nNote exclamation point character number 33. 16 bit binary code :output , codes 1-31 127-128 printable characters. Thus, 128 - 33 = 95 printable ASCII characters. Note codes 7-13 command characters. instance, character 10, indicates ``make new line’’ within character string.\n\\(\\blacksquare\\)","code":"\nrawToChar(as.raw(1:128), multiple = TRUE)  [1] \"\\001\" \"\\002\" \"\\003\" \"\\004\" \"\\005\" \"\\006\" \"\\a\"   \"\\b\"   \"\\t\"    \"\\n\"  \n [11] \"\\v\"   \"\\f\"   \"\\r\"   \"\\016\" \"\\017\" \"\\020\" \"\\021\" \"\\022\" \"\\023\" \"\\024\"\n [21] \"\\025\" \"\\026\" \"\\027\" \"\\030\" \"\\031\" \"\\032\" \"\\033\" \"\\034\" \"\\035\" \"\\036\"\n [31] \"\\037\" \" \"    \"!\"    \"\\\"\"   \"#\"    \"$\"    \"%\"    \"&\"    \"'\"    \"(\"   \n [41] \")\"    \"*\"    \"+\"    \",\"    \"-\"    \".\"    \"/\"    \"0\"    \"1\"    \"2\"   \n [51] \"3\"    \"4\"    \"5\"    \"6\"    \"7\"    \"8\"    \"9\"    \":\"    \";\"    \"<\"   \n [61] \"=\"    \">\"    \"?\"    \"@\"    \"A\"    \"B\"    \"C\"    \"D\"    \"E\"    \"F\"   \n [71] \"G\"    \"H\"    \"I\"    \"J\"    \"K\"    \"L\"    \"M\"    \"N\"    \"O\"    \"P\"   \n [81] \"Q\"    \"R\"    \"S\"    \"T\"    \"U\"    \"V\"    \"W\"    \"X\"    \"Y\"    \"Z\"   \n [91] \"[\"    \"\\\\\"   \"]\"    \"^\"    \"_\"    \"`\"    \"a\"    \"b\"    \"c\"    \"d\"   \n[101] \"e\"    \"f\"    \"g\"    \"h\"    \"i\"    \"j\"    \"k\"    \"l\"    \"m\"    \"n\"   \n[111] \"o\"    \"p\"    \"q\"    \"r\"    \"s\"    \"t\"    \"u\"    \"v\"    \"w\"    \"x\"   \n[121] \"y\"    \"z\"    \"{\"    \"|\"    \"}\"    \"~\"    \"\\177\" \"\\200\"   \nrawToBits(as.raw(33))[1] 01 00 00 00 00 01 00 00"},{"path":"ch12.html","id":"optimizing-r","chapter":"12 R and Your Computer","heading":"12.8 Optimizing R","text":"attention given computational efficiency several earlier sections chapter, briefly consider several methods optimizing R. particular, consider use R-interfaces, including scripting command line OS shells implement high performance computers (HPCs) parallel computing.","code":""},{"path":"ch12.html","id":"calling-linux-driven-hpcs","chapter":"12 R and Your Computer","heading":"12.8.1 Calling Linux-driven HPCs","text":"\nconstruction\n\n\n\n\n","code":""},{"path":"ch12.html","id":"parallel-computing","chapter":"12 R and Your Computer","heading":"12.8.2 Parallel Computing","text":"\nconstruction","code":""},{"path":"ch12.html","id":"exercises-11","chapter":"12 R and Your Computer","heading":"Exercises","text":"Define following terms:\nMotherboard\nCentral processing unit (CPU)\nRandom access memory\nPrimary memory\nSecondary memory\nVolatile memory\nNon-volatile memory\n \nDefine following terms:MotherboardCentral processing unit (CPU)Random access memoryPrimary memorySecondary memoryVolatile memoryNon-volatile memory\n level trustworthy precision (number digits) decimal fractional components R (software use 64 bit double precision)?level trustworthy precision (number digits) decimal fractional components R (software use 64 bit double precision)?Obtain five bit binary sequence number 21 hand. Check answer using dec2bin().Obtain five bit binary sequence number 21 hand. Check answer using dec2bin().Find decimal number corresponding five bit binary sequence 11111. Check answer using bin2dec().Find decimal number corresponding five bit binary sequence 11111. Check answer using bin2dec().Find 64 bit expression decimal number \\(-2\\) (minus 2) using function bit64(), shown chapter. Back-transform binary representation decimal number hand using Eq. (12.2). Use R functions like strsplit() unlist(), etc., help.Find 64 bit expression decimal number \\(-2\\) (minus 2) using function bit64(), shown chapter. Back-transform binary representation decimal number hand using Eq. (12.2). Use R functions like strsplit() unlist(), etc., help.","code":""},{"path":"references.html","id":"references","chapter":"References","heading":"References","text":"","code":""}]
