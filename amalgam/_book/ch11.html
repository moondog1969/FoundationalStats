<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 11 Interactive and Web Applications | An Amalgam of R</title>
<meta name="author" content="Ken Aho">
<meta name="description" content="“A user interface is like a joke. If you have to explain it, it’s not that good.”  - Martin LeBlanc, Iconfinder cofounder  11.1 Introduction to GUIs GUIs (Graphical User Interfaces) allow users to...">
<meta name="generator" content="bookdown 0.39 with bs4_book()">
<meta property="og:title" content="Chapter 11 Interactive and Web Applications | An Amalgam of R">
<meta property="og:type" content="book">
<meta property="og:description" content="“A user interface is like a joke. If you have to explain it, it’s not that good.”  - Martin LeBlanc, Iconfinder cofounder  11.1 Introduction to GUIs GUIs (Graphical User Interfaces) allow users to...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 11 Interactive and Web Applications | An Amalgam of R">
<meta name="twitter:description" content="“A user interface is like a joke. If you have to explain it, it’s not that good.”  - Martin LeBlanc, Iconfinder cofounder  11.1 Introduction to GUIs GUIs (Graphical User Interfaces) allow users to...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.8.0/transition.js"></script><script src="libs/bs3compat-0.8.0/tabs.js"></script><script src="libs/bs3compat-0.8.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/core-js-2.5.3/shim.min.js"></script><script src="libs/react-18.2.0/react.min.js"></script><script src="libs/react-18.2.0/react-dom.min.js"></script><script src="libs/reactwidget-2.0.0/react-tools.js"></script><script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="libs/reactable-0.4.4/reactable.css" rel="stylesheet">
<script src="libs/reactable-binding-0.4.4/reactable.js"></script><script src="libs/rglWebGL-binding-1.3.1/rglWebGL.js"></script><link href="libs/rglwidgetClass-1.3.1/rgl.css" rel="stylesheet">
<script src="libs/rglwidgetClass-1.3.1/rglClass.src.js"></script><script src="libs/rglwidgetClass-1.3.1/utils.src.js"></script><script src="libs/rglwidgetClass-1.3.1/buffer.src.js"></script><script src="libs/rglwidgetClass-1.3.1/subscenes.src.js"></script><script src="libs/rglwidgetClass-1.3.1/shaders.src.js"></script><script src="libs/rglwidgetClass-1.3.1/shadersrc.src.js"></script><script src="libs/rglwidgetClass-1.3.1/textures.src.js"></script><script src="libs/rglwidgetClass-1.3.1/projection.src.js"></script><script src="libs/rglwidgetClass-1.3.1/mouse.src.js"></script><script src="libs/rglwidgetClass-1.3.1/init.src.js"></script><script src="libs/rglwidgetClass-1.3.1/pieces.src.js"></script><script src="libs/rglwidgetClass-1.3.1/draw.src.js"></script><script src="libs/rglwidgetClass-1.3.1/controls.src.js"></script><script src="libs/rglwidgetClass-1.3.1/selection.src.js"></script><script src="libs/rglwidgetClass-1.3.1/rglTimer.src.js"></script><script src="libs/rglwidgetClass-1.3.1/pretty.src.js"></script><script src="libs/rglwidgetClass-1.3.1/axes.src.js"></script><script src="libs/rglwidgetClass-1.3.1/animation.src.js"></script><script src="libs/CanvasMatrix4-1.3.1/CanvasMatrix.src.js"></script><link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="libs/plotly-binding-4.10.4/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
          margin-bottom: 0em;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="A Primer and Reference for Biologists">An Amalgam of R</a>:
        <small class="text-muted">A Primer and Reference for Biologists</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li><a class="" href="ch1.html"><span class="header-section-number">1</span> Welcome to R</a></li>
<li><a class="" href="ch2.html"><span class="header-section-number">2</span> Some Basics</a></li>
<li><a class="" href="ch3.html"><span class="header-section-number">3</span> Data Objects, Packages, and Datasets</a></li>
<li><a class="" href="ch4.html"><span class="header-section-number">4</span> Basic Data Management</a></li>
<li><a class="" href="ch5.html"><span class="header-section-number">5</span> Welcome to the Tidyverse</a></li>
<li><a class="" href="ch6.html"><span class="header-section-number">6</span> Base Graphics</a></li>
<li><a class="" href="ch7.html"><span class="header-section-number">7</span> Grid Graphics, Including ggplot2</a></li>
<li><a class="" href="ch8.html"><span class="header-section-number">8</span> Functions</a></li>
<li><a class="" href="ch9.html"><span class="header-section-number">9</span> R Interfaces</a></li>
<li><a class="" href="ch10.html"><span class="header-section-number">10</span> Building R Packages</a></li>
<li><a class="active" href="ch11.html"><span class="header-section-number">11</span> Interactive and Web Applications</a></li>
<li><a class="" href="ch12.html"><span class="header-section-number">12</span> R and Your Computer</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="ch11" class="section level1" number="11">
<h1>
<span class="header-section-number">11</span> Interactive and Web Applications<a class="anchor" aria-label="anchor" href="#ch11"><i class="fas fa-link"></i></a>
</h1>
<blockquote>
<p><em>“A user interface is like a joke. If you have to explain it, it’s not that good.”</em></p>
</blockquote>
<div class="flushright">
<p>- <strong>Martin LeBlanc</strong>, <em>Iconfinder cofounder</em></p>
</div>
<div id="introduction-to-guis" class="section level2" number="11.1">
<h2>
<span class="header-section-number">11.1</span> Introduction to GUIs<a class="anchor" aria-label="anchor" href="#introduction-to-guis"><i class="fas fa-link"></i></a>
</h2>
<p><em>GUIs</em> (Graphical User Interfaces) allow users to interact with software using graphical icons and point-and-click specifications. The interactive control components of a GUI are called <em>widgets</em>. The following are some commonly used GUI widgets:
</p>
<ul>
<li>
<em>button</em>: typically a GUI controller for binary (e.g., on/off or run/don’t run) operations.</li>
<li>
<em>radiobutton</em>: A controller allowing selection from a group of mutually-exclusive options which are linked to specific operations.</li>
<li>
<em>checkbutton</em>: A controller that allows selection binary of multiple mutually-exclusive options, and is often linked to a second variable, allowing flexible rendering of a secondary set of widgets.</li>
<li>
<em>spinbox</em>: Provides a “spin-able” set of mutually exclusive options that can be selected and linked to operations.</li>
<li>
<em>combobox</em>: A text field with a popdown selection list.</li>
<li>
<em>slider</em>: A sliding controller that defines the numeric value of a linked variable that changes uniformly over some range.</li>
<li>
<em>message box</em>: A message window that typically prompts a user response and a corresponding linked operation.</li>
<li>
<em>scrollbar</em>: A modifiable viewport for a scrollable object (e.g., text that can be examined line by line).</li>
<li>
<em>pulldown menus</em>: Interactive menus with pulldown tabs and <em>menubuttons</em> that specify operations, potentially including links to other GUIs.</li>
</ul>
<p><strong>R</strong> allows building of GUIs to run functions and interact with graphics using a number of methods and language frameworks.
</p>
<p>It should be noted that <strong>R</strong> GUIs are are a mixed bag. On the plus side, <strong>R</strong> GUIs: 1) increase user-friendliness by allowing point and click operations, 2) allow rapid visual assessment of alteration to function arguments via widgets, 3) are often very amenable to graphics manipulations, and 4) are often very useful for data exploration or heuristic demonstrations. On the other hand, <strong>R</strong> GUIs: 1) often result in a loss of flexibility in controlling functions, 2) may contain a visually confusing mish-mash of widgets, and 3) constitute mysterious black boxes, which is contrary to the “mission statement” of <strong>R</strong> <span class="citation">(<a href="references.html#ref-chambers2008">Chambers 2008</a>)</span>. Further, command line (non-GUI) code entry allows an exact record of characteristics given to objects, and specifications provided to functions. This allows straightforward tracking, dissemination, and repeatability of computational analyses.</p>
<p>I will explore three methods for generating GUIs, named for the principal <strong>R</strong> package allowing their implementation: <em>tcltk</em>, <em>plotly</em>, and <em>shiny</em>.</p>
</div>
<div id="tcltk" class="section level2" number="11.2">
<h2>
<span class="header-section-number">11.2</span> <em>tcltk</em><a class="anchor" aria-label="anchor" href="#tcltk"><i class="fas fa-link"></i></a>
</h2>
<p>The <strong>R</strong> distribution package <em>tcltk</em> (pronounced: <em>tickle tee kay</em>) allows building of GUIs by providing a binding wrapper for the Tcl language, via the Tk toolkit, under a configuration called Tcl/Tk <span class="citation">(<a href="references.html#ref-ousterhout1991">Ousterhout 1991</a>)</span><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Tcl, an acronym for “tool command language,” is an interpreted programming language that is often embedded into C applications. Tk is a Tcl package for GUI building. Tk, when implemented in Tcl, is termed Tcl/Tk.&lt;/p&gt;"><sup>99</sup></a>. In programming, <em>binding</em> refers to an <em>application programming interface</em> (API) that provides glue code to allow a programming language to implement a foreign language or software package <span class="citation">(<a href="references.html#ref-wikbinding">Wikipedia 2024e</a>)</span>. Python bindings for Tcl/Tk are provided by the Python library <a href="https://docs.python.org/3/library/tkinter.html"><em>tkinter</em></a> which is included in the <a href="https://docs.python.org/3/library/index.html">Python standard library</a> of packages. Much better support exists for <em>tkinter</em> than <em>tcltk</em>. Additionally, <a href="https://wiki.python.org/moin/GuiProgramming">many non-Tcl/Tk approaches</a> exist for GUI building in Python, although they are not included in the Python standard library.</p>
<p>Lack of guidance for the <em>tcltk</em> package is likely due to the absence of a large user group. Assistance for the creation of <em>tcltk</em> GUIs can be found in several older articles from <strong>R</strong> News (which has since been replaced by the <strong>R</strong> Journal) <span class="citation">(<a href="references.html#ref-dalgaard2001">Dalgaard 2001</a>, <a href="references.html#ref-dalgaard2002">2002</a>; <a href="references.html#ref-fox2007">Fox 2007</a>)</span>, the book “Programming GUIs in <strong>R</strong>” <span class="citation">(<a href="references.html#ref-lawrence2018programming">Lawrence and Verzani 2018</a>)</span>, and in the GUI code for a number of newer <strong>R</strong> packages, including <em>Rcmdr</em> <span class="citation">(<a href="references.html#ref-foxRcmdrArticle">Fox 2005</a>; <a href="references.html#ref-foxRcmdrManual">Fox, Marquez, and Bouchet-Valat 2023</a>)</span> and <em>asbio</em> <span class="citation">(<a href="references.html#ref-aho2023">Aho 2023</a>)</span>. Despite resources, however, it is expected that users refer to the <a href="https://www.tcl.tk/man/tcl8.6/UserCmd/contents.html">Tcl/Tk package manual</a> for argument lists and descriptions of <em>tcltk</em> functions. Arguments in <em>tcltk</em> functions (generally) have the same names and functionality as their Tcl/tk equivalents, although some experimentation may be necessary.
<!-- This section is partially an effort to concatenate and distill existing information concerning *tcltk*. --></p>
<p>Tcl/Tk itself is cross platform, and uses facilities particular to the underlying OS. These are <em>Xlib</em> (X11) (a windowing system, written in C, for bitmap displays) for Unix/Linux, <em>Cocoa</em> for Mac OS, and the <em>Graphics Device Interface</em> (GDI) for Windows.</p>
<p>So-called <em>Themed Tk</em> (Ttk) GUIs often have advantages over older Tk GUIs, including anti-aliased font rendering, and have been a part of the Tk distribution since Tcl version 8.5. Naming conventions in <em>tcltk</em> indicate whether functions are binding for Tk or Ttk operations. The former function names start with <code>tk</code>, while the latter start with <code>ttk</code>.</p>
<p>Notably, <em>tcltk</em> GUIs that use or manipulate <strong>R</strong> graphics devices, particularly those with slider widgets, may work poorly with the native RStudio graphics device: <code>RStudioGD</code>. Thus, to run these sorts of GUIs in RStudio, one should open a non-<code>RStudioGD</code> device using:</p>
<div class="sourceCode" id="cb1170"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.new</a></span><span class="op">(</span>noRStudioGD <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>
</p>
<div class="example">
<p><span id="exm:exm-c11tcltkex" class="example"><strong>Example 11.1  </strong></span><span class="math inline">\(\text{}\)</span><br>
The binding mechanisms of <em>tcltk</em> can be viewed by examining underlying code from some its seminal functions. The <em>tcltk</em> function <code><a href="https://rdrr.io/r/tcltk/TkCommands.html">tcl()</a></code> provides a generic interface for calling any Tk or Tcl command<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;The code: &lt;code&gt;tcl("label", tt, text = "Hello world", bg = "red")&lt;/code&gt; is equivalent to &lt;code&gt;tklabel(tt, text = "Hello world", bg = "red")&lt;/code&gt;, where &lt;code&gt;tt&lt;/code&gt; is the top-level GUI object. Both prompt the Tcl/tk code: &lt;code&gt;label tp -text "Hello world"  -bg red&lt;/code&gt;, where &lt;code&gt;tp&lt;/code&gt; is the path name of the Tcl/Tk label object.&lt;/p&gt;'><sup>100</sup></a>. Indeed, many other <em>tcltk</em> commands are simply calls to <code><a href="https://rdrr.io/r/tcltk/TkCommands.html">tcl()</a></code>.</p>
<p>We see that <code><a href="https://rdrr.io/r/tcltk/TkCommands.html">tcl()</a></code> calls <code><a href="https://rdrr.io/r/tcltk/TclInterface.html">.Tcl.objv()</a></code> whose arguments, in turn, are formatted by <code><a href="https://rdrr.io/r/tcltk/TclInterface.html">.Tcl.args.objv()</a></code>.</p>
<div class="sourceCode" id="cb1171"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va">tcltk</span><span class="op">)</span></span>
<span><span class="va">tcl</span></span></code></pre></div>
<pre><code>function (...) 
.Tcl.objv(.Tcl.args.objv(...))
&lt;bytecode: 0x0000020d6ae6cc38&gt;
&lt;environment: namespace:tcltk&gt;</code></pre>
<p>The function <code><a href="https://rdrr.io/r/tcltk/TclInterface.html">.Tcl.objv()</a></code> calls an underlying C algorithm, <code>.C_dotTclObjv()</code>, using <code><a href="https://rdrr.io/r/base/CallExternal.html">.External()</a></code> that ostensibly binds <code><a href="https://rdrr.io/r/tcltk/TkCommands.html">tcl()</a></code> to Tcl/Tk.</p>
<div class="sourceCode" id="cb1173"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">.Tcl.objv</span></span></code></pre></div>
<pre><code>function (objv) 
structure(.External(.C_dotTclObjv, objv), class = "tclObj")
&lt;bytecode: 0x0000020d6ae70228&gt;
&lt;environment: namespace:tcltk&gt;</code></pre>
<p>The compiled C executable (Section <a href="ch9.html#interp">9.1</a>), <code>tcltk.dll</code>, is housed in the <em>tlctk</em> package <code>libs/x64</code> directory (Ch <a href="ch10.html#ch10">10</a>).</p>
<div class="sourceCode" id="cb1175"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tcltk</span><span class="fu">:::</span><span class="va">.C_dotTclObjv</span><span class="op">$</span><span class="va">dll</span></span></code></pre></div>
<pre><code>DLL name: tcltk
Filename: C:/Program
       Files/R/R-4.4.2/library/tcltk/libs/x64/tcltk.dll
Dynamic lookup: FALSE</code></pre>
<p>
</p>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
<div class="example">
<p><span id="exm:exm-c111" class="example"><strong>Example 11.2  </strong></span><span class="math inline">\(\text{}\)</span> As an initial foray into <em>tcltk</em> GUI-building we will create a button interface whose only purpose is to provide a message, and a means for its own destruction.</p>
<style type="text/css">
pre.numberSource code > span > a:first-child::before {
  left: -.05em;
}
</style>
<div class="sourceCode" id="cb1177"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb1177-1"><a href="ch11.html#cb1177-1"></a>tt <span class="ot">&lt;-</span> <span class="fu">tktoplevel</span>()</span>
<span id="cb1177-2"><a href="ch11.html#cb1177-2"></a>hello <span class="ot">&lt;-</span> <span class="fu">tkmessage</span>(tt, <span class="at">text =</span> <span class="st">"Hello world!"</span>)</span>
<span id="cb1177-3"><a href="ch11.html#cb1177-3"></a>spacer <span class="ot">=</span> <span class="fu">tklabel</span>(tt, <span class="at">padx =</span> <span class="dv">20</span>)</span>
<span id="cb1177-4"><a href="ch11.html#cb1177-4"></a>DM.but <span class="ot">&lt;-</span> <span class="fu">tkbutton</span>(tt, <span class="at">text =</span> <span class="st">"Exit"</span>, <span class="at">foreground =</span> <span class="st">"red"</span>,</span>
<span id="cb1177-5"><a href="ch11.html#cb1177-5"></a>                   <span class="at">background =</span> <span class="st">"lightgreen"</span>, <span class="at">padx =</span> <span class="dv">10</span>,</span>
<span id="cb1177-6"><a href="ch11.html#cb1177-6"></a>                   <span class="at">command =</span> <span class="cf">function</span>() <span class="fu">tkdestroy</span>(tt))</span>
<span id="cb1177-7"><a href="ch11.html#cb1177-7"></a><span class="fu">tkpack</span>(hello, spacer, DM.but)</span></code></pre></div>
<ul>
<li>On Line 1, I load the <em>tcltk</em> package.</li>
<li>On Line 2, I use use <code><a href="https://rdrr.io/r/tcltk/TkWidgets.html">tktoplevel()</a></code> to hierarchically define the “top level” widget as the object <code>tt</code>.</li>
<li>On Lines 3-4, I create a text message object, <code>hello</code>, and a spacer object, <code>spacer</code>. That latter is used to make room between the message and a button created in the next two lines of code.</li>
<li>On Lines 5-6 the button widget object <code>DM.but</code> is created, using the function <code><a href="https://rdrr.io/r/tcltk/TkWidgets.html">tkbutton()</a></code>. The first argument is name of parent widget, <code>tt</code>. The <code>text</code> argument provides a text label for the button. The arguments <code>foreground</code>, <code>background</code>, and <code>padx</code> are used to define the foreground color (the color of the button text label), the background color of the button, and to make the button wider, respectively. The <code>command</code> argument defines the function that the button initiates. In this case, the function <code><a href="https://rdrr.io/r/tcltk/TclInterface.html">tkdestroy()</a></code>, which destroys the GUI.</li>
<li>On Line 8, <code><a href="https://rdrr.io/r/tcltk/TkCommands.html">tkpack()</a></code> is used to place the button on the parent widget.</li>
</ul>
<p>The GUI itself is shown in Fig <a href="ch11.html#fig:tcltk1">11.1</a>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:tcltk1"></span>
<img src="figs11/tcltk1.png" alt="A simple *tcltk* GUI. " width="50%"><p class="caption">
Figure 11.1: A simple <em>tcltk</em> GUI.
</p>
</div>
<p>
</p>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
<div id="asswidget" class="section level3" number="11.2.1">
<h3>
<span class="header-section-number">11.2.1</span> Assigning and Manipulating Widget Values<a class="anchor" aria-label="anchor" href="#asswidget"><i class="fas fa-link"></i></a>
</h3>
<p>It is often useful to “remember” object characteristics and assignment values over the course of a GUI’s usage. For example, it may be necessary to count the number of times a button is pressed, or display a particular message based on a previous response. Because GUI actions will be carried out by local variables in functions, modifications to those variables will be lost when the function exits. While not usually good practice, one can use the super assignment operator <code>&lt;&lt;-</code> inside a function to create global variables. These will retain their values after the function exits.
</p>
<p>The <code><a href="https://rdrr.io/r/tcltk/TclInterface.html">tclVar()</a></code> function can be used to create an empty or specific values, which can then be used in call to other functions in the <em>tcltk</em> package. For example, to specify an empty <code><a href="https://rdrr.io/r/tcltk/TclInterface.html">tclVar()</a></code> value, one could use:</p>
<div class="sourceCode" id="cb1178"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myvar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/tcltk/TclInterface.html">tclVar</a></span><span class="op">(</span><span class="st">''</span><span class="op">)</span></span></code></pre></div>
<p>To access <code>myvar</code> information in widgets with <strong>R</strong> one could then use:</p>
<div class="sourceCode" id="cb1179"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rmyvar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/tcltk/TclInterface.html">tclvalue</a></span><span class="op">(</span><span class="va">myvar</span><span class="op">)</span></span></code></pre></div>
<p>Conjoined use of the super-assignment operator with <code><a href="https://rdrr.io/r/tcltk/TclInterface.html">tclVar()</a></code> and <code><a href="https://rdrr.io/r/tcltk/TkCommands.html">tcl()</a></code> is often very important when altering object parameters within <em>tcltk</em> functions.
</p>
</div>
<div id="user-functions-and-tcltk-guis" class="section level3" number="11.2.2">
<h3>
<span class="header-section-number">11.2.2</span> User functions and <em>tcltk</em> GUIs<a class="anchor" aria-label="anchor" href="#user-functions-and-tcltk-guis"><i class="fas fa-link"></i></a>
</h3>
<p>Callbacks are functions that are linked to GUI events. In <em>tclk</em> these functions can be user-defined, although they should not have arguments. Callbacks, user defined or otherwise, are generally executed using the <code>command</code> argument in a widget function. Recall, for example, use of <code>tkbutton(tt, command = functiton() tkdestroy)</code> in Example <a href="ch11.html#exm:exm-c111">11.2</a>. In general, a callback function <code>foo()</code> is called using <code>command = foo()</code> or <code>command = substitute(foo())</code>. Use of <code>substitute(foo())</code> allows substitution of variable values in <code>foo()</code>. Calling a function <code>bar()</code> from within the callback <code>foo()</code> may require coding similar to <code>foo &lt;- function(){substitute(bar())}</code>. See, for instance, <code><a href="https://rdrr.io/pkg/asbio/man/anm.ci.html">asbio::anm.ci.tck()</a></code>.
</p>
<div class="example">
<p><span id="exm:exm-c112" class="example"><strong>Example 11.3  </strong></span><span class="math inline">\(\text{}\)</span><br>
Consider the following silly example for finding the sum of two numbers.</p>
<div class="sourceCode" id="cb1180"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb1180-1"><a href="ch11.html#cb1180-1"></a>tt <span class="ot">&lt;-</span> <span class="fu">tktoplevel</span>()</span>
<span id="cb1180-2"><a href="ch11.html#cb1180-2"></a>tw1 <span class="ot">&lt;-</span> <span class="fu">tclVar</span>(<span class="st">''</span>); tw2 <span class="ot">&lt;-</span> <span class="fu">tclVar</span>(<span class="st">''</span>)</span>
<span id="cb1180-3"><a href="ch11.html#cb1180-3"></a>tke1 <span class="ot">&lt;-</span> <span class="fu">tkentry</span>(tt, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">textvariable =</span> tw1, <span class="at">justify =</span> <span class="st">"center"</span>)</span>
<span id="cb1180-4"><a href="ch11.html#cb1180-4"></a>tke2 <span class="ot">&lt;-</span> <span class="fu">tkentry</span>(tt, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">textvariable =</span> tw2, <span class="at">justify =</span> <span class="st">"center"</span>)</span>
<span id="cb1180-5"><a href="ch11.html#cb1180-5"></a></span>
<span id="cb1180-6"><a href="ch11.html#cb1180-6"></a>sumf <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb1180-7"><a href="ch11.html#cb1180-7"></a>  temp <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">tclvalue</span>(tw1)) <span class="sc">+</span> <span class="fu">as.numeric</span>(<span class="fu">tclvalue</span>(tw2))</span>
<span id="cb1180-8"><a href="ch11.html#cb1180-8"></a>  <span class="fu">tkconfigure</span>(ans, <span class="at">text =</span> <span class="fu">paste</span>(temp))</span>
<span id="cb1180-9"><a href="ch11.html#cb1180-9"></a>}</span>
<span id="cb1180-10"><a href="ch11.html#cb1180-10"></a></span>
<span id="cb1180-11"><a href="ch11.html#cb1180-11"></a>ans <span class="ot">&lt;-</span> <span class="fu">tklabel</span>(tt, <span class="at">text =</span> <span class="st">''</span>, <span class="at">background=</span><span class="st">"white"</span>, <span class="at">relief =</span> <span class="st">"sunken"</span>, <span class="at">padx =</span> <span class="dv">20</span>)</span>
<span id="cb1180-12"><a href="ch11.html#cb1180-12"></a><span class="fu">tkgrid</span>(tke1, <span class="fu">tklabel</span>(tt, <span class="at">text =</span> <span class="st">'+'</span>), tke2, <span class="fu">tklabel</span>(tt, <span class="at">text =</span> <span class="st">'='</span>), ans)</span>
<span id="cb1180-13"><a href="ch11.html#cb1180-13"></a><span class="fu">tkgrid</span>(<span class="fu">tklabel</span>(tt, <span class="at">text =</span> <span class="st">''</span>), <span class="at">columnspan =</span> <span class="dv">5</span>)</span>
<span id="cb1180-14"><a href="ch11.html#cb1180-14"></a><span class="fu">tkgrid</span>(<span class="fu">tkbutton</span>(tt, <span class="at">text =</span> <span class="st">'Get Sum!'</span>, <span class="at">foreground =</span> <span class="st">"red"</span>,</span>
<span id="cb1180-15"><a href="ch11.html#cb1180-15"></a>                   <span class="at">background =</span> <span class="st">"lightgreen"</span>, <span class="at">command =</span> sumf),</span>
<span id="cb1180-16"><a href="ch11.html#cb1180-16"></a>       <span class="at">columnspan =</span> <span class="dv">5</span>, <span class="at">sticky =</span> <span class="st">"e"</span>)</span></code></pre></div>
<ul>
<li>On Line 1, I use <code><a href="https://rdrr.io/r/tcltk/TkWidgets.html">tktoplevel()</a></code> to define the “top level” widget.</li>
<li>On Line 2, I specify empty initial values for the variables <code>tw1</code> and <code>tw2</code> using <code><a href="https://rdrr.io/r/tcltk/TclInterface.html">tclVar()</a></code>. These values will be editable by users via <code><a href="https://rdrr.io/r/tcltk/TkWidgets.html">tkentry()</a></code> widgets.</li>
<li>On Lines 3-4, I use the function <code><a href="https://rdrr.io/r/tcltk/TkWidgets.html">tkentry()</a></code> to provide widgets for users to enter numbers to be summed.</li>
<li>On Lines 6-9, I create the function <code>sumf</code>. The function <code><a href="https://rdrr.io/r/tcltk/TclInterface.html">tclvalue()</a></code>, used to compute the summation object <code>temp</code>, allows Tcl variables from <code><a href="https://rdrr.io/r/tcltk/TclInterface.html">tclVar()</a></code> to be evaluated in <strong>R</strong>. These variables, however, will have class <code>character</code>, and will require <code><a href="https://rdrr.io/r/base/numeric.html">as.numeric()</a></code>, as shown, for mathematical evaluation. One Line 8 (the final line of code in <code>sumf</code>, <code><a href="https://rdrr.io/r/tcltk/TkWidgetcmds.html">tkconfigure()</a></code> is used to potentially change <code>ans</code>, a <code><a href="https://rdrr.io/r/tcltk/TkWidgets.html">tkentry()</a></code> object defined on Line 11.</li>
<li>On Line 11, the <code><a href="https://rdrr.io/r/tcltk/TkWidgets.html">tkentry()</a></code> object <code>ans</code> is created and an initial empty value is assigned.</li>
<li>On Lines 12-16, widgets are placed in the GUI using <code><a href="https://rdrr.io/r/tcltk/TkCommands.html">tkgrid()</a></code>. The use of grid geometry approaches including <code><a href="https://rdrr.io/r/tcltk/TkCommands.html">tkgrid()</a></code> is elaborated next. The <code>tkbutton</code> widget in the final (bottom) grid of the GUI calls the <code>sumf</code> using either <code>command = sumf</code>, as shown, or <code>command = substitute(sumf())</code>.</li>
</ul>
<p>
The resulting GUI is shown in Fig <a href="ch11.html#fig:getsum">11.2</a>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:getsum"></span>
<img src="figs11/getsum.png" alt="A simple *tcltk* GUI, demonstrating the use of `tclVar()` and `tclvalue()`." width="50%"><p class="caption">
Figure 11.2: A simple <em>tcltk</em> GUI, demonstrating the use of <code><a href="https://rdrr.io/r/tcltk/TclInterface.html">tclVar()</a></code> and <code><a href="https://rdrr.io/r/tcltk/TclInterface.html">tclvalue()</a></code>.
</p>
</div>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
</div>
<div id="gui-geometry" class="section level3" number="11.2.3">
<h3>
<span class="header-section-number">11.2.3</span> GUI Geometry<a class="anchor" aria-label="anchor" href="#gui-geometry"><i class="fas fa-link"></i></a>
</h3>
<p>An important consideration in GUI development is <em>geometry management</em>, e.g., the dimensions of the GUI and the organization of widgets. By default, Tcl/Tk GUI windows are autosized to hold widgets as they are added. Widgets may be reorganized as the sizes of windows are altered. If a Window becomes too small to contain widgets, the last widget added will be the first removed.</p>
<p>The initial size of GUIs can be specified using the function <code><a href="https://rdrr.io/r/tcltk/TkWidgets.html">tkcanvas()</a></code>. The result of the code below is shown in Fig <a href="ch11.html#fig:wide">11.3</a></p>
<div class="sourceCode" id="cb1181"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/tcltk/TkWidgets.html">tktoplevel</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/tcltk/TkCommands.html">tktitle</a></span><span class="op">(</span><span class="va">tt</span><span class="op">)</span> <span class="op">=</span> <span class="st">"Wide GUI"</span></span>
<span><span class="va">dim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/tcltk/TkWidgets.html">tkcanvas</a></span><span class="op">(</span><span class="va">tt</span>, height <span class="op">=</span> <span class="fl">30</span>, width <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/tcltk/TkCommands.html">tkgrid</a></span><span class="op">(</span><span class="va">dim</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:wide"></span>
<img src="figs11/wide.png" alt="A *tcltk* GUI whose initial width was specified using `tkcanvas()`." width="95%"><p class="caption">
Figure 11.3: A <em>tcltk</em> GUI whose initial width was specified using <code><a href="https://rdrr.io/r/tcltk/TkWidgets.html">tkcanvas()</a></code>.
</p>
</div>
<p>Three different geometry managers are available in Tcl/Tk for inserting widgets in GUIs. These are called <em>placer</em>, <em>packer</em>, and <em>grid manager</em>. The placer tool is seldom used in GUI creation <span class="citation">(<a href="references.html#ref-dalgaard2001">Dalgaard 2001</a>)</span>. Thus, we will concentrate on GUI construction using packer and grid manager approaches. Only one of these approaches is generally used in the creation of a GUI. The initial Examples <a href="ch11.html#exm:exm-c111">11.2</a> and <a href="ch11.html#exm:exm-c112">11.3</a> use simple applications of packing and grid management, respectively.</p>
<div id="packing" class="section level4" number="11.2.3.1">
<h4>
<span class="header-section-number">11.2.3.1</span> Packing<a class="anchor" aria-label="anchor" href="#packing"><i class="fas fa-link"></i></a>
</h4>
<p>The function <code><a href="https://rdrr.io/r/tcltk/TkCommands.html">tkpack()</a></code> packs widgets around the edges of a conceptual cavity. Control of this process is provided by the <code>side</code>, which has options: <code>"left"</code>, <code>"right"</code>, <code>"top"</code> or <code>"bottom"</code>.
</p>
<div class="example">
<p><span id="exm:exm-c113" class="example"><strong>Example 11.4  </strong></span><span class="math inline">\(\text{}\)</span><br>
Note the result of the code below (Fig <a href="ch11.html#fig:pack">11.4</a>).</p>
<div class="sourceCode" id="cb1182"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb1182-1"><a href="ch11.html#cb1182-1"></a>tt <span class="ot">&lt;-</span> <span class="fu">tktoplevel</span>()</span>
<span id="cb1182-2"><a href="ch11.html#cb1182-2"></a>edge <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"top"</span>,<span class="st">"right"</span>,<span class="st">"bottom"</span>,<span class="st">"left"</span>)</span>
<span id="cb1182-3"><a href="ch11.html#cb1182-3"></a>buttons <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, </span>
<span id="cb1182-4"><a href="ch11.html#cb1182-4"></a>                  <span class="cf">function</span>(i) <span class="fu">tkbutton</span>(tt, <span class="at">text =</span> edge[i],</span>
<span id="cb1182-5"><a href="ch11.html#cb1182-5"></a>                     <span class="at">background =</span> <span class="st">"lightgreen"</span>, <span class="at">foreground =</span> <span class="st">"red"</span>))</span>
<span id="cb1182-6"><a href="ch11.html#cb1182-6"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb1182-7"><a href="ch11.html#cb1182-7"></a><span class="fu">tkpack</span>(buttons[[i]], <span class="at">side=</span>edge[i], <span class="at">fill =</span> <span class="st">"both"</span>)</span></code></pre></div>
<ul>
<li>On Line 1, the top level widget is designated.</li>
<li>On Line 2, a character vector is created, containing all the possible <code>side</code> options for the function <code><a href="https://rdrr.io/r/tcltk/TkCommands.html">tkpack()</a></code>.</li>
<li>On Lines 3-5, a four item list is generated containing four <code>tkbutton</code> widgets.</li>
<li>In Lines 6-7, buttons are accessed from the <code>buttons</code> list and packed, in order, at the specified locations <code>"top"</code>, <code>"right"</code>, <code>"bottom"</code>, and <code>"left"</code>. The argument <code>fill = "both"</code> ensures that the buttons will occupy all of their allocated <em>parcels</em> with respect to the <code><a href="https://rdrr.io/r/tcltk/TkCommands.html">tkpack()</a></code> conceptual central cavity. Because the <code>top</code> button was specified first, it takes up the entire top of the GUI. The <code>right</code> button, codified next, occupies the entire right-side of the GUI, except for the area now occupied by <code>top</code>, and so on. If an object does not fill its parcel it can be anchored to a GUI location using the <code><a href="https://rdrr.io/r/tcltk/TkCommands.html">tkpack()</a></code> argument <code>anchor</code>. This is accomplished by specifying compass-style values like <code>"n"</code> or <code>"sw"</code> which place a widget the middle top, and bottom left of the parcel, respectively. The default option is <code>anchor = "center"</code>.</li>
</ul>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:pack"></span>
<img src="figs11/pack.png" alt="A demonstration of the result of packing using `tkpack()`. Code follows [@dalgaard2001]." width="40%"><p class="caption">
Figure 11.4: A demonstration of the result of packing using <code><a href="https://rdrr.io/r/tcltk/TkCommands.html">tkpack()</a></code>. Code follows <span class="citation">(<a href="references.html#ref-dalgaard2001">Dalgaard 2001</a>)</span>.
</p>
</div>
<p></p>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
<div class="example">
<p><span id="exm:exm-c114" class="example"><strong>Example 11.5  </strong></span><span class="math inline">\(\text{}\)</span><br>
Calculator construction is often used as a pedagogic exercise in computer programming. As an extended example of packing using <code><a href="https://rdrr.io/r/tcltk/TkWidgets.html">tkframe()</a></code>, we will build a <em>tcltk</em> calculator GUI. For this example I am indebted to lecture notes for a 2011 <a href="https://www.stat.berkeley.edu/~s133/">statistical programming course</a> at UC Berkeley.</p>
<p>The most important coding concept used here is the pairing of the base <strong>R</strong> functions <code><a href="https://rdrr.io/r/base/parse.html">parse()</a></code> (which converts a string to an expression) and <code><a href="https://rdrr.io/r/base/eval.html">eval()</a></code> (which evaluates an expression). This combination allows the mathematical evaluation of a character string. Consider the string <code>"9 * 3"</code>. The mathematical solution can be obtained using:</p>
<div class="sourceCode" id="cb1183"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">txt</span> <span class="op">=</span> <span class="st">"9 * 3"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/eval.html">eval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/parse.html">parse</a></span><span class="op">(</span>text <span class="op">=</span> <span class="va">txt</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 27</code></pre>
<p>
</p>
<p>Our calculator GUI will require three functions: <code>mkput()</code>, <code>clearit()</code>, and <code>docalc()</code>. Each of the functions creates a global variable, <code>calcinp</code>, using the super assignment operator, <code>&lt;&lt;-</code>, that provides input to the calculator. Further, in all three functions, <code><a href="https://rdrr.io/r/tcltk/TkWidgetcmds.html">tkconfigure()</a></code> is used to change the calculator’s display, based on input from the GUI calculator keys.</p>
<div class="sourceCode" id="cb1185"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb1185-1"><a href="ch11.html#cb1185-1"></a>calcinp <span class="ot">&lt;-</span> <span class="st">''</span></span>
<span id="cb1185-2"><a href="ch11.html#cb1185-2"></a></span>
<span id="cb1185-3"><a href="ch11.html#cb1185-3"></a>mkput <span class="ot">&lt;-</span> <span class="cf">function</span>(sym){</span>
<span id="cb1185-4"><a href="ch11.html#cb1185-4"></a>       <span class="cf">function</span>(){</span>
<span id="cb1185-5"><a href="ch11.html#cb1185-5"></a>          calcinp <span class="ot">&lt;&lt;-</span> <span class="fu">paste</span>(calcinp, sym, <span class="at">sep=</span><span class="st">''</span>)</span>
<span id="cb1185-6"><a href="ch11.html#cb1185-6"></a>            <span class="fu">tkconfigure</span>(display, <span class="at">text =</span> calcinp)</span>
<span id="cb1185-7"><a href="ch11.html#cb1185-7"></a>          }</span>
<span id="cb1185-8"><a href="ch11.html#cb1185-8"></a>}</span></code></pre></div>
<ul>
<li><p>On Line 1 in the chunk above, <code>calcinp</code> is initially set to be an empty character string, i.e., <code>calcinp &lt;- ''</code>.</p></li>
<li><p>On Lines 3-8, the callback function <code>mkput</code> is defined. Note that <code>mkput</code> itself contains an argument-less function. This allows <code>mkput</code> to have an argument, <code>sym</code>, while satisfying the <em>tcltk</em> requirement for argument-less callbacks. The code on Line 5, <code>calcinp &lt;&lt;- paste(calcinp, sym, sep='')</code>, generates a global, updated form of <code>calcinp</code>, that combines an older <code>calcinp</code> value with a new calculator key specification, <code>sym</code>. The resulting string is placed in the display using <code><a href="https://rdrr.io/r/tcltk/TkWidgetcmds.html">tkconfigure()</a></code>.</p></li>
<li><p>The callback function <code>clearit</code> below, clears the display (Line 10), and redefines <code>calcinp</code> as an empty string (Line 11).</p></li>
</ul>
<div class="sourceCode" id="cb1186" startfrom="9"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r" style="counter-reset: source-line 8;"><span id="cb1186-9"><a href="ch11.html#cb1186-9"></a>clearit <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb1186-10"><a href="ch11.html#cb1186-10"></a>      <span class="fu">tkconfigure</span>(display, <span class="at">text =</span> <span class="st">''</span>)</span>
<span id="cb1186-11"><a href="ch11.html#cb1186-11"></a>      calcinp <span class="ot">&lt;&lt;-</span> <span class="st">''</span></span>
<span id="cb1186-12"><a href="ch11.html#cb1186-12"></a>      }</span></code></pre></div>
<ul>
<li>The callback function <code>docalc</code> below, evaluates the general <code>eval(parse(text = calcinp))</code> framework created by key entry, and provides exception handling in the case of key stroke errors by using <code>if(class(result) == 'try-error'); calcinp &lt;&lt;- 'Error'</code> on Lines 15-16. Importantly, the function <code><a href="https://rdrr.io/r/base/try.html">try()</a></code> (Line 14) will assign the class <code>try-error</code> to an expression that fails.
</li>
</ul>
<div class="sourceCode" id="cb1187" startfrom="13"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r" style="counter-reset: source-line 12;"><span id="cb1187-13"><a href="ch11.html#cb1187-13"></a>docalc <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb1187-14"><a href="ch11.html#cb1187-14"></a>      result <span class="ot">=</span> <span class="fu">try</span>(<span class="fu">eval</span>(<span class="fu">parse</span>(<span class="at">text =</span> calcinp)))</span>
<span id="cb1187-15"><a href="ch11.html#cb1187-15"></a>      <span class="cf">if</span>(<span class="fu">class</span>(result) <span class="sc">==</span> <span class="st">'try-error'</span>)</span>
<span id="cb1187-16"><a href="ch11.html#cb1187-16"></a>        calcinp <span class="ot">&lt;&lt;-</span> <span class="st">'Error'</span></span>
<span id="cb1187-17"><a href="ch11.html#cb1187-17"></a>      <span class="cf">else</span> calcinp <span class="ot">&lt;&lt;-</span> result</span>
<span id="cb1187-18"><a href="ch11.html#cb1187-18"></a>      <span class="fu">tkconfigure</span>(display, <span class="at">text =</span> calcinp)</span>
<span id="cb1187-19"><a href="ch11.html#cb1187-19"></a>      calcinp <span class="ot">&lt;&lt;-</span> <span class="st">''</span></span>
<span id="cb1187-20"><a href="ch11.html#cb1187-20"></a>      }</span></code></pre></div>
<p>We call these three functions in the GUI itself, which is generated in the code below (Lines 21-60).</p>
<ul>
<li>The largest calculator code component defines the form and arrangement of calculator key (27-60). Note that buttons are packed, by row, using <code><a href="https://rdrr.io/r/tcltk/TkCommands.html">tkpack()</a></code> within <code><a href="https://rdrr.io/r/tcltk/TkWidgets.html">tkframe()</a></code> objects. All button widgets use <code>command = mkput</code> except for the clear key, which uses <code>command = clearit</code>, and the equals key, which uses <code>command = docalc</code>.</li>
</ul>
<div class="sourceCode" id="cb1188" startfrom="21"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r" style="counter-reset: source-line 20;"><span id="cb1188-21"><a href="ch11.html#cb1188-21"></a>base <span class="ot">&lt;-</span> <span class="fu">tktoplevel</span>()</span>
<span id="cb1188-22"><a href="ch11.html#cb1188-22"></a><span class="fu">tkwm.title</span>(base,<span class="st">'Calculator'</span>)</span>
<span id="cb1188-23"><a href="ch11.html#cb1188-23"></a></span>
<span id="cb1188-24"><a href="ch11.html#cb1188-24"></a>display <span class="ot">&lt;-</span> <span class="fu">tklabel</span>(base,<span class="at">justify=</span><span class="st">'right'</span>,<span class="at">background=</span><span class="st">"white"</span>,</span>
<span id="cb1188-25"><a href="ch11.html#cb1188-25"></a>                   <span class="at">relief=</span><span class="st">"sunken"</span>, <span class="at">padx =</span> <span class="dv">50</span>)</span>
<span id="cb1188-26"><a href="ch11.html#cb1188-26"></a><span class="fu">tkpack</span>(display,<span class="at">side=</span><span class="st">'top'</span>)</span>
<span id="cb1188-27"><a href="ch11.html#cb1188-27"></a>row1 <span class="ot">&lt;-</span> <span class="fu">tkframe</span>(base)</span>
<span id="cb1188-28"><a href="ch11.html#cb1188-28"></a><span class="fu">tkpack</span>(<span class="fu">tkbutton</span>(row1,<span class="at">text=</span><span class="st">'7'</span>,<span class="at">command=</span><span class="fu">mkput</span>(<span class="st">'7'</span>),<span class="at">width=</span><span class="dv">3</span>),<span class="at">side=</span><span class="st">'left'</span>)</span>
<span id="cb1188-29"><a href="ch11.html#cb1188-29"></a><span class="fu">tkpack</span>(<span class="fu">tkbutton</span>(row1,<span class="at">text=</span><span class="st">'8'</span>,<span class="at">command=</span><span class="fu">mkput</span>(<span class="st">'8'</span>),<span class="at">width=</span><span class="dv">3</span>),<span class="at">side=</span><span class="st">'left'</span>)</span>
<span id="cb1188-30"><a href="ch11.html#cb1188-30"></a><span class="fu">tkpack</span>(<span class="fu">tkbutton</span>(row1,<span class="at">text=</span><span class="st">'9'</span>,<span class="at">command=</span><span class="fu">mkput</span>(<span class="st">'9'</span>),<span class="at">width=</span><span class="dv">3</span>),<span class="at">side=</span><span class="st">'left'</span>)</span>
<span id="cb1188-31"><a href="ch11.html#cb1188-31"></a><span class="fu">tkpack</span>(<span class="fu">tkbutton</span>(row1,<span class="at">text=</span><span class="st">'+'</span>,<span class="at">command=</span><span class="fu">mkput</span>(<span class="st">'+'</span>),<span class="at">width=</span><span class="dv">3</span>),<span class="at">side=</span><span class="st">'left'</span>)</span>
<span id="cb1188-32"><a href="ch11.html#cb1188-32"></a><span class="fu">tkpack</span>(row1,<span class="at">side=</span><span class="st">'top'</span>)</span>
<span id="cb1188-33"><a href="ch11.html#cb1188-33"></a></span>
<span id="cb1188-34"><a href="ch11.html#cb1188-34"></a>row2 <span class="ot">&lt;-</span> <span class="fu">tkframe</span>(base)</span>
<span id="cb1188-35"><a href="ch11.html#cb1188-35"></a><span class="fu">tkpack</span>(<span class="fu">tkbutton</span>(row2,<span class="at">text=</span><span class="st">'4'</span>,<span class="at">command=</span><span class="fu">mkput</span>(<span class="st">'4'</span>),<span class="at">width=</span><span class="dv">3</span>),<span class="at">side=</span><span class="st">'left'</span>)</span>
<span id="cb1188-36"><a href="ch11.html#cb1188-36"></a><span class="fu">tkpack</span>(<span class="fu">tkbutton</span>(row2,<span class="at">text=</span><span class="st">'5'</span>,<span class="at">command=</span><span class="fu">mkput</span>(<span class="st">'5'</span>),<span class="at">width=</span><span class="dv">3</span>),<span class="at">side=</span><span class="st">'left'</span>)</span>
<span id="cb1188-37"><a href="ch11.html#cb1188-37"></a><span class="fu">tkpack</span>(<span class="fu">tkbutton</span>(row2,<span class="at">text=</span><span class="st">'6'</span>,<span class="at">command=</span><span class="fu">mkput</span>(<span class="st">'6'</span>),<span class="at">width=</span><span class="dv">3</span>),<span class="at">side=</span><span class="st">'left'</span>)</span>
<span id="cb1188-38"><a href="ch11.html#cb1188-38"></a><span class="fu">tkpack</span>(<span class="fu">tkbutton</span>(row2,<span class="at">text=</span><span class="st">'-'</span>,<span class="at">command=</span><span class="fu">mkput</span>(<span class="st">'-'</span>),<span class="at">width=</span><span class="dv">3</span>),<span class="at">side=</span><span class="st">'left'</span>)</span>
<span id="cb1188-39"><a href="ch11.html#cb1188-39"></a><span class="fu">tkpack</span>(row2,<span class="at">side=</span><span class="st">'top'</span>)</span>
<span id="cb1188-40"><a href="ch11.html#cb1188-40"></a></span>
<span id="cb1188-41"><a href="ch11.html#cb1188-41"></a>row3 <span class="ot">&lt;-</span> <span class="fu">tkframe</span>(base)</span>
<span id="cb1188-42"><a href="ch11.html#cb1188-42"></a><span class="fu">tkpack</span>(<span class="fu">tkbutton</span>(row3,<span class="at">text=</span><span class="st">'1'</span>,<span class="at">command=</span><span class="fu">mkput</span>(<span class="st">'1'</span>),<span class="at">width=</span><span class="dv">3</span>),<span class="at">side=</span><span class="st">'left'</span>)</span>
<span id="cb1188-43"><a href="ch11.html#cb1188-43"></a><span class="fu">tkpack</span>(<span class="fu">tkbutton</span>(row3,<span class="at">text=</span><span class="st">'2'</span>,<span class="at">command=</span><span class="fu">mkput</span>(<span class="st">'2'</span>),<span class="at">width=</span><span class="dv">3</span>),<span class="at">side=</span><span class="st">'left'</span>)</span>
<span id="cb1188-44"><a href="ch11.html#cb1188-44"></a><span class="fu">tkpack</span>(<span class="fu">tkbutton</span>(row3,<span class="at">text=</span><span class="st">'3'</span>,<span class="at">command=</span><span class="fu">mkput</span>(<span class="st">'3'</span>),<span class="at">width=</span><span class="dv">3</span>),<span class="at">side=</span><span class="st">'left'</span>)</span>
<span id="cb1188-45"><a href="ch11.html#cb1188-45"></a><span class="fu">tkpack</span>(<span class="fu">tkbutton</span>(row3,<span class="at">text=</span><span class="st">'*'</span>,<span class="at">command=</span><span class="fu">mkput</span>(<span class="st">'*'</span>),<span class="at">width=</span><span class="dv">3</span>),<span class="at">side=</span><span class="st">'left'</span>)</span>
<span id="cb1188-46"><a href="ch11.html#cb1188-46"></a><span class="fu">tkpack</span>(row3,<span class="at">side=</span><span class="st">'top'</span>)</span>
<span id="cb1188-47"><a href="ch11.html#cb1188-47"></a></span>
<span id="cb1188-48"><a href="ch11.html#cb1188-48"></a>row4 <span class="ot">&lt;-</span> <span class="fu">tkframe</span>(base)</span>
<span id="cb1188-49"><a href="ch11.html#cb1188-49"></a><span class="fu">tkpack</span>(<span class="fu">tkbutton</span>(row4,<span class="at">text=</span><span class="st">'0'</span>,<span class="at">command=</span><span class="fu">mkput</span>(<span class="st">'0'</span>),<span class="at">width=</span><span class="dv">3</span>),<span class="at">side=</span><span class="st">'left'</span>)</span>
<span id="cb1188-50"><a href="ch11.html#cb1188-50"></a><span class="fu">tkpack</span>(<span class="fu">tkbutton</span>(row4,<span class="at">text=</span><span class="st">'('</span>,<span class="at">command=</span><span class="fu">mkput</span>(<span class="st">'('</span>),<span class="at">width=</span><span class="dv">3</span>),<span class="at">side=</span><span class="st">'left'</span>)</span>
<span id="cb1188-51"><a href="ch11.html#cb1188-51"></a><span class="fu">tkpack</span>(<span class="fu">tkbutton</span>(row4,<span class="at">text=</span><span class="st">')'</span>,<span class="at">command=</span><span class="fu">mkput</span>(<span class="st">')'</span>),<span class="at">width=</span><span class="dv">3</span>),<span class="at">side=</span><span class="st">'left'</span>)</span>
<span id="cb1188-52"><a href="ch11.html#cb1188-52"></a><span class="fu">tkpack</span>(<span class="fu">tkbutton</span>(row4,<span class="at">text=</span><span class="st">'/'</span>,<span class="at">command=</span><span class="fu">mkput</span>(<span class="st">'/'</span>),<span class="at">width=</span><span class="dv">3</span>),<span class="at">side=</span><span class="st">'left'</span>)</span>
<span id="cb1188-53"><a href="ch11.html#cb1188-53"></a><span class="fu">tkpack</span>(row4,<span class="at">side=</span><span class="st">'top'</span>)</span>
<span id="cb1188-54"><a href="ch11.html#cb1188-54"></a></span>
<span id="cb1188-55"><a href="ch11.html#cb1188-55"></a>row5 <span class="ot">&lt;-</span> <span class="fu">tkframe</span>(base)</span>
<span id="cb1188-56"><a href="ch11.html#cb1188-56"></a><span class="fu">tkpack</span>(<span class="fu">tkbutton</span>(row5,<span class="at">text=</span><span class="st">'.'</span>,<span class="at">command=</span><span class="fu">mkput</span>(<span class="st">'.'</span>),<span class="at">width=</span><span class="dv">3</span>),<span class="at">side=</span><span class="st">'left'</span>)</span>
<span id="cb1188-57"><a href="ch11.html#cb1188-57"></a><span class="fu">tkpack</span>(<span class="fu">tkbutton</span>(row5,<span class="at">text=</span><span class="st">'^'</span>,<span class="at">command=</span><span class="fu">mkput</span>(<span class="st">'^'</span>),<span class="at">width=</span><span class="dv">3</span>),<span class="at">side=</span><span class="st">'left'</span>)</span>
<span id="cb1188-58"><a href="ch11.html#cb1188-58"></a><span class="fu">tkpack</span>(<span class="fu">tkbutton</span>(row5,<span class="at">text=</span><span class="st">'C'</span>,<span class="at">command=</span>clearit,<span class="at">width=</span><span class="dv">3</span>),<span class="at">side=</span><span class="st">'left'</span>)</span>
<span id="cb1188-59"><a href="ch11.html#cb1188-59"></a><span class="fu">tkpack</span>(<span class="fu">tkbutton</span>(row5,<span class="at">text=</span><span class="st">'='</span>,<span class="at">command=</span>docalc,<span class="at">width=</span><span class="dv">3</span>),<span class="at">side=</span><span class="st">'left'</span>)</span>
<span id="cb1188-60"><a href="ch11.html#cb1188-60"></a><span class="fu">tkpack</span>(row5,<span class="at">side=</span><span class="st">'top'</span>)</span></code></pre></div>
<p>A slightly modified form of the GUI (with colored buttons)<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Code for Fig &lt;a href="ch11.html#fig:tcltkcalc"&gt;11.5&lt;/a&gt; can be obtained using &lt;code&gt;source(url("http://www2.cose.isu.edu/~ahoken/book/calctcltk.R"))&lt;/code&gt;.&lt;/p&gt;'><sup>101</sup></a> is shown in Fig <a href="ch11.html#fig:tcltkcalc">11.5</a>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:tcltkcalc"></span>
<img src="figs11/tcltk_calc.png" alt="A Tcl/Tk calculator GUI generated using the **R** package *tcltk*." width="45%"><p class="caption">
Figure 11.5: A Tcl/Tk calculator GUI generated using the <strong>R</strong> package <em>tcltk</em>.
</p>
</div>
<p>The Python library <em>tkinter</em> provides a well supported binding resource for Tcl/Tk. As we know (Ch <a href="ch9.html#ch9">9</a>) Python code can be run in <strong>R</strong>, using the package <em>reticulate</em>. Fig <a href="ch11.html#fig:tkintercalc">11.6</a> shows an analogous calculator the one shown in Fig <a href="ch11.html#fig:tcltkcalc">11.5</a>, generated in <strong>R</strong> via the Python script <code>calc.py</code>, which is contained at the book website. It is important to note that while the resulting GUI is generated below in an RStudio <strong>R</strong> chunk, via <em>reticulate</em>, the code and engines for running the GUI are Python, and thus, do not actually require <strong>R</strong>.</p>
<div class="sourceCode" id="cb1189"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/reticulate/">reticulate</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/py_run.html">py_run_file</a></span><span class="op">(</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/source_python.html">source_python</a></span><span class="op">(</span><span class="st">"http://www2.cose.isu.edu/~ahoken/book/calc.py"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The function <code><a href="https://rstudio.github.io/reticulate/reference/source_python.html">reticulate::source_python()</a></code> allows one to access Python source code.
</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:tkintercalc"></span>
<img src="figs11/tcltk_tkinter.png" alt="A Tcl/Tk calculator GUI generated using Python code via the Python binding library *tkinter*. Code follows a Python demo at the the [geeksforgeeks](https://www.geeksforgeeks.org/python-simple-calculator-using-tkinter/) website." width="50%"><p class="caption">
Figure 11.6: A Tcl/Tk calculator GUI generated using Python code via the Python binding library <em>tkinter</em>. Code follows a Python demo at the the <a href="https://www.geeksforgeeks.org/python-simple-calculator-using-tkinter/">geeksforgeeks</a> website.
</p>
</div>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
<p>
</p>
</div>
<div id="grid-manager" class="section level4" number="11.2.3.2">
<h4>
<span class="header-section-number">11.2.3.2</span> Grid Manager<a class="anchor" aria-label="anchor" href="#grid-manager"><i class="fas fa-link"></i></a>
</h4>
<p>Use of <code><a href="https://rdrr.io/r/tcltk/TkCommands.html">tkpack()</a></code> and <code><a href="https://rdrr.io/r/tcltk/TkWidgets.html">tkframe()</a></code> provides a great deal of flexibility for creating GUI layouts. They are, however, insufficient for handling a number of issues including lining widgets up vertically and horizontally. The grid manager function <code><a href="https://rdrr.io/r/tcltk/TkCommands.html">tkgrid()</a></code> can be used to lay out widgets in rows and columns using the arguments <code>column</code> and <code>row</code>. Importantly, <code>column = 0</code> and <code>row = 0</code> equate to the first column and first row, respectively, in a GUI or container widget. Additional important
<code><a href="https://rdrr.io/r/tcltk/TkCommands.html">tkgrid()</a></code> arguments include <code>columnspan</code>, <code>rowspan</code>, and <code>sticky</code>. The latter argument is analogous to <code>side</code> in <code><a href="https://rdrr.io/r/tcltk/TkCommands.html">tkpack()</a></code>.</p>
<p></p>
<div class="example">
<p><span id="exm:exm-c115a" class="example"><strong>Example 11.6  </strong></span><span class="math inline">\(\text{}\)</span><br>
The callback function below creates a single large blue dot in an <strong>R</strong> graphics device whose vertical position can be altered with a slider widget.</p>
<div class="sourceCode" id="cb1190"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb1190-1"><a href="ch11.html#cb1190-1"></a>plot.me <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb1190-2"><a href="ch11.html#cb1190-2"></a>  y <span class="ot">&lt;-</span> <span class="fu">evalq</span>(<span class="fu">tclvalue</span>(SliderValue)) <span class="co"># Evaluate the expression</span></span>
<span id="cb1190-3"><a href="ch11.html#cb1190-3"></a>  <span class="fu">plot</span>(<span class="dv">1</span>, <span class="fu">as.numeric</span>(y),<span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">"%"</span>, <span class="at">xaxt =</span> <span class="st">"n"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>),</span>
<span id="cb1190-4"><a href="ch11.html#cb1190-4"></a>       <span class="at">cex =</span> <span class="dv">4</span>, <span class="at">col =</span> <span class="dv">4</span>, <span class="at">pch =</span> <span class="dv">19</span>)</span>
<span id="cb1190-5"><a href="ch11.html#cb1190-5"></a>}</span></code></pre></div>
<p>The operation <code>evalq(foo)</code>, (Line 2) above, is equivalent to <code>eval(quote(foo))</code>. The operation <code>quote(foo)</code> simply returns the argument <code>foo</code> as an object of class “call”.
}</p>
<p>The GUI code below uses grid geometry to place widgets in specified GUI rows and columns.</p>
<div class="sourceCode" id="cb1191" startfrom="6"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r" style="counter-reset: source-line 5;"><span id="cb1191-6"><a href="ch11.html#cb1191-6"></a><span class="cf">if</span>(<span class="fu">names</span>(<span class="fu">dev.cur</span>()) <span class="sc">==</span> <span class="st">"RStudioGD"</span>) <span class="fu">dev.new</span>(<span class="at">noRStudioGD =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1191-7"><a href="ch11.html#cb1191-7"></a></span>
<span id="cb1191-8"><a href="ch11.html#cb1191-8"></a>slider.env <span class="ot">&lt;&lt;-</span> <span class="fu">new.env</span>()</span>
<span id="cb1191-9"><a href="ch11.html#cb1191-9"></a>tt <span class="ot">&lt;-</span> <span class="fu">tktoplevel</span>(); <span class="fu">tkwm.title</span>(tt, <span class="st">"Slider demo"</span>)</span>
<span id="cb1191-10"><a href="ch11.html#cb1191-10"></a>SliderValue <span class="ot">&lt;-</span> <span class="fu">tclVar</span>(<span class="st">"50"</span>)</span>
<span id="cb1191-11"><a href="ch11.html#cb1191-11"></a>SliderValueLabel <span class="ot">&lt;-</span> <span class="fu">tklabel</span>(tt, <span class="at">text =</span> <span class="fu">as.character</span>(<span class="fu">tclvalue</span>(SliderValue)))</span>
<span id="cb1191-12"><a href="ch11.html#cb1191-12"></a><span class="fu">tkgrid</span>(<span class="fu">tklabel</span>(tt, <span class="at">text =</span> <span class="st">"Slider Value: "</span>),</span>
<span id="cb1191-13"><a href="ch11.html#cb1191-13"></a>       SliderValueLabel, <span class="fu">tklabel</span>(tt, <span class="at">text =</span> <span class="st">"%"</span>))</span>
<span id="cb1191-14"><a href="ch11.html#cb1191-14"></a><span class="fu">tkconfigure</span>(SliderValueLabel, <span class="at">textvariable =</span> SliderValue)</span>
<span id="cb1191-15"><a href="ch11.html#cb1191-15"></a></span>
<span id="cb1191-16"><a href="ch11.html#cb1191-16"></a>slider <span class="ot">&lt;-</span> <span class="fu">tkscale</span>(tt, <span class="at">from =</span> <span class="dv">100</span>, <span class="at">to =</span> <span class="dv">0</span>, <span class="at">showvalue =</span> F,</span>
<span id="cb1191-17"><a href="ch11.html#cb1191-17"></a>                  <span class="at">variable =</span> SliderValue, <span class="at">resolution =</span> <span class="dv">1</span>,</span>
<span id="cb1191-18"><a href="ch11.html#cb1191-18"></a>                  <span class="at">orient =</span> <span class="st">"vertical"</span>, <span class="at">command =</span> <span class="fu">substitute</span>(<span class="fu">plot.me</span>()))</span>
<span id="cb1191-19"><a href="ch11.html#cb1191-19"></a></span>
<span id="cb1191-20"><a href="ch11.html#cb1191-20"></a><span class="fu">tkgrid</span>(slider, <span class="at">column =</span> <span class="dv">0</span>, <span class="at">row =</span> <span class="dv">1</span>, <span class="at">columnspan =</span> <span class="dv">2</span>)</span>
<span id="cb1191-21"><a href="ch11.html#cb1191-21"></a>message <span class="ot">=</span> <span class="fu">tkmessage</span>(tt, <span class="at">text =</span> <span class="st">"Move the slider to see changes in the plot"</span>)</span>
<span id="cb1191-22"><a href="ch11.html#cb1191-22"></a><span class="fu">tkgrid</span>(message, <span class="at">column =</span> <span class="dv">3</span>, <span class="at">row =</span> <span class="dv">1</span>)</span></code></pre></div>
<ul>
<li>On Line 6, I insure that the interactive will work in the RStudio system by creating a non-RStudio graphics device if the default device is <code>"RStudioGD"</code>. The code should work inside and outside of RStudio.</li>
<li>On Line 8, I create an environment for the slider widget using <code><a href="https://rdrr.io/r/base/environment.html">new.env()</a></code>.</li>
<li>On Line 9, I use use <code><a href="https://rdrr.io/r/tcltk/TkWidgets.html">tktoplevel()</a></code> to hierarchically define the “top level” widget as the object <code>tt</code>, and make a title.</li>
<li>On Line 10, I define 50 as the initial value for the slider widget that will be created.</li>
<li>On Line 11, a Tk label is created based on the slider output. Note the pairing of <code><a href="https://rdrr.io/r/tcltk/TclInterface.html">tclVar()</a></code> input and <code><a href="https://rdrr.io/r/tcltk/TclInterface.html">tclvalue()</a></code> output. In this process, the <code>SliderValueLabel</code> label object is configured to make its value equal to the <code>SliderValue</code> object.</li>
<li>On Lines 12-13, the <code>SliderValueLabel</code> is inserted between two text strings in a grid geometry.</li>
<li>On Lines 16-18, the slider is parameterized using the function <code><a href="https://rdrr.io/r/tcltk/TkWidgets.html">tkscale()</a></code>. The use of <code><a href="https://rdrr.io/r/base/substitute.html">substitute()</a></code> allows substitution of values for variables bound in the <code>plot.me()</code> function.</li>
<li>On Line 20, the slider is placed into the GUI at column 0 and row 1 (the first column and second row).</li>
<li>On Lines 21-22, a message is created and placed on the GUI at column 3 and row 1 (the fourth column and second row).
</li>
</ul>
<p>The form of the final GUI is shown in Figure <a href="ch11.html#fig:tcltk2">11.7</a>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:tcltk2"></span>
<img src="figs11/tcltk2.png" alt="A *tcltk* GUI for manipulating an **R** plot." width="40%"><p class="caption">
Figure 11.7: A <em>tcltk</em> GUI for manipulating an <strong>R</strong> plot.
</p>
</div>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
<div class="example">
<p><span id="exm:exm-c11pack2" class="example"><strong>Example 11.7  </strong></span><span class="math inline">\(\text{}\)</span><br>
Here is another grid manager example with a radiobutton GUI that allows selection of a bacterial phylum and printing of <code>"Correct"</code>, <code>"Incorrect"</code> text in the console, based on the button selection. It also embeds a photo.</p>
<div class="sourceCode" id="cb1192"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb1192-1"><a href="ch11.html#cb1192-1"></a>tt <span class="ot">&lt;-</span> <span class="fu">tktoplevel</span>()</span>
<span id="cb1192-2"><a href="ch11.html#cb1192-2"></a><span class="fu">tkwm.title</span>(tt, <span class="st">"Bacterial phyla"</span>)</span>
<span id="cb1192-3"><a href="ch11.html#cb1192-3"></a><span class="fu">tkgrid</span>(<span class="fu">tklabel</span>(tt, <span class="at">text =</span> <span class="st">"Which phylum is shown?"</span>, <span class="at">padx =</span> <span class="dv">5</span>,</span>
<span id="cb1192-4"><a href="ch11.html#cb1192-4"></a>               <span class="at">pady =</span> <span class="dv">5</span>, <span class="at">font =</span> <span class="st">"bold"</span>), <span class="at">column =</span> <span class="dv">1</span>, <span class="at">row =</span> <span class="dv">1</span>)</span>
<span id="cb1192-5"><a href="ch11.html#cb1192-5"></a></span>
<span id="cb1192-6"><a href="ch11.html#cb1192-6"></a>values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Acidobacteriota"</span>, <span class="st">"Armatimonadota"</span>,</span>
<span id="cb1192-7"><a href="ch11.html#cb1192-7"></a>            <span class="st">"Caldisericota"</span>, <span class="st">"Cyanobacteriota"</span>,</span>
<span id="cb1192-8"><a href="ch11.html#cb1192-8"></a>            <span class="st">"Elusimicrobiota"</span>, <span class="st">"Spirochaetota"</span>,</span>
<span id="cb1192-9"><a href="ch11.html#cb1192-9"></a>            <span class="st">"Thermomicrobia"</span>)</span>
<span id="cb1192-10"><a href="ch11.html#cb1192-10"></a></span>
<span id="cb1192-11"><a href="ch11.html#cb1192-11"></a>var <span class="ot">&lt;-</span> <span class="fu">tclVar</span>(values[<span class="dv">0</span>]) <span class="co"># initially, no phyla selected</span></span>
<span id="cb1192-12"><a href="ch11.html#cb1192-12"></a></span>
<span id="cb1192-13"><a href="ch11.html#cb1192-13"></a><span class="fu">tkimage.create</span>(<span class="st">"photo"</span>, <span class="st">"cyano"</span>, <span class="at">file =</span> <span class="st">"figs11/cyano.gif"</span>)</span>
<span id="cb1192-14"><a href="ch11.html#cb1192-14"></a></span>
<span id="cb1192-15"><a href="ch11.html#cb1192-15"></a>callback <span class="ot">&lt;-</span> <span class="cf">function</span>() <span class="fu">ifelse</span>(<span class="fu">tclvalue</span>(var) <span class="sc">==</span> <span class="st">"Cyanobacteriota"</span>,</span>
<span id="cb1192-16"><a href="ch11.html#cb1192-16"></a>                              <span class="fu">print</span>(<span class="st">"Correct"</span>),</span>
<span id="cb1192-17"><a href="ch11.html#cb1192-17"></a>                              <span class="fu">print</span>(<span class="st">"Incorrect"</span>))</span>
<span id="cb1192-18"><a href="ch11.html#cb1192-18"></a></span>
<span id="cb1192-19"><a href="ch11.html#cb1192-19"></a>lf <span class="ot">&lt;-</span> <span class="fu">ttkframe</span>(tt)</span>
<span id="cb1192-20"><a href="ch11.html#cb1192-20"></a><span class="fu">sapply</span>(values, <span class="cf">function</span>(x) {</span>
<span id="cb1192-21"><a href="ch11.html#cb1192-21"></a>  radio_button <span class="ot">&lt;-</span> <span class="fu">ttkradiobutton</span>(tt, <span class="at">variable =</span> var,</span>
<span id="cb1192-22"><a href="ch11.html#cb1192-22"></a>                                 <span class="at">text =</span> x, <span class="at">value =</span> x,</span>
<span id="cb1192-23"><a href="ch11.html#cb1192-23"></a>                                 <span class="at">command =</span> callback)</span>
<span id="cb1192-24"><a href="ch11.html#cb1192-24"></a></span>
<span id="cb1192-25"><a href="ch11.html#cb1192-25"></a> <span class="fu">tkgrid</span>(radio_button, <span class="at">pady =</span> <span class="dv">0</span>, <span class="at">padx =</span> <span class="dv">5</span>, <span class="at">sticky =</span> <span class="st">"nw"</span>,</span>
<span id="cb1192-26"><a href="ch11.html#cb1192-26"></a>        <span class="at">column =</span> <span class="dv">1</span>, <span class="at">rowspan =</span> <span class="dv">1</span>)</span>
<span id="cb1192-27"><a href="ch11.html#cb1192-27"></a> })</span>
<span id="cb1192-28"><a href="ch11.html#cb1192-28"></a></span>
<span id="cb1192-29"><a href="ch11.html#cb1192-29"></a><span class="fu">tkgrid</span>(<span class="fu">tklabel</span>(tt, <span class="at">text =</span> <span class="st">""</span>), <span class="at">sticky =</span> <span class="st">"n"</span>, <span class="at">column =</span> <span class="dv">1</span>,</span>
<span id="cb1192-30"><a href="ch11.html#cb1192-30"></a>       <span class="at">row =</span> <span class="dv">9</span>, <span class="at">columnspan =</span> <span class="dv">1</span>)</span>
<span id="cb1192-31"><a href="ch11.html#cb1192-31"></a>l <span class="ot">&lt;-</span> <span class="fu">ttklabel</span>(tt, <span class="at">image =</span> <span class="st">"cyano"</span>, <span class="at">relief =</span> <span class="st">"ridge"</span>)</span>
<span id="cb1192-32"><a href="ch11.html#cb1192-32"></a><span class="fu">tkgrid</span>(l, <span class="at">sticky =</span> <span class="st">"nw"</span>, <span class="at">rowspan =</span> <span class="dv">10</span>, <span class="at">column =</span> <span class="dv">2</span>,</span>
<span id="cb1192-33"><a href="ch11.html#cb1192-33"></a>       <span class="at">row =</span> <span class="dv">0</span>, <span class="at">pady =</span> <span class="dv">25</span>, <span class="at">padx =</span>  <span class="dv">10</span>)</span></code></pre></div>
<ul>
<li>On Line 1, the top level widget, <code>tt</code>, is designated.</li>
<li>On Line 2, a GUI title is created.</li>
<li>On Lines 3-4, the text “Which phylum is shown?” is placed in the column 1, row 1 position, using the grid manager function <code><a href="https://rdrr.io/r/tcltk/TkCommands.html">tkgrid()</a></code>.</li>
<li>On Lines 5-9, a character vector of bacterial phylum names is created for use in the GUI.</li>
<li>On Line 11 the initial phylum selection is specified. The use of <code>tclVar(values[0])</code> means that <em>no</em> selection will be initially designated.</li>
<li>On Line 13, the function <code><a href="https://rdrr.io/r/tcltk/TkCommands.html">tkimage.create()</a></code> is used to import a photo with .gif formatting (currently the only accepted format). The first argument <code>"photo"</code> indicates that an image will be created from a photo. The second argument creates an object name for the import, <code>"cyano"</code> that will called in later code.</li>
<li>On Lines 15-17, a callback function, <code>callback()</code> is created to print the text <code>"correct"</code> if Cyanobacteriota is selected, and print <code>"incorrect"</code> if some other selection is made.</li>
<li>On Line 19, an embedded frame is created to hold the radiobuttons.</li>
<li>On Lines 20-27, <code><a href="https://rdrr.io/r/base/lapply.html">sapply()</a></code> is used to run a user-defined function that embeds radiobuttons for each level in the character vector <code>values</code>.
<ul>
<li>On Line 21-23, the function creates an object <code>radio_button</code> using <code><a href="https://rdrr.io/r/tcltk/TkWidgets.html">ttkradiobutton()</a></code>. Note that the top-level path name, <code>tt</code> is given as the first argument, the initial radiobutton designation is given in the second argument, the arguments <code>text</code> and <code>value</code> will change levels in <code>vaues</code> change. the function <code>callback()</code> is called using the <code><a href="https://rdrr.io/r/tcltk/TkWidgets.html">ttkradiobutton()</a></code> <code>command</code> argument to respond to the selected radiobutton.</li>
<li>On Lines 25-26, radiobuttons are stacked, one row at a time, using <code><a href="https://rdrr.io/r/tcltk/TkCommands.html">tkgrid()</a></code>, as <code><a href="https://rdrr.io/r/base/lapply.html">sapply()</a></code> cycles through levles in <code>values</code>.</li>
</ul>
</li>
<li>On Lines 29-30, an aesthetic empty row is created at the bottom of column one create some additional space.</li>
<li>On Lines 31-32, the object <code>l</code> is created from the function <code><a href="https://rdrr.io/r/tcltk/TkWidgets.html">ttklabel()</a></code> to hold the image object <code>cyno</code>, created on Line 13.<br>
</li>
<li>On Lines 33-34, the image is embedded into the entirety of column two.</li>
</ul>
<p>The final form of the GUI is shown in Fig <a href="ch11.html#fig:phylaGUI">11.8</a>.</p>
<p>
</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:phylaGUI"></span>
<img src="figs11/phylaGUI.png" alt="A radiobutton *tcltk* GUI. Photo from CSIRO, CC BY 3.0, https://commons.wikimedia.org/w/index.php?curid=3548094" width="90%"><p class="caption">
Figure 11.8: A radiobutton <em>tcltk</em> GUI. Photo from CSIRO, CC BY 3.0, <a href="https://commons.wikimedia.org/w/index.php?curid=3548094" class="uri">https://commons.wikimedia.org/w/index.php?curid=3548094</a>
</p>
</div>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
</div>
</div>
<div id="widget-modifications" class="section level3" number="11.2.4">
<h3>
<span class="header-section-number">11.2.4</span> Widget Modifications<a class="anchor" aria-label="anchor" href="#widget-modifications"><i class="fas fa-link"></i></a>
</h3>
<p>Tcl/Tk provides shared modification settings for many of its widgets. These include the standard arguments <code>foreground</code> (the widget foreground color, see choices <a href="https://www.tcl.tk/man/tcl/TkCmd/colors.htm">here</a>), <code>background</code> (the widget background color), <code>image</code> (an image to display in the widget)<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;This requires creation with &lt;code&gt;tkimage.create()&lt;/code&gt; (see Example &lt;a href="ch11.html#exm:exm-c11pack2"&gt;11.7&lt;/a&gt;).&lt;/p&gt;'><sup>102</sup></a>, <code>relief</code> (the 3D appearance of the widget), <code>font</code>, and <code>text</code> (a text string to be placed in the widget), among many others. Be aware, however, that standard Tk widget modifiers may not always align with Ttk modifiers.</p>
<div class="example">
<p><span id="exm:exm-c11mod" class="example"><strong>Example 11.8  </strong></span><span class="math inline">\(\text{}\)</span><br></p>
<p>Here is an example of a GUI with working (but non-functional) widgets that allows demonstration of relief, background, and foreground color options for different types of widgets.</p>
<div class="sourceCode" id="cb1193"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb1193-1"><a href="ch11.html#cb1193-1"></a>types <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"flat"</span>, <span class="st">"groove"</span>, <span class="st">"raised"</span>, <span class="st">"ridge"</span>,</span>
<span id="cb1193-2"><a href="ch11.html#cb1193-2"></a>          <span class="st">"solid"</span>, <span class="st">"sunken"</span>)</span>
<span id="cb1193-3"><a href="ch11.html#cb1193-3"></a>bg <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"beige"</span>, <span class="st">"AntiqueWhite1"</span>, <span class="st">"aquamarine4"</span>, <span class="st">"burlywood3"</span>)</span>
<span id="cb1193-4"><a href="ch11.html#cb1193-4"></a>fg <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"BlueViolet"</span>,<span class="st">"aquamarine3"</span>, <span class="st">"white"</span>, <span class="st">"black"</span>)</span>
<span id="cb1193-5"><a href="ch11.html#cb1193-5"></a>          </span>
<span id="cb1193-6"><a href="ch11.html#cb1193-6"></a>base <span class="ot">=</span> <span class="fu">tktoplevel</span>()</span>
<span id="cb1193-7"><a href="ch11.html#cb1193-7"></a><span class="fu">tkwm.title</span>(base,<span class="st">"Widget Styles"</span>)</span>
<span id="cb1193-8"><a href="ch11.html#cb1193-8"></a></span>
<span id="cb1193-9"><a href="ch11.html#cb1193-9"></a>cnames <span class="ot">&lt;-</span> <span class="fu">tkframe</span>(base)</span>
<span id="cb1193-10"><a href="ch11.html#cb1193-10"></a><span class="fu">tkpack</span>(<span class="fu">tklabel</span>(cnames, <span class="at">text =</span> <span class="st">"Labels"</span>, <span class="at">font =</span> <span class="st">"bold"</span>),</span>
<span id="cb1193-11"><a href="ch11.html#cb1193-11"></a>       <span class="at">side =</span> <span class="st">"left"</span>, <span class="at">padx =</span> <span class="dv">3</span>)</span>
<span id="cb1193-12"><a href="ch11.html#cb1193-12"></a><span class="fu">tkpack</span>(<span class="fu">tklabel</span>(cnames, <span class="at">text =</span> <span class="st">"Buttons"</span>, <span class="at">font =</span> <span class="st">"bold"</span>),</span>
<span id="cb1193-13"><a href="ch11.html#cb1193-13"></a>       <span class="at">side =</span> <span class="st">"left"</span>, <span class="at">padx =</span> <span class="dv">17</span>)</span>
<span id="cb1193-14"><a href="ch11.html#cb1193-14"></a><span class="fu">tkpack</span>(<span class="fu">tklabel</span>(cnames, <span class="at">text =</span> <span class="st">"Radiobuttons"</span>, <span class="at">font =</span> <span class="st">"bold"</span>),</span>
<span id="cb1193-15"><a href="ch11.html#cb1193-15"></a>       <span class="at">side =</span> <span class="st">"left"</span>, <span class="at">padx =</span> <span class="dv">0</span>)</span>
<span id="cb1193-16"><a href="ch11.html#cb1193-16"></a><span class="fu">tkpack</span>(<span class="fu">tklabel</span>(cnames, <span class="at">text =</span> <span class="st">"Sliders"</span>, <span class="at">font =</span> <span class="st">"bold"</span>),</span>
<span id="cb1193-17"><a href="ch11.html#cb1193-17"></a>       <span class="at">side =</span> <span class="st">"left"</span>, <span class="at">padx =</span> <span class="dv">22</span>)</span>
<span id="cb1193-18"><a href="ch11.html#cb1193-18"></a><span class="fu">tkpack</span>(cnames, <span class="at">side =</span> <span class="st">"top"</span>, <span class="at">fill =</span> <span class="st">"both"</span>)</span>
<span id="cb1193-19"><a href="ch11.html#cb1193-19"></a></span>
<span id="cb1193-20"><a href="ch11.html#cb1193-20"></a>mkframe <span class="ot">&lt;-</span> <span class="cf">function</span>(type){</span>
<span id="cb1193-21"><a href="ch11.html#cb1193-21"></a>  fr <span class="ot">&lt;-</span> <span class="fu">tkframe</span>(base)</span>
<span id="cb1193-22"><a href="ch11.html#cb1193-22"></a>  <span class="fu">tkpack</span>(<span class="fu">tklabel</span>(fr, <span class="at">text =</span> type, <span class="at">relief =</span> type, </span>
<span id="cb1193-23"><a href="ch11.html#cb1193-23"></a>                 <span class="at">fg =</span> fg[<span class="dv">1</span>], <span class="at">bg =</span> bg[<span class="dv">1</span>]),</span>
<span id="cb1193-24"><a href="ch11.html#cb1193-24"></a>         <span class="at">side =</span> <span class="st">"left"</span>, <span class="at">padx =</span> <span class="dv">5</span>)</span>
<span id="cb1193-25"><a href="ch11.html#cb1193-25"></a>  <span class="fu">tkpack</span>(<span class="fu">tkbutton</span>(fr, <span class="at">text =</span> type, <span class="at">relief =</span> type, </span>
<span id="cb1193-26"><a href="ch11.html#cb1193-26"></a>                 <span class="at">fg =</span> fg[<span class="dv">2</span>], <span class="at">bg =</span> bg[<span class="dv">2</span>]),</span>
<span id="cb1193-27"><a href="ch11.html#cb1193-27"></a>         <span class="at">side =</span> <span class="st">"left"</span>, <span class="at">padx =</span> <span class="dv">30</span>)</span>
<span id="cb1193-28"><a href="ch11.html#cb1193-28"></a>  <span class="fu">tkpack</span>(<span class="fu">tkradiobutton</span>(fr, <span class="at">text =</span> type, <span class="at">relief =</span> type, </span>
<span id="cb1193-29"><a href="ch11.html#cb1193-29"></a>                 <span class="at">fg =</span> fg[<span class="dv">3</span>], <span class="at">bg =</span> bg[<span class="dv">3</span>]),</span>
<span id="cb1193-30"><a href="ch11.html#cb1193-30"></a>         <span class="at">side =</span> <span class="st">"left"</span>, <span class="at">padx =</span> <span class="dv">10</span>)</span>
<span id="cb1193-31"><a href="ch11.html#cb1193-31"></a>  <span class="fu">tkpack</span>(<span class="fu">tkscale</span>(fr, <span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">10</span>, <span class="at">showvalue =</span> T,</span>
<span id="cb1193-32"><a href="ch11.html#cb1193-32"></a>                 <span class="at">variable =</span> <span class="dv">1</span>, <span class="at">resolution =</span> <span class="dv">1</span>,</span>
<span id="cb1193-33"><a href="ch11.html#cb1193-33"></a>                 <span class="at">orient =</span> <span class="st">"horizontal"</span>,</span>
<span id="cb1193-34"><a href="ch11.html#cb1193-34"></a>                 <span class="at">relief =</span> type, <span class="at">fg =</span> fg[<span class="dv">4</span>], </span>
<span id="cb1193-35"><a href="ch11.html#cb1193-35"></a>                 <span class="at">bg =</span> bg[<span class="dv">4</span>]), <span class="at">side =</span> <span class="st">"left"</span>, <span class="at">padx =</span> <span class="dv">14</span>)</span>
<span id="cb1193-36"><a href="ch11.html#cb1193-36"></a></span>
<span id="cb1193-37"><a href="ch11.html#cb1193-37"></a>  <span class="fu">tkpack</span>(fr, <span class="at">side =</span> <span class="st">"top"</span>, <span class="at">pady =</span> <span class="dv">5</span>)</span>
<span id="cb1193-38"><a href="ch11.html#cb1193-38"></a>}</span>
<span id="cb1193-39"><a href="ch11.html#cb1193-39"></a></span>
<span id="cb1193-40"><a href="ch11.html#cb1193-40"></a><span class="fu">sapply</span>(types, mkframe)</span></code></pre></div>
<p>See Fig <a href="ch11.html#fig:styles">11.9</a>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:styles"></span>
<img src="figs11/styles.png" alt="Standard widget modifications. Relief styles are varied within each widget type, and background and foreground colors are varied among widget types." width="70%"><p class="caption">
Figure 11.9: Standard widget modifications. Relief styles are varied within each widget type, and background and foreground colors are varied among widget types.
</p>
</div>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
</div>
<div id="additional-tcltk-packages-and-toolkits" class="section level3" number="11.2.5">
<h3>
<span class="header-section-number">11.2.5</span> Additional <em>tcltk</em> Packages and Toolkits<a class="anchor" aria-label="anchor" href="#additional-tcltk-packages-and-toolkits"><i class="fas fa-link"></i></a>
</h3>
<p>Several <strong>R</strong> packages have been developed to streamline and extend the capacities of the <em>tcltk</em> package. These include <em>fgui</em> <span class="citation">(<a href="references.html#ref-fgui">Hoffmann and Laird 2009</a>)</span> and <em>PBSmodelling</em> <span class="citation">(<a href="references.html#ref-PBS">Jon T. Schnute, Couture-Beil, and Haigh 2023</a>; <a href="references.html#ref-schnute2013">Jon T. Schnute et al. 2013</a>)</span> which provides wrappers for some Tcl/Tk routines to simplify and facilitate GUI creation. The <code>gWidgets2</code> package has ambitiously sought to create <strong>R</strong> simplifying binding frameworks for several GUI toolkits including GTK, qt, and Tcl/Tk<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;GTK (formerly GIMP ToolKit and GTK+) and qt (pronounced ‘cute’) are free, open-source, cross-platform, toolkits for creating GUIs.&lt;/p&gt;"><sup>103</sup></a>. Currently, however, only the <code>gWidgets2</code> port for <code>tcltk</code>, called <em>gWidgets2tcltk</em>, is working. The <em>gWidgets2tcltk</em> package is currently used to build interactive self test questions for the pedagogic statistics package <em>asbio</em> (Fig <a href="ch11.html#fig:typeIandII">11.10</a>).</p>
<div class="sourceCode" id="cb1194"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">asbio</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/asbio/man/selftest.se.tck1.html">selftest.typeIISS.tck1</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:typeIandII"></span>
<img src="figs11/typeI_II.png" alt="A self-test GUI using the *gWidgets2tcltk* function `gcheckboxgroup`. For GUI code type: `fix(selftest.typeIISS.tck1)`." width="90%"><p class="caption">
Figure 11.10: A self-test GUI using the <em>gWidgets2tcltk</em> function <code>gcheckboxgroup</code>. For GUI code type: <code>fix(selftest.typeIISS.tck1)</code>.
</p>
</div>
<p>
</p>
<p>A number of Tcl/Tk extensions for <strong>R</strong> are available from the <em>SciViews</em> family of packages <span class="citation">(<a href="references.html#ref-grosjean">Grosjean 2024</a>)</span>, including <em>svDialogs</em> (an attempt at creating standard cross-platform dialog boxes), <em>svGUI</em>, and <em>tcltk2</em>. These packages, however, have not been updated (at least on CRAN) for several years.</p>
<p>
</p>
</div>
</div>
<div id="JS" class="section level2" number="11.3">
<h2>
<span class="header-section-number">11.3</span> JS and JSON Interactive Apps<a class="anchor" aria-label="anchor" href="#JS"><i class="fas fa-link"></i></a>
</h2>
<p>Many newer interactive <strong>R</strong> applications are designed and implemented using JavaScript<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Java is an OOP language designed to have few dependencies. Once compiled, Java code can run on all platforms that support Java. Additional details for Java web design are given &lt;a href="https://developer.mozilla.org/en-US/docs/Learn/JavaScript"&gt;here&lt;/a&gt;. JavaScript, while linguistically similar to Java, has many many important differences. For instance, JavaScript is an interpreted language, whereas Java code is generally compiled.&lt;/p&gt;'><sup>104</sup></a> (JS) or JavaScript Object Notation<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;JavaScript Object Notation (JSON) was derived from JavaScript largely to facilitate server-to-browser session communication.&lt;/p&gt;"><sup>105</sup></a> (JSON). GUIs generated from these approaches are often embedded in HTML<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;As noted in Section &lt;a href="ch2.html#workflow"&gt;2.9.2&lt;/a&gt;, HTML (Hypertext Markup Language) is the standard language for structuring web pages and web content. Basic HTML programming details are available from a number of sources, including this &lt;a href="https://developer.mozilla.org/en-US/docs/Learn/Getting_started_with_the_web/HTML_basics"&gt;Mozilla developer site&lt;/a&gt;.&lt;/p&gt;'><sup>106</sup></a> format, and thus can be viewed from web browsers.</p>
<p>There are several widely used <strong>R</strong> packages for generating these sorts of apps. The two most popular are <em>plotly</em> and <em>shiny</em>.</p>
<ul>
<li><p><em>plotly</em> creates interactive HTML/web graphics via the <em>plotly.js</em> JS library for interactive charts.</p></li>
<li><p><em>shiny</em> is a package designed by RStudio developers that utilizes other packages, chiefly <em>htmltools</em> and <em>htmlwidgets</em>.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;The packages &lt;em&gt;htmltools&lt;/em&gt; and &lt;em&gt;htmlwidgets&lt;/em&gt; were created by RStudio developers for &lt;strong&gt;R&lt;/strong&gt; bindings to JS libraries and HTML code.&lt;/p&gt;"><sup>107</sup></a> to provide direct interfaces between HTML embedded GUIs and <strong>R</strong>.</p></li>
</ul>
<p>The next two sections of this Chapter will focus on these packages and approaches.</p>
<p>
</p>
</div>
<div id="plotly" class="section level2" number="11.4">
<h2>
<span class="header-section-number">11.4</span> plotly<a class="anchor" aria-label="anchor" href="#plotly"><i class="fas fa-link"></i></a>
</h2>
<p>
The package <em>plotly</em> <span class="citation">(<a href="references.html#ref-sievert2020">Sievert 2020</a>)</span>, uses the <strong>R</strong> package <em>jsonlite</em>, which provides an <strong>R</strong> binder for JSON. JSON code is read by the JS library <em>plotly.js</em> to create interactive HTML embedded graphics (Fig <a href="ch11.html#fig:plotly1">11.11</a>). Charts resulting from this process are interactive under a standardized <em>plotly</em> format, although they don’t represent GUIs in a conventional sense.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plotly1"></span>
<img src="figs11/plotly3.png" alt="A graph from @sievert2020 that shows the process of creating an HTML-embedded plotly chart from a graph generated in **R**." width="75%"><p class="caption">
Figure 11.11: A graph from <span class="citation">Sievert (<a href="references.html#ref-sievert2020">2020</a>)</span> that shows the process of creating an HTML-embedded plotly chart from a graph generated in <strong>R</strong>.
</p>
</div>
<div class="example">
<p><span id="exm:exm-c116" class="example"><strong>Example 11.9  </strong></span><span class="math inline">\(\text{}\)</span><br></p>
<p>To provide a simple demonstration I bring in some libraries, including <em>plotly</em>, and the <code>world.emissions</code> data from package <em>asbio</em>.</p>
<div class="sourceCode" id="cb1195"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb1195-1"><a href="ch11.html#cb1195-1"></a><span class="fu">library</span>(tidyverse); <span class="fu">library</span>(plotly)</span>
<span id="cb1195-2"><a href="ch11.html#cb1195-2"></a><span class="fu">library</span>(asbio); <span class="fu">data</span>(world.emissions)</span>
<span id="cb1195-3"><a href="ch11.html#cb1195-3"></a></span>
<span id="cb1195-4"><a href="ch11.html#cb1195-4"></a>subset <span class="ot">&lt;-</span> world.emissions <span class="sc">|&gt;</span></span>
<span id="cb1195-5"><a href="ch11.html#cb1195-5"></a>  <span class="fu">filter</span>(country <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"United States"</span>, <span class="st">"Mexico"</span>, <span class="st">"China"</span>,</span>
<span id="cb1195-6"><a href="ch11.html#cb1195-6"></a>                        <span class="st">"Germany"</span>, <span class="st">"Russia"</span>, <span class="st">"Canada"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb1195-7"><a href="ch11.html#cb1195-7"></a>  <span class="fu">filter</span>(year <span class="sc">&gt;</span> <span class="dv">1950</span> <span class="sc">&amp;</span> year <span class="sc">&lt;=</span> <span class="dv">2019</span>)</span></code></pre></div>
<p>Plotly graphs are rendered using the function <code>plot_ly()</code>.</p>
<div class="sourceCode" id="cb1196" startfrom="8"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r" style="counter-reset: source-line 7;"><span id="cb1196-8"><a href="ch11.html#cb1196-8"></a><span class="fu">plot_ly</span>(subset, <span class="at">x =</span> <span class="sc">~</span>year, <span class="at">y =</span> <span class="sc">~</span>co2) <span class="sc">|&gt;</span></span>
<span id="cb1196-9"><a href="ch11.html#cb1196-9"></a>  <span class="fu">add_lines</span>(<span class="at">color =</span> <span class="sc">~</span>country) <span class="sc">|&gt;</span></span>
<span id="cb1196-10"><a href="ch11.html#cb1196-10"></a>  <span class="fu">layout</span>(</span>
<span id="cb1196-11"><a href="ch11.html#cb1196-11"></a>        <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">tickfont =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb1196-12"><a href="ch11.html#cb1196-12"></a>                     <span class="at">title =</span><span class="st">'CO\U2082 (million tonnes)'</span>,</span>
<span id="cb1196-13"><a href="ch11.html#cb1196-13"></a>                     <span class="at">titlefont =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">23</span>)),</span>
<span id="cb1196-14"><a href="ch11.html#cb1196-14"></a>        <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">tickfont =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb1196-15"><a href="ch11.html#cb1196-15"></a>                     <span class="at">title=</span><span class="st">'Year'</span>,</span>
<span id="cb1196-16"><a href="ch11.html#cb1196-16"></a>                     <span class="at">titlefont =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">23</span>)),</span>
<span id="cb1196-17"><a href="ch11.html#cb1196-17"></a>        <span class="at">legend =</span> <span class="fu">list</span>(<span class="at">font =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">20</span>))</span>
<span id="cb1196-18"><a href="ch11.html#cb1196-18"></a>        )</span></code></pre></div>
<ul>
<li>On Line 8, I call <code>plot_ly()</code>. Note the use of the tilde operator to call <em>x</em> and <em>y</em> axis variables, i.e., <code>x = ~year, y = ~co2</code>.</li>
<li>On Lines 9-18, I call additional plot characteristics using <em>tidyverse</em> pipe operators.
<ul>
<li>On Line 9 I use <code>add_lines()</code> to add a line <em>trace</em> to the plot.</li>
<li>Plot characteristics can be modified in a large number of ways using lists within the function <code>layout</code> (Lines 10-18).</li>
</ul>
</li>
</ul>
<p>The result is shown in Fig <a href="ch11.html#fig:plotly2">11.12</a>.
If you are viewing this document as an HTML, the lines in the plot will be interactive, and the plot will contain a menu that allows summarization of single or multiple data points, panning and zooming.
</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plotly2"></span>
<div class="plotly html-widget html-fill-item" id="htmlwidget-2e8c4804d80c0f47173a" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-2e8c4804d80c0f47173a">{"x":{"visdat":{"524027be6170":["function () ","plotlyVisDat"]},"cur_data":"524027be6170","attrs":{"524027be6170":{"x":{},"y":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","mode":"lines","color":{},"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"yaxis":{"domain":[0,1],"automargin":true,"tickfont":{"size":15},"title":"CO₂ (million tonnes)","titlefont":{"size":18}},"xaxis":{"domain":[0,1],"automargin":true,"tickfont":{"size":15},"title":"Year","titlefont":{"size":18}},"legend":{"font":{"size":15}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[1951,1952,1953,1954,1955,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[162.678,159.40899999999999,160.608,162.96799999999999,169.47300000000001,189.80199999999999,182.81100000000001,182.155,184.48099999999999,192.71600000000001,194.001,206.99100000000001,210.911,237.578,251.917,259.07400000000001,281.637,303.26100000000002,307.11900000000003,341.17700000000002,352.28500000000003,380.78699999999998,381.26499999999999,389.60500000000002,396.77300000000002,398.94600000000003,407.77100000000002,415.505,441.64699999999999,442.81700000000001,429.59800000000001,414.42599999999999,408.31,425.19900000000001,421.67599999999999,404.66000000000003,430.92200000000003,455.608,462.81799999999998,462.11700000000002,452.495,467.03699999999998,467.40600000000001,482.43700000000001,494.92000000000002,510.73700000000002,524.78899999999999,533.63999999999999,549.553,572.16200000000003,564.94600000000003,570.84500000000003,587.178,585.70299999999997,576.43399999999997,570.95000000000005,594.221,575.58699999999999,542.54999999999995,555.54999999999995,566.74099999999999,569.73699999999997,576.327,575.94200000000001,575.90700000000004,564.03300000000002,572.83399999999995,586.505,576.65099999999995],"type":"scatter","mode":"lines","name":"Canada","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"line":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1951,1952,1953,1954,1955,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[101.617,127.98699999999999,133.78399999999999,160.87799999999999,190.52099999999999,215.82400000000001,255.785,524.61699999999996,720.15200000000004,778.97900000000004,550.95899999999995,439.34199999999998,435.51799999999997,435.70400000000001,474.68099999999998,521.45899999999995,432.22399999999999,467.80599999999998,575.94500000000005,770.16700000000003,874.01599999999996,928.89400000000001,965.64700000000005,985.08500000000004,1142.1020000000001,1190.9649999999999,1304.403,1455.258,1487.1130000000001,1458.8869999999999,1442.7819999999999,1570.4680000000001,1655.8099999999999,1802.317,1951.7729999999999,2052.2420000000002,2191.0529999999999,2347.7629999999999,2386.8850000000002,2420.7890000000002,2538.0300000000002,2653.192,2835.7950000000001,3010.2420000000002,3265.0569999999998,3408.3470000000002,3414.549,3265.9029999999998,3258.1350000000002,3349.2950000000001,3426.1439999999998,3782.4389999999999,4452.3100000000004,5125.8940000000002,5771.1679999999997,6377.7479999999996,6861.7510000000002,7375.1899999999996,7758.8119999999999,8500.5429999999997,9388.1990000000005,9633.8989999999994,9796.527,9820.3600000000006,9683.2009999999991,9552.5169999999998,9750.7260000000006,9956.5689999999995,10174.681],"type":"scatter","mode":"lines","name":"China","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"line":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1951,1952,1953,1954,1955,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[576.86599999999999,610.98099999999999,623.49199999999996,659.73199999999997,723.49800000000005,766.19100000000003,777.90800000000002,756.37900000000002,755.79499999999996,813.95000000000005,834.84000000000003,883.16899999999998,945.49800000000005,968.91700000000003,960.10199999999998,951.42200000000003,936.22900000000004,984.79100000000005,1052.001,1026.0219999999999,1037.2360000000001,1041.48,1085.7360000000001,1062.7239999999999,1002.444,1090.837,1052.604,1079.127,1117.8820000000001,1100.059,1048.5170000000001,1015.727,1011.597,1033.2370000000001,1044.1099999999999,1047.463,1032.434,1029.0139999999999,1008.7809999999999,1052.3489999999999,1014.2,965.88999999999999,956.23299999999995,939.63,939.17700000000002,959.12400000000002,931.23000000000002,923.27599999999995,895.64300000000003,899.77999999999997,916.36599999999999,899.82100000000003,900.86599999999999,886.96600000000001,866.38900000000001,877.99699999999996,851.38300000000004,854.70600000000002,790.19600000000003,832.66999999999996,809.42700000000002,813.89300000000003,831.31600000000003,792.68499999999995,795.81600000000003,800.50999999999999,786.65499999999997,755.36199999999997,701.95500000000004],"type":"scatter","mode":"lines","name":"Germany","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"line":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1951,1952,1953,1954,1955,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[34.889000000000003,37.212000000000003,36.707000000000001,36.270000000000003,39.661999999999999,42.134,49.277999999999999,54.008000000000003,58.286999999999999,63.052,65.239999999999995,63.744,66.292000000000002,74.200000000000003,75.168000000000006,80.844999999999999,90.006,93.887,102.176,113.95099999999999,126.19,132.279,144.072,154.74700000000001,164.16499999999999,183.774,192.43600000000001,222.167,240.321,267.81799999999998,283.79700000000003,304.00999999999999,277.66699999999997,276.76600000000002,287.51100000000002,293.55599999999998,306.19400000000002,305.84899999999999,360.55500000000001,317.04199999999997,330.13299999999998,332.77999999999997,338.06700000000001,351.52800000000002,331.59699999999998,345.76600000000002,368.64499999999998,388.35700000000003,390.51600000000002,396.06599999999997,410.69799999999998,411.96800000000002,437.75799999999998,438.85700000000003,463.99299999999999,476.565,479.78699999999998,492.98000000000002,475.90300000000002,463.78300000000002,484.16500000000002,496.30000000000001,490.13,481.12900000000002,481.97500000000002,484.62900000000002,461.238,451.08100000000002,438.49799999999999],"type":"scatter","mode":"lines","name":"Mexico","marker":{"color":"rgba(231,138,195,1)","line":{"color":"rgba(231,138,195,1)"}},"textfont":{"color":"rgba(231,138,195,1)"},"error_y":{"color":"rgba(231,138,195,1)"},"error_x":{"color":"rgba(231,138,195,1)"},"line":{"color":"rgba(231,138,195,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1951,1952,1953,1954,1955,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[450.49099999999999,482.404,510.35199999999998,557.375,632.00699999999995,692.93799999999999,758.27700000000004,809.351,850.89400000000001,885.86099999999999,913.52499999999998,958.75699999999995,1028.2180000000001,1093.519,1159.9849999999999,1224.9760000000001,1280.896,1316.893,1371.4839999999999,1442.53,1530.8889999999999,1610.796,1678.915,1742.934,1832.155,1902.6320000000001,1967.2750000000001,2034.807,2051.6149999999998,2132.3009999999999,2091.6529999999998,2131.136,2161.3380000000002,2180.4960000000001,2351.6750000000002,2357.643,2347.9119999999998,2410.627,2356.6300000000001,2525.2939999999999,2395.9780000000001,1957.6590000000001,1859.46,1641.3989999999999,1612.9280000000001,1580.1610000000001,1475.1569999999999,1458.1569999999999,1486.0899999999999,1471.0519999999999,1507.501,1495.4839999999999,1525.3900000000001,1530.4739999999999,1547.376,1606.3130000000001,1604.3240000000001,1636.694,1528.7650000000001,1612.885,1664.953,1679.866,1619.173,1622.3489999999999,1622.8610000000001,1618.3040000000001,1646.1800000000001,1691.3599999999999,1678.367],"type":"scatter","mode":"lines","name":"Russia","marker":{"color":"rgba(166,216,84,1)","line":{"color":"rgba(166,216,84,1)"}},"textfont":{"color":"rgba(166,216,84,1)"},"error_y":{"color":"rgba(166,216,84,1)"},"error_x":{"color":"rgba(166,216,84,1)"},"line":{"color":"rgba(166,216,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1951,1952,1953,1954,1955,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[2612.7190000000001,2545.3800000000001,2606.0569999999998,2483.2959999999998,2721.0230000000001,2852.3850000000002,2828.3110000000001,2740.357,2823.0050000000001,2887.8200000000002,2877.3699999999999,2984.002,3116.0219999999999,3252.7550000000001,3388.1930000000002,3559.1790000000001,3693.2979999999998,3828.306,4021.5030000000002,4325.5010000000002,4351.3090000000002,4558.4530000000004,4762.4520000000002,4592.9579999999996,4400.7950000000001,4607.1679999999997,4735.366,4882.9639999999999,4894.0429999999997,4716.7160000000003,4530.3699999999999,4301.9709999999995,4335.9170000000004,4468.2619999999997,4484.3379999999997,4487.8559999999998,4680.8339999999998,4885.5910000000003,4948.0209999999997,5128.3010000000004,5078.8900000000003,5182.7070000000003,5283.4380000000001,5377.0330000000004,5438.9059999999999,5626.9120000000003,5703.7070000000003,5751.0519999999997,5830.2979999999998,5998.0699999999997,5900.4369999999999,5942.652,5991.96,6107.6180000000004,6131.893,6051.0510000000004,6128.4300000000003,5930.54,5491.0360000000001,5698.0559999999996,5565.2939999999999,5367.5690000000004,5514.0290000000005,5561.7190000000001,5412.4319999999998,5292.268,5253.6059999999998,5424.8819999999996,5284.6970000000001],"type":"scatter","mode":"lines","name":"United States","marker":{"color":"rgba(255,217,47,1)","line":{"color":"rgba(255,217,47,1)"}},"textfont":{"color":"rgba(255,217,47,1)"},"error_y":{"color":"rgba(255,217,47,1)"},"error_x":{"color":"rgba(255,217,47,1)"},"line":{"color":"rgba(255,217,47,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p class="caption">
Figure 11.12: Simple <em>plolty</em> chart with an interactive trace and standard <em>plotly</em> menu.
</p>
</div>
<p>
</p>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
<div id="ggplot-and-plotly" class="section level3" number="11.4.1">
<h3>
<span class="header-section-number">11.4.1</span> <em>ggplot</em> and <em>plotly</em><a class="anchor" aria-label="anchor" href="#ggplot-and-plotly"><i class="fas fa-link"></i></a>
</h3>
<p><em>Ggplot2</em> objects can be converted (imperfectly) to <em>plotly</em> objects using the function <code>plolty::ggplotly()</code>.
Unfortunately, a large number <code>ggplot</code> layout characteristics including figure margins and locations of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> axis labels will not translate to <code>ggplotly()</code>. Instead, we must call on potentially exhaustive hierarchically nested list components. This can be a pain, and it may be expedient to build separate list or function objects to facilitate the process.</p>
<div class="example">
<p><span id="exm:exm-c117" class="example"><strong>Example 11.10  </strong></span><span class="math inline">\(\text{}\)</span><br></p>
<p>To illustrate I extend the previous example. First, I create a nested list object, <code>k</code>, that specifies desired margin and axis characteristics.</p>
<div class="sourceCode" id="cb1197"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb1197-1"><a href="ch11.html#cb1197-1"></a>k <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb1197-2"><a href="ch11.html#cb1197-2"></a>  <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="fu">list</span>(<span class="at">font =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">18</span>)),</span>
<span id="cb1197-3"><a href="ch11.html#cb1197-3"></a>               <span class="at">tickfont =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">14</span>)),</span>
<span id="cb1197-4"><a href="ch11.html#cb1197-4"></a>  <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="fu">list</span>(<span class="at">font =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">18</span>)),</span>
<span id="cb1197-5"><a href="ch11.html#cb1197-5"></a>               <span class="at">tickfont =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">15</span>)),</span>
<span id="cb1197-6"><a href="ch11.html#cb1197-6"></a>    <span class="at">margin =</span> <span class="fu">list</span>(<span class="at">t =</span> <span class="dv">20</span>, <span class="at">r =</span> <span class="dv">20</span>, <span class="at">b =</span> <span class="dv">80</span>, <span class="at">l =</span> <span class="dv">80</span>))</span></code></pre></div>
<p>Here I create a simple ggplot boxplot, <code>g</code>. To get the desired characteristics in the mapped plotly graph I call on list components in <code>k</code> within <code>plotly::layout()</code>. Fig <a href="ch11.html#fig:plotly3">11.13</a> shows the result.</p>
<div class="sourceCode" id="cb1198" startfrom="7"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r" style="counter-reset: source-line 6;"><span id="cb1198-7"><a href="ch11.html#cb1198-7"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(subset, <span class="fu">aes</span>(<span class="at">x =</span> country, <span class="at">y =</span> co2)) <span class="sc">+</span></span>
<span id="cb1198-8"><a href="ch11.html#cb1198-8"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> country)) <span class="sc">+</span></span>
<span id="cb1198-9"><a href="ch11.html#cb1198-9"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb1198-10"><a href="ch11.html#cb1198-10"></a>  <span class="fu">ylab</span>(<span class="st">"CO\U2082 (million tonnes)"</span>) <span class="sc">+</span></span>
<span id="cb1198-11"><a href="ch11.html#cb1198-11"></a>  <span class="fu">xlab</span>(<span class="st">"Country"</span>)</span>
<span id="cb1198-12"><a href="ch11.html#cb1198-12"></a></span>
<span id="cb1198-13"><a href="ch11.html#cb1198-13"></a><span class="fu">ggplotly</span>(g) <span class="sc">%&gt;%</span></span>
<span id="cb1198-14"><a href="ch11.html#cb1198-14"></a>  <span class="fu">layout</span>(<span class="at">showlegend =</span> <span class="cn">FALSE</span>, <span class="at">xaxis =</span> k<span class="sc">$</span>xaxis, <span class="at">yaxis =</span> k<span class="sc">$</span>yaxis,</span>
<span id="cb1198-15"><a href="ch11.html#cb1198-15"></a>         <span class="at">margin =</span> k<span class="sc">$</span>margin)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plotly3"></span>
<div class="plotly html-widget html-fill-item" id="htmlwidget-a13c43408bc6fb493a9b" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-a13c43408bc6fb493a9b">{"x":{"data":[{"x":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"y":[162.678,159.40899999999999,160.608,162.96799999999999,169.47300000000001,189.80199999999999,182.81100000000001,182.155,184.48099999999999,192.71600000000001,194.001,206.99100000000001,210.911,237.578,251.917,259.07400000000001,281.637,303.26100000000002,307.11900000000003,341.17700000000002,352.28500000000003,380.78699999999998,381.26499999999999,389.60500000000002,396.77300000000002,398.94600000000003,407.77100000000002,415.505,441.64699999999999,442.81700000000001,429.59800000000001,414.42599999999999,408.31,425.19900000000001,421.67599999999999,404.66000000000003,430.92200000000003,455.608,462.81799999999998,462.11700000000002,452.495,467.03699999999998,467.40600000000001,482.43700000000001,494.92000000000002,510.73700000000002,524.78899999999999,533.63999999999999,549.553,572.16200000000003,564.94600000000003,570.84500000000003,587.178,585.70299999999997,576.43399999999997,570.95000000000005,594.221,575.58699999999999,542.54999999999995,555.54999999999995,566.74099999999999,569.73699999999997,576.327,575.94200000000001,575.90700000000004,564.03300000000002,572.83399999999995,586.505,576.65099999999995],"hoverinfo":"y","type":"box","fillcolor":"rgba(248,118,109,1)","marker":{"opacity":null,"outliercolor":"rgba(0,0,0,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"},"size":5.6692913385826778},"line":{"color":"rgba(51,51,51,1)","width":1.8897637795275593},"name":"Canada","legendgroup":"Canada","showlegend":true,"xaxis":"x","yaxis":"y","frame":null},{"x":[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],"y":[101.617,127.98699999999999,133.78399999999999,160.87799999999999,190.52099999999999,215.82400000000001,255.785,524.61699999999996,720.15200000000004,778.97900000000004,550.95899999999995,439.34199999999998,435.51799999999997,435.70400000000001,474.68099999999998,521.45899999999995,432.22399999999999,467.80599999999998,575.94500000000005,770.16700000000003,874.01599999999996,928.89400000000001,965.64700000000005,985.08500000000004,1142.1020000000001,1190.9649999999999,1304.403,1455.258,1487.1130000000001,1458.8869999999999,1442.7819999999999,1570.4680000000001,1655.8099999999999,1802.317,1951.7729999999999,2052.2420000000002,2191.0529999999999,2347.7629999999999,2386.8850000000002,2420.7890000000002,2538.0300000000002,2653.192,2835.7950000000001,3010.2420000000002,3265.0569999999998,3408.3470000000002,3414.549,3265.9029999999998,3258.1350000000002,3349.2950000000001,3426.1439999999998,3782.4389999999999,4452.3100000000004,5125.8940000000002,5771.1679999999997,6377.7479999999996,6861.7510000000002,7375.1899999999996,7758.8119999999999,8500.5429999999997,9388.1990000000005,9633.8989999999994,9796.527,9820.3600000000006,9683.2009999999991,9552.5169999999998,9750.7260000000006,9956.5689999999995,10174.681],"hoverinfo":"y","type":"box","fillcolor":"rgba(183,159,0,1)","marker":{"opacity":null,"outliercolor":"rgba(0,0,0,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"},"size":5.6692913385826778},"line":{"color":"rgba(51,51,51,1)","width":1.8897637795275593},"name":"China","legendgroup":"China","showlegend":true,"xaxis":"x","yaxis":"y","frame":null},{"x":[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],"y":[576.86599999999999,610.98099999999999,623.49199999999996,659.73199999999997,723.49800000000005,766.19100000000003,777.90800000000002,756.37900000000002,755.79499999999996,813.95000000000005,834.84000000000003,883.16899999999998,945.49800000000005,968.91700000000003,960.10199999999998,951.42200000000003,936.22900000000004,984.79100000000005,1052.001,1026.0219999999999,1037.2360000000001,1041.48,1085.7360000000001,1062.7239999999999,1002.444,1090.837,1052.604,1079.127,1117.8820000000001,1100.059,1048.5170000000001,1015.727,1011.597,1033.2370000000001,1044.1099999999999,1047.463,1032.434,1029.0139999999999,1008.7809999999999,1052.3489999999999,1014.2,965.88999999999999,956.23299999999995,939.63,939.17700000000002,959.12400000000002,931.23000000000002,923.27599999999995,895.64300000000003,899.77999999999997,916.36599999999999,899.82100000000003,900.86599999999999,886.96600000000001,866.38900000000001,877.99699999999996,851.38300000000004,854.70600000000002,790.19600000000003,832.66999999999996,809.42700000000002,813.89300000000003,831.31600000000003,792.68499999999995,795.81600000000003,800.50999999999999,786.65499999999997,755.36199999999997,701.95500000000004],"hoverinfo":"y","type":"box","fillcolor":"rgba(0,186,56,1)","marker":{"opacity":null,"outliercolor":"rgba(0,0,0,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"},"size":5.6692913385826778},"line":{"color":"rgba(51,51,51,1)","width":1.8897637795275593},"name":"Germany","legendgroup":"Germany","showlegend":true,"xaxis":"x","yaxis":"y","frame":null},{"x":[4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],"y":[34.889000000000003,37.212000000000003,36.707000000000001,36.270000000000003,39.661999999999999,42.134,49.277999999999999,54.008000000000003,58.286999999999999,63.052,65.239999999999995,63.744,66.292000000000002,74.200000000000003,75.168000000000006,80.844999999999999,90.006,93.887,102.176,113.95099999999999,126.19,132.279,144.072,154.74700000000001,164.16499999999999,183.774,192.43600000000001,222.167,240.321,267.81799999999998,283.79700000000003,304.00999999999999,277.66699999999997,276.76600000000002,287.51100000000002,293.55599999999998,306.19400000000002,305.84899999999999,360.55500000000001,317.04199999999997,330.13299999999998,332.77999999999997,338.06700000000001,351.52800000000002,331.59699999999998,345.76600000000002,368.64499999999998,388.35700000000003,390.51600000000002,396.06599999999997,410.69799999999998,411.96800000000002,437.75799999999998,438.85700000000003,463.99299999999999,476.565,479.78699999999998,492.98000000000002,475.90300000000002,463.78300000000002,484.16500000000002,496.30000000000001,490.13,481.12900000000002,481.97500000000002,484.62900000000002,461.238,451.08100000000002,438.49799999999999],"hoverinfo":"y","type":"box","fillcolor":"rgba(0,191,196,1)","marker":{"opacity":null,"outliercolor":"rgba(0,0,0,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"},"size":5.6692913385826778},"line":{"color":"rgba(51,51,51,1)","width":1.8897637795275593},"name":"Mexico","legendgroup":"Mexico","showlegend":true,"xaxis":"x","yaxis":"y","frame":null},{"x":[5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],"y":[450.49099999999999,482.404,510.35199999999998,557.375,632.00699999999995,692.93799999999999,758.27700000000004,809.351,850.89400000000001,885.86099999999999,913.52499999999998,958.75699999999995,1028.2180000000001,1093.519,1159.9849999999999,1224.9760000000001,1280.896,1316.893,1371.4839999999999,1442.53,1530.8889999999999,1610.796,1678.915,1742.934,1832.155,1902.6320000000001,1967.2750000000001,2034.807,2051.6149999999998,2132.3009999999999,2091.6529999999998,2131.136,2161.3380000000002,2180.4960000000001,2351.6750000000002,2357.643,2347.9119999999998,2410.627,2356.6300000000001,2525.2939999999999,2395.9780000000001,1957.6590000000001,1859.46,1641.3989999999999,1612.9280000000001,1580.1610000000001,1475.1569999999999,1458.1569999999999,1486.0899999999999,1471.0519999999999,1507.501,1495.4839999999999,1525.3900000000001,1530.4739999999999,1547.376,1606.3130000000001,1604.3240000000001,1636.694,1528.7650000000001,1612.885,1664.953,1679.866,1619.173,1622.3489999999999,1622.8610000000001,1618.3040000000001,1646.1800000000001,1691.3599999999999,1678.367],"hoverinfo":"y","type":"box","fillcolor":"rgba(97,156,255,1)","marker":{"opacity":null,"outliercolor":"rgba(0,0,0,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"},"size":5.6692913385826778},"line":{"color":"rgba(51,51,51,1)","width":1.8897637795275593},"name":"Russia","legendgroup":"Russia","showlegend":true,"xaxis":"x","yaxis":"y","frame":null},{"x":[6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6],"y":[2612.7190000000001,2545.3800000000001,2606.0569999999998,2483.2959999999998,2721.0230000000001,2852.3850000000002,2828.3110000000001,2740.357,2823.0050000000001,2887.8200000000002,2877.3699999999999,2984.002,3116.0219999999999,3252.7550000000001,3388.1930000000002,3559.1790000000001,3693.2979999999998,3828.306,4021.5030000000002,4325.5010000000002,4351.3090000000002,4558.4530000000004,4762.4520000000002,4592.9579999999996,4400.7950000000001,4607.1679999999997,4735.366,4882.9639999999999,4894.0429999999997,4716.7160000000003,4530.3699999999999,4301.9709999999995,4335.9170000000004,4468.2619999999997,4484.3379999999997,4487.8559999999998,4680.8339999999998,4885.5910000000003,4948.0209999999997,5128.3010000000004,5078.8900000000003,5182.7070000000003,5283.4380000000001,5377.0330000000004,5438.9059999999999,5626.9120000000003,5703.7070000000003,5751.0519999999997,5830.2979999999998,5998.0699999999997,5900.4369999999999,5942.652,5991.96,6107.6180000000004,6131.893,6051.0510000000004,6128.4300000000003,5930.54,5491.0360000000001,5698.0559999999996,5565.2939999999999,5367.5690000000004,5514.0290000000005,5561.7190000000001,5412.4319999999998,5292.268,5253.6059999999998,5424.8819999999996,5284.6970000000001],"hoverinfo":"y","type":"box","fillcolor":"rgba(245,100,227,1)","marker":{"opacity":null,"outliercolor":"rgba(0,0,0,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"},"size":5.6692913385826778},"line":{"color":"rgba(51,51,51,1)","width":1.8897637795275593},"name":"United States","legendgroup":"United States","showlegend":true,"xaxis":"x","yaxis":"y","frame":null}],"layout":{"margin":{"t":20,"r":20,"b":80,"l":80},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,6.5999999999999996],"tickmode":"array","ticktext":["Canada","China","Germany","Mexico","Russia","United States"],"tickvals":[1,2,3,3.9999999999999996,5,6],"categoryorder":"array","categoryarray":["Canada","China","Germany","Mexico","Russia","United States"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":15},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176002,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"Country","font":{"color":"rgba(0,0,0,1)","family":"","size":18}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-472.1006000000001,10681.670600000001],"tickmode":"array","ticktext":["0","2500","5000","7500","10000"],"tickvals":[0,2500,5000,7500,10000],"categoryorder":"array","categoryarray":["0","2500","5000","7500","10000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":14},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176002,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":{"text":"CO₂ (million tonnes)","font":{"color":"rgba(0,0,0,1)","family":"","size":18}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"country","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"524014dc6b35":{"x":{},"y":{},"fill":{},"type":"box"}},"cur_data":"524014dc6b35","visdat":{"524014dc6b35":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p class="caption">
Figure 11.13: Simple <em>plolty</em> barplot based on a ggplot.
</p>
</div>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
<div class="example">
<p><span id="exm:exm-c118" class="example"><strong>Example 11.11  </strong></span><span class="math inline">\(\text{}\)</span><br></p>
<p>Here is another application using the function <code><a href="https://ggobi.github.io/ggally/reference/ggcoef.html">GGally::ggcoef()</a></code> to create a coefficient plot. A coefficient plot displays statistical model parameter estimates and confidence intervals. We can make the plot interactive (in HTML) using <code>ggplotly()</code> (Fig <a href="ch11.html#fig:plotly4">11.14</a>).</p>
<div class="sourceCode" id="cb1199"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb1199-1"><a href="ch11.html#cb1199-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb1199-2"><a href="ch11.html#cb1199-2"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(co2) <span class="sc">~</span> country <span class="sc">+</span> year,</span>
<span id="cb1199-3"><a href="ch11.html#cb1199-3"></a>            <span class="at">data =</span> subset)</span>
<span id="cb1199-4"><a href="ch11.html#cb1199-4"></a></span>
<span id="cb1199-5"><a href="ch11.html#cb1199-5"></a>gg <span class="ot">&lt;-</span> <span class="fu">ggcoef</span>(model,</span>
<span id="cb1199-6"><a href="ch11.html#cb1199-6"></a>             <span class="at">exclude_intercept =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1199-7"><a href="ch11.html#cb1199-7"></a>             <span class="at">errorbar_height =</span> .<span class="dv">1</span>,</span>
<span id="cb1199-8"><a href="ch11.html#cb1199-8"></a>             <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb1199-9"><a href="ch11.html#cb1199-9"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb1199-10"><a href="ch11.html#cb1199-10"></a></span>
<span id="cb1199-11"><a href="ch11.html#cb1199-11"></a><span class="fu">ggplotly</span>(gg) <span class="sc">%&gt;%</span></span>
<span id="cb1199-12"><a href="ch11.html#cb1199-12"></a>  <span class="fu">layout</span>(<span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">tickfont =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb1199-13"><a href="ch11.html#cb1199-13"></a>                       <span class="at">title =</span><span class="st">''</span>,</span>
<span id="cb1199-14"><a href="ch11.html#cb1199-14"></a>                       <span class="at">titlefont =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">18</span>)),</span>
<span id="cb1199-15"><a href="ch11.html#cb1199-15"></a>          <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">tickfont =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb1199-16"><a href="ch11.html#cb1199-16"></a>                        <span class="at">title=</span><span class="st">'Parameter estimates'</span>,</span>
<span id="cb1199-17"><a href="ch11.html#cb1199-17"></a>                        <span class="at">titlefont =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">18</span>)),</span>
<span id="cb1199-18"><a href="ch11.html#cb1199-18"></a>           <span class="at">legend =</span> <span class="fu">list</span>(<span class="at">font =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">15</span>))</span>
<span id="cb1199-19"><a href="ch11.html#cb1199-19"></a>           )</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plotly4"></span>
<div class="plotly html-widget html-fill-item" id="htmlwidget-16cb5f4c3635ab7c6d48" style="width:528px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-16cb5f4c3635ab7c6d48">{"x":{"data":[{"x":[0,0],"y":[0.40000000000000002,6.5999999999999996],"text":"xintercept: 0","type":"scatter","mode":"lines","line":{"width":3.7795275590551185,"color":"rgba(127,127,127,1)","dash":"dot"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.487100357591971,0.85342933215559091,-0.64387887592449344,1.3296545321621058,2.4535782902644034,0.024409363699636741],"y":[1,2,3,4,5,6],"text":["estimate:  1.487100<br />term: countryChina<br />conf.low:  1.330135<br />conf.high:  1.644066","estimate:  0.853429<br />term: countryGermany<br />conf.low:  0.696464<br />conf.high:  1.010395","estimate: -0.643879<br />term: countryMexico<br />conf.low: -0.800844<br />conf.high: -0.486913","estimate:  1.329655<br />term: countryRussia<br />conf.low:  1.172689<br />conf.high:  1.486620","estimate:  2.453578<br />term: countryUnited States<br />conf.low:  2.296613<br />conf.high:  2.610544","estimate:  0.024409<br />term: year<br />conf.low:  0.022134<br />conf.high:  0.026684"],"type":"scatter","mode":"lines","opacity":1,"line":{"color":"transparent"},"error_x":{"array":[0.15696557210830764,0.15696557210830775,0.15696557210830764,0.15696557210830719,0.15696557210830697,0.00227510230757531],"arrayminus":[0.15696557210830764,0.15696557210830764,0.15696557210830764,0.15696557210830719,0.15696557210830697,0.00227510230757531],"type":"data","width":5.1612903225806512,"symmetric":false,"color":"rgba(64,64,64,1)"},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.487100357591971,0.85342933215559091,-0.64387887592449344,1.3296545321621058,2.4535782902644034,0.024409363699636741],"y":[1,2,3,4,5,6],"text":["estimate:  1.487100<br />term: countryChina","estimate:  0.853429<br />term: countryGermany","estimate: -0.643879<br />term: countryMexico","estimate:  1.329655<br />term: countryRussia","estimate:  2.453578<br />term: countryUnited States","estimate:  0.024409<br />term: year"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,255,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,0,255,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":24.036529680365298,"r":7.3059360730593612,"b":37.990867579908681,"l":142.46575342465755},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.97141386355307668,2.7811132778929859],"tickmode":"array","ticktext":["0","1","2"],"tickvals":[0,1,2],"categoryorder":"array","categoryarray":["0","1","2"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":15},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":"Parameter estimates","hoverformat":".2f","titlefont":{"size":18}},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,6.5999999999999996],"tickmode":"array","ticktext":["countryChina","countryGermany","countryMexico","countryRussia","countryUnited States","year"],"tickvals":[1,2,3,3.9999999999999996,5,6],"categoryorder":"array","categoryarray":["countryChina","countryGermany","countryMexico","countryRussia","countryUnited States","year"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296806,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":15},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f","titlefont":{"size":18}},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":15}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"5240eae1272":{"xintercept":{},"type":"scatter"},"52401bde6d23":{"x":{},"y":{},"xmin":{},"xmax":{}},"52406da5185e":{"x":{},"y":{}}},"cur_data":"5240eae1272","visdat":{"5240eae1272":["function (y) ","x"],"52401bde6d23":["function (y) ","x"],"52406da5185e":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p class="caption">
Figure 11.14: Coefficient plot from the function <code><a href="https://ggobi.github.io/ggally/reference/ggcoef.html">GGally::ggcoef()</a></code>, rendered using <code>ggplotly()</code>.
</p>
</div>
<p>
</p>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
</div>
</div>
<div id="shiny" class="section level2" number="11.5">
<h2>
<span class="header-section-number">11.5</span> <em>shiny</em><a class="anchor" aria-label="anchor" href="#shiny"><i class="fas fa-link"></i></a>
</h2>
<p>Probably the easiest and most flexible way to create interactive HTML apps is through tools in the package <em>shiny</em>. Unlike <em>ploty</em> apps, <em>shiny</em> apps will allow real-time interfacing with <strong>R</strong> for computations. RStudio has internals to facilitate <em>shiny</em> app creation for embedding on webpages. Examples given here are often based on apps described in Hadley Wickham’s book <em>Mastering Shiny</em> <span class="citation">(<a href="references.html#ref-wickham2021mastering">Wickham 2021</a>)</span>.
</p>
<p>A <em>shiny</em> app will have three components:</p>
<ul>
<li>A user interface (<code>ui</code>) specification that defines how your app <em>looks</em>.</li>
<li>A server function that defines how your app <em>works</em>. The function will (generally) have three arguments <code>input</code>, <code>output</code>, and <code>session</code>.</li>
<li>An app execution call that conjoins the user interface and server functions. This is done with <code>shinyApp()</code>
</li>
</ul>
<div class="example">
<p><span id="exm:exm-c119" class="example"><strong>Example 11.12  </strong></span>As a first example, here is <strong>R</strong> code for rendering text in an HTML app (Fig <a href="ch11.html#fig:hw1">11.15</a>).</p>
<div class="sourceCode" id="cb1200"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb1200-1"><a href="ch11.html#cb1200-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb1200-2"><a href="ch11.html#cb1200-2"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb1200-3"><a href="ch11.html#cb1200-3"></a>  <span class="st">"Hello, world!"</span></span>
<span id="cb1200-4"><a href="ch11.html#cb1200-4"></a>)</span>
<span id="cb1200-5"><a href="ch11.html#cb1200-5"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb1200-6"><a href="ch11.html#cb1200-6"></a>}</span>
<span id="cb1200-7"><a href="ch11.html#cb1200-7"></a><span class="fu">shinyApp</span>(ui, server)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:hw1"></span>
<img src="figs11/hello_world.png" alt="A very simple *shiny* app. Code follows @wickham2021mastering." width="50%"><p class="caption">
Figure 11.15: A very simple <em>shiny</em> app. Code follows <span class="citation">Wickham (<a href="references.html#ref-wickham2021mastering">2021</a>)</span>.
</p>
</div>
<ul>
<li>
<strong><code>ui</code>:</strong> <code><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html">shiny::fluidPage()</a></code> is a layout function that defines the basic visual structure of the app (Lines 1-4). Among other things the function allows definition of app rows using <code><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html">shiny::fluidRow()</a></code>, and columns (within rows) using <code><a href="https://rdrr.io/pkg/shiny/man/column.html">shiny::column()</a></code>. Fluid pages can rescale their components in real-time to fill the available GUI window width.</li>
<li>
<strong><code>server</code>:</strong> For this simple example the <code>server</code> function contains no commands (Lines 5-6). Although, as a matter of convention, the <code>server</code> arguments: <code>input, output, session</code> are still included.</li>
<li>
<strong><code>shinyApp</code>:</strong> The app function pairs the <code>ui</code>/<code>server</code> objects (Line 7).</li>
</ul>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
<p>
</p>
<p>One can open an <strong>R</strong> script with a <em>shiny</em> app skeleton in RStudio by going to <strong>File<span class="math inline">\(&gt;\)</span>New File<span class="math inline">\(&gt;\)</span>Shiny Web Application</strong>. This will allow RStudio to recognize the script as app code. This, in turn, allows running the app by either sending its code to the console (e.g., using <kbd>Ctrl</kbd> + <kbd>Enter</kbd>), or by using the <strong>Run App</strong> button in the <strong>Shiny Web Application</strong> toolbar.</p>
<div class="example">
<p><span id="exm:exm-c1110" class="example"><strong>Example 11.13  </strong></span>Here is a simple app that lists and provides details about datasets in the package <em>asbio</em> (Fig <a href="ch11.html#fig:asbiod1">11.16</a>).</p>
<div class="sourceCode" id="cb1201"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb1201-1"><a href="ch11.html#cb1201-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb1201-2"><a href="ch11.html#cb1201-2"></a>  <span class="fu">selectInput</span>(<span class="st">"dataset"</span>, <span class="at">label =</span> <span class="st">"Dataset"</span>,</span>
<span id="cb1201-3"><a href="ch11.html#cb1201-3"></a>              <span class="at">choices =</span> <span class="fu">data</span>(<span class="at">package =</span> <span class="st">"asbio"</span>)<span class="sc">$</span>results[,<span class="dv">3</span>])</span>
<span id="cb1201-4"><a href="ch11.html#cb1201-4"></a>)</span>
<span id="cb1201-5"><a href="ch11.html#cb1201-5"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb1201-6"><a href="ch11.html#cb1201-6"></a>}</span>
<span id="cb1201-7"><a href="ch11.html#cb1201-7"></a><span class="fu">shinyApp</span>(ui, server)</span></code></pre></div>
<ul>
<li>
<strong><code>ui</code>:</strong> <code>fluidPage()</code> includes <code><a href="https://rdrr.io/pkg/shiny/man/selectInput.html">shiny::selectInput()</a></code>, an input control function that provides the user with a select box widget. An appropriate label <code>"Dataset"</code> is defined. Selection box <code>choices</code> are the third column in <code>data(package = "asbio")$results</code>, which contains the names of the dataframe object names in <em>asbio</em>.</li>
<li>
<strong><code>server</code>:</strong> Once again, the <code>server</code> function contains no commands (Lines 5-6).</li>
<li>
<strong><code>shinyApp</code>:</strong> The app function again pairs the <code>ui</code>/<code>server</code> objects (Line 7).</li>
</ul>
<p>
</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:asbiod1"></span>
<img src="figs11/asbio1.png" alt="A *shiny* app to allow scrolling through *asbio* datasets." width="50%"><p class="caption">
Figure 11.16: A <em>shiny</em> app to allow scrolling through <em>asbio</em> datasets.
</p>
</div>
<p>The app in Fig <a href="ch11.html#fig:asbiod1">11.16</a> has limited usefulness because it provides only the <code>asbio</code> dataframe object names. Indeed, we could get more information by simply running <code>data(package = "asbio")</code>. Here we insert additional features into the user interface and server to increase functionality (Fig <a href="ch11.html#fig:asbiod2">11.17</a>).</p>
<div class="sourceCode" id="cb1202"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb1202-1"><a href="ch11.html#cb1202-1"></a>adata <span class="ot">&lt;-</span> <span class="fu">data</span>(<span class="at">package =</span> <span class="st">"asbio"</span>)<span class="sc">$</span>results[,<span class="dv">3</span>]</span>
<span id="cb1202-2"><a href="ch11.html#cb1202-2"></a><span class="fu">data</span>(<span class="at">list =</span> adata[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(adata)]) <span class="co"># loads all asbio datasets</span></span>
<span id="cb1202-3"><a href="ch11.html#cb1202-3"></a></span>
<span id="cb1202-4"><a href="ch11.html#cb1202-4"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb1202-5"><a href="ch11.html#cb1202-5"></a>  <span class="fu">selectInput</span>(<span class="st">"dataset"</span>, <span class="at">label =</span> <span class="st">"Dataset"</span>, <span class="at">choices =</span> adata),</span>
<span id="cb1202-6"><a href="ch11.html#cb1202-6"></a>  <span class="fu">verbatimTextOutput</span>(<span class="st">"summary"</span>),</span>
<span id="cb1202-7"><a href="ch11.html#cb1202-7"></a>  <span class="fu">tableOutput</span>(<span class="st">"table"</span>)</span>
<span id="cb1202-8"><a href="ch11.html#cb1202-8"></a>)</span>
<span id="cb1202-9"><a href="ch11.html#cb1202-9"></a></span>
<span id="cb1202-10"><a href="ch11.html#cb1202-10"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session){</span>
<span id="cb1202-11"><a href="ch11.html#cb1202-11"></a>    output<span class="sc">$</span>summary <span class="ot">&lt;-</span> <span class="fu">renderPrint</span>({</span>
<span id="cb1202-12"><a href="ch11.html#cb1202-12"></a>    dataset <span class="ot">&lt;-</span> <span class="fu">get</span>(input<span class="sc">$</span>dataset)</span>
<span id="cb1202-13"><a href="ch11.html#cb1202-13"></a>    <span class="fu">summary</span>(dataset)</span>
<span id="cb1202-14"><a href="ch11.html#cb1202-14"></a>  })</span>
<span id="cb1202-15"><a href="ch11.html#cb1202-15"></a></span>
<span id="cb1202-16"><a href="ch11.html#cb1202-16"></a>  output<span class="sc">$</span>table <span class="ot">&lt;-</span> <span class="fu">renderTable</span>({</span>
<span id="cb1202-17"><a href="ch11.html#cb1202-17"></a>      dataset <span class="ot">&lt;-</span> <span class="fu">get</span>(input<span class="sc">$</span>dataset)</span>
<span id="cb1202-18"><a href="ch11.html#cb1202-18"></a>    dataset</span>
<span id="cb1202-19"><a href="ch11.html#cb1202-19"></a>  })</span>
<span id="cb1202-20"><a href="ch11.html#cb1202-20"></a>}</span>
<span id="cb1202-21"><a href="ch11.html#cb1202-21"></a></span>
<span id="cb1202-22"><a href="ch11.html#cb1202-22"></a><span class="fu">shinyApp</span>(ui, server)</span></code></pre></div>
<ul>
<li><p>The code <code>data(list = adata[1:length(adata)])</code> loads all the <em>asbio</em> datasets into the global environment (Line 2).</p></li>
<li>
<p><strong><code>ui</code>:</strong> <code>fluidPage()</code> now specifies three features, which will occur from top to bottom app, as they are listed (Lines 4-8).</p>
<ul>
<li>The functions<code><a href="https://rdrr.io/pkg/shiny/man/textOutput.html">shiny::verbatimTextOutput()</a></code> (Line 6) and <code><a href="https://rdrr.io/pkg/shiny/man/renderTable.html">shiny::tableOutput()</a></code> (Line 7) are controls that define how and where output (depending on the order they are specified in <code>fluidPage()</code>) are displayed. Specifically, <code>verbatimTextOutput()</code> displays code, and <code>tableOutput()</code> displays tables.</li>
</ul>
</li>
<li>
<p><strong><code>server</code>:</strong> The <code>server</code> function has been modified to allow interaction with the user interface (Lines 10-20). It allows generations of two objects: <code>output$summary</code> (Line 11) and <code>output$table</code> (Line 12), based on <code>input$dataset</code> from the <code>ui</code>.</p>
<ul>
<li>
<code>output$summary</code> (lines 10-14) is a rendered expression from <code><a href="https://rdrr.io/pkg/shiny/man/renderPrint.html">shiny::renderPrint()</a></code>. In particular, this will be output from <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> (Line 13) for columns in <code>input$dataset</code> which is made available in the object <code>dataset</code> on Line 12. The output operation is coupled with <code>verbatimTextOutput("summary")</code> in the <code>ui</code>.<br>
</li>
<li>
<code>output$table</code> (Lines 16-19) is a rendered expression from <code><a href="https://rdrr.io/pkg/shiny/man/renderTable.html">shiny::renderTable()</a></code>. It will show the raw data in a scrollable table for the dataframe specified in the <code>ui</code>. This output operation is coupled with <code>tableOutput("table")</code> in the <code>ui</code>.</li>
</ul>
</li>
<li><p><strong><code>shinyApp</code>:</strong> As before, we generate the app using: <code>shinyApp(ui, server)</code> (Line 22).</p></li>
</ul>
<p>
</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:asbiod2"></span>
<img src="figs11/asbio2.png" alt="A modified *shiny* app to provide summaries of scrollable *asbio* datasets." width="50%"><p class="caption">
Figure 11.17: A modified <em>shiny</em> app to provide summaries of scrollable <em>asbio</em> datasets.
</p>
</div>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
<div id="ui-details" class="section level3" number="11.5.1">
<h3>
<span class="header-section-number">11.5.1</span> <code>ui</code> Details<a class="anchor" aria-label="anchor" href="#ui-details"><i class="fas fa-link"></i></a>
</h3>
<p>Input widget functions are specified in the <code>ui</code>. A <code>ui</code> input function, e.g., <code>selectInput()</code> with first argument <code>"foo"</code>, or with <code>inputId = "foo"</code> can be called by <code>server</code> operations using the script <code>input$foo</code>. Most input functions have a 2nd argument called <code>label</code> that creates a user-readable label for the control widget on the app. A The 3rd input argument is typically <code>value</code> which creates a starting value for the widget control. Fig <a href="ch11.html#fig:widgets">11.18</a> shows many of the standard <em>shiny</em> <code>ui</code> input functions (without output). Important <code>ui</code> import functions are also listed Table <a href="ch11.html#tab:uii">11.1</a>.</p>
<div class="sourceCode" id="cb1203"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"shiny_widgets.R"</span><span class="op">)</span></span>
<span><span class="fu">shiny_widgets</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:widgets"></span>
<img src="figs11/widgets.png" alt="A variety of *shiny* input widgets and operations that can be specified in the `ui`. By row, the figure depicts widgets generated by the functions: `actionButton()`, `submitButton()`, `checkboxInput`, `checkboxGroupInput()`, `dateInput()`, `dateRangeInput()`, `fileInput()`, `helpText()`, `numericInput()`, `radioButtons()`, `selectInput()`, `sliderInput()`, and `textInput()`. Also see Table \@ref(tab:uii)." width="80%"><p class="caption">
Figure 11.18: A variety of <em>shiny</em> input widgets and operations that can be specified in the <code>ui</code>. By row, the figure depicts widgets generated by the functions: <code>actionButton()</code>, <code>submitButton()</code>, <code>checkboxInput</code>, <code>checkboxGroupInput()</code>, <code>dateInput()</code>, <code>dateRangeInput()</code>, <code>fileInput()</code>, <code>helpText()</code>, <code>numericInput()</code>, <code>radioButtons()</code>, <code>selectInput()</code>, <code>sliderInput()</code>, and <code>textInput()</code>. Also see Table <a href="ch11.html#tab:uii">11.1</a>.
</p>
</div>
<p>
</p>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:uii">Table 11.1: </span>Some important <em>shiny</em> <code>ui</code> input functions.</caption>
<colgroup>
<col width="29%">
<col width="70%">
</colgroup>
<thead><tr class="header">
<th align="left">Function</th>
<th align="left">Purpose</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">
<code>actionButton()</code>, <code>actionLink()</code>
</td>
<td align="left">Creates an action button or link.</td>
</tr>
<tr class="even">
<td align="left"><code>submitButton()</code></td>
<td align="left">Create a submit button.</td>
</tr>
<tr class="odd">
<td align="left"><code>checkboxInput()</code></td>
<td align="left">Create a checkbox to specify logical values.</td>
</tr>
<tr class="even">
<td align="left"><code>dateInput()</code></td>
<td align="left">Create a selectable calendar.</td>
</tr>
<tr class="odd">
<td align="left"><code>dateRangeInput()</code></td>
<td align="left">Create a pair of selectable calendars.</td>
</tr>
<tr class="even">
<td align="left"><code>fileInput()</code></td>
<td align="left">Create a file upload control to upload one or more files.</td>
</tr>
<tr class="odd">
<td align="left"><code>helpText()</code></td>
<td align="left">Create help text which can be added to input to provide additional information.</td>
</tr>
<tr class="even">
<td align="left"><code>numericInput()</code></td>
<td align="left">Create an input control for entry of numeric values</td>
</tr>
<tr class="odd">
<td align="left"><code>radioButtons()</code></td>
<td align="left">Create a set of radio buttons to select item from a list.</td>
</tr>
<tr class="even">
<td align="left"><code>selectInput()</code></td>
<td align="left">Create a selectable list, from which single or multiple items can be selected.</td>
</tr>
<tr class="odd">
<td align="left"><code>sliderInput()</code></td>
<td align="left">Constructs a slider widget to elect a number, date, or date-time.</td>
</tr>
<tr class="even">
<td align="left"><code>passwordInput</code></td>
<td align="left">Create an control for entry for passwords.</td>
</tr>
<tr class="odd">
<td align="left"><code>textInput()</code></td>
<td align="left">Create an input control for unstructured text.</td>
</tr>
</tbody>
</table></div>
<div id="output" class="section level4" number="11.5.1.1">
<h4>
<span class="header-section-number">11.5.1.1</span> Output<a class="anchor" aria-label="anchor" href="#output"><i class="fas fa-link"></i></a>
</h4>
<p>Output functions in the <code>ui</code> create placeholders that can filled by the <code>server</code> function. As with inputs, outputs require a unique ID. For instance, in Fig <a href="ch11.html#fig:usco21">11.19</a>, which provides a simple summary of the <code><a href="https://rdrr.io/pkg/asbio/man/world.emissions.html">asbio::world.emissions</a></code> dataset, <code>output$code</code> and <code>output$text</code> generated in the <code>server</code> are placed in the fluid page using <code>textOutput("text")</code> and <code>verbatimTextOutput("code")</code>.</p>
<div class="sourceCode" id="cb1204"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb1204-1"><a href="ch11.html#cb1204-1"></a><span class="fu">library</span>(asbio)</span>
<span id="cb1204-2"><a href="ch11.html#cb1204-2"></a><span class="fu">data</span>(world.emissions)</span>
<span id="cb1204-3"><a href="ch11.html#cb1204-3"></a></span>
<span id="cb1204-4"><a href="ch11.html#cb1204-4"></a>US <span class="ot">&lt;-</span> world.emissions <span class="sc">|&gt;</span></span>
<span id="cb1204-5"><a href="ch11.html#cb1204-5"></a>  <span class="fu">filter</span>(country <span class="sc">==</span> <span class="st">"United States"</span>)</span>
<span id="cb1204-6"><a href="ch11.html#cb1204-6"></a></span>
<span id="cb1204-7"><a href="ch11.html#cb1204-7"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb1204-8"><a href="ch11.html#cb1204-8"></a>  <span class="fu">textOutput</span>(<span class="st">"text"</span>),</span>
<span id="cb1204-9"><a href="ch11.html#cb1204-9"></a>  <span class="fu">verbatimTextOutput</span>(<span class="st">"code"</span>)</span>
<span id="cb1204-10"><a href="ch11.html#cb1204-10"></a>)</span>
<span id="cb1204-11"><a href="ch11.html#cb1204-11"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb1204-12"><a href="ch11.html#cb1204-12"></a>  output<span class="sc">$</span>text <span class="ot">&lt;-</span> <span class="fu">renderText</span>({</span>
<span id="cb1204-13"><a href="ch11.html#cb1204-13"></a>    <span class="st">"Summary of the US CO\u2082 data </span><span class="sc">\n</span><span class="st">"</span></span>
<span id="cb1204-14"><a href="ch11.html#cb1204-14"></a>  })</span>
<span id="cb1204-15"><a href="ch11.html#cb1204-15"></a>  output<span class="sc">$</span>code <span class="ot">&lt;-</span> <span class="fu">renderPrint</span>({</span>
<span id="cb1204-16"><a href="ch11.html#cb1204-16"></a>    <span class="fu">summary</span>(US<span class="sc">$</span>co2)</span>
<span id="cb1204-17"><a href="ch11.html#cb1204-17"></a>  })</span>
<span id="cb1204-18"><a href="ch11.html#cb1204-18"></a>}</span>
<span id="cb1204-19"><a href="ch11.html#cb1204-19"></a></span>
<span id="cb1204-20"><a href="ch11.html#cb1204-20"></a><span class="fu">shinyApp</span>(ui, server)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:usco21"></span>
<img src="figs11/co2_1.png" alt="A simple app providing a single descriptive statistics summary." width="70%"><p class="caption">
Figure 11.19: A simple app providing a single descriptive statistics summary.
</p>
</div>
<p>Table <a href="ch11.html#tab:uio">11.2</a> lists some potential <code>ui</code> output functions that can be used in <em>shiny</em> apps.</p>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:uio">Table 11.2: </span>Some important <em>shiny</em> <code>ui</code> output functions.</caption>
<colgroup>
<col width="27%">
<col width="72%">
</colgroup>
<thead><tr class="header">
<th align="left">Function</th>
<th align="left">Purpose</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">
<code>downloadButton()</code>, <code>downloadLink()</code>
</td>
<td align="left">Create a download button or link. To be paired with <code>downloadHandler()</code> in <code>server</code>.</td>
</tr>
<tr class="even">
<td align="left">
<code>htmlOutput()</code>, <code>uiOutput()</code>
</td>
<td align="left">Create an HTML output element.</td>
</tr>
<tr class="odd">
<td align="left">
<code>imageOutput()</code>, <code>plotOutput()</code>
</td>
<td align="left">Create a plot or image output element. To be paired with <code>renderPlot()</code> and <code>renderImage()</code>, respectively, in <code>server</code>.</td>
</tr>
<tr class="even">
<td align="left"><code>outputOptions()</code></td>
<td align="left">Set options for an output object.</td>
</tr>
<tr class="odd">
<td align="left">
<code>modalDialog()</code>, <code>modalButton()</code>
</td>
<td align="left">Create a modal dialog interface.</td>
</tr>
<tr class="even">
<td align="left">
<code>showNotification()</code>, <code>removeNotification()</code>
</td>
<td align="left">Show or remove a notification.</td>
</tr>
<tr class="odd">
<td align="left">
<code>textOutput()</code>, <code>verbatimTextOutput()</code>
</td>
<td align="left">Create a text output element. To be paired with <code>renderText()</code> and <code>renderPrint()</code>, respectively, in <code>server</code>.</td>
</tr>
<tr class="even">
<td align="left"><code>urlModal()</code></td>
<td align="left">Generate a modal dialog that displays a URL.</td>
</tr>
</tbody>
</table></div>
<p>
</p>
</div>
</div>
<div id="server-details" class="section level3" number="11.5.2">
<h3>
<span class="header-section-number">11.5.2</span> <code>server</code> Details<a class="anchor" aria-label="anchor" href="#server-details"><i class="fas fa-link"></i></a>
</h3>
<p>As noted earlier, the <code>server</code> function requires three arguments: <code>input</code>, <code>output</code>, and <code>session</code>. The <code>input</code> argument allows assembly of items from the <code>ui</code> front-end to create a list-like object. The <code>output</code> argument in <code>server</code> provides output for <code>ui</code> inputs, often via rendering and handling functions (Table <a href="ch11.html#tab:serveo">11.3</a>).</p>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:serveo">Table 11.3: </span>Some <em>shiny</em> <code>server</code> rendering and handling functions.</caption>
<colgroup>
<col width="22%">
<col width="78%">
</colgroup>
<thead><tr class="header">
<th align="left">Function</th>
<th align="left">Purpose</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>downloadHandler()</code></td>
<td align="left">Create a download button or link. To be paired with <code>downloadButton()</code> and <code>downloadLink()</code> in <code>ui</code>.</td>
</tr>
<tr class="even">
<td align="left">
<code>renderPlot()</code>, <code>renderImage()</code>
</td>
<td align="left">Create a plot or image output element. To be paired with <code>imageOutput()</code> and <code>plotOutput()</code>, respectively, in <code>ui</code>.</td>
</tr>
<tr class="odd">
<td align="left">
<code>renderText()</code> , <code>renderPrint()</code>
</td>
<td align="left">Create a text output element. To be paired with <code>textOutput()</code> and <code>verbatimTextOutput()</code>, respectively, in <code>ui</code>.</td>
</tr>
</tbody>
</table></div>
<p>
</p>
<p>Fig <a href="ch11.html#fig:shiny4">11.20</a> shows an app with sliders inputs, generated using the function <code>sliderInput()</code> in the <code>ui</code>, and text (product) output which is provided to the <code>ui</code> from the <code>server</code>, via <code>renderText()</code>.</p>
<div class="sourceCode" id="cb1205"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb1205-1"><a href="ch11.html#cb1205-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb1205-2"><a href="ch11.html#cb1205-2"></a>  <span class="fu">sliderInput</span>(<span class="st">"x"</span>, <span class="at">label =</span> <span class="st">"If x is"</span>, <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max =</span> <span class="dv">50</span>, <span class="at">value =</span> <span class="dv">30</span>),</span>
<span id="cb1205-3"><a href="ch11.html#cb1205-3"></a>  <span class="fu">sliderInput</span>(<span class="st">"y"</span>, <span class="at">label =</span> <span class="st">"And y is"</span>, <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max =</span> <span class="dv">50</span>, <span class="at">value =</span> <span class="dv">30</span>),</span>
<span id="cb1205-4"><a href="ch11.html#cb1205-4"></a>  <span class="st">"then x times y is"</span>,</span>
<span id="cb1205-5"><a href="ch11.html#cb1205-5"></a>  <span class="fu">textOutput</span>(<span class="st">"product"</span>)</span>
<span id="cb1205-6"><a href="ch11.html#cb1205-6"></a>)</span>
<span id="cb1205-7"><a href="ch11.html#cb1205-7"></a></span>
<span id="cb1205-8"><a href="ch11.html#cb1205-8"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb1205-9"><a href="ch11.html#cb1205-9"></a>  output<span class="sc">$</span>product <span class="ot">&lt;-</span> <span class="fu">renderText</span>({</span>
<span id="cb1205-10"><a href="ch11.html#cb1205-10"></a>    input<span class="sc">$</span>x <span class="sc">*</span> input<span class="sc">$</span>y</span>
<span id="cb1205-11"><a href="ch11.html#cb1205-11"></a>  })</span>
<span id="cb1205-12"><a href="ch11.html#cb1205-12"></a>}</span>
<span id="cb1205-13"><a href="ch11.html#cb1205-13"></a></span>
<span id="cb1205-14"><a href="ch11.html#cb1205-14"></a><span class="fu">shinyApp</span>(ui, server)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:shiny4"></span>
<img src="figs11/shiny4.png" alt="A simple slider app." width="70%"><p class="caption">
Figure 11.20: A simple slider app.
</p>
</div>
</div>
<div id="running-shiny-apps-in-r-markdown" class="section level3" number="11.5.3">
<h3>
<span class="header-section-number">11.5.3</span> Running <em>shiny</em> Apps in <strong>R</strong> Markdown<a class="anchor" aria-label="anchor" href="#running-shiny-apps-in-r-markdown"><i class="fas fa-link"></i></a>
</h3>
<p>Unlike <em>plotly</em> graphics, <em>shiny</em> apps are not automatically interactive in an <strong>R</strong> markdown rendered document. However, it is easy to a make shiny app interactive in this setting (provided that <strong>R</strong> is open to run the app). One simply adds <code>runtime:shiny</code> to the <strong>R</strong> Markdown YAML header. Thus, the YAML header in <strong>R</strong> markdown should have the format of Fig <a href="ch11.html#fig:yaml11">11.21</a>. Note that this approach will now be possible under Bookdown.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:yaml11"></span>
<img src="figs11/YAML.png" alt="YAML header to allow inclusion of *shiny* apps in an **R** Markdown generated HTML." width="55%"><p class="caption">
Figure 11.21: YAML header to allow inclusion of <em>shiny</em> apps in an <strong>R</strong> Markdown generated HTML.
</p>
</div>
<p>Some adjustments to <strong>R</strong> and Markdown code may be needed (e.g., figure margins in <code>renderPlot()</code> may need to be changed) to make apps fit nicely on a page. A <em>shiny</em> app will only work remotely (outside of an <strong>R</strong> session) if a server implementing <strong>R</strong> is used to implement the app’s code. This process will be detailed at the end of the chapter.</p>
</div>
<div id="reactive-programming" class="section level3" number="11.5.4">
<h3>
<span class="header-section-number">11.5.4</span> Reactive Programming<a class="anchor" aria-label="anchor" href="#reactive-programming"><i class="fas fa-link"></i></a>
</h3>
<p>We can increase efficiency in Shiny apps using reactive programming wherein outputs automatically update as inputs change. Under reactive programming we specify interactive dependencies so that when an input changes, all related outputs are automatically updated. The code below results in the app shown in Fig <a href="ch11.html#fig:react">11.22</a>. Note that the output updates ``reactively’’ as I type individual characters of my name.</p>
<div class="sourceCode" id="cb1206"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb1206-1"><a href="ch11.html#cb1206-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb1206-2"><a href="ch11.html#cb1206-2"></a>  <span class="fu">textInput</span>(<span class="st">"name"</span>, <span class="st">"What's your name?"</span>),</span>
<span id="cb1206-3"><a href="ch11.html#cb1206-3"></a>  <span class="fu">textOutput</span>(<span class="st">"greeting"</span>)</span>
<span id="cb1206-4"><a href="ch11.html#cb1206-4"></a>)</span>
<span id="cb1206-5"><a href="ch11.html#cb1206-5"></a></span>
<span id="cb1206-6"><a href="ch11.html#cb1206-6"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb1206-7"><a href="ch11.html#cb1206-7"></a>  output<span class="sc">$</span>greeting <span class="ot">&lt;-</span> <span class="fu">renderText</span>({</span>
<span id="cb1206-8"><a href="ch11.html#cb1206-8"></a>   <span class="fu">paste0</span>(<span class="st">"Hello "</span>, input<span class="sc">$</span>name, <span class="st">"!"</span>)</span>
<span id="cb1206-9"><a href="ch11.html#cb1206-9"></a>  })</span>
<span id="cb1206-10"><a href="ch11.html#cb1206-10"></a>}</span>
<span id="cb1206-11"><a href="ch11.html#cb1206-11"></a><span class="fu">shinyApp</span>(ui, server)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:react"></span>
<img src="figs11/names.png" alt="Reactive behavior of a simple *shiny* app." width="50%"><p class="caption">
Figure 11.22: Reactive behavior of a simple <em>shiny</em> app.
</p>
</div>
<p>Reactive programming usually occurs in more complex settings than the previous example and requires the function <code>reactive</code>.</p>
<div class="example">
<p><span id="exm:exm-c11react" class="example"><strong>Example 11.14  </strong></span><span class="math inline">\(\text{}\)</span><br>
As an extended example, imagine we wish to rapidly examine green house emissions data for the fifty countries in the <code><a href="https://rdrr.io/pkg/asbio/man/world.emissions.html">asbio::world.emissions</a></code> dataset with the highest current populations. As a first step, we do some data tidying and create a stats summary callback function we will use later.</p>
<div class="sourceCode" id="cb1207"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb1207-1"><a href="ch11.html#cb1207-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1207-2"><a href="ch11.html#cb1207-2"></a>not.redundant <span class="ot">&lt;-</span> world.emissions <span class="sc">|&gt;</span> <span class="fu">filter</span>(continent <span class="sc">!=</span> <span class="st">"Redundant"</span>)</span>
<span id="cb1207-3"><a href="ch11.html#cb1207-3"></a></span>
<span id="cb1207-4"><a href="ch11.html#cb1207-4"></a>pop.max <span class="ot">&lt;-</span> not.redundant <span class="sc">|&gt;</span></span>
<span id="cb1207-5"><a href="ch11.html#cb1207-5"></a>  <span class="fu">group_by</span>(country) <span class="sc">|&gt;</span></span>
<span id="cb1207-6"><a href="ch11.html#cb1207-6"></a>  <span class="fu">summarise</span>(<span class="at">max.pop =</span> <span class="fu">max</span>(population)) <span class="sc">|&gt;</span></span>
<span id="cb1207-7"><a href="ch11.html#cb1207-7"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(max.pop))</span>
<span id="cb1207-8"><a href="ch11.html#cb1207-8"></a></span>
<span id="cb1207-9"><a href="ch11.html#cb1207-9"></a><span class="co"># names of 50 largest countries</span></span>
<span id="cb1207-10"><a href="ch11.html#cb1207-10"></a>country_names <span class="ot">&lt;-</span> <span class="fu">setNames</span>(<span class="at">nm =</span> pop.max<span class="sc">$</span>country[<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>])</span>
<span id="cb1207-11"><a href="ch11.html#cb1207-11"></a></span>
<span id="cb1207-12"><a href="ch11.html#cb1207-12"></a><span class="co"># 50 largest countries data</span></span>
<span id="cb1207-13"><a href="ch11.html#cb1207-13"></a>top50 <span class="ot">&lt;-</span> not.redundant <span class="sc">|&gt;</span></span>
<span id="cb1207-14"><a href="ch11.html#cb1207-14"></a>  <span class="fu">filter</span>(country <span class="sc">%in%</span> pop.max<span class="sc">$</span>country[<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>])</span>
<span id="cb1207-15"><a href="ch11.html#cb1207-15"></a></span>
<span id="cb1207-16"><a href="ch11.html#cb1207-16"></a><span class="co"># summary stats</span></span>
<span id="cb1207-17"><a href="ch11.html#cb1207-17"></a>summarize <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">rn =</span> <span class="fu">c</span>(<span class="st">"CO2"</span>, <span class="st">"CH4"</span>, <span class="st">"NOx"</span>, <span class="st">"total GHG"</span>)){</span>
<span id="cb1207-18"><a href="ch11.html#cb1207-18"></a>    mean <span class="ot">&lt;-</span> <span class="fu">apply</span>(x, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">mean</span>(x, <span class="at">na.rm =</span> T))</span>
<span id="cb1207-19"><a href="ch11.html#cb1207-19"></a>    max <span class="ot">&lt;-</span> <span class="fu">apply</span>(x, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">max</span>(x, <span class="at">na.rm =</span> T))</span>
<span id="cb1207-20"><a href="ch11.html#cb1207-20"></a>    sum <span class="ot">&lt;-</span> <span class="fu">apply</span>(x, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">sum</span>(x, <span class="at">na.rm =</span> T))</span>
<span id="cb1207-21"><a href="ch11.html#cb1207-21"></a>    n <span class="ot">&lt;-</span> <span class="fu">apply</span>(x, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">length</span>(<span class="fu">which</span>(<span class="sc">!</span><span class="fu">is.na</span>(x))))</span>
<span id="cb1207-22"><a href="ch11.html#cb1207-22"></a>    df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">mean =</span> mean, <span class="at">max =</span> max, <span class="at">cumulative =</span> sum, <span class="at">n =</span> n)</span>
<span id="cb1207-23"><a href="ch11.html#cb1207-23"></a>    <span class="fu">row.names</span>(df) <span class="ot">&lt;-</span> rn</span>
<span id="cb1207-24"><a href="ch11.html#cb1207-24"></a>    df</span>
<span id="cb1207-25"><a href="ch11.html#cb1207-25"></a>}</span></code></pre></div>
<ul>
<li>
<strong><code>ui</code>:</strong> We define a relatively complex <code>ui</code> that will provide sufficient inputs and outputs for the <code>server</code> function.</li>
</ul>
<div class="sourceCode" id="cb1208" startfrom="26"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r" style="counter-reset: source-line 25;"><span id="cb1208-26"><a href="ch11.html#cb1208-26"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb1208-27"><a href="ch11.html#cb1208-27"></a>  <span class="fu">titlePanel</span>(<span class="fu">h1</span>(<span class="st">"Greenhouse gasses"</span>, <span class="at">align =</span> <span class="st">"center"</span>)), <span class="co">#h1 = HTML heading</span></span>
<span id="cb1208-28"><a href="ch11.html#cb1208-28"></a>  <span class="fu">fluidRow</span>(</span>
<span id="cb1208-29"><a href="ch11.html#cb1208-29"></a>    <span class="fu">column</span>(<span class="dv">6</span>,</span>
<span id="cb1208-30"><a href="ch11.html#cb1208-30"></a>      <span class="fu">selectInput</span>(<span class="st">"country"</span>, <span class="at">choices =</span> country_names, <span class="at">label =</span> <span class="st">"Country"</span>)</span>
<span id="cb1208-31"><a href="ch11.html#cb1208-31"></a>    )</span>
<span id="cb1208-32"><a href="ch11.html#cb1208-32"></a>  ),</span>
<span id="cb1208-33"><a href="ch11.html#cb1208-33"></a>  <span class="fu">fluidRow</span>(</span>
<span id="cb1208-34"><a href="ch11.html#cb1208-34"></a>    <span class="fu">column</span>(<span class="dv">4</span>, <span class="fu">tableOutput</span>(<span class="st">"diag"</span>)), <span class="co"># table</span></span>
<span id="cb1208-35"><a href="ch11.html#cb1208-35"></a>  ),</span>
<span id="cb1208-36"><a href="ch11.html#cb1208-36"></a>  <span class="fu">br</span>(), <span class="co"># line break</span></span>
<span id="cb1208-37"><a href="ch11.html#cb1208-37"></a>  <span class="fu">br</span>(),</span>
<span id="cb1208-38"><a href="ch11.html#cb1208-38"></a>  <span class="fu">fluidRow</span>(</span>
<span id="cb1208-39"><a href="ch11.html#cb1208-39"></a>    <span class="fu">column</span>(<span class="dv">12</span>, <span class="fu">plotOutput</span>(<span class="st">"plot"</span>)) <span class="co"># plot</span></span>
<span id="cb1208-40"><a href="ch11.html#cb1208-40"></a>  )</span>
<span id="cb1208-41"><a href="ch11.html#cb1208-41"></a>)</span></code></pre></div>
<ul>
<li>Note that we use the <code>fluidRow()</code> layout function. Shiny app rows, created with <code>fluidRow()</code>, contain twelve columns. These can be divided up in various ways using <code><a href="https://rdrr.io/pkg/shiny/man/column.html">shiny::column()</a></code>(Fig <a href="ch11.html#fig:srows">11.23</a>).</li>
<li>The functions <code><a href="https://rstudio.github.io/htmltools/reference/builder.html">htmltools::br()</a></code> and <code><a href="https://rstudio.github.io/htmltools/reference/builder.html">htmltools::h1()</a></code> are HTML tags from the package <em>htmltools</em>, which is imported by <em>shiny</em>. The <code>h1()</code> function creates a first level heading. Thus, it is equivalent to the HTML operator <code>&lt;h1&gt;</code>. The <code>br()</code> functions equates to an HTML line break tag, i.e., <code>&lt;br&gt;</code>. A list of HTML equivalent tags is provided in <code><a href="https://rstudio.github.io/htmltools/reference/builder.html">?htmltools::builder</a></code>.</li>
<li>The function <code>plotOutput()</code> allows input of interactive <strong>R</strong> graphs, including ggplots (see below).</li>
</ul>
<p>
</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:srows"></span>
<img src="figs11/fluidrow.png" alt="Behavior of *shiny* app rows and columns, in the `ui`. Figure taken from @wickham2021mastering." width="50%"><p class="caption">
Figure 11.23: Behavior of <em>shiny</em> app rows and columns, in the <code>ui</code>. Figure taken from <span class="citation">Wickham (<a href="references.html#ref-wickham2021mastering">2021</a>)</span>.
</p>
</div>
<ul>
<li>
<strong><code>server</code>:</strong>: The <code>server</code> function contains several new features, including use of the function <code>reactive()</code>.</li>
</ul>
<div class="sourceCode" id="cb1209" startfrom="42"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r" style="counter-reset: source-line 41;"><span id="cb1209-42"><a href="ch11.html#cb1209-42"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb1209-43"><a href="ch11.html#cb1209-43"></a>  selected <span class="ot">&lt;-</span> <span class="fu">reactive</span>(top50 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(country <span class="sc">==</span> input<span class="sc">$</span>country))</span>
<span id="cb1209-44"><a href="ch11.html#cb1209-44"></a></span>
<span id="cb1209-45"><a href="ch11.html#cb1209-45"></a>  output<span class="sc">$</span>diag <span class="ot">&lt;-</span> <span class="fu">renderTable</span>(</span>
<span id="cb1209-46"><a href="ch11.html#cb1209-46"></a>  <span class="fu">summarize</span>(<span class="fu">select</span>(<span class="fu">selected</span>(), co2, methane, nitrous_oxide, total_ghg)),</span>
<span id="cb1209-47"><a href="ch11.html#cb1209-47"></a>  <span class="at">colnames =</span> <span class="cn">TRUE</span>, <span class="at">rownames =</span> <span class="cn">TRUE</span></span>
<span id="cb1209-48"><a href="ch11.html#cb1209-48"></a>  )</span>
<span id="cb1209-49"><a href="ch11.html#cb1209-49"></a></span>
<span id="cb1209-50"><a href="ch11.html#cb1209-50"></a>  output<span class="sc">$</span>plot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb1209-51"><a href="ch11.html#cb1209-51"></a>  <span class="fu">selected</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1209-52"><a href="ch11.html#cb1209-52"></a>       <span class="fu">ggplot</span>(<span class="fu">aes</span>(year, co2)) <span class="sc">+</span></span>
<span id="cb1209-53"><a href="ch11.html#cb1209-53"></a>       <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb1209-54"><a href="ch11.html#cb1209-54"></a>       <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb1209-55"><a href="ch11.html#cb1209-55"></a>            <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(CO[<span class="dv">2</span>], <span class="st">" emissions ("</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>, <span class="st">" tonnes)"</span>)))</span>
<span id="cb1209-56"><a href="ch11.html#cb1209-56"></a>  })</span>
<span id="cb1209-57"><a href="ch11.html#cb1209-57"></a>}</span></code></pre></div>
<ul>
<li>The code:</li>
</ul>
<div class="sourceCode" id="cb1210"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">selected</span> <span class="op">&lt;-</span> <span class="fu">reactive</span><span class="op">(</span><span class="va">top50</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">country</span> <span class="op">==</span> <span class="va">input</span><span class="op">$</span><span class="va">country</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>provides a data subset for a particular country that only needs to be calculated once, and then re-used. This also allows spontaneous (as possible) interaction with the <code>ui</code> with respect to this choice. The reactive object <code>selected</code> is called several times, as a function, in the <code>server</code> function.
- The object <code>output$plot &lt;- renderPlot()</code> will be a ggplot generated from <code>selected()</code> which will be called by <code>plotOutput("plot")</code> in the <code>ui</code>.</p>
<p>
</p>
<ul>
<li>
<strong><code>shinyApp</code>:</strong> As before, we generate the app using:</li>
</ul>
<div class="sourceCode" id="cb1211" startfrom="58"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r" style="counter-reset: source-line 57;"><span id="cb1211-58"><a href="ch11.html#cb1211-58"></a><span class="fu">shinyApp</span>(ui, server)</span></code></pre></div>
<p>The final form of the app is shown in Fig <a href="ch11.html#fig:gg11">11.24</a>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:gg11"></span>
<img src="figs11/gg.png" alt="A *shiny* app to graphically depict changing CO$_2$ levels over time for a user-selected country." width="50%"><p class="caption">
Figure 11.24: A <em>shiny</em> app to graphically depict changing CO<span class="math inline">\(_2\)</span> levels over time for a user-selected country.
</p>
</div>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
<div class="example">
<p><span id="exm:exm-c11react2" class="example"><strong>Example 11.15  </strong></span><span class="math inline">\(\text{}\)</span><br><span class="citation">Wickham (<a href="references.html#ref-wickham2021mastering">2021</a>)</span> used <span class="math inline">\(t\)</span>-test computations to demonstrate reactive programming as shown (with some modifications) below. We first delineate two callback functions we wish to use in the app.</p>
<div class="sourceCode" id="cb1212"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb1212-1"><a href="ch11.html#cb1212-1"></a>freqpoly <span class="ot">&lt;-</span> <span class="cf">function</span>(x1, x2, <span class="at">binwidth =</span> <span class="fl">0.1</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>)) {</span>
<span id="cb1212-2"><a href="ch11.html#cb1212-2"></a>  <span class="fu">require</span>(ggplot2)</span>
<span id="cb1212-3"><a href="ch11.html#cb1212-3"></a>  df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1212-4"><a href="ch11.html#cb1212-4"></a>    <span class="at">x =</span> <span class="fu">c</span>(x1, x2),</span>
<span id="cb1212-5"><a href="ch11.html#cb1212-5"></a>    <span class="at">group =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"x1"</span>, <span class="fu">length</span>(x1)), <span class="fu">rep</span>(<span class="st">"x2"</span>, <span class="fu">length</span>(x2)))</span>
<span id="cb1212-6"><a href="ch11.html#cb1212-6"></a>  )</span>
<span id="cb1212-7"><a href="ch11.html#cb1212-7"></a>  <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, <span class="at">colour =</span> group)) <span class="sc">+</span></span>
<span id="cb1212-8"><a href="ch11.html#cb1212-8"></a>    <span class="fu">geom_freqpoly</span>(<span class="at">binwidth =</span> binwidth, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1212-9"><a href="ch11.html#cb1212-9"></a>    <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> xlim)</span>
<span id="cb1212-10"><a href="ch11.html#cb1212-10"></a>}</span>
<span id="cb1212-11"><a href="ch11.html#cb1212-11"></a></span>
<span id="cb1212-12"><a href="ch11.html#cb1212-12"></a>t_test <span class="ot">&lt;-</span> <span class="cf">function</span>(x1, x2) {</span>
<span id="cb1212-13"><a href="ch11.html#cb1212-13"></a>  test <span class="ot">&lt;-</span> <span class="fu">t.test</span>(x1, x2)</span>
<span id="cb1212-14"><a href="ch11.html#cb1212-14"></a>  <span class="fu">sprintf</span>(</span>
<span id="cb1212-15"><a href="ch11.html#cb1212-15"></a>    <span class="st">"p-value: %0.3f </span><span class="sc">\n</span><span class="st">CI for µ1 - µ2: [%0.2f, %0.2f]"</span>,</span>
<span id="cb1212-16"><a href="ch11.html#cb1212-16"></a>     test<span class="sc">$</span>p.value, test<span class="sc">$</span>conf.int[<span class="dv">1</span>], test<span class="sc">$</span>conf.int[<span class="dv">2</span>]</span>
<span id="cb1212-17"><a href="ch11.html#cb1212-17"></a>  )</span>
<span id="cb1212-18"><a href="ch11.html#cb1212-18"></a>}</span></code></pre></div>
<p>The function <code><a href="https://rdrr.io/r/stats/t.test.html">t.test()</a></code> runs <span class="math inline">\(t\)</span>-tests for true normal population means. In particular, assuming <span class="math inline">\(X_1 \sim N(\mu_1, \sigma^2_1)\)</span>, <span class="math inline">\(X_2 \sim N(\mu_2, \sigma^2_2)\)</span> we generally consider the hypotheses:</p>
<p><span class="math display">\[\begin{align*}
\text{H}_0: \mu_1 &amp;= \mu_2 \\
\text{H}_\text{A}: \mu_1 &amp;\neq \mu_2
\end{align*}\]</span></p>
<p>By default, <code><a href="https://rdrr.io/r/stats/t.test.html">t.test()</a></code> does not assume homoscedasticty (that is, it allows <span class="math inline">\(\sigma^2_1 \neq \sigma^2_2\)</span>). Thus, it uses the Satterthwaite method to estimate degrees of freedom for the null <span class="math inline">\(t\)</span>-distribution of the test statistic <span class="citation">(<a href="references.html#ref-aho2014">Aho 2014</a>)</span>. The GUI we will create will run <span class="math inline">\(t\)</span>-tests on randomly generated data from two user-specified normal distributions <code>x1</code> and <code>x2</code>.</p>
<p>The function <code><a href="https://rdrr.io/r/base/sprintf.html">sprintf()</a></code> in <code>t_test()</code> uses C code to return a formatted combination of text and variable outcomes. The code below combines text and inputs for double precision values (indicated with <code>f</code>) for <span class="math inline">\(p\)</span>-values, and bounds for a 95% confidence interval for a true mean difference. The code <code>%0.3f</code> indicates rounding to three significant digits. As before, the code <code>\n</code> creates a text line break.</p>
<ul>
<li>
<strong><code>ui</code>:</strong> we use the function <code>numericInput()</code> to specify characteristics of the normal distributions under consideration. The <code>sliderInput()</code> function is used to specify <em>x</em>-limits in app-rendered ggplot frequency plot.</li>
</ul>
<div class="sourceCode" id="cb1213" startfrom="19"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r" style="counter-reset: source-line 18;"><span id="cb1213-19"><a href="ch11.html#cb1213-19"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb1213-20"><a href="ch11.html#cb1213-20"></a>  <span class="fu">fluidRow</span>(</span>
<span id="cb1213-21"><a href="ch11.html#cb1213-21"></a>    <span class="fu">column</span>(<span class="dv">4</span>,</span>
<span id="cb1213-22"><a href="ch11.html#cb1213-22"></a>      <span class="st">"Distribution 1"</span>,</span>
<span id="cb1213-23"><a href="ch11.html#cb1213-23"></a>      <span class="fu">numericInput</span>(<span class="st">"n1"</span>, <span class="at">label =</span> <span class="st">"n"</span>, <span class="at">value =</span> <span class="dv">200</span>, <span class="at">min =</span> <span class="dv">1</span>),</span>
<span id="cb1213-24"><a href="ch11.html#cb1213-24"></a>      <span class="fu">numericInput</span>(<span class="st">"mean1"</span>, <span class="at">label =</span> <span class="st">"µ"</span>, <span class="at">value =</span> <span class="dv">0</span>, <span class="at">step =</span> <span class="fl">0.1</span>),</span>
<span id="cb1213-25"><a href="ch11.html#cb1213-25"></a>      <span class="fu">numericInput</span>(<span class="st">"sd1"</span>, <span class="at">label =</span> <span class="st">"\u03c3"</span>, <span class="at">value =</span> <span class="fl">0.5</span>, <span class="at">min =</span> <span class="fl">0.1</span>, <span class="at">step =</span> <span class="fl">0.1</span>)</span>
<span id="cb1213-26"><a href="ch11.html#cb1213-26"></a>    ),</span>
<span id="cb1213-27"><a href="ch11.html#cb1213-27"></a>    <span class="fu">column</span>(<span class="dv">4</span>,</span>
<span id="cb1213-28"><a href="ch11.html#cb1213-28"></a>      <span class="st">"Distribution 2"</span>,</span>
<span id="cb1213-29"><a href="ch11.html#cb1213-29"></a>      <span class="fu">numericInput</span>(<span class="st">"n2"</span>, <span class="at">label =</span> <span class="st">"n"</span>, <span class="at">value =</span> <span class="dv">200</span>, <span class="at">min =</span> <span class="dv">1</span>),</span>
<span id="cb1213-30"><a href="ch11.html#cb1213-30"></a>      <span class="fu">numericInput</span>(<span class="st">"mean2"</span>, <span class="at">label =</span> <span class="st">"µ"</span>, <span class="at">value =</span> <span class="dv">0</span>, <span class="at">step =</span> <span class="fl">0.1</span>),</span>
<span id="cb1213-31"><a href="ch11.html#cb1213-31"></a>      <span class="fu">numericInput</span>(<span class="st">"sd2"</span>, <span class="at">label =</span> <span class="st">"\u03c3"</span>, <span class="at">value =</span> <span class="fl">0.5</span>, <span class="at">min =</span> <span class="fl">0.1</span>, <span class="at">step =</span> <span class="fl">0.1</span>)</span>
<span id="cb1213-32"><a href="ch11.html#cb1213-32"></a>    ),</span>
<span id="cb1213-33"><a href="ch11.html#cb1213-33"></a>    <span class="fu">column</span>(<span class="dv">4</span>,</span>
<span id="cb1213-34"><a href="ch11.html#cb1213-34"></a>      <span class="st">"Frequency polygon"</span>,</span>
<span id="cb1213-35"><a href="ch11.html#cb1213-35"></a>      <span class="fu">numericInput</span>(<span class="st">"binwidth"</span>, <span class="at">label =</span> <span class="st">"Bin width"</span>, <span class="at">value =</span> <span class="fl">0.1</span>, <span class="at">step =</span> <span class="fl">0.1</span>),</span>
<span id="cb1213-36"><a href="ch11.html#cb1213-36"></a>      <span class="fu">sliderInput</span>(<span class="st">"range"</span>, <span class="at">label =</span> <span class="st">"range"</span>, <span class="at">value =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>), <span class="at">min =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">max =</span> <span class="dv">5</span>)</span>
<span id="cb1213-37"><a href="ch11.html#cb1213-37"></a>    )</span>
<span id="cb1213-38"><a href="ch11.html#cb1213-38"></a>  ),</span>
<span id="cb1213-39"><a href="ch11.html#cb1213-39"></a>  <span class="fu">fluidRow</span>(</span>
<span id="cb1213-40"><a href="ch11.html#cb1213-40"></a>    <span class="fu">column</span>(<span class="dv">12</span>, <span class="fu">plotOutput</span>(<span class="st">"hist"</span>))</span>
<span id="cb1213-41"><a href="ch11.html#cb1213-41"></a>  ),</span>
<span id="cb1213-42"><a href="ch11.html#cb1213-42"></a>  <span class="fu">fluidRow</span>(</span>
<span id="cb1213-43"><a href="ch11.html#cb1213-43"></a>    <span class="fu">column</span>(<span class="dv">1</span>),</span>
<span id="cb1213-44"><a href="ch11.html#cb1213-44"></a>    <span class="fu">column</span>(<span class="dv">5</span>, <span class="fu">verbatimTextOutput</span>(<span class="st">"ttest"</span>)),</span>
<span id="cb1213-45"><a href="ch11.html#cb1213-45"></a>    <span class="fu">column</span>(<span class="dv">2</span>),</span>
<span id="cb1213-46"><a href="ch11.html#cb1213-46"></a>    <span class="fu">column</span>(<span class="dv">3</span>, <span class="fu">actionButton</span>(<span class="st">"simulate"</span>, <span class="st">"Simulate!"</span>)),</span>
<span id="cb1213-47"><a href="ch11.html#cb1213-47"></a>    <span class="fu">column</span>(<span class="dv">1</span>)</span>
<span id="cb1213-48"><a href="ch11.html#cb1213-48"></a>  )</span>
<span id="cb1213-49"><a href="ch11.html#cb1213-49"></a>)</span></code></pre></div>
<ul>
<li>
<strong><code>server</code>:</strong> In the server we use reactive programming to generate random samples from a normal distribution. Specifically, for the object <code>x1</code> we obtain a random sample of size <code>input$n1</code> from a normal distribution with a mean of <code>input$mean1</code> and a standard deviation of <code>input$sd1</code>. These parameter values are specified in the <code>ui</code>.</li>
</ul>
<div class="sourceCode" id="cb1214" startfrom="50"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r" style="counter-reset: source-line 49;"><span id="cb1214-50"><a href="ch11.html#cb1214-50"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb1214-51"><a href="ch11.html#cb1214-51"></a>  x1 <span class="ot">&lt;-</span> <span class="fu">reactive</span>({input<span class="sc">$</span>simulate</span>
<span id="cb1214-52"><a href="ch11.html#cb1214-52"></a>        <span class="fu">rnorm</span>(input<span class="sc">$</span>n1, input<span class="sc">$</span>mean1, input<span class="sc">$</span>sd1)})</span>
<span id="cb1214-53"><a href="ch11.html#cb1214-53"></a>  x2 <span class="ot">&lt;-</span> <span class="fu">reactive</span>({input<span class="sc">$</span>simulate</span>
<span id="cb1214-54"><a href="ch11.html#cb1214-54"></a>        <span class="fu">rnorm</span>(input<span class="sc">$</span>n2, input<span class="sc">$</span>mean2, input<span class="sc">$</span>sd2)})</span>
<span id="cb1214-55"><a href="ch11.html#cb1214-55"></a></span>
<span id="cb1214-56"><a href="ch11.html#cb1214-56"></a>  output<span class="sc">$</span>hist <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb1214-57"><a href="ch11.html#cb1214-57"></a>    <span class="fu">freqpoly</span>(<span class="fu">x1</span>(), <span class="fu">x2</span>(), <span class="at">binwidth =</span> input<span class="sc">$</span>binwidth, <span class="at">xlim =</span> input<span class="sc">$</span>range)</span>
<span id="cb1214-58"><a href="ch11.html#cb1214-58"></a>  }, <span class="at">res =</span> <span class="dv">96</span>)</span>
<span id="cb1214-59"><a href="ch11.html#cb1214-59"></a></span>
<span id="cb1214-60"><a href="ch11.html#cb1214-60"></a>  output<span class="sc">$</span>ttest <span class="ot">&lt;-</span> <span class="fu">renderText</span>({</span>
<span id="cb1214-61"><a href="ch11.html#cb1214-61"></a>    <span class="fu">t_test</span>(<span class="fu">x1</span>(), <span class="fu">x2</span>())</span>
<span id="cb1214-62"><a href="ch11.html#cb1214-62"></a>  })</span>
<span id="cb1214-63"><a href="ch11.html#cb1214-63"></a>}</span></code></pre></div>
<p>
- <strong><code>shinyApp</code>:</strong> As before, we generate the app using:</p>
<div class="sourceCode" id="cb1215" startfrom="64"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r" style="counter-reset: source-line 63;"><span id="cb1215-64"><a href="ch11.html#cb1215-64"></a><span class="fu">shinyApp</span>(ui, server)</span></code></pre></div>
<p>The final form of the app is shown in Fig <a href="ch11.html#fig:gg2">11.25</a>.</p>
<p>
</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:gg2"></span>
<img src="figs11/gg2.png" alt="A *shiny* app to demonstrate the mechanism of $t$-tests." width="70%"><p class="caption">
Figure 11.25: A <em>shiny</em> app to demonstrate the mechanism of <span class="math inline">\(t\)</span>-tests.
</p>
</div>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
</div>
<div id="additional-layout-control" class="section level3" number="11.5.5">
<h3>
<span class="header-section-number">11.5.5</span> Additional Layout Control<a class="anchor" aria-label="anchor" href="#additional-layout-control"><i class="fas fa-link"></i></a>
</h3>
<p>We have already learned about techniques like <code>fluidRow()</code> to control single page layouts in <code>fluidPage()</code>. Another popular HTML layout uses side panels. These can be implemented in the <em>shiny</em> <code>ui</code> using the functions <code>sidebarLayout()</code> and <code>sidebarPanel()</code>. Sidebar formatting is summarized in Fig <a href="ch11.html#fig:sb">11.26</a>.</p>
<p>
</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:sb"></span>
<img src="figs11/fluidpage.png" alt="Sidebar formatting for *shiny*. Figure taken from @wickham2021mastering." width="60%"><p class="caption">
Figure 11.26: Sidebar formatting for <em>shiny</em>. Figure taken from <span class="citation">Wickham (<a href="references.html#ref-wickham2021mastering">2021</a>)</span>.
</p>
</div>
<div class="example">
<p><span id="exm:exm-c11norm" class="example"><strong>Example 11.16  </strong></span><span class="math inline">\(\text{}\)</span><br>
Here is an example for displaying a normal distribution using sliders in sidebars.</p>
<ul>
<li>
<strong><code>ui</code>:</strong> The user interface specifies a sidebar layout, using <code>sidebarLayout()</code>, that contains a sidebar panel designated with <code>sidebarPanel</code>, and a main panel, designated with <code>mainPanel()</code>.</li>
</ul>
<p></p>
<div class="sourceCode" id="cb1216"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb1216-1"><a href="ch11.html#cb1216-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb1216-2"><a href="ch11.html#cb1216-2"></a>   <span class="fu">titlePanel</span>(<span class="fu">h1</span>(<span class="st">"Normal Distribution"</span>, <span class="at">align =</span> <span class="st">"center"</span>)),</span>
<span id="cb1216-3"><a href="ch11.html#cb1216-3"></a>   <span class="fu">sidebarLayout</span>(</span>
<span id="cb1216-4"><a href="ch11.html#cb1216-4"></a>      <span class="fu">sidebarPanel</span>(</span>
<span id="cb1216-5"><a href="ch11.html#cb1216-5"></a>         <span class="fu">sliderInput</span>(<span class="st">"mu"</span>, <span class="st">"\u03BC"</span>, <span class="at">step =</span> <span class="fl">0.2</span>, <span class="at">min =</span> <span class="sc">-</span><span class="dv">3</span>,</span>
<span id="cb1216-6"><a href="ch11.html#cb1216-6"></a>                     <span class="at">max =</span> <span class="dv">3</span>, <span class="at">value =</span> <span class="dv">0</span>),</span>
<span id="cb1216-7"><a href="ch11.html#cb1216-7"></a>         <span class="fu">sliderInput</span>(<span class="st">"sigma"</span>, <span class="st">"\u03C3"</span>, <span class="at">min =</span> <span class="fl">0.5</span>, <span class="at">max =</span> <span class="dv">3</span>,</span>
<span id="cb1216-8"><a href="ch11.html#cb1216-8"></a>                     <span class="at">value =</span> <span class="dv">1</span>), <span class="at">width =</span> <span class="dv">4</span></span>
<span id="cb1216-9"><a href="ch11.html#cb1216-9"></a>      ),</span>
<span id="cb1216-10"><a href="ch11.html#cb1216-10"></a>    <span class="fu">mainPanel</span>(<span class="fu">plotOutput</span>(<span class="st">"plot"</span>))</span>
<span id="cb1216-11"><a href="ch11.html#cb1216-11"></a>))</span></code></pre></div>
<ul>
<li>
<strong><code>server</code>:</strong> The only output from the <code>server</code> is a base <strong>R</strong> plot of the normal PDF.</li>
</ul>
<div class="sourceCode" id="cb1217" startfrom="12"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r" style="counter-reset: source-line 11;"><span id="cb1217-12"><a href="ch11.html#cb1217-12"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) ({</span>
<span id="cb1217-13"><a href="ch11.html#cb1217-13"></a>   xmin <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">4</span>; xmax <span class="ot">&lt;-</span> <span class="dv">4</span>; ymin <span class="ot">&lt;-</span> <span class="dv">0</span>; ymax <span class="ot">&lt;-</span> <span class="fl">0.8</span></span>
<span id="cb1217-14"><a href="ch11.html#cb1217-14"></a>   xx <span class="ot">&lt;-</span> <span class="fu">seq</span>(xmin, xmax, <span class="at">length =</span> <span class="dv">100</span>)</span>
<span id="cb1217-15"><a href="ch11.html#cb1217-15"></a></span>
<span id="cb1217-16"><a href="ch11.html#cb1217-16"></a>   output<span class="sc">$</span>plot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb1217-17"><a href="ch11.html#cb1217-17"></a>       yy <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(xx, input<span class="sc">$</span>mu, input<span class="sc">$</span>sigma)</span>
<span id="cb1217-18"><a href="ch11.html#cb1217-18"></a>       <span class="fu">plot</span>(xx, yy, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">xlim =</span> <span class="fu">c</span>(xmin, xmax), <span class="at">ylim =</span> <span class="fu">c</span>(ymin, ymax),</span>
<span id="cb1217-19"><a href="ch11.html#cb1217-19"></a>            <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="fu">italic</span>(x)),</span>
<span id="cb1217-20"><a href="ch11.html#cb1217-20"></a>            <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(f), <span class="st">"("</span>, <span class="fu">italic</span>(x), <span class="st">")"</span>, <span class="at">sep =</span> <span class="st">""</span>)),</span>
<span id="cb1217-21"><a href="ch11.html#cb1217-21"></a>            <span class="at">cex.axis =</span> <span class="fl">1.2</span>, <span class="at">cex.lab =</span> <span class="fl">1.2</span>, <span class="at">lwd =</span> <span class="fl">1.4</span>)</span>
<span id="cb1217-22"><a href="ch11.html#cb1217-22"></a>     })</span>
<span id="cb1217-23"><a href="ch11.html#cb1217-23"></a>})</span></code></pre></div>
<p>}
- <strong><code>shinyApp</code>:</strong> As before, we use <code>shinyApp()</code> to generate the app.</p>
<div class="sourceCode" id="cb1218" startfrom="24"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r" style="counter-reset: source-line 23;"><span id="cb1218-24"><a href="ch11.html#cb1218-24"></a><span class="fu">shinyApp</span>(ui, server)</span></code></pre></div>
<p>The final form of the app is shown in Fig <a href="ch11.html#fig:normdist">11.27</a>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:normdist"></span>
<img src="figs11/normdist.png" alt="A *shiny* app for demonstrating the normal distribution." width="80%"><p class="caption">
Figure 11.27: A <em>shiny</em> app for demonstrating the normal distribution.
</p>
</div>
<p>Interestingly, the app appears less reactive than an analogous plot GUI generated with <em>tcltk</em>. Compare the app from Fig <a href="ch11.html#fig:normdist">11.27</a> to <code><a href="https://rdrr.io/pkg/asbio/man/see.norm.tck.html">asbio::see.norm.tck()</a></code>.</p>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
<div id="multi-page-apps" class="section level4" number="11.5.5.1">
<h4>
<span class="header-section-number">11.5.5.1</span> Multi-page Apps<a class="anchor" aria-label="anchor" href="#multi-page-apps"><i class="fas fa-link"></i></a>
</h4>
<p>Complex apps may be impossible to fit onto a single page. In <em>shiny</em>, the simplest way to break a app page into multiple pages is to use <code>tabsetPanel()</code> and <code>tabPanel()</code>.
<span class="citation">Wickham (<a href="references.html#ref-wickham2021mastering">2021</a>)</span> that does not provide widget output because of its empty <code>server</code> (Fig <a href="ch11.html#fig:multipanel">11.28</a>). In the <code>ui</code> a tabset panel is generated using <code>tabsetPanel()</code>. This entity has three panels, each is generated using <code>tabPanel()</code>. Only the first panel <code>"Import data"</code> currently contains content.
</p>
<div class="sourceCode" id="cb1219"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb1219-1"><a href="ch11.html#cb1219-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb1219-2"><a href="ch11.html#cb1219-2"></a>  <span class="fu">tabsetPanel</span>(</span>
<span id="cb1219-3"><a href="ch11.html#cb1219-3"></a>    <span class="fu">tabPanel</span>(<span class="st">"Import data"</span>,</span>
<span id="cb1219-4"><a href="ch11.html#cb1219-4"></a>      <span class="fu">fileInput</span>(<span class="st">"file"</span>, <span class="st">"Data"</span>, <span class="at">buttonLabel =</span> <span class="st">"Upload..."</span>),</span>
<span id="cb1219-5"><a href="ch11.html#cb1219-5"></a>      <span class="fu">textInput</span>(<span class="st">"delim"</span>, <span class="st">"Delimiter"</span>, <span class="st">""</span>),</span>
<span id="cb1219-6"><a href="ch11.html#cb1219-6"></a>      <span class="fu">numericInput</span>(<span class="st">"skip"</span>, <span class="st">"Rows to skip"</span>, <span class="dv">0</span>, <span class="at">min =</span> <span class="dv">0</span>),</span>
<span id="cb1219-7"><a href="ch11.html#cb1219-7"></a>      <span class="fu">numericInput</span>(<span class="st">"rows"</span>, <span class="st">"Rows to preview"</span>, <span class="dv">10</span>, <span class="at">min =</span> <span class="dv">1</span>)</span>
<span id="cb1219-8"><a href="ch11.html#cb1219-8"></a>    ),</span>
<span id="cb1219-9"><a href="ch11.html#cb1219-9"></a>    <span class="fu">tabPanel</span>(<span class="st">"Set parameters"</span>),</span>
<span id="cb1219-10"><a href="ch11.html#cb1219-10"></a>    <span class="fu">tabPanel</span>(<span class="st">"Visualise results"</span>)</span>
<span id="cb1219-11"><a href="ch11.html#cb1219-11"></a>  )</span>
<span id="cb1219-12"><a href="ch11.html#cb1219-12"></a>)</span>
<span id="cb1219-13"><a href="ch11.html#cb1219-13"></a></span>
<span id="cb1219-14"><a href="ch11.html#cb1219-14"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb1219-15"><a href="ch11.html#cb1219-15"></a>}</span>
<span id="cb1219-16"><a href="ch11.html#cb1219-16"></a><span class="fu">shinyApp</span>(ui, server)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:multipanel"></span>
<img src="figs11/multipanel.png" alt="A *shiny* multipanel example." width="60%"><p class="caption">
Figure 11.28: A <em>shiny</em> multipanel example.
</p>
</div>
<p>A tabset can be an input when its <code>id</code> argument is used.
This allows an app to behave differently depending on which tab is currently visible (Fig <a href="ch11.html#fig:tabs2">11.29</a>).</p>
<div class="sourceCode" id="cb1220"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb1220-1"><a href="ch11.html#cb1220-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb1220-2"><a href="ch11.html#cb1220-2"></a>  <span class="fu">sidebarLayout</span>(</span>
<span id="cb1220-3"><a href="ch11.html#cb1220-3"></a>    <span class="fu">sidebarPanel</span>(</span>
<span id="cb1220-4"><a href="ch11.html#cb1220-4"></a>      <span class="fu">textOutput</span>(<span class="st">"panel"</span>)</span>
<span id="cb1220-5"><a href="ch11.html#cb1220-5"></a>    ),</span>
<span id="cb1220-6"><a href="ch11.html#cb1220-6"></a>    <span class="fu">mainPanel</span>(</span>
<span id="cb1220-7"><a href="ch11.html#cb1220-7"></a>      <span class="fu">tabsetPanel</span>(</span>
<span id="cb1220-8"><a href="ch11.html#cb1220-8"></a>        <span class="at">id =</span> <span class="st">"tabset"</span>,</span>
<span id="cb1220-9"><a href="ch11.html#cb1220-9"></a>        <span class="fu">tabPanel</span>(<span class="st">"panel 1"</span>),</span>
<span id="cb1220-10"><a href="ch11.html#cb1220-10"></a>        <span class="fu">tabPanel</span>(<span class="st">"panel 2"</span>),</span>
<span id="cb1220-11"><a href="ch11.html#cb1220-11"></a>        <span class="fu">tabPanel</span>(<span class="st">"panel 3"</span>)</span>
<span id="cb1220-12"><a href="ch11.html#cb1220-12"></a>      )</span>
<span id="cb1220-13"><a href="ch11.html#cb1220-13"></a>    )</span>
<span id="cb1220-14"><a href="ch11.html#cb1220-14"></a>  )</span>
<span id="cb1220-15"><a href="ch11.html#cb1220-15"></a>)</span>
<span id="cb1220-16"><a href="ch11.html#cb1220-16"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb1220-17"><a href="ch11.html#cb1220-17"></a>  output<span class="sc">$</span>panel <span class="ot">&lt;-</span> <span class="fu">renderText</span>({</span>
<span id="cb1220-18"><a href="ch11.html#cb1220-18"></a>    <span class="fu">paste</span>(<span class="st">"Current panel: "</span>, input<span class="sc">$</span>tabset)</span>
<span id="cb1220-19"><a href="ch11.html#cb1220-19"></a>  })</span>
<span id="cb1220-20"><a href="ch11.html#cb1220-20"></a>}</span>
<span id="cb1220-21"><a href="ch11.html#cb1220-21"></a><span class="fu">shinyApp</span>(ui, server)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:tabs2"></span>
<img src="figs11/tabs2.png" alt="Tabs for a multi-page app." width="100%"><p class="caption">
Figure 11.29: Tabs for a multi-page app.
</p>
</div>
<p>Because tabs are displayed horizontally, there is a limit to their number. The functions <code>navlistPanel()</code>, <code>navbarPage()</code>, and <code>navbarMenu()</code> provide vertical layouts that allow more tabs with longer titles (Fig <a href="ch11.html#fig:tabs3">11.30</a>).
</p>
<div class="sourceCode" id="cb1221"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb1221-1"><a href="ch11.html#cb1221-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb1221-2"><a href="ch11.html#cb1221-2"></a>  <span class="fu">navlistPanel</span>(</span>
<span id="cb1221-3"><a href="ch11.html#cb1221-3"></a>    <span class="at">id =</span> <span class="st">"tabset"</span>,</span>
<span id="cb1221-4"><a href="ch11.html#cb1221-4"></a>    <span class="st">"Heading 1"</span>,</span>
<span id="cb1221-5"><a href="ch11.html#cb1221-5"></a>    <span class="fu">tabPanel</span>(<span class="st">"panel 1"</span>, <span class="st">"Panel one contents"</span>),</span>
<span id="cb1221-6"><a href="ch11.html#cb1221-6"></a>    <span class="st">"Heading 2"</span>,</span>
<span id="cb1221-7"><a href="ch11.html#cb1221-7"></a>    <span class="fu">tabPanel</span>(<span class="st">"panel 2"</span>, <span class="st">"Panel two contents"</span>),</span>
<span id="cb1221-8"><a href="ch11.html#cb1221-8"></a>    <span class="fu">tabPanel</span>(<span class="st">"panel 3"</span>, <span class="st">"Panel three contents"</span>)</span>
<span id="cb1221-9"><a href="ch11.html#cb1221-9"></a>  )</span>
<span id="cb1221-10"><a href="ch11.html#cb1221-10"></a>)</span>
<span id="cb1221-11"><a href="ch11.html#cb1221-11"></a></span>
<span id="cb1221-12"><a href="ch11.html#cb1221-12"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb1221-13"><a href="ch11.html#cb1221-13"></a>}</span>
<span id="cb1221-14"><a href="ch11.html#cb1221-14"></a><span class="fu">shinyApp</span>(ui, server)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:tabs3"></span>
<img src="figs11/tabs2.png" alt="A multi-page app with vertical tabs." width="100%"><p class="caption">
Figure 11.30: A multi-page app with vertical tabs.
</p>
</div>
</div>
<div id="layout-themes" class="section level4" number="11.5.5.2">
<h4>
<span class="header-section-number">11.5.5.2</span> Layout Themes<a class="anchor" aria-label="anchor" href="#layout-themes"><i class="fas fa-link"></i></a>
</h4>
<p>Customization of the general <em>shiny</em> layout can be obtained by utilizing or modifying <strong>Bootstrap</strong><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Bootstrap is a collection of HTML conventions, Cascading Style Sheets (CSS) styles (CSS is a language used to style HTML documents, including colors and fonts), and java script snippets bundled into a convenient form.&lt;/p&gt;"><sup>108</sup></a> themes and classes.
These can include layouts specific to mobile apps (see package <em>RInterface</em>) and Google’s material design frame (see package <em>shinymaterial</em>).</p>
<p>
</p>
<p>Here we use the <code>"darkly"</code> bootswatch (Fig <a href="ch11.html#fig:bstheme">11.31</a>). Other choices include <code>"sandstone"</code>, <code>"flatly"</code>, and <code>"united"</code>.</p>
<div class="sourceCode" id="cb1222"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb1222-1"><a href="ch11.html#cb1222-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb1222-2"><a href="ch11.html#cb1222-2"></a>  <span class="at">theme =</span> bslib<span class="sc">::</span><span class="fu">bs_theme</span>(<span class="at">bootswatch =</span> <span class="st">"darkly"</span>),</span>
<span id="cb1222-3"><a href="ch11.html#cb1222-3"></a>  <span class="fu">sidebarLayout</span>(</span>
<span id="cb1222-4"><a href="ch11.html#cb1222-4"></a>    <span class="fu">sidebarPanel</span>(</span>
<span id="cb1222-5"><a href="ch11.html#cb1222-5"></a>      <span class="fu">textInput</span>(<span class="st">"txt"</span>, <span class="st">"Text input:"</span>, <span class="st">"text here"</span>),</span>
<span id="cb1222-6"><a href="ch11.html#cb1222-6"></a>      <span class="fu">sliderInput</span>(<span class="st">"slider"</span>, <span class="st">"Slider input:"</span>, <span class="dv">1</span>, <span class="dv">100</span>, <span class="dv">30</span>)</span>
<span id="cb1222-7"><a href="ch11.html#cb1222-7"></a>    ),</span>
<span id="cb1222-8"><a href="ch11.html#cb1222-8"></a>    <span class="fu">mainPanel</span>(</span>
<span id="cb1222-9"><a href="ch11.html#cb1222-9"></a>      <span class="fu">h1</span>(<span class="fu">paste0</span>(<span class="st">"Theme: darkly"</span>)),</span>
<span id="cb1222-10"><a href="ch11.html#cb1222-10"></a>      <span class="fu">h2</span>(<span class="st">"Header 2"</span>),</span>
<span id="cb1222-11"><a href="ch11.html#cb1222-11"></a>      <span class="fu">p</span>(<span class="st">"Some text"</span>)</span>
<span id="cb1222-12"><a href="ch11.html#cb1222-12"></a>    )</span>
<span id="cb1222-13"><a href="ch11.html#cb1222-13"></a>  )</span>
<span id="cb1222-14"><a href="ch11.html#cb1222-14"></a>)</span>
<span id="cb1222-15"><a href="ch11.html#cb1222-15"></a></span>
<span id="cb1222-16"><a href="ch11.html#cb1222-16"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb1222-17"><a href="ch11.html#cb1222-17"></a>}</span>
<span id="cb1222-18"><a href="ch11.html#cb1222-18"></a><span class="fu">shinyApp</span>(ui, server)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:bstheme"></span>
<img src="figs11/darkly.png" alt="A *shiny* app using the `darkly` bootswatch from Bootstrap." width="80%"><p class="caption">
Figure 11.31: A <em>shiny</em> app using the <code>darkly</code> bootswatch from Bootstrap.
</p>
</div>
<p>Further control of <em>shiny</em> apps can be achieved by programming directly in HTML, CSS, and Java<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;for more information, check this &lt;strong&gt;R&lt;/strong&gt;-studio help &lt;a href="https://shiny.rstudio.com/articles/html-ui.html"&gt;link&lt;/a&gt; and this &lt;a href="https://unleash-shiny.rinterface.com/index.html"&gt;link&lt;/a&gt; to a book by David Granjon&lt;/p&gt;'><sup>109</sup></a>. In fact, HTML code in <code>ui</code>s is revealed by running <code>ui</code> functions directly in the <strong>R</strong> console (Fig <a href="ch11.html#fig:HTMLcode">11.32</a>).</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:HTMLcode"></span>
<img src="figs11/HTML_code.png" alt="Representation of *shiny* code as HTML code." width="100%"><p class="caption">
Figure 11.32: Representation of <em>shiny</em> code as HTML code.
</p>
</div>
</div>
</div>
<div id="plotoutput-interactives" class="section level3" number="11.5.6">
<h3>
<span class="header-section-number">11.5.6</span> <code>plotOutput</code> Interactives<a class="anchor" aria-label="anchor" href="#plotoutput-interactives"><i class="fas fa-link"></i></a>
</h3>
<p>One of the perks of <code>plotOutput()</code> is that it can be an input that responds to mouse pointer events. Such controls are also possible with <em>tcltk</em> GUIs. A <em>shiny</em> plot can respond to four different mouse events: <code>click</code>, <code>dblclick</code> (double click), <code>hover</code> (i.e., the mouse stays in the same place), and <code>brush</code> (a rectangular selection tool).</p>
<div class="example">
<p><span id="exm:exm-c11mouse" class="example"><strong>Example 11.17  </strong></span><span class="math inline">\(\text{}\)</span><br>
Consider the following simple example:</p>
<div class="sourceCode" id="cb1223"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb1223-1"><a href="ch11.html#cb1223-1"></a>US <span class="ot">&lt;-</span> world.emissions <span class="sc">%&gt;%</span> <span class="fu">filter</span>(country <span class="sc">==</span> <span class="st">"United States"</span>)</span>
<span id="cb1223-2"><a href="ch11.html#cb1223-2"></a></span>
<span id="cb1223-3"><a href="ch11.html#cb1223-3"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb1223-4"><a href="ch11.html#cb1223-4"></a>  <span class="fu">plotOutput</span>(<span class="st">"plot"</span>, <span class="at">click =</span> <span class="st">"plot_click"</span>),</span>
<span id="cb1223-5"><a href="ch11.html#cb1223-5"></a>  <span class="fu">verbatimTextOutput</span>(<span class="st">"info"</span>)</span>
<span id="cb1223-6"><a href="ch11.html#cb1223-6"></a>)</span>
<span id="cb1223-7"><a href="ch11.html#cb1223-7"></a></span>
<span id="cb1223-8"><a href="ch11.html#cb1223-8"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output) {</span>
<span id="cb1223-9"><a href="ch11.html#cb1223-9"></a>  output<span class="sc">$</span>plot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb1223-10"><a href="ch11.html#cb1223-10"></a>    <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb1223-11"><a href="ch11.html#cb1223-11"></a>    <span class="fu">plot</span>(US<span class="sc">$</span>year, US<span class="sc">$</span>co2, <span class="at">xlab =</span> <span class="st">"Year"</span>,</span>
<span id="cb1223-12"><a href="ch11.html#cb1223-12"></a>         <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(CO[<span class="dv">2</span>], <span class="st">" ("</span>,<span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>, <span class="st">" tonnes)"</span>)), <span class="at">type =</span> <span class="st">"l"</span>)</span>
<span id="cb1223-13"><a href="ch11.html#cb1223-13"></a>  }, <span class="at">res =</span> <span class="dv">96</span>)</span>
<span id="cb1223-14"><a href="ch11.html#cb1223-14"></a></span>
<span id="cb1223-15"><a href="ch11.html#cb1223-15"></a>  output<span class="sc">$</span>info <span class="ot">&lt;-</span> <span class="fu">renderPrint</span>({</span>
<span id="cb1223-16"><a href="ch11.html#cb1223-16"></a>    <span class="fu">req</span>(input<span class="sc">$</span>plot_click)</span>
<span id="cb1223-17"><a href="ch11.html#cb1223-17"></a>    x <span class="ot">&lt;-</span> <span class="fu">round</span>(input<span class="sc">$</span>plot_click<span class="sc">$</span>x, <span class="dv">2</span>)</span>
<span id="cb1223-18"><a href="ch11.html#cb1223-18"></a>    y <span class="ot">&lt;-</span> <span class="fu">round</span>(input<span class="sc">$</span>plot_click<span class="sc">$</span>y, <span class="dv">2</span>)</span>
<span id="cb1223-19"><a href="ch11.html#cb1223-19"></a>    <span class="fu">cat</span>(<span class="st">"[year = "</span>, x, <span class="st">", CO2 = "</span>, y, <span class="st">" million tonnes]"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb1223-20"><a href="ch11.html#cb1223-20"></a>  })</span>
<span id="cb1223-21"><a href="ch11.html#cb1223-21"></a>}</span>
<span id="cb1223-22"><a href="ch11.html#cb1223-22"></a><span class="fu">shinyApp</span>(ui, server)</span></code></pre></div>
<p>Note the use of <code>req()</code>, to ensure the app doesn’t do anything before the first click. The resulting app is shown in Fig <a href="ch11.html#fig:mouse1">11.33</a>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:mouse1"></span>
<img src="figs11/mouse1.png" alt="A mouse interactive *shiny* app." width="100%"><p class="caption">
Figure 11.33: A mouse interactive <em>shiny</em> app.
</p>
</div>
<p>Here we use <code>nearPoints()</code> to return a dataframe for a point <em>near</em> a mouse click.</p>
<div class="sourceCode" id="cb1224"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb1224-1"><a href="ch11.html#cb1224-1"></a>US.ghg <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(US[,<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">14</span>,<span class="dv">15</span>)])</span>
<span id="cb1224-2"><a href="ch11.html#cb1224-2"></a></span>
<span id="cb1224-3"><a href="ch11.html#cb1224-3"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb1224-4"><a href="ch11.html#cb1224-4"></a>  <span class="fu">plotOutput</span>(<span class="st">"plot"</span>, <span class="at">click =</span> <span class="st">"plot_click"</span>),</span>
<span id="cb1224-5"><a href="ch11.html#cb1224-5"></a>  <span class="fu">tableOutput</span>(<span class="st">"data"</span>)</span>
<span id="cb1224-6"><a href="ch11.html#cb1224-6"></a>)</span>
<span id="cb1224-7"><a href="ch11.html#cb1224-7"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb1224-8"><a href="ch11.html#cb1224-8"></a>  output<span class="sc">$</span>plot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb1224-9"><a href="ch11.html#cb1224-9"></a>    <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb1224-10"><a href="ch11.html#cb1224-10"></a>    <span class="fu">plot</span>(US.ghg<span class="sc">$</span>year, US.ghg<span class="sc">$</span>co2, <span class="at">xlab =</span> <span class="st">"Year"</span>,</span>
<span id="cb1224-11"><a href="ch11.html#cb1224-11"></a>         <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(CO[<span class="dv">2</span>], <span class="st">" ("</span>,<span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>, <span class="st">" tonnes)"</span>)),</span>
<span id="cb1224-12"><a href="ch11.html#cb1224-12"></a>         <span class="at">type =</span> <span class="st">"l"</span>)</span>
<span id="cb1224-13"><a href="ch11.html#cb1224-13"></a>  }, <span class="at">res =</span> <span class="dv">96</span>)</span>
<span id="cb1224-14"><a href="ch11.html#cb1224-14"></a></span>
<span id="cb1224-15"><a href="ch11.html#cb1224-15"></a>  output<span class="sc">$</span>data <span class="ot">&lt;-</span> <span class="fu">renderTable</span>({</span>
<span id="cb1224-16"><a href="ch11.html#cb1224-16"></a>    <span class="fu">nearPoints</span>(US.ghg, input<span class="sc">$</span>plot_click,</span>
<span id="cb1224-17"><a href="ch11.html#cb1224-17"></a>               <span class="at">xvar =</span> <span class="st">"year"</span>, <span class="at">yvar =</span> <span class="st">"co2"</span>)</span>
<span id="cb1224-18"><a href="ch11.html#cb1224-18"></a>  })</span>
<span id="cb1224-19"><a href="ch11.html#cb1224-19"></a>}</span>
<span id="cb1224-20"><a href="ch11.html#cb1224-20"></a><span class="fu">shinyApp</span>(ui, server)</span></code></pre></div>
<p>The resulting app is shown in Fig <a href="ch11.html#fig:mouse2">11.34</a>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:mouse2"></span>
<img src="figs11/mouse2.png" alt="Another mouse interactive *shiny* app." width="100%"><p class="caption">
Figure 11.34: Another mouse interactive <em>shiny</em> app.
</p>
</div>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
</div>
<div id="putting-your-app-online" class="section level3" number="11.5.7">
<h3>
<span class="header-section-number">11.5.7</span> Putting Your App Online<a class="anchor" aria-label="anchor" href="#putting-your-app-online"><i class="fas fa-link"></i></a>
</h3>
<p>A <em>shiny</em> app will only work remotely (outside of an <strong>R</strong> session) if a server implementing <strong>R</strong> is used to call the app’s code. RStudio helps with this by housing a shiny server site shinyapps.io (Fig <a href="ch11.html#fig:shinyweb">11.35</a>). The site is currently free of charge for a relatively small number of personal applications.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:shinyweb"></span>
<img src="figs11/shiny_web.png" alt="The *shiny* apps website (https://www.shinyapps.io/)." width="100%"><p class="caption">
Figure 11.35: The <em>shiny</em> apps website (<a href="https://www.shinyapps.io/" class="uri">https://www.shinyapps.io/</a>).
</p>
</div>
<p>My personal shinyapps.io account is shown in Fig <a href="ch11.html#fig:shinyweb1">11.36</a>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:shinyweb1"></span>
<img src="figs11/shiny_web1.png" alt="My personal *shiny* apps website, with three apps." width="100%"><p class="caption">
Figure 11.36: My personal <em>shiny</em> apps website, with three apps.
</p>
</div>
<p>The account houses links for some apps summarizing the <a href="https://ahoken.shinyapps.io/Examples_of_Interactives_v1/">green house gas data</a>, and the <a href="https://ahoken.shinyapps.io/seeHW/">Hardy Weinberg equilibrium</a>.</p>
</div>
</div>
<div id="comparison-of-gui-generating-approaches" class="section level2" number="11.6">
<h2>
<span class="header-section-number">11.6</span> Comparison of GUI-generating Approaches<a class="anchor" aria-label="anchor" href="#comparison-of-gui-generating-approaches"><i class="fas fa-link"></i></a>
</h2>
<p>Three <strong>R</strong> GUI building approaches were described in this chapter. The package <em>tcltk</em> uses the Tcl/Tk GUI building tools alongside the native windowing capacities of Windows, Unix-like and Mac operating systems. The <em>plotly</em> and <em>shiny</em> libraries render GUIs under an HTML framework. A final comparative summary of the three approaches is given in Table <a href="ch11.html#tab:guimethods">11.4</a>.</p>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:guimethods">Table 11.4: </span>Comparison of the three approaches for GUI generation in <strong>R</strong> introduced in this chapter.</caption>
<colgroup>
<col width="2%">
<col width="25%">
<col width="39%">
<col width="33%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="left">Mechanics</th>
<th align="left">Strengths</th>
<th align="left">Weaknesses</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><em>tcltk</em></td>
<td align="left">Package provides binding for Tcl/Tk GUI building tools.</td>
<td align="left">1) Direct interfacing with <strong>R</strong> 2) Excellent GUI reactivity 3) Wide range of widgets</td>
<td align="left">1) Limited to <strong>R</strong> environment, 2) GUIs may have poor aesthetics, 3) Awkward coding frameworks, 4) Poor support online or otherwise.</td>
</tr>
<tr class="even">
<td align="left"><em>plotly</em></td>
<td align="left">Package provides language interfacing from <strong>R</strong> to JSON to HTML.</td>
<td align="left">1) After generation, does not require <strong>R</strong>, 2) Some built-in ggplot compatibility.</td>
<td align="left">1) GUI capabilities limited to plot interactives.</td>
</tr>
<tr class="odd">
<td align="left"><em>shiny</em></td>
<td align="left">Language interfacing from <strong>R</strong> to JSON to HTML. Maintains connection to <strong>R</strong> environment \end{tabular}</td>
<td align="left">1) Good support online and otherwise. 2) High level of RStudio compatibility. 3) Potentially aesthetic GUIs. 4) Straightforward coding 5) Wide range of widgets</td>
<td align="left">1) Requires direct connection to an <strong>R</strong> session, or server connection to an <strong>R</strong> environment, 2) Potentially poor reactivity.</td>
</tr>
</tbody>
</table></div>
</div>
<div id="exercises-10" class="section level2 unnumbered">
<h2>Exercises<a class="anchor" aria-label="anchor" href="#exercises-10"><i class="fas fa-link"></i></a>
</h2>
<ol style="list-style-type: decimal">
<li><p>Make a <em>tcltk</em> GUI that solves and reports the solutions to differential equations.</p></li>
<li><p>Make a <code>plotly</code> graph of any <code>gglot2</code> graph using <code>ggplotly</code>.</p></li>
<li><p>Make a <code>shiny</code> app to greet someone. Hint: place the two code chunks below in the <code>ui</code> and the <code>server</code> function, respectively.</p></li>
</ol>
<div class="sourceCode" id="cb1225"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">textInput</span><span class="op">(</span><span class="st">"name"</span>, <span class="st">"What's your name?"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb1226"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output</span><span class="op">$</span><span class="va">greeting</span> <span class="op">&lt;-</span> <span class="fu">renderText</span><span class="op">(</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Hello "</span>, <span class="va">input</span><span class="op">$</span><span class="va">name</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<div class="line-block">      Make the app interactive inside an <strong>R</strong> Markdown rendered document.<br>
      Along with the code, include a snapshot of the app in action.</div>
<p><br></p>
<ol start="4" style="list-style-type: decimal">
<li>Your friend has designed an app that solves the exponential growth function for a population with an initial population size of 10, and an intrinsic growth rate of 2, for times, <span class="math inline">\(t\)</span>, from 1 to 50:
<span class="math display">\[f(t) = 10 \times \exp(2 \times t).\]</span>
</li>
</ol>
<div class="sourceCode" id="cb1227"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu">fluidPage</span><span class="op">(</span></span>
<span>  <span class="fu">sliderInput</span><span class="op">(</span><span class="st">"t"</span>, label <span class="op">=</span> <span class="st">"If t is"</span>, min <span class="op">=</span> <span class="fl">1</span>, max <span class="op">=</span> <span class="fl">50</span>, value <span class="op">=</span> <span class="fl">30</span><span class="op">)</span>,</span>
<span>  <span class="st">"then the population size is"</span>,</span>
<span>  <span class="fu">textOutput</span><span class="op">(</span><span class="st">"exp.growth"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">output</span><span class="op">$</span><span class="va">exp.growth</span> <span class="op">&lt;-</span> <span class="fu">renderText</span><span class="op">(</span><span class="op">{</span><span class="fl">10</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">t</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">shinyApp</span><span class="op">(</span><span class="va">ui</span>, <span class="va">server</span><span class="op">)</span></span></code></pre></div>
<div class="line-block">      Does the function generate an error? Why?<br>
      Fix the code and provide a snapshot of the app in action.</div>

</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="ch10.html"><span class="header-section-number">10</span> Building R Packages</a></div>
<div class="next"><a href="ch12.html"><span class="header-section-number">12</span> R and Your Computer</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#ch11"><span class="header-section-number">11</span> Interactive and Web Applications</a></li>
<li><a class="nav-link" href="#introduction-to-guis"><span class="header-section-number">11.1</span> Introduction to GUIs</a></li>
<li>
<a class="nav-link" href="#tcltk"><span class="header-section-number">11.2</span> tcltk</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#asswidget"><span class="header-section-number">11.2.1</span> Assigning and Manipulating Widget Values</a></li>
<li><a class="nav-link" href="#user-functions-and-tcltk-guis"><span class="header-section-number">11.2.2</span> User functions and tcltk GUIs</a></li>
<li><a class="nav-link" href="#gui-geometry"><span class="header-section-number">11.2.3</span> GUI Geometry</a></li>
<li><a class="nav-link" href="#widget-modifications"><span class="header-section-number">11.2.4</span> Widget Modifications</a></li>
<li><a class="nav-link" href="#additional-tcltk-packages-and-toolkits"><span class="header-section-number">11.2.5</span> Additional tcltk Packages and Toolkits</a></li>
</ul>
</li>
<li><a class="nav-link" href="#JS"><span class="header-section-number">11.3</span> JS and JSON Interactive Apps</a></li>
<li>
<a class="nav-link" href="#plotly"><span class="header-section-number">11.4</span> plotly</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#ggplot-and-plotly"><span class="header-section-number">11.4.1</span> ggplot and plotly</a></li></ul>
</li>
<li>
<a class="nav-link" href="#shiny"><span class="header-section-number">11.5</span> shiny</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#ui-details"><span class="header-section-number">11.5.1</span> ui Details</a></li>
<li><a class="nav-link" href="#server-details"><span class="header-section-number">11.5.2</span> server Details</a></li>
<li><a class="nav-link" href="#running-shiny-apps-in-r-markdown"><span class="header-section-number">11.5.3</span> Running shiny Apps in R Markdown</a></li>
<li><a class="nav-link" href="#reactive-programming"><span class="header-section-number">11.5.4</span> Reactive Programming</a></li>
<li><a class="nav-link" href="#additional-layout-control"><span class="header-section-number">11.5.5</span> Additional Layout Control</a></li>
<li><a class="nav-link" href="#plotoutput-interactives"><span class="header-section-number">11.5.6</span> plotOutput Interactives</a></li>
<li><a class="nav-link" href="#putting-your-app-online"><span class="header-section-number">11.5.7</span> Putting Your App Online</a></li>
</ul>
</li>
<li><a class="nav-link" href="#comparison-of-gui-generating-approaches"><span class="header-section-number">11.6</span> Comparison of GUI-generating Approaches</a></li>
<li><a class="nav-link" href="#exercises-10">Exercises</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>An Amalgam of R</strong>: A Primer and Reference for Biologists" was written by Ken Aho. It was last built on 2025-01-29.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
